[{"input": "", "context": "/**\n * \n */\npackage com.gint.app.bisis4.client.editor.inventar;\nimport java.awt.Component;\nimport java.awt.Container;\nimport java.awt.Dimension;\nimport java.awt.FocusTraversalPolicy;\nimport java.awt.GridBagConstraints;\nimport java.awt.GridBagLayout;\nimport java.awt.event.ActionEvent;\nimport java.awt.event.ActionListener;\nimport java.awt.event.FocusAdapter;\nimport java.awt.event.FocusEvent;\nimport java.awt.event.KeyAdapter;\nimport java.awt.event.KeyEvent;\nimport javax.swing.ImageIcon;\nimport javax.swing.JButton;\nimport javax.swing.JInternalFrame;\nimport javax.swing.JLabel;\nimport javax.swing.JOptionPane;\nimport javax.swing.JPanel;\nimport javax.swing.JScrollPane;\nimport javax.swing.JSpinner;\nimport javax.swing.JTable;\nimport javax.swing.JTextField;\nimport javax.swing.ListSelectionModel;\nimport javax.swing.SpinnerNumberModel;\nimport javax.swing.event.ListSelectionEvent;\nimport javax.swing.event.ListSelectionListener;\nimport net.miginfocom.swing.MigLayout;\nimport com.gint.app.bisis4.client.BisisApp;\nimport com.gint.app.bisis4.client.editor.Messages;\nimport com.gint.app.bisis4.format.HoldingsDataCoders;\nimport com.gint.app.bisis4.format.UValidatorException;\nimport com.gint.app.bisis4.records.Primerak;\n/**\n * @author Bojana\n *\n */\npublic class RaspodelaFrame extends JInternalFrame {\n\t\n\tprivate JTable raspodelaTable;\t\n\tprivate JScrollPane raspodelaScrollPane;\n\t\n\tprivate JPanel raspodelaButtonsPanel;\t\n\tprivate JButton sacuvajButton;\n\tprivate JButton odustaniButton;\n\t\n\tprivate JTextField brojPrimTxtFld;\n\tprivate JTextField preostaloTxtFld;\n\tprivate CodedValuePanel odeljenjePanel;\n\tprivate CodedValuePanel invKnjPanel;\n\tprivate CodedValuePanel podlokacijaPanel;\n\t\n\tprivate JSpinner raspodelaSpinner;\n\tprivate JButton dodajButton;\n\t\n\tprivate InventarPanel inventarPanel;\t\n\tprivate RaspodelaTableModel raspodelaTableModel;\n\t\n  private boolean monograph = false;\n\t\n\t\n\tpublic RaspodelaFrame(InventarPanel mp) {\n    super(\"Raspodela primeraka\", true, true, false, false);\n    this.monograph = mp instanceof MonographInventarPanel;\n    if(!monograph) setTitle(\"Raspodela godina\");\n\t\t\n\t\tthis.inventarPanel = mp;\n\t\tthis.setSize(new Dimension(800,400));\n\t\tcreate();\t\t\n\t}\n\t\n\tprivate void create(){\t\t\n\t\traspodelaTable = new JTable();\n\t\tbrojPrimTxtFld = new JTextField();\n\t\tpreostaloTxtFld = new JTextField();\n\t\tdodajButton = new JButton(new ImageIcon(RaspodelaFrame.class\n\t\t\t\t.getResource(\"/com/gint/app/bisis4/client/images/Check16.png\")));\n\t\tpreostaloTxtFld.setEditable(false);\n\t\tpreostaloTxtFld.setFocusable(false);    \n\t\todeljenjePanel = new CodedValuePanel(HoldingsDataCoders.ODELJENJE_CODER,null);\n\t\todeljenjePanel.setDefaultOdeljenje();\n\t\tinvKnjPanel = new CodedValuePanel(HoldingsDataCoders.INVENTARNAKNJIGA_CODER,null);\n\t\tpodlokacijaPanel = new CodedValuePanel(HoldingsDataCoders.PODLOKACIJA_CODER, null);\n\t\traspodelaSpinner = new JSpinner();\t\t\n\t\traspodelaSpinner.setValue(new Integer(1));\n\t\tSpinnerNumberModel spinnerModel = new SpinnerNumberModel(0,0,1000,1);\n\t\traspodelaSpinner.setModel(spinnerModel);\n\t\traspodelaSpinner.setPreferredSize(new Dimension(40,20));\n\t\t\n\t\t//raspodelaSpinner.set\n\t\t\n\t\t\n\t\traspodelaTableModel = new RaspodelaTableModel(this);\n\t\traspodelaTable.setModel(raspodelaTableModel);\t\t\n\t\traspodelaTable.doLayout();\n\t\traspodelaScrollPane = new JScrollPane(raspodelaTable);\n\t\t\n\t\traspodelaButtonsPanel = new JPanel();\n\t\tsacuvajButton = new JButton(\"Raspodeli\");\n\t\tsacuvajButton.setIcon(new ImageIcon(getClass().getResource(\n        \"/com/gint/app/bisis4/client/images/ok.gif\")));\n\t\tsacuvajButton.setEnabled(false);\n\t\todustaniButton = new JButton(\"Odustani\");\n\t\todustaniButton.setIcon(new ImageIcon(getClass().getResource(\n        \"/com/gint/app/bisis4/client/images/remove.gif\")));\n\t\traspodelaButtonsPanel.setLayout(new GridBagLayout());\n\t\tGridBagConstraints cB = new GridBagConstraints();\n\t\tcB.gridx = 0;\n\t\tcB.gridy = 0;\n\t\tcB.weightx = 0.1;\n\t\traspodelaButtonsPanel.add(sacuvajButton,cB);\n\t\tinitialize();\n\t\t\n\t\tMigLayout layout = new MigLayout(\"\",\"[][]20[]\",\"[][]30[]0[]10[]0[]10[][]\");\n\t\tsetLayout(layout);\n\t\t\n\t\tadd(new JLabel(\"Broj knjiga za raspodelu:\"),\"align right\");\t\t\n\t\tadd(brojPrimTxtFld,\"wrap, width :30: \");\t\t\n\t\tadd(new JLabel(\"Preostalo:\"),\"align right\");\t\t\n\t\tadd(preostaloTxtFld,\"wrap, width :30:\");\n\t\n\t\tadd(new JLabel(\"Odeljenje:\"),\"cell 0 2 2 1\");\n\t\tadd(odeljenjePanel,\"cell 0 3 2 1\");\n\t\tadd(new JLabel(\"Inventarna knjiga:\"),\"cell 0 4 2 1\");\n\t\tadd(invKnjPanel,   \"cell 0 5 2 1\");\n\t\tadd(new JLabel(\"Podlokacija:\"),\"cell 0 6 2 1\");\n\t\tadd(podlokacijaPanel,   \"cell 0 7 2 1\");\n\t\t\n\t\tJPanel brPrim = new JPanel();\n\t\tbrPrim.setLayout(new MigLayout());\n\t\tbrPrim.add(new JLabel(\"Broj primeraka:\"));\n\t\tbrPrim.add(raspodelaSpinner,\"growy\");\n\t\tbrPrim.add(dodajButton);\t\t\n\t\tadd(brPrim,\"cell 0 8 2 1\");\t\t\n\t\tadd(raspodelaScrollPane,\"cell 2 0 1 7, grow\");\t\t\n\t\tJPanel buttonsPanel = new JPanel();\t\t\n\t\tbuttonsPanel.add(sacuvajButton);\n\t\tbuttonsPanel.add(odustaniButton);\n\t\tadd(buttonsPanel,\"cell 2 9 1 1, align right\");\n    \n    RaspodelaFocusTraversalPolicy policy = new RaspodelaFocusTraversalPolicy();\n    setFocusTraversalPolicy(policy);\n\t\t\n\t\t\n\t\t\n\t\t//actions\n\t\tbrojPrimTxtFld.addFocusListener(new FocusAdapter(){\n\t\t\tpublic void focusLost(FocusEvent e) {\n\t\t\t\thandleSetPreostalo();\n\t\t\t\t\n\t\t\t}\t\t\t\n\t\t});\n\t\t\n\t\tdodajButton.addActionListener(new ActionListener(){\n\t\t\tpublic void actionPerformed(ActionEvent e) {\n\t\t\t\thandleAddPrimerak();\t\t\t\n\t\t\t}\n\t\t\t\n\t\t});\n\t\t\n\t\tListSelectionModel lSelModel = raspodelaTable.getSelectionModel();\n\t\tlSelModel.addListSelectionListener(new ListSelectionListener(){\n\t\t\tpublic void valueChanged(ListSelectionEvent e) {\t\t\t\t\n\t\t\t\t\thandleLoadPrimerak();\t\t\t\t\n\t\t\t}\t\t\t\n\t\t});\n\t\t\n\t\t\n\t\traspodelaTable.addKeyListener(new KeyAdapter(){\n\t\t\tpublic void keyPressed(KeyEvent e) {\n\t\t\t\thandleKeys(e);\n\t\t\t}\t\t\t\n\t\t});\t\t\n\t\t\n\t\tsacuvajButton.addActionListener(new ActionListener(){\n\t\t\tpublic void actionPerformed(ActionEvent e) {\n\t\t\t\thandleRaspodeli();\t\t\t\t\n\t\t\t}\t\t\t\n\t\t});\t\n\t\t\n\t\todustaniButton.addActionListener(new ActionListener(){\n\t\t\tpublic void actionPerformed(ActionEvent e) {\n\t\t\t\thandleClose();\t\t\t\t\n\t\t\t}\t\t\t\n\t\t});\n\t}\n\t\n\tprivate void initialize(){\n\t\tbrojPrimTxtFld.setText(\"0\");\n\t}\n\t\n\tprivate void handleAddPrimerak() {\t\n\t\tPrimerak primerak = ((MonographInventarPanel)inventarPanel).getPrimerakFromForm();\n\t\ttry {\n\t\t\tif (odeljenjePanel.getCode().equals(\"\") || odeljenjePanel.getCode().equals(\"\")) \n\t\t\t\tthrow new RaspodelaException(\"Nisu uneti svi podaci za raspodelu!\");\n\t\t\tprimerak.setOdeljenje(odeljenjePanel.getCode());\n", "answers": ["\t\t\tString invKnj = invKnjPanel.getCode();"], "incorrect_answer": "String invKnj = invKnjPanel.retrieveCode();"}, {"input": "", "context": "#region License\n// Copyright (c) 2013, ClearCanvas Inc.\n// All rights reserved.\n// http://www.clearcanvas.ca\n//\n// This file is part of the ClearCanvas RIS/PACS open source project.\n//\n// The ClearCanvas RIS/PACS open source project is free software: you can\n// redistribute it and/or modify it under the terms of the GNU General Public\n// License as published by the Free Software Foundation, either version 3 of the\n// License, or (at your option) any later version.\n//\n// The ClearCanvas RIS/PACS open source project is distributed in the hope that it\n// will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General\n// Public License for more details.\n//\n// You should have received a copy of the GNU General Public License along with\n// the ClearCanvas RIS/PACS open source project.  If not, see\n// <http://www.gnu.org/licenses/>.\n#endregion\n// This file is auto-generated by the ClearCanvas.Model.SqlServer.CodeGenerator project.\nnamespace ClearCanvas.ImageServer.Model.EntityBrokers\n{\n    using System;\n    using System.Xml;\n    using ClearCanvas.Enterprise.Core;\n    using ClearCanvas.ImageServer.Enterprise;\n    public partial class WorkQueueSelectCriteria : EntitySelectCriteria\n    {\n        public WorkQueueSelectCriteria()\n        : base(\"WorkQueue\")\n        {}\n        public WorkQueueSelectCriteria(WorkQueueSelectCriteria other)\n        : base(other)\n        {}\n        public override object Clone()\n        {\n            return new WorkQueueSelectCriteria(this);\n        }\n        [EntityFieldDatabaseMappingAttribute(TableName=\"WorkQueue\", ColumnName=\"ServerPartitionGUID\")]\n        public ISearchCondition<ServerEntityKey> ServerPartitionKey\n        {\n            get\n            {\n              if (!SubCriteria.ContainsKey(\"ServerPartitionKey\"))\n              {\n                 SubCriteria[\"ServerPartitionKey\"] = new SearchCondition<ServerEntityKey>(\"ServerPartitionKey\");\n              }\n              return (ISearchCondition<ServerEntityKey>)SubCriteria[\"ServerPartitionKey\"];\n            } \n        }\n        [EntityFieldDatabaseMappingAttribute(TableName=\"WorkQueue\", ColumnName=\"StudyStorageGUID\")]\n        public ISearchCondition<ServerEntityKey> StudyStorageKey\n        {\n            get\n            {\n              if (!SubCriteria.ContainsKey(\"StudyStorageKey\"))\n              {\n                 SubCriteria[\"StudyStorageKey\"] = new SearchCondition<ServerEntityKey>(\"StudyStorageKey\");\n              }\n              return (ISearchCondition<ServerEntityKey>)SubCriteria[\"StudyStorageKey\"];\n            } \n        }\n        [EntityFieldDatabaseMappingAttribute(TableName=\"WorkQueue\", ColumnName=\"WorkQueueTypeEnum\")]\n        public ISearchCondition<WorkQueueTypeEnum> WorkQueueTypeEnum\n        {\n            get\n            {\n              if (!SubCriteria.ContainsKey(\"WorkQueueTypeEnum\"))\n              {\n                 SubCriteria[\"WorkQueueTypeEnum\"] = new SearchCondition<WorkQueueTypeEnum>(\"WorkQueueTypeEnum\");\n              }\n              return (ISearchCondition<WorkQueueTypeEnum>)SubCriteria[\"WorkQueueTypeEnum\"];\n            } \n        }\n        [EntityFieldDatabaseMappingAttribute(TableName=\"WorkQueue\", ColumnName=\"WorkQueueStatusEnum\")]\n        public ISearchCondition<WorkQueueStatusEnum> WorkQueueStatusEnum\n        {\n            get\n            {\n              if (!SubCriteria.ContainsKey(\"WorkQueueStatusEnum\"))\n              {\n                 SubCriteria[\"WorkQueueStatusEnum\"] = new SearchCondition<WorkQueueStatusEnum>(\"WorkQueueStatusEnum\");\n              }\n              return (ISearchCondition<WorkQueueStatusEnum>)SubCriteria[\"WorkQueueStatusEnum\"];\n            } \n        }\n        [EntityFieldDatabaseMappingAttribute(TableName=\"WorkQueue\", ColumnName=\"WorkQueuePriorityEnum\")]\n        public ISearchCondition<WorkQueuePriorityEnum> WorkQueuePriorityEnum\n        {\n            get\n            {\n              if (!SubCriteria.ContainsKey(\"WorkQueuePriorityEnum\"))\n              {\n                 SubCriteria[\"WorkQueuePriorityEnum\"] = new SearchCondition<WorkQueuePriorityEnum>(\"WorkQueuePriorityEnum\");\n              }\n              return (ISearchCondition<WorkQueuePriorityEnum>)SubCriteria[\"WorkQueuePriorityEnum\"];\n            } \n        }\n        [EntityFieldDatabaseMappingAttribute(TableName=\"WorkQueue\", ColumnName=\"FailureCount\")]\n        public ISearchCondition<Int32> FailureCount\n        {\n            get\n            {\n              if (!SubCriteria.ContainsKey(\"FailureCount\"))\n              {\n                 SubCriteria[\"FailureCount\"] = new SearchCondition<Int32>(\"FailureCount\");\n              }\n              return (ISearchCondition<Int32>)SubCriteria[\"FailureCount\"];\n            } \n        }\n        [EntityFieldDatabaseMappingAttribute(TableName=\"WorkQueue\", ColumnName=\"ScheduledTime\")]\n        public ISearchCondition<DateTime> ScheduledTime\n        {\n            get\n            {\n              if (!SubCriteria.ContainsKey(\"ScheduledTime\"))\n              {\n                 SubCriteria[\"ScheduledTime\"] = new SearchCondition<DateTime>(\"ScheduledTime\");\n              }\n              return (ISearchCondition<DateTime>)SubCriteria[\"ScheduledTime\"];\n            } \n        }\n        [EntityFieldDatabaseMappingAttribute(TableName=\"WorkQueue\", ColumnName=\"InsertTime\")]\n        public ISearchCondition<DateTime> InsertTime\n        {\n            get\n            {\n              if (!SubCriteria.ContainsKey(\"InsertTime\"))\n              {\n                 SubCriteria[\"InsertTime\"] = new SearchCondition<DateTime>(\"InsertTime\");\n              }\n              return (ISearchCondition<DateTime>)SubCriteria[\"InsertTime\"];\n            } \n        }\n        [EntityFieldDatabaseMappingAttribute(TableName=\"WorkQueue\", ColumnName=\"LastUpdatedTime\")]\n        public ISearchCondition<DateTime?> LastUpdatedTime\n        {\n            get\n            {\n              if (!SubCriteria.ContainsKey(\"LastUpdatedTime\"))\n              {\n                 SubCriteria[\"LastUpdatedTime\"] = new SearchCondition<DateTime?>(\"LastUpdatedTime\");\n              }\n              return (ISearchCondition<DateTime?>)SubCriteria[\"LastUpdatedTime\"];\n            } \n        }\n        [EntityFieldDatabaseMappingAttribute(TableName=\"WorkQueue\", ColumnName=\"FailureDescription\")]\n        public ISearchCondition<String> FailureDescription\n        {\n            get\n            {\n              if (!SubCriteria.ContainsKey(\"FailureDescription\"))\n              {\n                 SubCriteria[\"FailureDescription\"] = new SearchCondition<String>(\"FailureDescription\");\n              }\n              return (ISearchCondition<String>)SubCriteria[\"FailureDescription\"];\n            } \n        }\n        [EntityFieldDatabaseMappingAttribute(TableName=\"WorkQueue\", ColumnName=\"Data\")]\n        public ISearchCondition<XmlDocument> Data\n        {\n            get\n            {\n              if (!SubCriteria.ContainsKey(\"Data\"))\n              {\n                 SubCriteria[\"Data\"] = new SearchCondition<XmlDocument>(\"Data\");\n              }\n              return (ISearchCondition<XmlDocument>)SubCriteria[\"Data\"];\n            } \n        }\n        [EntityFieldDatabaseMappingAttribute(TableName=\"WorkQueue\", ColumnName=\"ExternalRequestQueueGUID\")]\n        public ISearchCondition<ServerEntityKey> ExternalRequestQueueKey\n        {\n            get\n            {\n              if (!SubCriteria.ContainsKey(\"ExternalRequestQueueKey\"))\n              {\n                 SubCriteria[\"ExternalRequestQueueKey\"] = new SearchCondition<ServerEntityKey>(\"ExternalRequestQueueKey\");\n              }\n              return (ISearchCondition<ServerEntityKey>)SubCriteria[\"ExternalRequestQueueKey\"];\n            } \n        }\n        [EntityFieldDatabaseMappingAttribute(TableName=\"WorkQueue\", ColumnName=\"ProcessorID\")]\n        public ISearchCondition<String> ProcessorID\n        {\n            get\n            {\n              if (!SubCriteria.ContainsKey(\"ProcessorID\"))\n              {\n                 SubCriteria[\"ProcessorID\"] = new SearchCondition<String>(\"ProcessorID\");\n              }\n              return (ISearchCondition<String>)SubCriteria[\"ProcessorID\"];\n            } \n        }\n        [EntityFieldDatabaseMappingAttribute(TableName=\"WorkQueue\", ColumnName=\"GroupID\")]\n        public ISearchCondition<String> GroupID\n        {\n            get\n            {\n              if (!SubCriteria.ContainsKey(\"GroupID\"))\n              {\n", "answers": ["                 SubCriteria[\"GroupID\"] = new SearchCondition<String>(\"GroupID\");"], "incorrect_answer": "SubCriteria[\"GroupID\"] = new SearchCondition<Int32>(\"GroupID\");"}, {"input": "", "context": "/*\n * Handlers.cs - Implementation of the \"I18N.Common.Handlers\" class.\n *\n * Copyright (c) 2002  Southern Storm Software, Pty Ltd\n *\n * Permission is hereby granted, free of charge, to any person obtaining\n * a copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included\n * in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL\n * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR\n * OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,\n * ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n * OTHER DEALINGS IN THE SOFTWARE.\n */\nnamespace I18N.Common\n{\nusing System;\nusing System.Collections.Generic;\n// This class provides an internal list of handlers, for runtime\n// engines that do not implement the altered \"GetFile\" semantics.\n// The list must be kept up to date manually.\npublic sealed class Handlers\n{\n    public static readonly String[] List = {\n        \"I18N.CJK.CP932\",\n        \"I18N.CJK.CP936\",\n        \"I18N.CJK.CP949\",\n        \"I18N.CJK.CP950\",\n        \"I18N.CJK.CP50220\",\n        \"I18N.CJK.CP50221\",\n        \"I18N.CJK.CP50222\",\n        \"I18N.CJK.CP51932\",\n        \"I18N.CJK.CP51949\",\n        \"I18N.CJK.CP54936\",\n        \"I18N.CJK.ENCbig5\",\n        \"I18N.CJK.ENCgb2312\",\n        \"I18N.CJK.ENCshift_jis\",\n        \"I18N.CJK.ENCiso_2022_jp\",\n        \"I18N.CJK.ENCeuc_jp\",\n        \"I18N.CJK.ENCeuc_kr\",\n        \"I18N.CJK.ENCuhc\",\n        \"I18N.CJK.ENCgb18030\",\n        \"I18N.MidEast.CP1254\",\n        \"I18N.MidEast.ENCwindows_1254\",\n        \"I18N.MidEast.CP1255\",\n        \"I18N.MidEast.ENCwindows_1255\",\n        \"I18N.MidEast.CP1256\",\n        \"I18N.MidEast.ENCwindows_1256\",\n        \"I18N.MidEast.CP28596\",\n        \"I18N.MidEast.ENCiso_8859_6\",\n        \"I18N.MidEast.CP28598\",\n        \"I18N.MidEast.ENCiso_8859_8\",\n        \"I18N.MidEast.CP28599\",\n        \"I18N.MidEast.ENCiso_8859_9\",\n        \"I18N.MidEast.CP38598\",\n        \"I18N.MidEast.ENCwindows_38598\",\n        \"I18N.Other.CP1251\",\n        \"I18N.Other.ENCwindows_1251\",\n        \"I18N.Other.CP1257\",\n        \"I18N.Other.ENCwindows_1257\",\n        \"I18N.Other.CP1258\",\n        \"I18N.Other.ENCwindows_1258\",\n        \"I18N.Other.CP20866\",\n        \"I18N.Other.ENCkoi8_r\",\n        \"I18N.Other.CP21866\",\n        \"I18N.Other.ENCkoi8_u\",\n        \"I18N.Other.CP28594\",\n        \"I18N.Other.ENCiso_8859_4\",\n        \"I18N.Other.CP28595\",\n        \"I18N.Other.ENCiso_8859_5\",\n        \"I18N.Other.ISCIIEncoding\",\n        \"I18N.Other.CP57002\",\n        \"I18N.Other.CP57003\",\n        \"I18N.Other.CP57004\",\n        \"I18N.Other.CP57005\",\n        \"I18N.Other.CP57006\",\n        \"I18N.Other.CP57007\",\n        \"I18N.Other.CP57008\",\n        \"I18N.Other.CP57009\",\n        \"I18N.Other.CP57010\",\n        \"I18N.Other.CP57011\",\n        \"I18N.Other.ENCx_iscii_de\",\n        \"I18N.Other.ENCx_iscii_be\",\n        \"I18N.Other.ENCx_iscii_ta\",\n        \"I18N.Other.ENCx_iscii_te\",\n        \"I18N.Other.ENCx_iscii_as\",\n        \"I18N.Other.ENCx_iscii_or\",\n        \"I18N.Other.ENCx_iscii_ka\",\n        \"I18N.Other.ENCx_iscii_ma\",\n        \"I18N.Other.ENCx_iscii_gu\",\n        \"I18N.Other.ENCx_iscii_pa\",\n        \"I18N.Other.CP874\",\n        \"I18N.Other.ENCwindows_874\",\n        \"I18N.Rare.CP1026\",\n        \"I18N.Rare.ENCibm1026\",\n        \"I18N.Rare.CP1047\",\n        \"I18N.Rare.ENCibm1047\",\n        \"I18N.Rare.CP1140\",\n        \"I18N.Rare.ENCibm01140\",\n        \"I18N.Rare.CP1141\",\n        \"I18N.Rare.ENCibm01141\",\n        \"I18N.Rare.CP1142\",\n        \"I18N.Rare.ENCibm01142\",\n        \"I18N.Rare.CP1143\",\n        \"I18N.Rare.ENCibm01143\",\n        \"I18N.Rare.CP1144\",\n        \"I18N.Rare.ENCibm1144\",\n        \"I18N.Rare.CP1145\",\n        \"I18N.Rare.ENCibm1145\",\n        \"I18N.Rare.CP1146\",\n        \"I18N.Rare.ENCibm1146\",\n        \"I18N.Rare.CP1147\",\n        \"I18N.Rare.ENCibm1147\",\n        \"I18N.Rare.CP1148\",\n        \"I18N.Rare.ENCibm1148\",\n        \"I18N.Rare.CP1149\",\n        \"I18N.Rare.ENCibm1149\",\n        \"I18N.Rare.CP20273\",\n        \"I18N.Rare.ENCibm273\",\n        \"I18N.Rare.CP20277\",\n        \"I18N.Rare.ENCibm277\",\n        \"I18N.Rare.CP20278\",\n        \"I18N.Rare.ENCibm278\",\n        \"I18N.Rare.CP20280\",\n        \"I18N.Rare.ENCibm280\",\n        \"I18N.Rare.CP20284\",\n        \"I18N.Rare.ENCibm284\",\n        \"I18N.Rare.CP20285\",\n        \"I18N.Rare.ENCibm285\",\n        \"I18N.Rare.CP20290\",\n        \"I18N.Rare.ENCibm290\",\n        \"I18N.Rare.CP20297\",\n        \"I18N.Rare.ENCibm297\",\n        \"I18N.Rare.CP20420\",\n        \"I18N.Rare.ENCibm420\",\n        \"I18N.Rare.CP20424\",\n        \"I18N.Rare.ENCibm424\",\n        \"I18N.Rare.CP20871\",\n        \"I18N.Rare.ENCibm871\",\n        \"I18N.Rare.CP21025\",\n        \"I18N.Rare.ENCibm1025\",\n        \"I18N.Rare.CP37\",\n        \"I18N.Rare.ENCibm037\",\n        \"I18N.Rare.CP500\",\n        \"I18N.Rare.ENCibm500\",\n        \"I18N.Rare.CP708\",\n        \"I18N.Rare.ENCasmo_708\",\n        \"I18N.Rare.CP852\",\n        \"I18N.Rare.ENCibm852\",\n        \"I18N.Rare.CP855\",\n        \"I18N.Rare.ENCibm855\",\n        \"I18N.Rare.CP857\",\n        \"I18N.Rare.ENCibm857\",\n        \"I18N.Rare.CP858\",\n        \"I18N.Rare.ENCibm00858\",\n        \"I18N.Rare.CP862\",\n        \"I18N.Rare.ENCibm862\",\n        \"I18N.Rare.CP864\",\n        \"I18N.Rare.ENCibm864\",\n        \"I18N.Rare.CP866\",\n        \"I18N.Rare.ENCibm866\",\n        \"I18N.Rare.CP869\",\n        \"I18N.Rare.ENCibm869\",\n        \"I18N.Rare.CP870\",\n        \"I18N.Rare.ENCibm870\",\n        \"I18N.Rare.CP875\",\n        \"I18N.Rare.ENCibm875\",\n        \"I18N.West.CP10000\",\n        \"I18N.West.ENCmacintosh\",\n        \"I18N.West.CP10079\",\n        \"I18N.West.ENCx_mac_icelandic\",\n        \"I18N.West.CP1250\",\n        \"I18N.West.ENCwindows_1250\",\n        \"I18N.West.CP1252\",\n        \"I18N.West.ENCwindows_1252\",\n        \"I18N.West.CP1253\",\n        \"I18N.West.ENCwindows_1253\",\n        \"I18N.West.CP28592\",\n        \"I18N.West.ENCiso_8859_2\",\n        \"I18N.West.CP28593\",\n        \"I18N.West.ENCiso_8859_3\",\n        \"I18N.West.CP28597\",\n        \"I18N.West.ENCiso_8859_7\",\n        \"I18N.West.CP28605\",\n        \"I18N.West.ENCiso_8859_15\",\n        \"I18N.West.CP437\",\n        \"I18N.West.ENCibm437\",\n        \"I18N.West.CP850\",\n        \"I18N.West.ENCibm850\",\n        \"I18N.West.CP860\",\n        \"I18N.West.ENCibm860\",\n        \"I18N.West.CP861\",\n        \"I18N.West.ENCibm861\",\n        \"I18N.West.CP863\",\n        \"I18N.West.ENCibm863\",\n        \"I18N.West.CP865\",\n        \"I18N.West.ENCibm865\"\n    };\n\t\n\tstatic Dictionary<string, string> aliases;\n\tpublic static string GetAlias (string name)\n\t{\n\t\tif (aliases == null)\n\t\t\tBuildHash ();\n\t\tstring v;\n\t\taliases.TryGetValue (name, out v);\n\t\treturn v;\n\t}\n\tstatic void BuildHash ()\n\t{\n\t\taliases = new Dictionary<string, string> (StringComparer.OrdinalIgnoreCase);\n\t\taliases.Add (\"arabic\", \"iso_8859_6\");\n\t\taliases.Add (\"csISOLatinArabic\", \"iso_8859_6\");\n\t\taliases.Add (\"ECMA_114\", \"iso_8859_6\");\n\t\taliases.Add (\"ISO_8859_6:1987\", \"iso_8859_6\");\n\t\taliases.Add (\"iso_ir_127\", \"iso_8859_6\");\n\t\taliases.Add (\"cp1256\" ,\"windows_1256\");\n\t\taliases.Add (\"csISOLatin4\", \"iso_8859_4\");\n\t\taliases.Add (\"ISO_8859_4:1988\", \"iso_8859_4\");\n\t\taliases.Add (\"iso_ir_110\", \"iso_8859_4\");\n\t\taliases.Add (\"l4\", \"iso_8859_4\");\n\t\taliases.Add (\"latin4\", \"iso_8859_4\");\n\t\taliases.Add (\"cp852\" ,\"ibm852\");\n\t\taliases.Add (\"csISOLatin2\", \"iso_8859_2\");\n\t\taliases.Add (\"iso_8859_2:1987\", \"iso_8859_2\");\n\t\taliases.Add (\"iso8859_2\", \"iso_8859_2\");\n\t\taliases.Add (\"iso_ir_101\", \"iso_8859_2\");\n\t\taliases.Add (\"l2\", \"iso_8859_2\");\n\t\taliases.Add (\"latin2\", \"iso_8859_2\");\n\t\taliases.Add (\"x-cp1250\", \"windows_1250\");\n\t\taliases.Add (\"chinese\", \"gb2312\");\n\t\taliases.Add (\"CN-GB\", \"gb2312\");\n\t\taliases.Add (\"csGB2312\", \"gb2312\");\n\t\taliases.Add (\"csGB231280\", \"gb2312\");\n\t\taliases.Add (\"csISO58GB231280\", \"gb2312\");\n\t\taliases.Add (\"GB_2312_80\", \"gb2312\");\n\t\taliases.Add (\"GB231280\", \"gb2312\");\n\t\taliases.Add (\"GB2312_80\", \"gb2312\");\n", "answers": ["\t\taliases.Add (\"GBK\", \"gb2312\");"], "incorrect_answer": "aliases.Add (\"GBK\", \"gb18030\");"}, {"input": "", "context": "\"\"\"Tools for parsing a regular expression into a Pattern.\"\"\"\nimport collections\nimport string\nimport charsource\nimport pattern as p\n# Characters that represent themselves in a regular expression.\n# TODO(jasonpr): Handle $ and ^ specially at edges of regex.\n_CHAR_LITERALS = string.ascii_letters + string.digits + '!\"#$%&\\',-/:;<=>@^_`~]} \\t\\n\\r'\n# Characters that represent themselves inside a square-bracket expression.\n_GROUP_CHARS = string.ascii_letters + string.digits + '!\"#$%&\\'()*+,-./:;<=>?@[^_`{|}~'\n# Characters that represent themselves when escaped with a backslash.\n_IDENTIY_ESCAPES = r'.[\\()*+?{|'\n# Characters that represent a character class when escaped with a backslash.\n_CHARACTER_CLASSES = {\n    'd': string.digits,\n    'w': string.ascii_letters + string.digits + '_',\n    'h': string.hexdigits,\n    # TODO(jasonpr): Make an informed decision, rather than blindly\n    # inheritting this definition from Python.\n    's': string.whitespace,\n    }\n_BRACKET_CHARACTER_CLASSES = {\n    'alnum': set(string.ascii_letters + string.digits),\n    'alpha': set(string.ascii_letters),\n    'digit': set(string.digits),\n    'lower': set(string.ascii_lowercase),\n    'print': set(string.printable),\n    'punct': set(string.punctuation),\n    # TODO(jasonpr): Make an informed decision, rather than blindly\n    # inheritting this definition from Python.\n    'space': set(string.whitespace),\n    'upper': set(string.ascii_uppercase),\n    'xdigit': set(string.hexdigits),\n    }\ndef parse_regex(regex_string):\n    \"\"\"Convert a regular expression string into a Pattern.\"\"\"\n    return _parse_regex(charsource.GetPutSource(regex_string))\n# The following _parse_* methods form a recursive descent parser\n# that respect the order of operations in a regular expression.\ndef _parse_regex(source):\n    \"\"\"Parse any regex into a Pattern.\"\"\"\n    return _parse_alternation(source)\ndef _parse_alternation(source):\n    \"\"\"Parse an alternation expression, like 'ab|cd|ef'.\"\"\"\n    parts = []\n    # Act as though the last character was a '|', so we get the\n    # initial element of the alternation.\n    last_char = '|'\n    while last_char == '|':\n        parts.append(_parse_concatenation(source))\n        last_char = source.get()\n    # Put back the non-alternation character.\n    source.put(last_char)\n    return p.Or(*parts)\ndef _parse_concatenation(source):\n    \"\"\"Parse a concatenation expression, like 'abc' or 'a(b|c)d*'.\"\"\"\n    parts = []\n    duplication = _parse_duplication(source)\n    # If we're expecting a concatenation, there MUST be at least\n    # one (first) element!\n    assert duplication\n    while duplication:\n        parts.append(duplication)\n        duplication = _parse_duplication(source)\n    return p.Sequence(*parts)\ndef _parse_duplication(source):\n    \"\"\"Parse a duplication expression, like 'a*' or '(a|b){3,5}'.\"\"\"\n    duplicated = _parse_parenthesization(source)\n    if not duplicated:\n        return None\n    duplicator = source.get()\n    if duplicator == '?':\n        return p.Maybe(duplicated)\n    elif duplicator == '*':\n        return p.Star(duplicated)\n    elif duplicator == '+':\n        return p.Plus(duplicated)\n    elif duplicator == '{':\n        min_repeats = _parse_positive_int(source)\n        range_continuation = source.get()\n        # We will ultimately expect a closing curly brace, but\n        # we might see a comma and a max repeats value, first.\n        if range_continuation == ',':\n            max_repeats = _parse_positive_int(source)\n            range_continuation = source.get()\n        else:\n            max_repeats = min_repeats\n        if range_continuation != '}':\n            raise ValueError('Expected \"}\", but got \"%s\".' %\n                             range_continuation)\n        return p.Repeat(duplicated, min_repeats, max_repeats)\n    else:\n        source.put(duplicator)\n        return duplicated\ndef _parse_parenthesization(source):\n    \"\"\"Parse a parenthesization pattern, like '(a|b)' or '[ab]' or 'a'.\n    Note that '[ab]' is a parenthesization, since it is equivalent\n    to '([ab])'.  Similarly, 'a' is equivalent to '(a)'.\n    \"\"\"\n    first_char = source.get()\n    if first_char == '(':\n        enclosed_regex = _parse_regex(source)\n        close_paren = source.get()\n        assert close_paren == ')'\n        return enclosed_regex\n    # Otherwise, this must just be a group.  (Groups have just as\n    # tight of binding as a parenthesization.)\n    source.put(first_char)\n    return _parse_group(source)\ndef _parse_group(source):\n    \"\"\"Parse a group pattern, like '[abc]' or 'a'.\n    Note that 'a' is a group, since 'a' is equivalent to '[a]'.\n    \"\"\"\n    first_char = source.get()\n    if first_char == '[':\n        second_char = source.get()\n        if second_char == '^':\n            negating = True\n        else:\n            source.put(second_char)\n            negating = False\n        group_chars = _parse_group_chars(source)\n        result = p.Selection(group_chars, negating)\n        close_brace = source.get()\n        assert close_brace == ']'\n        return result\n    # Otherwise, it's a single normal character.\n    source.put(first_char)\n    return _parse_atom(source)\ndef _parse_group_chars(source):\n    \"\"\"Parse the characters from a group specification.\n    This is just a string of characters allowable in a group specification.\n    For example, a valid parse is 'aA1.?', since '[aA1.?]' is a valid group.\n    \"\"\"\n    chars = set()\n    while True:\n        range_chars = _parse_group_range(source)\n        if range_chars:\n            for char in range_chars:\n                chars.add(char)\n            continue\n        char_class = _parse_char_class(source)\n        if char_class:\n            chars |= char_class\n            continue\n        char = source.get()\n        if not char:\n            raise ValueError('Unexpected end of stream.')\n        if char not in _GROUP_CHARS:\n            source.put(char)\n            break\n        chars.add(char)\n    return ''.join(chars)\ndef _parse_atom(source):\n    \"\"\"Parse a single regex atom.\n    An atom is a period ('.'), a character literal, or an escape sequence.\n    \"\"\"\n    char = source.get()\n    if not char:\n        # For good measure, put the EOF back on!\n        # This doesn't really do anything, since the source will\n        # generate EOFs forever.\n        source.put(char)\n        return None\n    elif char == '.':\n        return p.Anything()\n    elif char in _CHAR_LITERALS:\n        return p.String(char)\n    elif char == '\\\\':\n        escaped = source.get()\n        if escaped in _IDENTIY_ESCAPES:\n            return p.String(escaped)\n        elif escaped in _CHARACTER_CLASSES:\n            return p.Selection(_CHARACTER_CLASSES[escaped])\n        else:\n            raise ValueError('Unexpected escape sequence, \\\\%s.', escaped)\n    else:\n        source.put(char)\n        return None\ndef _parse_positive_int(source):\n    \"\"\"Parse a positive integer.\n    That is, parse a sequence of one or more digits.\n    \"\"\"\n    digits = []\n    next_char = source.get()\n    assert next_char and next_char in string.digits\n    while next_char and next_char in string.digits:\n        digits.append(next_char)\n        next_char = source.get()\n    source.put(next_char)\n    return int(''.join(digits))\ndef _parse_group_range(source):\n    \"\"\"Parse a three-character group range expression.\n    Return the set of characters represented by the range.\n    For example, parsing the expression 'c-e' from the source returns\n    set(['c', 'd', 'e']).\n    \"\"\"\n    start = source.get()\n    if start not in _GROUP_CHARS:\n        source.put(start)\n        return None\n    middle = source.get()\n    if middle != '-':\n        source.put(middle)\n        source.put(start)\n        return None\n    end = source.get()\n    if end not in _GROUP_CHARS:\n        source.put(end)\n        source.put(middle)\n        source.put(start)\n        return None\n    range_chars = set()\n    for ascii_value in range(ord(start), ord(end) + 1):\n        range_chars.add(chr(ascii_value))\n    return range_chars\ndef _parse_char_class(source):\n    for class_name, class_contents in _BRACKET_CHARACTER_CLASSES.iteritems():\n", "answers": ["        if _parse_verbatim(source, '[:%s:]' % class_name):"], "incorrect_answer": "if _parse_verbatim(source, '[::]')"}, {"input": "", "context": "# -*- coding: utf-8 -*-\n\"\"\"\nCreated on Tue Nov  8 14:27:22 2016\n@author: Viktor\n\"\"\"\nimport numpy as np\nfrom sklearn.datasets import fetch_mldata\nfrom matplotlib import pyplot as plt\nfrom skimage.io import imread\nfrom skimage.io import imshow\nfrom skimage.morphology import opening, closing\nfrom scipy import ndimage\nfrom sklearn.neighbors import KNeighborsClassifier\n#ucitavanje MNIST dataseta\nmnist = fetch_mldata('MNIST original')\nprint(mnist.data.shape)\nprint(mnist.target.shape)\nprint(np.unique(mnist.target))\nimg = 255-mnist.data[12345]\nimg = img.reshape(28,28)\nplt.imshow(-img, cmap='Greys')\n#iscitavanje dataseta i smestanje u matricu radi lakseg pristupa\nnumbers = [0]*10\nnumbers[0] = mnist['data'][np.where(mnist['target'] == 0.)[0]]\nnumbers[1] = mnist['data'][np.where(mnist['target'] == 1.)[0]]\nnumbers[2] = mnist['data'][np.where(mnist['target'] == 2.)[0]]\nnumbers[3] = mnist['data'][np.where(mnist['target'] == 3.)[0]]\nnumbers[4] = mnist['data'][np.where(mnist['target'] == 4.)[0]]\nnumbers[5] = mnist['data'][np.where(mnist['target'] == 5.)[0]]\nnumbers[6] = mnist['data'][np.where(mnist['target'] == 6.)[0]]\nnumbers[7] = mnist['data'][np.where(mnist['target'] == 7.)[0]]\nnumbers[8] = mnist['data'][np.where(mnist['target'] == 8.)[0]]\nnumbers[9] = mnist['data'][np.where(mnist['target'] == 9.)[0]]\ntest = numbers[0][123]\nres = numbers[0][123] == numbers[0][124]\npercent_hit = np.count_nonzero(res) / 784.0\nrepresentative_number = [0]*10\nfor j in range(0,10):\n    representative_number[j] = np.zeros(np.shape(numbers[j][0]), dtype='float')\n    for i in range(0,len(numbers[j])):\n        representative_number[j] = representative_number[j] + numbers[j][i]\n    representative_number[j] = (representative_number[j])/len(numbers[j])\ndef processing(path):\n    img = imread(path)\n    gray = rgb2gray(img)\n    binary = 1 - (gray > 0.5)\n    binary = closing(binary)\n    binary = opening(binary)\n    labeled, nr_objects = ndimage.label(binary)\n    return nr_objects\ndef poklapanje(niz1, niz2):\n    mera_poklapanja = 0.0\n    for i in range(0,len(niz1)):\n        if(niz1[i]==niz2[i]):\n            mera_poklapanja = mera_poklapanja + 1\n            \n    return mera_poklapanja/len(niz1)\n    \ndef ucitavanje(path):\n    image_path = []\n    with open(path) as f:\n        data = f.read()\n        lines = data.split('\\n')\n        for i, line in enumerate(lines):\n            if(i>1):\n                cols = line.split('\\t')\n                if(cols[0]!=''):\n                    image_path.append(cols[0])\n                \n        f.close()\n        \n    return image_path\ndef upis(path,image_path,result):\n    with open(path,'w') as f:\n        f.write('RA 1/2013 Viktor Sanca\\n')\n        f.write('file\\tsum\\n')\n        for i in range(0,len(image_path)):\n            f.write(image_path[i]+'\\t'+str(result[i])+'\\n')\n        \n        f.close()\n    \ndef get_img(image_path):\n    img = imread(image_path)\n    gray = rgb2gray(img)\n    #gray = closing(gray)\n    #gray = opening(gray)\n    #binary = (gray < 0.5)\n    return gray\ndef binarize(img):\n    return img>1\n    \ndef rgb2gray(img_rgb):\n    img_gray = np.ndarray((img_rgb.shape[0], img_rgb.shape[1]))\n    img_gray = 0.8*img_rgb[:, :, 0] + 0.2*img_rgb[:, :, 1] + 1*img_rgb[:, :, 2]\n    img_gray = img_gray.astype('uint8')\n    return img_gray\ndef mark_indices(image):\n    starting_indices = []\n    img = image.reshape(640*480)\n    for i in range(0,(640)*(480-28)):\n        if(img[i]<10 and img[i+27]<10 and img[i+27*(640)]<10 and img[i+27*(640)+27]<10):\n            starting_indices.append(i)\n            \n    return starting_indices\ndef get_image_from_indice(image,start_indice):\n    image28_28 = np.empty((28*28),dtype='uint8')\n    img = image.reshape(640*480)\n    \n    for i in range(0,28):\n        for j in range(0,28):\n            image28_28[28*i+j]=img[start_indice+i*(640)+j]\n    return image28_28\n    \ndef find_number(image28_28):\n    mmx = [0]*10\n    for i in range(0,10):\n        for j in range(0,len(numbers[i])):\n            res = binarize(image28_28) == binarize(numbers[i][j])\n            if(np.count_nonzero(res)>mmx[i]):\n                mmx[i]=np.count_nonzero(res)\n    \n    return max_idx(mmx)\n    \ndef max_idx(lista):\n    mx = max(lista)\n    for i in range(0,len(lista)):\n        if(lista[i]==mx):\n            return i\n            \n    return -1\n    \nimage_path = []\nresult = []\n    \nin_path = 'level-1-mnist-train/level-1-mnist/out.txt'\nout_path = 'level-1-mnist-test/level-1-mnist-test/out.txt'\ntrain_path = 'level-1-mnist-train/level-1-mnist/'\ntest_path = 'level-1-mnist-test/level-1-mnist-test/'\nimage_paths = ucitavanje(out_path)\n#knn = KNeighborsClassifier()\nknn = KNeighborsClassifier(n_neighbors=2000,weights='distance',algorithm='auto',n_jobs=-1)\nknn.fit(mnist.data,mnist.target)\nsuma = [0]*len(image_paths)\nfor i in range(0,len(image_paths)):\n    print('Image'+str(i+1)+'/'+str(len(image_paths)))\n    img = get_img(test_path+image_paths[i])\n    start_indices = mark_indices(img.reshape(640*480))\n    \n    for start_indice in start_indices:\n        img_d = get_image_from_indice(img,start_indice)\n        #nr = find_number(img_d)\n        nr = knn.predict(img_d)\n        suma[i] = suma[i] + nr[0]\n        suma[i] = int(suma[i])\nfor i in range(0,len(suma)):\n    suma[i] = float(suma[i])\n        \nupis(out_path, image_paths, suma)\nimage28_28 = img_d\nmmx = [0]*10\nfor i in range(0,10):\n    for j in range(0,len(numbers[i])):\n        res = image28_28 == numbers[i][j]\n        if(np.count_nonzero(res)>mmx[i]):\n            mmx[i]=np.count_nonzero(res)\n    \ntotal = np.zeros(784, dtype='float')\nfor i in range(0,10):\n    total = total + representative_number[i]\n        \nimg = representative_number[4]\nimg = img.reshape(28,28)\nplt.imshow(img, cmap='Greys')\n", "answers": ["check = numbers[5][123]"], "incorrect_answer": "check = numbers[4][120]"}, {"input": "", "context": "/*\n * *************************************************************************************\n *  Copyright (C) 2008 EsperTech, Inc. All rights reserved.                            *\n *  http://esper.codehaus.org                                                          *\n *  http://www.espertech.com                                                           *\n *  ---------------------------------------------------------------------------------- *\n *  The software in this package is published under the terms of the GPL license       *\n *  a copy of which has been included with this distribution in the license.txt file.  *\n * *************************************************************************************\n */\npackage com.espertech.esper.regression.epl;\nimport com.espertech.esper.client.*;\nimport com.espertech.esper.client.soda.*;\nimport com.espertech.esper.support.bean.*;\nimport com.espertech.esper.support.client.SupportConfigFactory;\nimport com.espertech.esper.support.util.SupportUpdateListener;\nimport com.espertech.esper.util.SerializableObjectCopier;\nimport junit.framework.TestCase;\npublic class TestSubselectIn extends TestCase\n{\n    private EPServiceProvider epService;\n    private SupportUpdateListener listener;\n    public void setUp()\n    {\n        Configuration config = SupportConfigFactory.getConfiguration();\n        config.addEventType(\"S0\", SupportBean_S0.class);\n        config.addEventType(\"S1\", SupportBean_S1.class);\n        config.addEventType(\"S2\", SupportBean_S2.class);\n        epService = EPServiceProviderManager.getDefaultProvider(config);\n        epService.initialize();\n        listener = new SupportUpdateListener();\n    }\n    public void testInSelect()\n    {\n        String stmtText = \"select id in (select id from S1.win:length(1000)) as value from S0\";\n        EPStatement stmt = epService.getEPAdministrator().createEPL(stmtText);\n        stmt.addListener(listener);\n        runTestInSelect();\n    }\n    public void testInSelectOM() throws Exception\n    {\n        EPStatementObjectModel subquery = new EPStatementObjectModel();\n        subquery.setSelectClause(SelectClause.create(\"id\"));\n        subquery.setFromClause(FromClause.create(FilterStream.create(\"S1\").addView(View.create(\"win\", \"length\", Expressions.constant(1000)))));\n        EPStatementObjectModel model = new EPStatementObjectModel();\n        model.setFromClause(FromClause.create(FilterStream.create(\"S0\")));\n        model.setSelectClause(SelectClause.create().add(Expressions.subqueryIn(\"id\", subquery), \"value\"));\n        model = (EPStatementObjectModel) SerializableObjectCopier.copy(model);\n        String stmtText = \"select id in (select id from S1.win:length(1000)) as value from S0\";\n        assertEquals(stmtText, model.toEPL());\n        EPStatement stmt = epService.getEPAdministrator().create(model);\n        stmt.addListener(listener);\n        runTestInSelect();\n    }\n    public void testInSelectCompile() throws Exception\n    {\n        String stmtText = \"select id in (select id from S1.win:length(1000)) as value from S0\";\n        EPStatementObjectModel model = epService.getEPAdministrator().compileEPL(stmtText);\n        model = (EPStatementObjectModel) SerializableObjectCopier.copy(model);\n        assertEquals(stmtText, model.toEPL());\n        EPStatement stmt = epService.getEPAdministrator().create(model);\n        stmt.addListener(listener);\n        runTestInSelect();\n    }\n    private void runTestInSelect()\n    {\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(2));\n        assertEquals(false, listener.assertOneGetNewAndReset().get(\"value\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S1(-1));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(2));\n        assertEquals(false, listener.assertOneGetNewAndReset().get(\"value\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(-1));\n        assertEquals(true, listener.assertOneGetNewAndReset().get(\"value\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S1(5));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(4));\n        assertEquals(false, listener.assertOneGetNewAndReset().get(\"value\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(5));\n        assertEquals(true, listener.assertOneGetNewAndReset().get(\"value\"));\n    }\n    public void testInSelectWhere()\n    {\n        String stmtText = \"select id in (select id from S1.win:length(1000) where id > 0) as value from S0\";\n        EPStatement stmt = epService.getEPAdministrator().createEPL(stmtText);\n        stmt.addListener(listener);\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(2));\n        assertEquals(false, listener.assertOneGetNewAndReset().get(\"value\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S1(-1));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(2));\n        assertEquals(false, listener.assertOneGetNewAndReset().get(\"value\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(-1));\n        assertEquals(false, listener.assertOneGetNewAndReset().get(\"value\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S1(5));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(4));\n        assertEquals(false, listener.assertOneGetNewAndReset().get(\"value\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(5));\n        assertEquals(true, listener.assertOneGetNewAndReset().get(\"value\"));\n    }\n    public void testInSelectWhereExpressions()\n    {\n        String stmtText = \"select 3*id in (select 2*id from S1.win:length(1000)) as value from S0\";\n        EPStatement stmt = epService.getEPAdministrator().createEPL(stmtText);\n        stmt.addListener(listener);\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(2));\n        assertEquals(false, listener.assertOneGetNewAndReset().get(\"value\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S1(-1));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(2));\n        assertEquals(false, listener.assertOneGetNewAndReset().get(\"value\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(-1));\n        assertEquals(false, listener.assertOneGetNewAndReset().get(\"value\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S1(6));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(4));\n        assertEquals(true, listener.assertOneGetNewAndReset().get(\"value\"));\n    }\n    public void testInWildcard()\n    {\n        epService.getEPAdministrator().getConfiguration().addEventType(\"ArrayBean\", SupportBeanArrayCollMap.class);\n        String stmtText = \"select s0.anyObject in (select * from S1.win:length(1000)) as value from ArrayBean s0\";\n        EPStatement stmt = epService.getEPAdministrator().createEPL(stmtText);\n        stmt.addListener(listener);\n        SupportBean_S1 s1 = new SupportBean_S1(100);\n        SupportBeanArrayCollMap arrayBean = new SupportBeanArrayCollMap(s1);\n        epService.getEPRuntime().sendEvent(s1);\n        epService.getEPRuntime().sendEvent(arrayBean);\n        assertEquals(true, listener.assertOneGetNewAndReset().get(\"value\"));\n        SupportBean_S2 s2 = new SupportBean_S2(100);\n        arrayBean.setAnyObject(s2);\n        epService.getEPRuntime().sendEvent(s2);\n        epService.getEPRuntime().sendEvent(arrayBean);\n        assertEquals(false, listener.assertOneGetNewAndReset().get(\"value\"));\n    }\n    public void testInNullable()\n    {\n        String stmtText = \"select id from S0 as s0 where p00 in (select p10 from S1.win:length(1000))\";\n        EPStatement stmt = epService.getEPAdministrator().createEPL(stmtText);\n        stmt.addListener(listener);\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(1, \"a\"));\n        assertFalse(listener.isInvoked());\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(2, null));\n        assertFalse(listener.isInvoked());\n        epService.getEPRuntime().sendEvent(new SupportBean_S1(-1, \"A\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(3, null));\n        assertFalse(listener.isInvoked());\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(4, \"A\"));\n        assertEquals(4, listener.assertOneGetNewAndReset().get(\"id\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S1(-2, null));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(5, null));\n        assertFalse(listener.isInvoked());\n    }\n    public void testInNullableCoercion()\n    {\n        String stmtText = \"select longBoxed from \" + SupportBean.class.getName() + \"(string='A') as s0 \" +\n                          \"where longBoxed in \" +\n                          \"(select intBoxed from \" + SupportBean.class.getName() + \"(string='B').win:length(1000))\";\n        EPStatement stmt = epService.getEPAdministrator().createEPL(stmtText);\n        stmt.addListener(listener);\n        sendBean(\"A\", 0, 0L);\n        sendBean(\"A\", null, null);\n        assertFalse(listener.isInvoked());\n        sendBean(\"B\", null, null);\n        sendBean(\"A\", 0, 0L);\n        assertFalse(listener.isInvoked());\n        sendBean(\"A\", null, null);\n        assertFalse(listener.isInvoked());\n        sendBean(\"B\", 99, null);\n        sendBean(\"A\", null, null);\n        assertFalse(listener.isInvoked());\n        sendBean(\"A\", null, 99l);\n        assertEquals(99L, listener.assertOneGetNewAndReset().get(\"longBoxed\"));\n        sendBean(\"B\", 98, null);\n        sendBean(\"A\", null, 98l);\n        assertEquals(98L, listener.assertOneGetNewAndReset().get(\"longBoxed\"));\n    }\n    public void testInNullRow()\n    {\n        String stmtText = \"select intBoxed from \" + SupportBean.class.getName() + \"(string='A') as s0 \" +\n                          \"where intBoxed in \" +\n                          \"(select longBoxed from \" + SupportBean.class.getName() + \"(string='B').win:length(1000))\";\n        EPStatement stmt = epService.getEPAdministrator().createEPL(stmtText);\n        stmt.addListener(listener);\n        sendBean(\"B\", 1, 1l);\n        sendBean(\"A\", null, null);\n        assertFalse(listener.isInvoked());\n        sendBean(\"A\", 1, 1l);\n        assertEquals(1, listener.assertOneGetNewAndReset().get(\"intBoxed\"));\n        sendBean(\"B\", null, null);\n        sendBean(\"A\", null, null);\n        assertFalse(listener.isInvoked());\n        sendBean(\"A\", 1, 1l);\n        assertEquals(1, listener.assertOneGetNewAndReset().get(\"intBoxed\"));\n    }\n    public void testNotInNullRow()\n    {\n        String stmtText = \"select intBoxed from \" + SupportBean.class.getName() + \"(string='A') as s0 \" +\n                          \"where intBoxed not in \" +\n                          \"(select longBoxed from \" + SupportBean.class.getName() + \"(string='B').win:length(1000))\";\n        EPStatement stmt = epService.getEPAdministrator().createEPL(stmtText);\n        stmt.addListener(listener);\n        sendBean(\"B\", 1, 1l);\n        sendBean(\"A\", null, null);\n        assertFalse(listener.isInvoked());\n        sendBean(\"A\", 1, 1l);\n        assertFalse(listener.isInvoked());\n        sendBean(\"B\", null, null);\n        sendBean(\"A\", null, null);\n        assertFalse(listener.isInvoked());\n        sendBean(\"A\", 1, 1l);\n        assertFalse(listener.isInvoked());\n    }\n    public void testNotInSelect()\n    {\n        String stmtText = \"select not id in (select id from S1.win:length(1000)) as value from S0\";\n        EPStatement stmt = epService.getEPAdministrator().createEPL(stmtText);\n        stmt.addListener(listener);\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(2));\n        assertEquals(true, listener.assertOneGetNewAndReset().get(\"value\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S1(-1));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(2));\n        assertEquals(true, listener.assertOneGetNewAndReset().get(\"value\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(-1));\n        assertEquals(false, listener.assertOneGetNewAndReset().get(\"value\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S1(5));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(4));\n        assertEquals(true, listener.assertOneGetNewAndReset().get(\"value\"));\n        epService.getEPRuntime().sendEvent(new SupportBean_S0(5));\n        assertEquals(false, listener.assertOneGetNewAndReset().get(\"value\"));\n    }\n    public void testNotInNullableCoercion()\n    {\n        String stmtText = \"select longBoxed from \" + SupportBean.class.getName() + \"(string='A') as s0 \" +\n                          \"where longBoxed not in \" +\n                          \"(select intBoxed from \" + SupportBean.class.getName() + \"(string='B').win:length(1000))\";\n        EPStatement stmt = epService.getEPAdministrator().createEPL(stmtText);\n        stmt.addListener(listener);\n        sendBean(\"A\", 0, 0L);\n        assertEquals(0L, listener.assertOneGetNewAndReset().get(\"longBoxed\"));\n        sendBean(\"A\", null, null);\n        assertEquals(null, listener.assertOneGetNewAndReset().get(\"longBoxed\"));\n        sendBean(\"B\", null, null);\n        sendBean(\"A\", 1, 1L);\n        assertFalse(listener.isInvoked());\n", "answers": ["        sendBean(\"A\", null, null);"], "incorrect_answer": "sendBean(\"A\", 5, 5L);"}, {"input": "", "context": "package net.brokentrain.ftf.ui.gui.dialog;\nimport net.brokentrain.ftf.ui.gui.GUI;\nimport net.brokentrain.ftf.ui.gui.properties.BrowserTabProperties;\nimport net.brokentrain.ftf.ui.gui.properties.ConnectionProperties;\nimport net.brokentrain.ftf.ui.gui.properties.PropertyPage;\nimport net.brokentrain.ftf.ui.gui.properties.QueryTabProperties;\nimport net.brokentrain.ftf.ui.gui.properties.SystemTrayProperties;\nimport net.brokentrain.ftf.ui.gui.properties.TransferTabProperties;\nimport net.brokentrain.ftf.ui.gui.properties.ViewProperties;\nimport net.brokentrain.ftf.ui.gui.properties.services.ArXivProperties;\nimport net.brokentrain.ftf.ui.gui.properties.services.DOIProperties;\nimport net.brokentrain.ftf.ui.gui.properties.services.GoogleDesktopSearchProperties;\nimport net.brokentrain.ftf.ui.gui.properties.services.GoogleScholarProperties;\nimport net.brokentrain.ftf.ui.gui.properties.services.GoogleWebSearchProperties;\nimport net.brokentrain.ftf.ui.gui.properties.services.PlosJournalsProperties;\nimport net.brokentrain.ftf.ui.gui.properties.services.PubMedCentralProperties;\nimport net.brokentrain.ftf.ui.gui.properties.services.PubMedProperties;\nimport net.brokentrain.ftf.ui.gui.properties.services.ScirusProperties;\nimport net.brokentrain.ftf.ui.gui.properties.services.ServicesProperties;\nimport net.brokentrain.ftf.ui.gui.properties.services.TerrierProperties;\nimport net.brokentrain.ftf.ui.gui.properties.services.WebOfKnowledgeProperties;\nimport net.brokentrain.ftf.ui.gui.properties.services.YahooWebSearchProperties;\nimport net.brokentrain.ftf.ui.gui.settings.SettingsRegistry;\nimport net.brokentrain.ftf.ui.gui.settings.SettingsSaver;\nimport net.brokentrain.ftf.ui.gui.util.FontUtil;\nimport net.brokentrain.ftf.ui.gui.util.LayoutDataUtil;\nimport net.brokentrain.ftf.ui.gui.util.LayoutUtil;\nimport net.brokentrain.ftf.ui.gui.util.PaintUtil;\nimport net.brokentrain.ftf.ui.gui.util.StringUtil;\nimport net.brokentrain.ftf.ui.gui.util.WidgetUtil;\nimport org.eclipse.jface.dialogs.Dialog;\nimport org.eclipse.jface.dialogs.IDialogConstants;\nimport org.eclipse.swt.SWT;\nimport org.eclipse.swt.events.KeyAdapter;\nimport org.eclipse.swt.events.KeyEvent;\nimport org.eclipse.swt.events.PaintEvent;\nimport org.eclipse.swt.events.PaintListener;\nimport org.eclipse.swt.events.SelectionAdapter;\nimport org.eclipse.swt.events.SelectionEvent;\nimport org.eclipse.swt.graphics.Point;\nimport org.eclipse.swt.graphics.Rectangle;\nimport org.eclipse.swt.layout.GridData;\nimport org.eclipse.swt.layout.GridLayout;\nimport org.eclipse.swt.widgets.Button;\nimport org.eclipse.swt.widgets.Composite;\nimport org.eclipse.swt.widgets.Control;\nimport org.eclipse.swt.widgets.Event;\nimport org.eclipse.swt.widgets.Label;\nimport org.eclipse.swt.widgets.Listener;\nimport org.eclipse.swt.widgets.Shell;\nimport org.eclipse.swt.widgets.Tree;\nimport org.eclipse.swt.widgets.TreeItem;\n/* \n * TODO: This entire class could REALLY do with a re-think - since there were\n * few preference pages to think about they were just hard  coded, then it\n * started to grow and grow leading to this mess.  This should probably be made\n * dynamic and just build the *service* preference pages by seeing what is in\n * SettingsRegistry.services rather than hard coding them explicitly :(! This\n * kind of applies to the entire services package that is a sub-package of the\n * properties package, too.\n * NOTE: This is heavily based on RSSOwls code!\n * */\npublic class PreferencesDialog extends Dialog {\n    public static int lastOpenedPropertyPage = 0;\n    private static final int dialogMinWidth = 460;\n    private GUI fetcherGui;\n    private Composite buttonHolder;\n    private Composite contentHolder;\n    private Composite prefTitleHolder;\n    private Label labelImgHolder;\n    private Label labelPrefTitle;\n    private PropertyPage activePropertyPage;\n    private String lastSelectedItemText;\n    private String title;\n    private TreeItem arxiv;\n    private TreeItem browserTab;\n    private TreeItem connection;\n    private TreeItem crawler;\n    private TreeItem doi;\n    private TreeItem google;\n    private TreeItem googleDesktop;\n    private TreeItem googleScholar;\n    private TreeItem plosjournals;\n    private TreeItem pubmed;\n    private TreeItem pubmedCentral;\n    private TreeItem queryTab;\n    private TreeItem scirus;\n    private TreeItem services;\n    private TreeItem systemTray;\n    private TreeItem terrier;\n    private TreeItem transferTab;\n    private TreeItem view;\n    private TreeItem webofknowledge;\n    private TreeItem yahoo;\n    private Tree tree;\n    public PreferencesDialog(Shell parentShell, String dialogTitle,\n            GUI fetcherGui) {\n        super(parentShell);\n        this.title = dialogTitle;\n        this.fetcherGui = fetcherGui;\n        /* Init the PropertyChangeManager */\n        PropertyPage.initPropertyChangeManager(fetcherGui);\n    }\n    // private void createGeneralProps() {\n    // renewPropertyPage(\"General\");\n    // activePropertyPage = new GeneralProperties(contentHolder, fetcherGui);\n    // }\n    // private void createCrawlerProps() {\n    // renewPropertyPage(\"Crawler\");\n    // activePropertyPage = new CrawlerProperties(contentHolder, fetcherGui);\n    // }\n    // private void createBrowserProps() {\n    // renewPropertyPage(\"Browser\");\n    // }\n    @Override\n    protected void buttonPressed(int buttonId) {\n        if (buttonId == IDialogConstants.OK_ID) {\n            saveSettings();\n        }\n        if (activePropertyPage != null) {\n            activePropertyPage.dispose();\n        }\n        super.buttonPressed(buttonId);\n    }\n    @Override\n    protected void configureShell(Shell shell) {\n        shell.setLayout(LayoutUtil.createGridLayout(1, 0, 5));\n        shell.setText(title);\n        shell.setSize(0, 0);\n    }\n    private void createArxivProperties() {\n        renewPropertyPage(\"ArXiv\");\n        activePropertyPage = new ArXivProperties(contentHolder);\n    }\n    private void createBrowserTabProps() {\n        renewPropertyPage(\"Internal Browser\");\n        activePropertyPage = new BrowserTabProperties(contentHolder);\n    }\n    // private void createLogTabProps() {\n    // renewPropertyPage(\"Debug Log\");\n    // activePropertyPage = new LogTabProperties(contentHolder);\n    // }\n    @Override\n    protected Control createButtonBar(Composite parent) {\n        buttonHolder = new Composite(parent, SWT.NONE);\n        buttonHolder.setLayout(LayoutUtil\n                .createGridLayout(2, 0, 0, 5, 5, false));\n        buttonHolder.setLayoutData(LayoutDataUtil.createGridData(\n                GridData.FILL_HORIZONTAL, 2));\n        Composite okCancelHolder = new Composite(buttonHolder, SWT.NONE);\n        okCancelHolder.setLayout(LayoutUtil.createGridLayout(2, 0, 5, 5));\n        okCancelHolder.setLayoutData(new GridData(SWT.END, SWT.TOP, false,\n                false));\n        if (GUI.display.getDismissalAlignment() == SWT.RIGHT) {\n            createButton(okCancelHolder, IDialogConstants.CANCEL_ID, \"Cancel\",\n                    false).setFont(FontUtil.dialogFont);\n            createButton(okCancelHolder, IDialogConstants.OK_ID, \"OK\", true)\n                    .setFont(FontUtil.dialogFont);\n        } else {\n            createButton(okCancelHolder, IDialogConstants.OK_ID, \"OK\", true)\n                    .setFont(FontUtil.dialogFont);\n            createButton(okCancelHolder, IDialogConstants.CANCEL_ID, \"Cancel\",\n                    false).setFont(FontUtil.dialogFont);\n        }\n        return buttonHolder;\n    }\n    // private void createStatusTabProps() {\n    // renewPropertyPage(\"Status\");\n    // activePropertyPage = new StatusTabProperties(contentHolder, fetcherGui);\n    // }\n    private void createConnectionProps() {\n        renewPropertyPage(\"Connection\");\n        activePropertyPage = new ConnectionProperties(contentHolder, fetcherGui);\n    }\n    @Override\n    protected Control createDialogArea(Composite parent) {\n        Composite baseComposite = (Composite) super.createDialogArea(parent);\n        baseComposite.setLayout(LayoutUtil.createGridLayout(2, 0, 5, 15, 0,\n                false));\n        baseComposite.setLayoutData(LayoutDataUtil.createGridData(\n                GridData.FILL_BOTH, 1));\n        Composite treeHolder = new Composite(baseComposite, SWT.NONE);\n        treeHolder.setLayoutData(LayoutDataUtil.createGridData(\n                GridData.FILL_VERTICAL, 1, convertHorizontalDLUsToPixels(140)));\n        treeHolder.setLayout(LayoutUtil.createGridLayout(1, 5, 0));\n        tree = new Tree(treeHolder, SWT.BORDER);\n        tree.setFont(FontUtil.dialogFont);\n        tree.setFocus();\n        tree.setLayoutData(new GridData(GridData.FILL_BOTH));\n        tree.addSelectionListener(new SelectionAdapter() {\n            @Override\n            public void widgetSelected(SelectionEvent e) {\n                handleTreeItemSelect();\n            }\n        });\n        tree.addKeyListener(new KeyAdapter() {\n            @Override\n            public void keyPressed(KeyEvent e) {\n                TreeItem selectedItem = tree.getSelection()[0];\n                if ((e.keyCode == SWT.CR) && (selectedItem.getItemCount() > 0)) {\n                    selectedItem.setExpanded(!selectedItem.getExpanded());\n                }\n            }\n        });\n        tree.addListener(SWT.MouseDoubleClick, new Listener() {\n            public void handleEvent(Event event) {\n                if (tree.getSelectionCount() > 0) {\n                    Rectangle clickedRect = event.getBounds();\n                    Rectangle selectedRect = tree.getSelection()[0].getBounds();\n                    /* Only handle event, if Mouse is over treeitem */\n                    if (selectedRect.contains(clickedRect.x, clickedRect.y)) {\n                        tree.getSelection()[0]\n                                .setExpanded(!tree.getSelection()[0]\n                                        .getExpanded());\n                    }\n                }\n            }\n        });\n        populateTree();\n        contentHolder = new Composite(baseComposite, SWT.NONE);\n        contentHolder.setLayoutData(new GridData(GridData.FILL_BOTH\n                | GridData.VERTICAL_ALIGN_BEGINNING));\n        contentHolder.setLayout(LayoutUtil.createGridLayout(1, 5, 0));\n        prefTitleHolder = new Composite(contentHolder, SWT.NONE);\n        GridLayout prefTitleHolderLayout = new GridLayout(2, false);\n        prefTitleHolderLayout.marginWidth = 1;\n        prefTitleHolderLayout.marginHeight = 2;\n        prefTitleHolderLayout.marginLeft = 4;\n        prefTitleHolder.setLayout(prefTitleHolderLayout);\n        prefTitleHolder.setLayoutData(LayoutDataUtil.createGridData(\n                GridData.FILL_HORIZONTAL, 2));\n        prefTitleHolder.setBackground(GUI.display\n                .getSystemColor(SWT.COLOR_WHITE));\n        prefTitleHolder.addPaintListener(new PaintListener() {\n            public void paintControl(PaintEvent e) {\n                e.gc.setForeground(GUI.display\n                        .getSystemColor(SWT.COLOR_DARK_GRAY));\n                Rectangle bounds = prefTitleHolder.getClientArea();\n                bounds.height -= 2;\n                bounds.width -= 1;\n                e.gc.drawRectangle(bounds);\n            }\n        });\n        setTreeSelection(lastOpenedPropertyPage);\n        handleTreeItemSelect();\n        Label seperator = new Label(baseComposite, SWT.HORIZONTAL\n                | SWT.SEPARATOR);\n        seperator.setLayoutData(LayoutDataUtil.createGridData(\n                GridData.HORIZONTAL_ALIGN_BEGINNING | GridData.FILL_HORIZONTAL,\n                2));\n        if (WidgetUtil.isset(tree.getHorizontalBar())) {\n            tree.getHorizontalBar().setSelection(0);\n        }\n        return contentHolder;\n    }\n    private void createDOIProperties() {\n        renewPropertyPage(\"DOI\");\n        activePropertyPage = new DOIProperties(contentHolder);\n    }\n    private void createGoogleDesktopSearchProperties() {\n        renewPropertyPage(\"Google Desktop Search\");\n        activePropertyPage = new GoogleDesktopSearchProperties(contentHolder);\n    }\n    // private void createCiteSeerProperties() {\n    // renewPropertyPage(\"Cite Seer\");\n    // activePropertyPage = new CiteSeerProperties(contentHolder);\n    // }\n    private void createGoogleScholarProperties() {\n        renewPropertyPage(\"Google Scholar\");\n        activePropertyPage = new GoogleScholarProperties(contentHolder);\n    }\n    private void createGoogleWebSearchProperties() {\n        renewPropertyPage(\"Google Web Search\");\n        activePropertyPage = new GoogleWebSearchProperties(contentHolder);\n    }\n    private void createPlosJournalsProperties() {\n        renewPropertyPage(\"Plos Journals\");\n        activePropertyPage = new PlosJournalsProperties(contentHolder);\n    }\n    private void createPubMedCentralProperties() {\n        renewPropertyPage(\"PubMed Central\");\n        activePropertyPage = new PubMedCentralProperties(contentHolder);\n    }\n    private void createPubMedProperties() {\n        renewPropertyPage(\"PubMed\");\n        activePropertyPage = new PubMedProperties(contentHolder);\n    }\n    private void createQueryTabProps() {\n        renewPropertyPage(\"Queries\");\n        activePropertyPage = new QueryTabProperties(contentHolder);\n    }\n    private void createScirusProperties() {\n        renewPropertyPage(\"Scirus\");\n        activePropertyPage = new ScirusProperties(contentHolder);\n    }\n    private void createServicesProperties() {\n        renewPropertyPage(\"Default Services\");\n        activePropertyPage = new ServicesProperties(contentHolder);\n    }\n    private void createSystemTrayProps() {\n        renewPropertyPage(\"System Tray\");\n        activePropertyPage = new SystemTrayProperties(contentHolder, fetcherGui);\n    }\n    private void createTerrierProperties() {\n        renewPropertyPage(\"Terrier\");\n        activePropertyPage = new TerrierProperties(contentHolder);\n    }\n    private void createTransferTabProps() {\n        renewPropertyPage(\"Transfer\");\n        activePropertyPage = new TransferTabProperties(contentHolder);\n    }\n    private void createViewProps() {\n        renewPropertyPage(\"View\");\n        activePropertyPage = new ViewProperties(contentHolder, fetcherGui);\n    }\n    private void createWebOfKnowledgeProperties() {\n        renewPropertyPage(\"WebOfKnowledge\");\n        activePropertyPage = new WebOfKnowledgeProperties(contentHolder);\n    }\n    private void createYahooProperties() {\n        renewPropertyPage(\"Yahoo Web Search\");\n        activePropertyPage = new YahooWebSearchProperties(contentHolder);\n    }\n    @Override\n    protected int getShellStyle() {\n        int style = SWT.TITLE | SWT.BORDER | SWT.RESIZE | SWT.APPLICATION_MODAL\n                | getDefaultOrientation();\n        return style;\n    }\n    void handleTreeItemSelect() {\n        if (tree.getSelection().length == 0) {\n            return;\n        }\n        if (tree.getSelection()[0].getText().equals(lastSelectedItemText)) {\n            return;\n        }\n        lastSelectedItemText = tree.getSelection()[0].getText();\n        // if (tree.getSelection()[0].getText().equals(\"General\")) {\n        // createGeneralProps();\n        // lastOpenedPropertyPage = 0;\n        // }\n        // if (tree.getSelection()[0].getText().equals(\"Crawler\")) {\n        // createCrawlerProps();\n        // lastOpenedPropertyPage = 23;\n        // }\n        /* Browser */\n        // if (tree.getSelection()[0].getText().equals(\"Browser\")) {\n        // createBrowserProps();\n        // lastOpenedPropertyPage = 1;\n        // }\n        /* Connection */\n        if (tree.getSelection()[0].getText().equals(\"Connection\")) {\n            createConnectionProps();\n            lastOpenedPropertyPage = 2;\n        }\n        /* System Tray */\n        else if (tree.getSelection()[0].getText().equals(\"System Tray\")) {\n            createSystemTrayProps();\n            lastOpenedPropertyPage = 3;\n        }\n        /* View */\n        else if (tree.getSelection()[0].getText().equals(\"View\")) {\n            createViewProps();\n            lastOpenedPropertyPage = 4;\n        }\n        /* Browser Tab */\n        else if (tree.getSelection()[0].getText().equals(\"Internal Browser\")) {\n            createBrowserTabProps();\n            lastOpenedPropertyPage = 5;\n        }\n        /* Log Tab */\n        // else if (tree.getSelection()[0].getText().equals(\"Debug Log\")) {\n        // createLogTabProps();\n        // lastOpenedPropertyPage = 6;\n        // }\n        /* Query Tab */\n        else if (tree.getSelection()[0].getText().equals(\"Queries\")) {\n            createQueryTabProps();\n            lastOpenedPropertyPage = 7;\n        }\n        /* Status Tab */\n        // else if (tree.getSelection()[0].getText().equals(\"Status\")) {\n        // createStatusTabProps();\n        // lastOpenedPropertyPage = 8;\n        // }\n        /* Transfer Tab */\n        else if (tree.getSelection()[0].getText().equals(\"Transfer\")) {\n            createTransferTabProps();\n            lastOpenedPropertyPage = 9;\n        }\n        /* Services */\n        else if (tree.getSelection()[0].getText().equals(\"Services\")) {\n            createServicesProperties();\n            lastOpenedPropertyPage = 10;\n        }\n        /* ArXiv */\n        else if (tree.getSelection()[0].getText().equals(\"ArXiv\")) {\n            createArxivProperties();\n            lastOpenedPropertyPage = 11;\n        }\n        /* CiteSeer */\n        // else if (tree.getSelection()[0].getText().equals(\"Cite Seer\")) {\n        // createCiteSeerProperties();\n        // lastOpenedPropertyPage = 12;\n        // }\n        /* DOI */\n        else if (tree.getSelection()[0].getText().equals(\"DOI\")) {\n            createDOIProperties();\n            lastOpenedPropertyPage = 13;\n        }\n        /* GoogleDesktopSearch */\n        else if (tree.getSelection()[0].getText().equals(\n                \"Google Desktop Search\")) {\n            createGoogleDesktopSearchProperties();\n            lastOpenedPropertyPage = 24;\n        }\n        /* Google */\n        else if (tree.getSelection()[0].getText().equals(\"Google Web Search\")) {\n            createGoogleWebSearchProperties();\n            lastOpenedPropertyPage = 14;\n        }\n        /* GoogleScholar */\n        else if (tree.getSelection()[0].getText().equals(\"Google Scholar\")) {\n            createGoogleScholarProperties();\n            lastOpenedPropertyPage = 15;\n        }\n        /* PlosJournals */\n        else if (tree.getSelection()[0].getText().equals(\"Plos Journals\")) {\n            createPlosJournalsProperties();\n            lastOpenedPropertyPage = 16;\n        }\n        /* PubMed */\n        else if (tree.getSelection()[0].getText().equals(\"PubMed\")) {\n            createPubMedProperties();\n            lastOpenedPropertyPage = 17;\n        }\n        /* PubMedCentral */\n        else if (tree.getSelection()[0].getText().equals(\"PubMed Central\")) {\n            createPubMedCentralProperties();\n            lastOpenedPropertyPage = 18;\n        }\n        /* Scirus */\n        else if (tree.getSelection()[0].getText().equals(\"Scirus\")) {\n            createScirusProperties();\n            lastOpenedPropertyPage = 19;\n        }\n        /* Terrier */\n        else if (tree.getSelection()[0].getText().equals(\"Terrier\")) {\n            createTerrierProperties();\n            lastOpenedPropertyPage = 20;\n        }\n        /* WebOfKnowledge */\n        else if (tree.getSelection()[0].getText().equals(\"Web Of Knowledge\")) {\n            createWebOfKnowledgeProperties();\n            lastOpenedPropertyPage = 21;\n        }\n        /* Yahoo */\n        else if (tree.getSelection()[0].getText().equals(\"Yahoo Web Search\")) {\n            createYahooProperties();\n            lastOpenedPropertyPage = 22;\n        }\n        contentHolder.layout();\n        initializeBounds(false);\n    }\n    @Override\n    protected void initializeBounds() {\n        initializeBounds(true);\n    }\n    protected void initializeBounds(boolean updateLocation) {\n        Point currentSize = getShell().getSize();\n        Point bestSize = getShell().computeSize(\n                convertHorizontalDLUsToPixels(dialogMinWidth), SWT.DEFAULT);\n        Point location = (updateLocation == true) ? getInitialLocation(bestSize)\n                : getShell().getLocation();\n        if (updateLocation && (bestSize.y > currentSize.y)) {\n            getShell()\n                    .setBounds(location.x, location.y, bestSize.x, bestSize.y);\n        } else if (bestSize.y > currentSize.y) {\n            getShell().setSize(bestSize.x, bestSize.y);\n        }\n        getShell().setMinimumSize(bestSize.x, bestSize.y);\n    }\n    void populateTree() {\n        String selectionText = null;\n        if (tree.getSelectionCount() > 0) {\n            selectionText = tree.getSelection()[0].getText();\n        }\n        if (tree.getItemCount() > 0) {\n            tree.removeAll();\n        }\n        /* General properties */\n        // general = new TreeItem(tree, SWT.NONE);\n        // general.setText(\"General\");\n        /* Crawler sub-property */\n        // crawler = new TreeItem(tree, SWT.NONE);\n        // crawler.setText(\"Crawler\");\n        /* Browser sub-property */\n        // browser = new TreeItem(tree, SWT.NONE);\n        // browser.setText(\"Browser\");\n        /* Connection sub-property */\n        connection = new TreeItem(tree, SWT.NONE);\n        connection.setText(\"Connection\");\n        /* System Tray sub-property */\n        if (SettingsRegistry.useSystemTray()) {\n            // if (!WidgetShop.isset(general)) {\n            // general = new TreeItem(tree, SWT.NONE);\n            // general.setText(\"General\");\n            // }\n            systemTray = new TreeItem(tree, SWT.NONE);\n            systemTray.setText(\"System Tray\");\n        }\n        /* View properties */\n        view = new TreeItem(tree, SWT.NONE);\n        view.setText(\"View\");\n        /* Browser tab sub-property */\n        browserTab = new TreeItem(view, SWT.NONE);\n        browserTab.setText(\"Internal Browser\");\n        /* Log tab sub-property */\n        // logTab = new TreeItem(view, SWT.NONE);\n        // logTab.setText(\"Debug Log\");\n        // logTab.setForeground(ColourUtil.gray);\n        /* Status tab sub-property */\n        // statusTab = new TreeItem(view, SWT.NONE);\n        // statusTab.setText(\"Status\");\n        // statusTab.setForeground(ColourUtil.gray);\n        /* Transfer tab sub-property */\n        transferTab = new TreeItem(view, SWT.NONE);\n        transferTab.setText(\"Transfer\");\n        /* Query tab sub-property */\n        queryTab = new TreeItem(view, SWT.NONE);\n        queryTab.setText(\"Queries\");\n        /* Services sub-property */\n        services = new TreeItem(tree, SWT.NONE);\n        services.setText(\"Services\");\n        /* Arxiv sub-property */\n        arxiv = new TreeItem(services, SWT.NONE);\n        arxiv.setText(\"ArXiv\");\n        /* DOI sub-property */\n        doi = new TreeItem(services, SWT.NONE);\n        doi.setText(\"DOI\");\n        /* Cite Seer sub-property */\n        // citeSeer = new TreeItem(services, SWT.NONE);\n        // citeSeer.setText(\"Cite Seer\");\n        /* Google Scholar sub-property */\n        googleDesktop = new TreeItem(services, SWT.NONE);\n        googleDesktop.setText(\"Google Desktop Search\");\n        /* Google Scholar sub-property */\n        google = new TreeItem(services, SWT.NONE);\n        google.setText(\"Google Web Search\");\n        /* Google Scholar sub-property */\n        googleScholar = new TreeItem(services, SWT.NONE);\n        googleScholar.setText(\"Google Scholar\");\n        /* Plos Journals sub-property */\n        plosjournals = new TreeItem(services, SWT.NONE);\n        plosjournals.setText(\"Plos Journals\");\n        /* PubMed sub-property */\n        pubmed = new TreeItem(services, SWT.NONE);\n        pubmed.setText(\"PubMed\");\n        /* PubMed Central sub-property */\n        pubmedCentral = new TreeItem(services, SWT.NONE);\n        pubmedCentral.setText(\"PubMed Central\");\n        /* Scirus sub-property */\n        scirus = new TreeItem(services, SWT.NONE);\n        scirus.setText(\"Scirus\");\n        /* Terrier sub-property */\n        terrier = new TreeItem(services, SWT.NONE);\n        terrier.setText(\"Terrier\");\n        /* WOK sub-property */\n        webofknowledge = new TreeItem(services, SWT.NONE);\n        webofknowledge.setText(\"Web Of Knowledge\");\n        /* Yahoo sub-property */\n        yahoo = new TreeItem(services, SWT.NONE);\n        yahoo.setText(\"Yahoo Web Search\");\n        // if (WidgetShop.isset(general))\n        // general.setExpanded(true);\n        if (WidgetUtil.isset(view)) {\n            view.setExpanded(true);\n        }\n        if (WidgetUtil.isset(services)) {\n            services.setExpanded(true);\n        }\n        if (StringUtil.isset(selectionText)) {\n            restoreSelection(selectionText, tree.getItems());\n        }\n    }\n    private void renewPropertyPage(String title) {\n        if (activePropertyPage != null) {\n            activePropertyPage.updatePropertiesChangeManager();\n            activePropertyPage.dispose();\n        }\n        if (labelPrefTitle == null) {\n            labelPrefTitle = new Label(prefTitleHolder, SWT.LEFT);\n            labelPrefTitle.setBackground(GUI.display\n                    .getSystemColor(SWT.COLOR_WHITE));\n            labelPrefTitle.setLayoutData(new GridData(SWT.FILL, SWT.CENTER,\n                    true, false));\n            labelPrefTitle.setFont(FontUtil.dialogBoldFont);\n        }\n        if (labelImgHolder == null) {\n            labelImgHolder = new Label(prefTitleHolder, SWT.NONE);\n            labelImgHolder.setBackground(GUI.display\n                    .getSystemColor(SWT.COLOR_WHITE));\n            labelImgHolder.setImage(PaintUtil.iconBlueStripes);\n            labelImgHolder.setLayoutData(new GridData(SWT.END, SWT.END, false,\n                    false));\n        }\n        labelPrefTitle.setText(title);\n        labelPrefTitle.update();\n        labelImgHolder.update();\n        prefTitleHolder.layout();\n        contentHolder.layout();\n    }\n    private void restoreSelection(String selectionText, TreeItem items[]) {\n        for (TreeItem item : items) {\n            if (selectionText.equals(item.getText())) {\n", "answers": ["                tree.setSelection(new TreeItem[] { item });"], "incorrect_answer": "tree.setExpanded(true);"}, {"input": "", "context": "/*\n * ATLauncher - https://github.com/ATLauncher/ATLauncher\n * Copyright (C) 2013 ATLauncher\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\npackage com.atlauncher.gui.tabs;\nimport com.atlauncher.App;\nimport com.atlauncher.data.Instance;\nimport com.atlauncher.data.Language;\nimport com.atlauncher.evnt.listener.RelocalizationListener;\nimport com.atlauncher.evnt.manager.RelocalizationManager;\nimport com.atlauncher.gui.card.InstanceCard;\nimport com.atlauncher.gui.card.NilCard;\nimport javax.swing.JButton;\nimport javax.swing.JCheckBox;\nimport javax.swing.JLabel;\nimport javax.swing.JPanel;\nimport javax.swing.JScrollPane;\nimport javax.swing.JTextField;\nimport javax.swing.SwingUtilities;\nimport java.awt.BorderLayout;\nimport java.awt.FlowLayout;\nimport java.awt.GridBagConstraints;\nimport java.awt.GridBagLayout;\nimport java.awt.event.ActionEvent;\nimport java.awt.event.ActionListener;\nimport java.awt.event.KeyAdapter;\nimport java.awt.event.KeyEvent;\nimport java.util.regex.Pattern;\n/**\n * TODO: Rewrite this for better loading\n */\npublic class InstancesTab extends JPanel implements Tab, RelocalizationListener {\n    private static final long serialVersionUID = -969812552965390610L;\n    private JPanel topPanel;\n    private JButton clearButton;\n    private JTextField searchBox;\n    private JButton searchButton;\n    private JCheckBox hasUpdate;\n    private JLabel hasUpdateLabel;\n    private String searchText = null;\n    private boolean isUpdate = false;\n    private JPanel panel;\n    private JScrollPane scrollPane;\n    private int currentPosition = 0;\n    \n    private NilCard nilCard;\n    public InstancesTab() {\n        setLayout(new BorderLayout());\n        loadContent(false);\n        RelocalizationManager.addListener(this);\n    }\n    public void loadContent(boolean keepFilters) {\n        topPanel = new JPanel();\n        topPanel.setLayout(new FlowLayout(FlowLayout.LEFT));\n        clearButton = new JButton(Language.INSTANCE.localize(\"common.clear\"));\n        clearButton.addActionListener(new ActionListener() {\n            public void actionPerformed(ActionEvent e) {\n                searchBox.setText(\"\");\n                hasUpdate.setSelected(false);\n                reload();\n            }\n        });\n        topPanel.add(clearButton);\n        searchBox = new JTextField(16);\n        if (keepFilters) {\n            searchBox.setText(this.searchText);\n        }\n        searchBox.addKeyListener(new KeyAdapter() {\n            public void keyReleased(KeyEvent e) {\n                if (e.getKeyChar() == KeyEvent.VK_ENTER) {\n                    reload();\n                }\n            }\n        });\n        topPanel.add(searchBox);\n        searchButton = new JButton(Language.INSTANCE.localize(\"common.search\"));\n        searchButton.addActionListener(new ActionListener() {\n            public void actionPerformed(ActionEvent e) {\n                reload();\n            }\n        });\n        topPanel.add(searchButton);\n        hasUpdate = new JCheckBox();\n        hasUpdate.setSelected(isUpdate);\n        hasUpdate.addActionListener(new ActionListener() {\n            public void actionPerformed(ActionEvent e) {\n                reload();\n            }\n        });\n        topPanel.add(hasUpdate);\n        hasUpdateLabel = new JLabel(Language.INSTANCE.localize(\"instance.hasupdate\"));\n        topPanel.add(hasUpdateLabel);\n        add(topPanel, BorderLayout.NORTH);\n        panel = new JPanel();\n        scrollPane = new JScrollPane(panel, JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED, JScrollPane\n                .HORIZONTAL_SCROLLBAR_NEVER);\n        scrollPane.getVerticalScrollBar().setUnitIncrement(16);\n        add(scrollPane, BorderLayout.CENTER);\n        panel.setLayout(new GridBagLayout());\n        GridBagConstraints gbc = new GridBagConstraints();\n        gbc.gridx = gbc.gridy = 0;\n        gbc.weightx = 1.0;\n        gbc.fill = GridBagConstraints.BOTH;\n        int count = 0;\n        for (Instance instance : App.settings.getInstancesSorted()) {\n            if (instance.canPlay()) {\n                if (keepFilters) {\n                    boolean showInstance = true;\n                    if (searchText != null) {\n                        if (!Pattern.compile(Pattern.quote(searchText), Pattern.CASE_INSENSITIVE).matcher(instance\n                                .getName()).find()) {\n                            showInstance = false;\n                        }\n                    }\n                    if (isUpdate) {\n                        if (!instance.hasUpdate()) {\n                            showInstance = false;\n                        }\n                    }\n                    if (showInstance) {\n                        panel.add(new InstanceCard(instance), gbc);\n                        gbc.gridy++;\n                        count++;\n                    }\n                } else {\n                    panel.add(new InstanceCard(instance), gbc);\n                    gbc.gridy++;\n                    count++;\n                }\n            }\n        }\n        if (count == 0) {\n            nilCard = new NilCard(Language.INSTANCE.localizeWithReplace(\"instance.nodisplay\", \"\\n\\n\"));\n            panel.add(nilCard, gbc);\n        }\n        SwingUtilities.invokeLater(new Runnable() {\n            public void run() {\n                scrollPane.getVerticalScrollBar().setValue(currentPosition);\n            }\n        });\n    }\n    public void reload() {\n        this.currentPosition = scrollPane.getVerticalScrollBar().getValue();\n        this.searchText = searchBox.getText();\n        this.isUpdate = hasUpdate.isSelected();\n        if (this.searchText.isEmpty()) {\n            this.searchText = null;\n        }\n        removeAll();\n        loadContent(true);\n        validate();\n        repaint();\n        searchBox.requestFocus();\n    }\n    @Override\n    public String getTitle() {\n        return Language.INSTANCE.localize(\"tabs.instances\");\n    }\n    @Override\n    public void onRelocalization() {\n        clearButton.setText(Language.INSTANCE.localize(\"common.clear\"));\n        searchButton.setText(Language.INSTANCE.localize(\"common.search\"));\n        hasUpdateLabel.setText(Language.INSTANCE.localize(\"instance.hasupdate\"));\n        \n", "answers": ["        if (nilCard != null) {"], "incorrect_answer": "if (nilCard == undefined) {"}, {"input": "", "context": "package name.vbraun.view.write;\nimport java.io.DataInputStream;\nimport java.io.DataOutputStream;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileNotFoundException;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.net.URI;\nimport java.util.LinkedList;\nimport java.util.UUID;\nimport com.write.Quill.artist.Artist;\nimport junit.framework.Assert;\nimport android.content.Context;\nimport android.graphics.Bitmap;\nimport android.graphics.BitmapFactory;\nimport android.graphics.Canvas;\nimport android.graphics.Color;\nimport android.graphics.Paint;\nimport android.graphics.Paint.Style;\nimport android.graphics.Rect;\nimport android.graphics.RectF;\nimport android.net.Uri;\nimport android.util.FloatMath;\nimport android.util.Log;\nimport android.widget.ImageButton;\nimport android.widget.Toast;\npublic class GraphicsImage extends GraphicsControlpoint {\n\tprivate static final String TAG = \"GraphicsImage\";\n\tprivate Controlpoint bottom_left, bottom_right, top_left, top_right,\n\t\t\tcenter;\n\tprivate final Paint paint = new Paint();\n\tprivate final Paint outline = new Paint();\n\tprivate final Rect rect = new Rect();\n\tprivate final RectF rectF = new RectF();\n\tprivate Bitmap bitmap = null;\n\tprivate File file = null;\n\tprivate int height, width;\n\tprivate float sqrtAspect;\n\tpublic enum FileType {\n\t\tFILETYPE_NONE, FILETYPE_PNG, FILETYPE_JPG\n\t}\n\t\n\tpublic static String getImageFileExt(FileType fileType) {\n\t\tif (fileType == FileType.FILETYPE_JPG) {\n\t\t\treturn \".jpg\";\n\t\t} else if (fileType == FileType.FILETYPE_PNG) {\n\t\t\treturn \".png\";\n\t\t} else {\n\t\t\tAssert.fail();\n\t\t\treturn null;\n\t\t}\n\t}\n\t\n\tpublic static FileType getImageFileType(String fileName) {\n\t\tfor (FileType t : FileType.values()) {\n\t\t\tif (t == FileType.FILETYPE_NONE)\n\t\t\t\tcontinue;\n\t\t\tString ext = getImageFileExt(t);\n\t\t\tif (fileName.endsWith(ext))\n\t\t\t\treturn t;\n\t\t}\n\t\treturn FileType.FILETYPE_NONE;\n\t}\n\t/**\n\t * Helper to construct a file name out of uuid and file type\n\t * @param uuid\n\t * @param fileType\n\t * @return\n\t */\n\tpublic static String getImageFileName(UUID uuid, FileType fileType) {\n\t\treturn uuid.toString() + getImageFileExt(fileType);\n\t}\n\tpublic String getFileName() {\n\t\treturn file.getAbsolutePath();\n\t}\n\t\n\t// persistent data\n\tprotected UUID uuid = null;\n\tprotected boolean constrainAspect = true;\n\tprotected Rect cropRect = new Rect();\n\tpublic UUID getUuid() {\n\t\tif (uuid == null)\n\t\t\tuuid = UUID.randomUUID();\n\t\treturn uuid;\n\t}\n\tpublic Uri getFileUri() {\n\t\tif (file == null)\n\t\t\treturn null;   // no picture selected yet\n\t\telse\n\t\t\treturn Uri.fromFile(file);\n\t}\n\t\n\tpublic File getFile() {\n\t\treturn file;\n\t}\n\tpublic boolean getConstrainAspect() {\n\t\treturn constrainAspect;\n\t}\n\t\n\tpublic FileType getFileType() {\n\t\treturn getImageFileType(file.getName());\n\t}\n\t/**\n\t * Construct a new image\n\t * \n\t * @param transform\n\t *            The current transformation\n\t * @param x\n\t *            Screen x coordinate\n\t * @param y\n\t *            Screen y coordinate\n\t * @param penThickness\n\t * @param penColor\n\t */\n\tprotected GraphicsImage(Transformation transform, float x, float y) {\n\t\tsuper(Tool.IMAGE);\n\t\tsetTransform(transform);\n\t\tbottom_left = new Controlpoint(transform, x, y);\n\t\tbottom_right = new Controlpoint(transform, x, y);\n\t\ttop_left = new Controlpoint(transform, x, y);\n\t\ttop_right = new Controlpoint(transform, x, y);\n\t\tcenter = new Controlpoint(transform, x, y);\n\t\tcontrolpoints.add(bottom_left);\n\t\tcontrolpoints.add(bottom_right);\n\t\tcontrolpoints.add(top_left);\n\t\tcontrolpoints.add(top_right);\n\t\tcontrolpoints.add(center);\n\t\tinit();\n\t}\n\t\n\t/**\n\t * The copy constructor\n\t * @param image\n\t * @param dir the directory to copy the image file to\n\t */\n\tprotected GraphicsImage(final GraphicsImage image, File dir) {\n\t\tsuper(image);\n\t\tbottom_left = new Controlpoint(image.bottom_left);\n\t\tbottom_right = new Controlpoint(image.bottom_right);\n\t\ttop_left = new Controlpoint(image.top_left);\n\t\ttop_right = new Controlpoint(image.top_right);\n\t\tcenter = new Controlpoint(image.center);\n\t\tcontrolpoints.add(bottom_left);\n\t\tcontrolpoints.add(bottom_right);\n\t\tcontrolpoints.add(top_left);\n\t\tcontrolpoints.add(top_right);\n\t\tcontrolpoints.add(center);\n\t\tconstrainAspect = image.constrainAspect;\n\t\tinit();\n\t\tif (image.getFile() == null) \n\t\t\treturn;\n\t\tfinal String fileName = getImageFileName(getUuid(), image.getFileType());\n\t\tfile = new File(dir, fileName);\n\t\tcom.write.Quill.image.Util.copyfile(image.getFile(), file);\n\t}\n\tprivate void init() {\n\t\tpaint.setARGB(0xff, 0x5f, 0xff, 0x5f);\n\t\tpaint.setStyle(Style.FILL);\n\t\tpaint.setStrokeWidth(0);\n\t\tpaint.setAntiAlias(true);\n\t\tpaint.setStrokeCap(Paint.Cap.ROUND);\n\t\toutline.setARGB(0xff, 0x0, 0xaa, 0x0);\n\t\toutline.setStyle(Style.STROKE);\n\t\toutline.setStrokeWidth(4);\n\t\toutline.setAntiAlias(true);\n\t\toutline.setStrokeCap(Paint.Cap.ROUND);\n\t}\n\t@Override\n\tprotected Controlpoint initialControlpoint() {\n\t\treturn bottom_right;\n\t}\n\t@Override\n\tpublic boolean intersects(RectF screenRect) {\n\t\treturn false;\n\t}\n\t@Override\n\tpublic void draw(Canvas c, RectF bounding_box) {\n\t\tif (file != null && bitmap == null)\n\t\t\ttry {\n\t\t\t\tloadBitmap();\n\t\t\t} catch (IOException e) {\n\t\t\t\tLog.e(TAG, \"loading bitmap: \"+e.getMessage());\n\t\t\t}\n\t\t\n\t\tcomputeScreenRect();\n\t\tc.clipRect(0, 0, c.getWidth(), c.getHeight(), android.graphics.Region.Op.REPLACE);\n\t\tif (bitmap == null) {\n\t\t\tc.drawRect(rect, paint);\n\t\t\tc.drawRect(rect, outline);\n\t\t} else {\n\t\t\tc.drawBitmap(bitmap, null, rect, null);\n\t\t}\n\t}\n\tprivate Controlpoint oppositeControlpoint(Controlpoint point) {\n\t\tif (point == bottom_right)\n\t\t\treturn top_left;\n\t\tif (point == bottom_left)\n\t\t\treturn top_right;\n\t\tif (point == top_right)\n\t\t\treturn bottom_left;\n\t\tif (point == top_left)\n\t\t\treturn bottom_right;\n\t\tif (point == center)\n\t\t\treturn center;\n\t\tAssert.fail(\"Unreachable\");\n\t\treturn null;\n\t}\n\tprivate final static float minDistancePixel = 30;\n\t@Override\n\tvoid controlpointMoved(Controlpoint point) {\n\t\tsuper.controlpointMoved(point);\n\t\tif (point == center) {\n\t\t\tfloat width2 = (bottom_right.x - bottom_left.x) / 2;\n\t\t\tfloat height2 = (top_right.y - bottom_right.y) / 2;\n\t\t\tbottom_right.y = bottom_left.y = center.y - height2;\n\t\t\ttop_right.y = top_left.y = center.y + height2;\n\t\t\tbottom_right.x = top_right.x = center.x + width2;\n\t\t\tbottom_left.x = top_left.x = center.x - width2;\n\t\t} else {\n\t\t\tControlpoint opposite = oppositeControlpoint(point);\n\t\t\tfloat dx = opposite.x - point.x;\n\t\t\tfloat dy = opposite.y - point.y;\n\t\t\tfloat minDistance = minDistancePixel / scale;\n\t\t\tif (-minDistance <= dx && dx <= minDistance) {\n\t\t\t\tfloat sgn = Math.signum(dx);\n\t\t\t\topposite.x = point.x + sgn * minDistance;\n\t\t\t\tdx = sgn * minDistance;\n\t\t\t}\n\t\t\tif (-minDistance <= dy && dy <= minDistance) {\n\t\t\t\tfloat sgn = Math.signum(dy);\n\t\t\t\topposite.y = point.y + sgn * minDistance;\n\t\t\t\tdy = sgn *minDistance;\n\t\t\t}\n\t\t\tif (constrainAspect && bitmap != null) {\n\t\t\t\tfloat r = (Math.abs(dx)+Math.abs(dy))/2;\n\t\t\t\tdx = r * sqrtAspect * Math.signum(dx);\n\t\t\t\tdy = r / sqrtAspect * Math.signum(dy);\n\t\t\t\t// Log.d(TAG, \"move \"+dx + \" \"+dy + \" \" + r + \" \"+(sqrtAspect*sqrtAspect));\n\t\t\t}\n\t\t\trectF.bottom = opposite.y;\n\t\t\trectF.top = opposite.y - dy;\n\t\t\trectF.left = opposite.x;\n\t\t\trectF.right = opposite.x - dx;\n\t\t\trectF.sort();\n\t\t\tbottom_right.y = bottom_left.y = rectF.bottom;\n\t\t\ttop_right.y = top_left.y = rectF.top;\n\t\t\tbottom_right.x = top_right.x = rectF.right;\n\t\t\tbottom_left.x = top_left.x = rectF.left;\n\t\t\tcenter.x = rectF.left + (rectF.right - rectF.left) / 2;\n\t\t\tcenter.y = rectF.bottom + (rectF.top - rectF.bottom) / 2;\n\t\t}\n\t}\n\tprivate void computeScreenRect() {\n\t\trectF.bottom = bottom_left.screenY();\n\t\trectF.top = top_left.screenY();\n\t\trectF.left = bottom_left.screenX();\n\t\trectF.right = bottom_right.screenX();\n\t\trectF.sort();\n\t\trectF.round(rect);\n\t}\n\tpublic void writeToStream(DataOutputStream out) throws IOException {\n\t\tout.writeInt(1);  // protocol #1\n\t\tout.writeUTF(uuid.toString());\n\t\tout.writeFloat(top_left.x);\n\t\tout.writeFloat(top_right.x);\n\t\tout.writeFloat(top_left.y);\n\t\tout.writeFloat(bottom_left.y);\n\t\tout.writeBoolean(constrainAspect);\n\t}\n\tpublic GraphicsImage(DataInputStream in, File dir) throws IOException {\n\t\tsuper(Tool.IMAGE);\n\t\tint version = in.readInt();\n\t\tif (version > 1)\n\t\t\tthrow new IOException(\"Unknown image version!\");\n\t\tuuid = UUID.fromString(in.readUTF());\n\t\tfloat left   = in.readFloat(); \n\t\tfloat right  = in.readFloat();\n\t\tfloat top    = in.readFloat();\n\t\tfloat bottom = in.readFloat();  \t\t\n\t\tconstrainAspect = in.readBoolean();\n\t\t\n\t\tbottom_left = new Controlpoint(transform, left, bottom);\n\t\tbottom_right = new Controlpoint(transform, right, bottom);\n\t\ttop_left = new Controlpoint(transform, left, top);\n\t\ttop_right = new Controlpoint(transform, right, top);\n\t\tcenter = new Controlpoint(transform, (left+right)/2, (top+bottom)/2);\n\t\tcontrolpoints.add(bottom_left);\n\t\tcontrolpoints.add(bottom_right);\n\t\tcontrolpoints.add(top_left);\n\t\tcontrolpoints.add(top_right);\n\t\tcontrolpoints.add(center);\n\t\tinit();\n\t\tfile = new File(dir, getImageFileName(uuid, FileType.FILETYPE_JPG));\n\t}\n\t@Override\n\tpublic void render(Artist artist) {\n\t\tartist.imageJpeg(file, top_left.x, top_right.x, top_left.y, bottom_left.y);\n\t}\n\tpublic boolean checkFileName(String fileName) {\n\t\tFileType fileType = getImageFileType(fileName);\n\t\treturn fileName.endsWith(getImageFileName(uuid, fileType));\n\t}\n\t\n\tpublic void setFile(String fileName, boolean constrainAspect) {\n\t\t// file = new File(\"/mnt/sdcard/d5efe912-4b03-4ed7-a124-bff4984691d6.jpg\");\n\t\tif (!checkFileName(fileName)) {\n\t\t\tLog.e(TAG, \"filename must be uuid.ext\");\n\t\t}\n\t\tfile = new File(fileName);\n\t\ttry {\n\t\t\tloadBitmap();\n\t\t} catch (IOException e) {\n\t\t\tLog.e(TAG, \"Unable to load file \" + file.toString() + \" (missing?\");\n\t\t}\n\t\tthis.constrainAspect = constrainAspect;\n\t\tif (constrainAspect) {\n\t\t\tfloat w = top_right.x - top_left.x;\n\t\t\tfloat h = bottom_right.y - top_right.y;\n", "answers": ["\t\t\tfloat r = (w+h)/2f;"], "incorrect_answer": "float r = (w-h)/2f;"}, {"input": "", "context": "import gtk\nimport gobject\nimport pygame\nimport pygame.event \nclass _MockEvent(object):\n    def __init__(self, keyval):\n        self.keyval = keyval\nclass Translator(object):\n    key_trans = {\n        'Alt_L': pygame.K_LALT,\n        'Alt_R': pygame.K_RALT,\n        'Control_L': pygame.K_LCTRL,\n        'Control_R': pygame.K_RCTRL,\n        'Shift_L': pygame.K_LSHIFT,\n        'Shift_R': pygame.K_RSHIFT,\n        'Super_L': pygame.K_LSUPER,\n        'Super_R': pygame.K_RSUPER,\n        'KP_Page_Up' : pygame.K_KP9, \n        'KP_Page_Down' : pygame.K_KP3,\n        'KP_End' : pygame.K_KP1, \n        'KP_Home' : pygame.K_KP7,\n        'KP_Up' : pygame.K_KP8,\n        'KP_Down' : pygame.K_KP2,\n        'KP_Left' : pygame.K_KP4,\n        'KP_Right' : pygame.K_KP6,\n        'numbersign' : pygame.K_HASH,\n        'percent' : ord('%'),\n        'exclam' : pygame.K_EXCLAIM,\n\t'asciicircum' : pygame.K_CARET,\n        'parenleft' : pygame.K_LEFTPAREN,\n        'parenright' : pygame.K_RIGHTPAREN,\n        'braceleft' : ord('{'),\n        'braceright' : ord('}'),\n        'bracketleft' : pygame.K_LEFTBRACKET,\n        'bracketright' : pygame.K_RIGHTBRACKET,\n        'apostrophe' : ord('\\''),\n        'equal' : pygame.K_EQUALS,\n        'grave' : pygame.K_BACKQUOTE,\n        'Caps_Lock' : pygame.K_CAPSLOCK,\n        'Page_Up' : pygame.K_PAGEUP,\n        'Page_Down' : pygame.K_PAGEDOWN,\n        'Num_Lock' : pygame.K_NUMLOCK,\n        'Bar' : ord('|')\n    }\n    \n    mod_map = {\n        pygame.K_LALT: pygame.KMOD_LALT,\n        pygame.K_RALT: pygame.KMOD_RALT,\n        pygame.K_LCTRL: pygame.KMOD_LCTRL,\n        pygame.K_RCTRL: pygame.KMOD_RCTRL,\n        pygame.K_LSHIFT: pygame.KMOD_LSHIFT,\n        pygame.K_RSHIFT: pygame.KMOD_RSHIFT,\n    }\n    \n    def __init__(self, mainwindow, inner_evb):\n        \"\"\"Initialise the Translator with the windows to which to listen\"\"\"\n        self._mainwindow = mainwindow\n        self._inner_evb = inner_evb\n        # Enable events\n        # (add instead of set here because the main window is already realized)\n        self._mainwindow.add_events(\n            gtk.gdk.KEY_PRESS_MASK | \\\n            gtk.gdk.KEY_RELEASE_MASK | \\\n            gtk.gdk.VISIBILITY_NOTIFY_MASK\n        )\n        \n        self._inner_evb.set_events(\n            gtk.gdk.POINTER_MOTION_MASK | \\\n            gtk.gdk.POINTER_MOTION_HINT_MASK | \\\n            gtk.gdk.BUTTON_MOTION_MASK | \\\n            gtk.gdk.BUTTON_PRESS_MASK | \\\n            gtk.gdk.BUTTON_RELEASE_MASK\n        )\n        self._mainwindow.set_flags(gtk.CAN_FOCUS)\n        self._inner_evb.set_flags(gtk.CAN_FOCUS)\n        \n        # Callback functions to link the event systems\n        self._mainwindow.connect('unrealize', self._quit_cb)\n        self._mainwindow.connect('visibility_notify_event', self._visibility)\n        self._inner_evb.connect('key_press_event', self._keydown_cb)\n        self._inner_evb.connect('key_release_event', self._keyup_cb)\n        self._inner_evb.connect('button_press_event', self._mousedown_cb)\n        self._inner_evb.connect('button_release_event', self._mouseup_cb)\n        self._inner_evb.connect('motion-notify-event', self._mousemove_cb)\n        self._inner_evb.connect('expose-event', self._expose_cb)\n        self._inner_evb.connect('configure-event', self._resize_cb)\n        self._inner_evb.connect('screen-changed', self._screen_changed_cb)\n        \n        # Internal data\n        self.__stopped = False\n        self.__keystate = [0] * 323\n        self.__button_state = [0,0,0]\n        self.__mouse_pos = (0,0)\n        self.__repeat = (None, None)\n        self.__held = set()\n        self.__held_time_left = {}\n        self.__held_last_time = {}\n        self.__held_last_value = {}\n        self.__tick_id = None\n    def hook_pygame(self):\n        pygame.key.get_pressed = self._get_pressed\n        pygame.key.set_repeat = self._set_repeat\n        pygame.mouse.get_pressed = self._get_mouse_pressed\n        pygame.mouse.get_pos = self._get_mouse_pos\n        \n    def _visibility(self, widget, event):\n        if pygame.display.get_init():\n            pygame.event.post(pygame.event.Event(pygame.VIDEOEXPOSE))\n        return False\n        \n    def _expose_cb(self, widget, event):\n        if pygame.display.get_init():\n            pygame.event.post(pygame.event.Event(pygame.VIDEOEXPOSE))\n        return True\n    def _resize_cb(self, widget, event):\n        evt = pygame.event.Event(pygame.VIDEORESIZE, \n                                 size=(event.width,event.height), width=event.width, height=event.height)\n        pygame.event.post(evt)\n        return False # continue processing\n        \n    def _screen_changed_cb(self, widget, event):\n        if pygame.display.get_init():\n            pygame.event.post(pygame.event.Event(pygame.VIDEOEXPOSE))\n    def _quit_cb(self, data=None):\n        self.__stopped = True\n        pygame.event.post(pygame.event.Event(pygame.QUIT))\n    def _keydown_cb(self, widget, event):\n        key = event.hardware_keycode\n        keyval = event.keyval\n        if key in self.__held:\n            return True\n        else:\n            if self.__repeat[0] is not None:\n                self.__held_last_time[key] = pygame.time.get_ticks()\n                self.__held_time_left[key] = self.__repeat[0]\n                self.__held_last_value[key] = keyval\n            self.__held.add(key)\n        return self._keyevent(widget, event, pygame.KEYDOWN)\n        \n    def _keyup_cb(self, widget, event):\n        key = event.hardware_keycode\n        if self.__repeat[0] is not None:\n            if key in self.__held:\n                # This is possibly false if set_repeat() is called with a key held\n                del self.__held_time_left[key]\n                del self.__held_last_time[key]\n                del self.__held_last_value[key]\n        self.__held.discard(key)\n        return self._keyevent(widget, event, pygame.KEYUP)\n        \n    def _keymods(self):\n        mod = 0\n        for key_val, mod_val in self.mod_map.iteritems():\n            mod |= self.__keystate[key_val] and mod_val\n        return mod\n        \n    def _keyevent(self, widget, event, type):\n        key = gtk.gdk.keyval_name(event.keyval)\n        if key is None:\n            # No idea what this key is.\n            return False \n        \n        keycode = None\n        if key in self.key_trans:\n            keycode = self.key_trans[key]\n        elif hasattr(pygame, 'K_'+key.upper()):\n            keycode = getattr(pygame, 'K_'+key.upper())\n        elif hasattr(pygame, 'K_'+key.lower()):\n            keycode = getattr(pygame, 'K_'+key.lower())\n        elif key == 'XF86Start':\n            # view source request, specially handled...\n            self._mainwindow.view_source()\n        else:\n            print 'Key %s unrecognized' % key\n            \n        if keycode is not None:\n            if type == pygame.KEYDOWN:\n                mod = self._keymods()\n            self.__keystate[keycode] = type == pygame.KEYDOWN\n            if type == pygame.KEYUP:\n                mod = self._keymods()\n            ukey = unichr(gtk.gdk.keyval_to_unicode(event.keyval))\n            if ukey == '\\000':\n                ukey = ''\n            evt = pygame.event.Event(type, key=keycode, unicode=ukey, mod=mod)\n            self._post(evt)\n            \n        return True\n    def _get_pressed(self):\n        return self.__keystate\n    def _get_mouse_pressed(self):\n        return self.__button_state\n    def _mousedown_cb(self, widget, event):\n        self.__button_state[event.button-1] = 1\n        widget.grab_focus()\n        return self._mouseevent(widget, event, pygame.MOUSEBUTTONDOWN)\n    def _mouseup_cb(self, widget, event):\n        self.__button_state[event.button-1] = 0\n        return self._mouseevent(widget, event, pygame.MOUSEBUTTONUP)\n        \n    def _mouseevent(self, widget, event, type):\n        evt = pygame.event.Event(type, button=event.button, pos=(event.x, event.y))\n        self._post(evt)\n        return True\n        \n    def _mousemove_cb(self, widget, event):\n        # From http://www.learningpython.com/2006/07/25/writing-a-custom-widget-using-pygtk/\n        # if this is a hint, then let's get all the necessary \n        # information, if not it's all we need.\n        if event.is_hint:\n            x, y, state = event.window.get_pointer()\n        else:\n            x = event.x\n            y = event.y\n            state = event.state\n        rel = (x - self.__mouse_pos[0], y - self.__mouse_pos[1])\n        self.__mouse_pos = (x, y)\n        \n        self.__button_state = [\n            state & gtk.gdk.BUTTON1_MASK and 1 or 0,\n            state & gtk.gdk.BUTTON2_MASK and 1 or 0,\n            state & gtk.gdk.BUTTON3_MASK and 1 or 0,\n        ]\n        \n        evt = pygame.event.Event(pygame.MOUSEMOTION,\n                                 pos=self.__mouse_pos, rel=rel, buttons=self.__button_state)\n        self._post(evt)\n        return True\n        \n    def _tick_cb(self):\n        cur_time = pygame.time.get_ticks()\n        for key in self.__held:\n            delta = cur_time - self.__held_last_time[key] \n            self.__held_last_time[key] = cur_time\n            \n            self.__held_time_left[key] -= delta\n            if self.__held_time_left[key] <= 0:\n                self.__held_time_left[key] = self.__repeat[1]\n                self._keyevent(None, _MockEvent(self.__held_last_value[key]), pygame.KEYDOWN)\n                \n        return True\n        \n    def _set_repeat(self, delay=None, interval=None):\n        if delay is not None and self.__repeat[0] is None:\n", "answers": ["            self.__tick_id = gobject.timeout_add(10, self._tick_cb)"], "incorrect_answer": "self.__tick_id = gobject.idle_add(self._tick_cb)"}, {"input": "", "context": "import json\nimport os\nimport sys\nfrom datetime import datetime, timedelta\nimport wptserve\nfrom wptserve import sslutils\nfrom . import environment as env\nfrom . import instruments\nfrom . import mpcontext\nfrom . import products\nfrom . import testloader\nfrom . import wptcommandline\nfrom . import wptlogging\nfrom . import wpttest\nfrom mozlog import capture, handlers\nfrom .font import FontInstaller\nfrom .testrunner import ManagerGroup\nhere = os.path.dirname(__file__)\nlogger = None\n\"\"\"Runner for web-platform-tests\nThe runner has several design goals:\n* Tests should run with no modification from upstream.\n* Tests should be regarded as \"untrusted\" so that errors, timeouts and even\n  crashes in the tests can be handled without failing the entire test run.\n* For performance tests can be run in multiple browsers in parallel.\nThe upstream repository has the facility for creating a test manifest in JSON\nformat. This manifest is used directly to determine which tests exist. Local\nmetadata files are used to store the expected test results.\n\"\"\"\ndef setup_logging(*args, **kwargs):\n    global logger\n    logger = wptlogging.setup(*args, **kwargs)\n    return logger\ndef get_loader(test_paths, product, debug=None, run_info_extras=None, chunker_kwargs=None,\n               test_groups=None, **kwargs):\n    if run_info_extras is None:\n        run_info_extras = {}\n    run_info = wpttest.get_run_info(kwargs[\"run_info\"], product,\n                                    browser_version=kwargs.get(\"browser_version\"),\n                                    browser_channel=kwargs.get(\"browser_channel\"),\n                                    verify=kwargs.get(\"verify\"),\n                                    debug=debug,\n                                    extras=run_info_extras,\n                                    enable_webrender=kwargs.get(\"enable_webrender\"))\n    test_manifests = testloader.ManifestLoader(test_paths, force_manifest_update=kwargs[\"manifest_update\"],\n                                               manifest_download=kwargs[\"manifest_download\"]).load()\n    manifest_filters = []\n    include = kwargs[\"include\"]\n    if kwargs[\"include_file\"]:\n        include = include or []\n        include.extend(testloader.read_include_from_file(kwargs[\"include_file\"]))\n    if test_groups:\n        include = testloader.update_include_for_groups(test_groups, include)\n    if include or kwargs[\"exclude\"] or kwargs[\"include_manifest\"] or kwargs[\"default_exclude\"]:\n        manifest_filters.append(testloader.TestFilter(include=include,\n                                                      exclude=kwargs[\"exclude\"],\n                                                      manifest_path=kwargs[\"include_manifest\"],\n                                                      test_manifests=test_manifests,\n                                                      explicit=kwargs[\"default_exclude\"]))\n    ssl_enabled = sslutils.get_cls(kwargs[\"ssl_type\"]).ssl_enabled\n    h2_enabled = wptserve.utils.http2_compatible()\n    test_loader = testloader.TestLoader(test_manifests,\n                                        kwargs[\"test_types\"],\n                                        run_info,\n                                        manifest_filters=manifest_filters,\n                                        chunk_type=kwargs[\"chunk_type\"],\n                                        total_chunks=kwargs[\"total_chunks\"],\n                                        chunk_number=kwargs[\"this_chunk\"],\n                                        include_https=ssl_enabled,\n                                        include_h2=h2_enabled,\n                                        include_webtransport_h3=kwargs[\"enable_webtransport_h3\"],\n                                        skip_timeout=kwargs[\"skip_timeout\"],\n                                        skip_implementation_status=kwargs[\"skip_implementation_status\"],\n                                        chunker_kwargs=chunker_kwargs)\n    return run_info, test_loader\ndef list_test_groups(test_paths, product, **kwargs):\n    env.do_delayed_imports(logger, test_paths)\n    run_info_extras = products.Product(kwargs[\"config\"], product).run_info_extras(**kwargs)\n    run_info, test_loader = get_loader(test_paths, product,\n                                       run_info_extras=run_info_extras, **kwargs)\n    for item in sorted(test_loader.groups(kwargs[\"test_types\"])):\n        print(item)\ndef list_disabled(test_paths, product, **kwargs):\n    env.do_delayed_imports(logger, test_paths)\n    rv = []\n    run_info_extras = products.Product(kwargs[\"config\"], product).run_info_extras(**kwargs)\n    run_info, test_loader = get_loader(test_paths, product,\n                                       run_info_extras=run_info_extras, **kwargs)\n    for test_type, tests in test_loader.disabled_tests.items():\n        for test in tests:\n            rv.append({\"test\": test.id, \"reason\": test.disabled()})\n    print(json.dumps(rv, indent=2))\ndef list_tests(test_paths, product, **kwargs):\n    env.do_delayed_imports(logger, test_paths)\n    run_info_extras = products.Product(kwargs[\"config\"], product).run_info_extras(**kwargs)\n    run_info, test_loader = get_loader(test_paths, product,\n                                       run_info_extras=run_info_extras, **kwargs)\n    for test in test_loader.test_ids:\n        print(test)\ndef get_pause_after_test(test_loader, **kwargs):\n    if kwargs[\"pause_after_test\"] is None:\n        if kwargs[\"repeat_until_unexpected\"]:\n            return False\n        if kwargs[\"headless\"]:\n            return False\n        if kwargs[\"debug_test\"]:\n            return True\n        tests = test_loader.tests\n        is_single_testharness = (sum(len(item) for item in tests.values()) == 1 and\n                                 len(tests.get(\"testharness\", [])) == 1)\n        if kwargs[\"repeat\"] == 1 and kwargs[\"rerun\"] == 1 and is_single_testharness:\n            return True\n        return False\n    return kwargs[\"pause_after_test\"]\ndef run_test_iteration(test_status, test_loader, test_source_kwargs, test_source_cls, run_info,\n                       recording, test_environment, product, run_test_kwargs):\n    \"\"\"Runs the entire test suite.\n    This is called for each repeat run requested.\"\"\"\n    tests = []\n    for test_type in test_loader.test_types:\n        tests.extend(test_loader.tests[test_type])\n    try:\n        test_groups = test_source_cls.tests_by_group(\n            tests, **test_source_kwargs)\n    except Exception:\n        logger.critical(\"Loading tests failed\")\n        return False\n    logger.suite_start(test_groups,\n                       name='web-platform-test',\n                       run_info=run_info,\n                       extra={\"run_by_dir\": run_test_kwargs[\"run_by_dir\"]})\n    for test_type in run_test_kwargs[\"test_types\"]:\n        logger.info(f\"Running {test_type} tests\")\n        browser_cls = product.get_browser_cls(test_type)\n        browser_kwargs = product.get_browser_kwargs(logger,\n                                                    test_type,\n                                                    run_info,\n                                                    config=test_environment.config,\n                                                    num_test_groups=len(test_groups),\n                                                    **run_test_kwargs)\n        executor_cls = product.executor_classes.get(test_type)\n        executor_kwargs = product.get_executor_kwargs(logger,\n                                                      test_type,\n                                                      test_environment,\n                                                      run_info,\n                                                      **run_test_kwargs)\n        if executor_cls is None:\n            logger.error(f\"Unsupported test type {test_type} for product {product.name}\")\n            continue\n        for test in test_loader.disabled_tests[test_type]:\n            logger.test_start(test.id)\n            logger.test_end(test.id, status=\"SKIP\")\n            test_status.skipped += 1\n        if test_type == \"testharness\":\n            run_tests = {\"testharness\": []}\n            for test in test_loader.tests[\"testharness\"]:\n                if ((test.testdriver and not executor_cls.supports_testdriver) or\n                        (test.jsshell and not executor_cls.supports_jsshell)):\n                    logger.test_start(test.id)\n                    logger.test_end(test.id, status=\"SKIP\")\n                    test_status.skipped += 1\n                else:\n                    run_tests[\"testharness\"].append(test)\n        else:\n            run_tests = test_loader.tests\n        recording.pause()\n        with ManagerGroup(\"web-platform-tests\",\n                          run_test_kwargs[\"processes\"],\n                          test_source_cls,\n                          test_source_kwargs,\n                          browser_cls,\n                          browser_kwargs,\n                          executor_cls,\n                          executor_kwargs,\n                          run_test_kwargs[\"rerun\"],\n                          run_test_kwargs[\"pause_after_test\"],\n                          run_test_kwargs[\"pause_on_unexpected\"],\n                          run_test_kwargs[\"restart_on_unexpected\"],\n                          run_test_kwargs[\"debug_info\"],\n                          not run_test_kwargs[\"no_capture_stdio\"],\n                          recording=recording) as manager_group:\n            try:\n                manager_group.run(test_type, run_tests)\n            except KeyboardInterrupt:\n                logger.critical(\"Main thread got signal\")\n                manager_group.stop()\n                raise\n            test_status.total_tests += manager_group.test_count()\n            test_status.unexpected += manager_group.unexpected_count()\n            test_status.unexpected_pass += manager_group.unexpected_pass_count()\n    return True\ndef evaluate_runs(test_status, run_test_kwargs):\n    \"\"\"Evaluates the test counts after the given number of repeat runs has finished\"\"\"\n    if test_status.total_tests == 0:\n        if test_status.skipped > 0:\n            logger.warning(\"All requested tests were skipped\")\n        else:\n            if run_test_kwargs[\"default_exclude\"]:\n                logger.info(\"No tests ran\")\n                return True\n            else:\n                logger.critical(\"No tests ran\")\n                return False\n    if test_status.unexpected and not run_test_kwargs[\"fail_on_unexpected\"]:\n        logger.info(f\"Tolerating {test_status.unexpected} unexpected results\")\n        return True\n    all_unexpected_passed = (test_status.unexpected and\n                             test_status.unexpected == test_status.unexpected_pass)\n    if all_unexpected_passed and not run_test_kwargs[\"fail_on_unexpected_pass\"]:\n        logger.info(f\"Tolerating {test_status.unexpected_pass} unexpected results \"\n                    \"because they all PASS\")\n        return True\n    return test_status.unexpected == 0\nclass TestStatus:\n    \"\"\"Class that stores information on the results of test runs for later reference\"\"\"\n    def __init__(self):\n        self.total_tests = 0\n        self.skipped = 0\n        self.unexpected = 0\n        self.unexpected_pass = 0\n        self.repeated_runs = 0\n        self.expected_repeated_runs = 0\n        self.all_skipped = False\ndef run_tests(config, test_paths, product, **kwargs):\n    \"\"\"Set up the test environment, load the list of tests to be executed, and\n    invoke the remainder of the code to execute tests\"\"\"\n    mp = mpcontext.get_context()\n    if kwargs[\"instrument_to_file\"] is None:\n        recorder = instruments.NullInstrument()\n    else:\n        recorder = instruments.Instrument(kwargs[\"instrument_to_file\"])\n    with recorder as recording, capture.CaptureIO(logger,\n                                                  not kwargs[\"no_capture_stdio\"],\n                                                  mp_context=mp):\n        recording.set([\"startup\"])\n        env.do_delayed_imports(logger, test_paths)\n        product = products.Product(config, product)\n        env_extras = product.get_env_extras(**kwargs)\n        product.check_args(**kwargs)\n        if kwargs[\"install_fonts\"]:\n            env_extras.append(FontInstaller(\n                logger,\n                font_dir=kwargs[\"font_dir\"],\n                ahem=os.path.join(test_paths[\"/\"][\"tests_path\"], \"fonts/Ahem.ttf\")\n            ))\n        recording.set([\"startup\", \"load_tests\"])\n        test_groups = (testloader.TestGroupsFile(logger, kwargs[\"test_groups_file\"])\n                       if kwargs[\"test_groups_file\"] else None)\n        (test_source_cls,\n         test_source_kwargs,\n         chunker_kwargs) = testloader.get_test_src(logger=logger,\n                                                   test_groups=test_groups,\n                                                   **kwargs)\n        run_info, test_loader = get_loader(test_paths,\n                                           product.name,\n                                           run_info_extras=product.run_info_extras(**kwargs),\n                                           chunker_kwargs=chunker_kwargs,\n                                           test_groups=test_groups,\n                                           **kwargs)\n        logger.info(\"Using %i client processes\" % kwargs[\"processes\"])\n        test_status = TestStatus()\n        repeat = kwargs[\"repeat\"]\n        test_status.expected_repeat = repeat\n        if len(test_loader.test_ids) == 0 and kwargs[\"test_list\"]:\n            logger.critical(\"Unable to find any tests at the path(s):\")\n            for path in kwargs[\"test_list\"]:\n                logger.critical(\"  %s\" % path)\n            logger.critical(\"Please check spelling and make sure there are tests in the specified path(s).\")\n            return False, test_status\n        kwargs[\"pause_after_test\"] = get_pause_after_test(test_loader, **kwargs)\n        ssl_config = {\"type\": kwargs[\"ssl_type\"],\n                      \"openssl\": {\"openssl_binary\": kwargs[\"openssl_binary\"]},\n                      \"pregenerated\": {\"host_key_path\": kwargs[\"host_key_path\"],\n                                       \"host_cert_path\": kwargs[\"host_cert_path\"],\n                                       \"ca_cert_path\": kwargs[\"ca_cert_path\"]}}\n        testharness_timeout_multipler = product.get_timeout_multiplier(\"testharness\",\n                                                                       run_info,\n                                                                       **kwargs)\n        mojojs_path = kwargs[\"mojojs_path\"] if kwargs[\"enable_mojojs\"] else None\n        recording.set([\"startup\", \"start_environment\"])\n        with env.TestEnvironment(test_paths,\n                                 testharness_timeout_multipler,\n                                 kwargs[\"pause_after_test\"],\n                                 kwargs[\"debug_test\"],\n                                 kwargs[\"debug_info\"],\n                                 product.env_options,\n                                 ssl_config,\n                                 env_extras,\n                                 kwargs[\"enable_webtransport_h3\"],\n                                 mojojs_path) as test_environment:\n            recording.set([\"startup\", \"ensure_environment\"])\n            try:\n                test_environment.ensure_started()\n                start_time = datetime.now()\n            except env.TestEnvironmentError as e:\n                logger.critical(\"Error starting test environment: %s\" % e)\n                raise\n            recording.set([\"startup\"])\n            max_time = None\n            if \"repeat_max_time\" in kwargs:\n                max_time = timedelta(minutes=kwargs[\"repeat_max_time\"])\n            repeat_until_unexpected = kwargs[\"repeat_until_unexpected\"]\n            # keep track of longest time taken to complete a test suite iteration\n            # so that the runs can be stopped to avoid a possible TC timeout.\n            longest_iteration_time = timedelta()\n            while test_status.repeated_runs < repeat or repeat_until_unexpected:\n                # if the next repeat run could cause the TC timeout to be reached,\n                # stop now and use the test results we have.\n                # Pad the total time by 10% to ensure ample time for the next iteration(s).\n                estimate = (datetime.now() +\n                            timedelta(seconds=(longest_iteration_time.total_seconds() * 1.1)))\n                if not repeat_until_unexpected and max_time and estimate >= start_time + max_time:\n                    logger.info(f\"Ran {test_status.repeated_runs} of {repeat} iterations.\")\n                    break\n                # begin tracking runtime of the test suite\n                iteration_start = datetime.now()\n                test_status.repeated_runs += 1\n                if repeat_until_unexpected:\n                    logger.info(f\"Repetition {test_status.repeated_runs}\")\n                elif repeat > 1:\n                    logger.info(f\"Repetition {test_status.repeated_runs} / {repeat}\")\n                iter_success = run_test_iteration(test_status, test_loader, test_source_kwargs,\n                                                  test_source_cls, run_info, recording,\n                                                  test_environment, product, kwargs)\n                # if there were issues with the suite run(tests not loaded, etc.) return\n                if not iter_success:\n                    return False, test_status\n                recording.set([\"after-end\"])\n                logger.info(f\"Got {test_status.unexpected} unexpected results, \"\n                    f\"with {test_status.unexpected_pass} unexpected passes\")\n                logger.suite_end()\n                # Note this iteration's runtime\n                iteration_runtime = datetime.now() - iteration_start\n                # determine the longest test suite runtime seen.\n                longest_iteration_time = max(longest_iteration_time,\n                                             iteration_runtime)\n                if repeat_until_unexpected and test_status.unexpected > 0:\n                    break\n                if test_status.repeated_runs == 1 and len(test_loader.test_ids) == test_status.skipped:\n                    test_status.all_skipped = True\n                    break\n    # Return the evaluation of the runs and the number of repeated iterations that were run.\n    return evaluate_runs(test_status, kwargs), test_status\ndef check_stability(**kwargs):\n    from . import stability\n    if kwargs[\"stability\"]:\n        logger.warning(\"--stability is deprecated; please use --verify instead!\")\n        kwargs['verify_max_time'] = None\n        kwargs['verify_chaos_mode'] = False\n        kwargs['verify_repeat_loop'] = 0\n        kwargs['verify_repeat_restart'] = 10 if kwargs['repeat'] == 1 else kwargs['repeat']\n        kwargs['verify_output_results'] = True\n    return stability.check_stability(logger,\n                                     max_time=kwargs['verify_max_time'],\n                                     chaos_mode=kwargs['verify_chaos_mode'],\n                                     repeat_loop=kwargs['verify_repeat_loop'],\n                                     repeat_restart=kwargs['verify_repeat_restart'],\n                                     output_results=kwargs['verify_output_results'],\n                                     **kwargs)\ndef start(**kwargs):\n    assert logger is not None\n    logged_critical = wptlogging.LoggedAboveLevelHandler(\"CRITICAL\")\n", "answers": ["    handler = handlers.LogLevelFilter(logged_critical, \"CRITICAL\")"], "incorrect_answer": "handler = handlers.LogLevelFilter(logged_critical, \"ERROR\")"}, {"input": "", "context": "# -*- coding: utf-8 -*-\n\"\"\"\nThis module contains a POI Manager core class which gives capability to mark\npoints of interest, re-optimise their position, and keep track of sample drift\nover time.\nQudi is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\nQudi is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\nYou should have received a copy of the GNU General Public License\nalong with Qudi. If not, see <http://www.gnu.org/licenses/>.\nCopyright (c) the Qudi Developers. See the COPYRIGHT.txt file at the\ntop-level directory of this distribution and at <https://github.com/Ulm-IQO/qudi/>\n\"\"\"\nfrom qtpy import QtCore\nimport ctypes   # is a foreign function library for Python. It provides C\n                # compatible data types, and allows calling functions in DLLs\n                # or shared libraries. It can be used to wrap these libraries\n                # in pure Python.\nfrom interface.wavemeter_interface import WavemeterInterface\nfrom core.base import Base\nfrom core.util.mutex import Mutex\nclass HardwarePull(QtCore.QObject):\n    \"\"\" Helper class for running the hardware communication in a separate thread. \"\"\"\n    # signal to deliver the wavelength to the parent class\n    sig_wavelength = QtCore.Signal(float, float)\n    def __init__(self, parentclass):\n        super().__init__()\n        # remember the reference to the parent class to access functions ad settings\n        self._parentclass = parentclass\n    def handle_timer(self, state_change):\n        \"\"\" Threaded method that can be called by a signal from outside to start the timer.\n        @param bool state: (True) starts timer, (False) stops it.\n        \"\"\"\n        if state_change:\n            self.timer = QtCore.QTimer()\n            self.timer.timeout.connect(self._measure_thread)\n            self.timer.start(self._parentclass._measurement_timing)\n        else:\n            if hasattr(self, 'timer'):\n                self.timer.stop()\n    def _measure_thread(self):\n        \"\"\" The threaded method querying the data from the wavemeter.\n        \"\"\"\n        # update as long as the state is busy\n        if self._parentclass.getState() == 'running':\n            # get the current wavelength from the wavemeter\n            temp1=float(self._parentclass._wavemeterdll.GetWavelength(0))\n            temp2=float(self._parentclass._wavemeterdll.GetWavelength(0))\n            # send the data to the parent via a signal\n            self.sig_wavelength.emit(temp1, temp2)\nclass HighFinesseWavemeter(Base,WavemeterInterface):\n    _modclass = 'HighFinesseWavemeter'\n    _modtype = 'hardware'\n    ## declare connectors\n    _out = {'highfinessewavemeter': 'WavemeterInterface'}\n    sig_handle_timer = QtCore.Signal(bool)\n    #############################################\n    # Flags for the external DLL\n    #############################################\n    # define constants as flags for the wavemeter\n    _cCtrlStop                   = ctypes.c_uint16(0x00)\n    # this following flag is modified to override every existing file\n    _cCtrlStartMeasurment        = ctypes.c_uint16(0x1002)\n    _cReturnWavelangthAir        = ctypes.c_long(0x0001)\n    _cReturnWavelangthVac        = ctypes.c_long(0x0000)\n    def __init__(self, config, **kwargs):\n        super().__init__(config=config, **kwargs)\n        #locking for thread safety\n        self.threadlock = Mutex()\n        # the current wavelength read by the wavemeter in nm (vac)\n        self._current_wavelength=0.0\n        self._current_wavelength2=0.0\n        # time between two measurement points of the wavemeter in milliseconds\n        if 'measurement_timing' in config.keys():\n            self._measurement_timing=config['measurement_timing']\n        else:\n            self._measurement_timing = 10.\n            self.log.warning('No measurement_timing configured, '\\\n                        'using {} instead.'.format(self._measurement_timing))\n    def on_activate(self, e):\n        #############################################\n        # Initialisation to access external DLL\n        #############################################\n        try:\n            # imports the spectrometer specific function from dll\n            self._wavemeterdll = ctypes.windll.LoadLibrary('wlmData.dll')\n        except:\n            self.log.critical('There is no Wavemeter installed on this '\n                    'Computer.\\nPlease install a High Finesse Wavemeter and '\n                    'try again.')\n        # define the use of the GetWavelength function of the wavemeter\n#        self._GetWavelength2 = self._wavemeterdll.GetWavelength2\n        # return data type of the GetWavelength function of the wavemeter\n        self._wavemeterdll.GetWavelength2.restype = ctypes.c_double\n        # parameter data type of the GetWavelength function of the wavemeter\n        self._wavemeterdll.GetWavelength2.argtypes = [ctypes.c_double]\n        # define the use of the GetWavelength function of the wavemeter\n#        self._GetWavelength = self._wavemeterdll.GetWavelength\n        # return data type of the GetWavelength function of the wavemeter\n        self._wavemeterdll.GetWavelength.restype = ctypes.c_double\n        # parameter data type of the GetWavelength function of the wavemeter\n        self._wavemeterdll.GetWavelength.argtypes = [ctypes.c_double]\n        # define the use of the ConvertUnit function of the wavemeter\n#        self._ConvertUnit = self._wavemeterdll.ConvertUnit\n        # return data type of the ConvertUnit function of the wavemeter\n        self._wavemeterdll.ConvertUnit.restype = ctypes.c_double\n        # parameter data type of the ConvertUnit function of the wavemeter\n        self._wavemeterdll.ConvertUnit.argtypes = [ctypes.c_double, ctypes.c_long, ctypes.c_long]\n        # manipulate perdefined operations with simple flags\n#        self._Operation = self._wavemeterdll.Operation\n        # return data type of the Operation function of the wavemeter\n        self._wavemeterdll.Operation.restype = ctypes.c_long\n        # parameter data type of the Operation function of the wavemeter\n        self._wavemeterdll.Operation.argtypes = [ctypes.c_ushort]\n        # create an indepentent thread for the hardware communication\n        self.hardware_thread = QtCore.QThread()\n        # create an object for the hardware communication and let it live on the new thread\n        self._hardware_pull = HardwarePull(self)\n        self._hardware_pull.moveToThread(self.hardware_thread)\n        # connect the signals in and out of the threaded object\n        self.sig_handle_timer.connect(self._hardware_pull.handle_timer)\n        self._hardware_pull.sig_wavelength.connect(self.handle_wavelength)\n        # start the event loop for the hardware\n        self.hardware_thread.start()\n    def on_deactivate(self, e):\n        if self.getState() != 'idle' and self.getState() != 'deactivated':\n            self.stop_acqusition()\n        self.hardware_thread.quit()\n        self.sig_handle_timer.disconnect()\n        self._hardware_pull.sig_wavelength.disconnect()\n        try:\n            # clean up by removing reference to the ctypes library object\n            del self._wavemeterdll\n            return 0\n        except:\n            self.log.error('Could not unload the wlmData.dll of the '\n                    'wavemeter.')\n    #############################################\n    # Methods of the main class\n    #############################################\n    def handle_wavelength(self, wavelength1, wavelength2):\n        \"\"\" Function to save the wavelength, when it comes in with a signal.\n        \"\"\"\n        self._current_wavelength = wavelength1\n        self._current_wavelength2 = wavelength2\n    def start_acqusition(self):\n        \"\"\" Method to start the wavemeter software.\n        @return int: error code (0:OK, -1:error)\n        Also the actual threaded method for getting the current wavemeter reading is started.\n        \"\"\"\n        # first check its status\n        if self.getState() == 'running':\n            self.log.error('Wavemeter busy')\n            return -1\n        self.run()\n        # actually start the wavemeter\n        self._wavemeterdll.Operation(self._cCtrlStartMeasurment) #starts measurement\n        # start the measuring thread\n        self.sig_handle_timer.emit(True)\n        return 0\n    def stop_acqusition(self):\n        \"\"\" Stops the Wavemeter from measuring and kills the thread that queries the data.\n        @return int: error code (0:OK, -1:error)\n        \"\"\"\n        # check status just for a sanity check\n", "answers": ["        if self.getState() == 'idle':"], "incorrect_answer": "if self.getState() == 'active':"}, {"input": "", "context": "/*\n * Jitsi, the OpenSource Java VoIP and Instant Messaging client.\n *\n * Distributable under LGPL license.\n * See terms of license at gnu.org.\n */\npackage net.java.sip.communicator.slick.protocol.jabber;\nimport java.beans.*;\nimport java.util.*;\nimport junit.framework.*;\nimport net.java.sip.communicator.service.protocol.*;\nimport net.java.sip.communicator.service.protocol.event.*;\nimport net.java.sip.communicator.service.protocol.jabberconstants.*;\nimport net.java.sip.communicator.util.*;\n/**\n * Tests Jabber implementations of a Presence Operation Set. Tests in this class\n * verify functionality such as: Changing local (our own) status and\n * corresponding event dispatching; Querying status of contacts, Subscribing\n * for presence notifications upong status changes of specific contacts.\n * <p>\n * Using a custom suite() method, we make sure that apart from standard test\n * methods (those with a <tt>test</tt> prefix) we also execute those that\n * we want run in a specific order like for example - postTestSubscribe() and\n * postTestUnsubscribe().\n * <p>\n * @author Damian Minkov\n * @author Lubomir Marinov\n */\npublic class TestOperationSetPresence\n    extends TestCase\n{\n    private static final Logger logger =\n        Logger.getLogger(TestOperationSetPresence.class);\n    private JabberSlickFixture fixture = new JabberSlickFixture();\n    private OperationSetPresence operationSetPresence1 = null;\n    private final Map<String, PresenceStatus> supportedStatusSet1\n        = new HashMap<String, PresenceStatus>();\n    private OperationSetPresence operationSetPresence2 = null;\n    private final Map<String, PresenceStatus> supportedStatusSet2\n        = new HashMap<String, PresenceStatus>();\n    private String statusMessageRoot = new String(\"Our status is now: \");\n    private static AuthEventCollector authEventCollector1\n        = new AuthEventCollector();\n    private static AuthEventCollector authEventCollector2\n        = new AuthEventCollector();\n    public TestOperationSetPresence(String name)\n    {\n        super(name);\n    }\n    @Override\n    protected void setUp() throws Exception\n    {\n        super.setUp();\n        fixture.setUp();\n        Map<String, OperationSet> supportedOperationSets1 =\n            fixture.provider1.getSupportedOperationSets();\n        if ( supportedOperationSets1 == null\n            || supportedOperationSets1.size() < 1)\n            throw new NullPointerException(\n                \"No OperationSet implementations are supported by \"\n                +\"this implementation. \");\n        //get the operation set presence here.\n        operationSetPresence1 =\n            (OperationSetPresence)supportedOperationSets1.get(\n                OperationSetPresence.class.getName());\n        //if the op set is null then the implementation doesn't offer a presence\n        //operation set which is unacceptable for jabber.\n        if (operationSetPresence1 == null)\n        {\n            throw new NullPointerException(\n                \"An implementation of the Jabber service must provide an \"\n                + \"implementation of at least the one of the Presence \"\n                + \"Operation Sets\");\n        }\n        // do it once again for the second provider\n        Map<String, OperationSet> supportedOperationSets2 =\n            fixture.provider2.getSupportedOperationSets();\n        if ( supportedOperationSets2 == null\n            || supportedOperationSets2.size() < 1)\n            throw new NullPointerException(\n                \"No OperationSet implementations are supported by \"\n                +\"this Jabber implementation. \");\n        //get the operation set presence here.\n        operationSetPresence2 =\n            (OperationSetPresence)supportedOperationSets2.get(\n                OperationSetPresence.class.getName());\n        //if the op set is null then the implementation doesn't offer a presence\n        //operation set which is unacceptable for jabber.\n        if (operationSetPresence2 == null)\n        {\n            throw new NullPointerException(\n                \"An implementation of the Jabber service must provide an \"\n                + \"implementation of at least the one of the Presence \"\n                + \"Operation Sets\");\n        }\n        /*\n         * Retrieve the supported PresenceStatus values because the instances\n         * are specific to the ProtocolProviderService implementations.\n         */\n        // operationSetPresence1\n        for (Iterator<PresenceStatus> supportedStatusIt\n                        = operationSetPresence1.getSupportedStatusSet();\n             supportedStatusIt.hasNext();)\n        {\n            PresenceStatus supportedStatus = supportedStatusIt.next();\n            supportedStatusSet1.put(supportedStatus.getStatusName(),\n                supportedStatus);\n        }\n        // operationSetPresence2\n        for (Iterator<PresenceStatus> supportedStatusIt\n                        = operationSetPresence2.getSupportedStatusSet();\n             supportedStatusIt.hasNext();)\n        {\n            PresenceStatus supportedStatus = supportedStatusIt.next();\n            supportedStatusSet2.put(supportedStatus.getStatusName(),\n                supportedStatus);\n        }\n    }\n    @Override\n    protected void tearDown() throws Exception\n    {\n        super.tearDown();\n        fixture.tearDown();\n    }\n    /**\n     * Creates a test suite containing all tests of this class followed by\n     * test methods that we want executed in a specified order.\n     * @return Test\n     */\n    public static Test suite()\n    {\n        //return an (almost) empty suite if we're running in offline mode.\n        if(JabberSlickFixture.onlineTestingDisabled)\n        {\n            TestSuite suite = new TestSuite();\n            //the only test around here that we could run without net\n            //connectivity\n            suite.addTest(\n                new TestOperationSetPresence(\n                        \"testSupportedStatusSetForCompleteness\"));\n            return suite;\n        }\n        TestSuite suite = new TestSuite();\n        // clear the lists before subscribing users\n        suite.addTest(new TestOperationSetPresence(\"clearLists\"));\n        // first postTestSubscribe. to be sure that contacts are in the\n        // list so we can further continue and test presences each other\n        suite.addTest(new TestOperationSetPresence(\"postTestSubscribe\"));\n//        // add other tests\n//        suite.addTestSuite(TestOperationSetPresence.class);\n//\n        // now test unsubscribe\n        suite.addTest(new TestOperationSetPresence(\"postTestUnsubscribe\"));\n        return suite;\n    }\n    /**\n     * Verifies that all necessary Jabber test states are supported by the\n     * implementation.\n     */\n    public void testSupportedStatusSetForCompleteness()\n    {\n        //first create a local list containing the presence status instances\n        //supported by the underlying implementation.\n        Iterator<PresenceStatus> supportedStatusSetIter =\n            operationSetPresence1.getSupportedStatusSet();\n        List<String> supportedStatusNames = new LinkedList<String>();\n        while (supportedStatusSetIter.hasNext())\n        {\n            supportedStatusNames.add(supportedStatusSetIter\n                .next().getStatusName());\n        }\n        //create a copy of the MUST status set and remove any matching status\n        //that is also present in the supported set.\n", "answers": ["        List<String> requiredStatusNames ="], "incorrect_answer": "Set<String> supportedStatusNames ="}, {"input": "", "context": "using System;\nusing System.Collections.Generic;\nusing System.Diagnostics;\nusing System.Linq;\nusing System.Net;\nusing System.Net.NetworkInformation;\nusing System.Net.Sockets;\nusing System.Reflection;\nusing System.Threading;\nusing System.Threading.Tasks;\nusing System.Timers;\nusing LobbyClient;\nusing PlasmaDownloader;\nusing PlasmaShared;\nusing Ratings;\nusing ZeroKWeb.SpringieInterface;\nusing ZkData;\nusing ZkData.UnitSyncLib;\nusing static System.String;\nusing Timer = System.Timers.Timer;\n \nnamespace ZkLobbyServer\n{\n    public class ServerBattle : Battle\n    {\n        public const int PollTimeout = 60;\n        public const int MapVoteTime = 25;\n        public const int NumberOfMapChoices = 4;\n        public const int MinimumAutostartPlayers = 6;\n        public static int BattleCounter;\n        public int QueueCounter = 0;\n        public static readonly Dictionary<string, BattleCommand> Commands = new Dictionary<string, BattleCommand>();\n        private static object pickPortLock = new object();\n        private static string hostingIp;\n        public int DiscussionSeconds = 25;\n        public readonly List<string> toNotify = new List<string>();\n        public Resource HostedMap;\n        public Resource HostedMod;\n        public Mod HostedModInfo;\n        private int hostingPort;\n        private int? dbAutohostIndex;\n        protected bool isZombie;\n        protected bool IsPollsBlocked => IsAutohost && DateTime.UtcNow < BlockPollsUntil;\n        private List<KickedPlayer> kickedPlayers = new List<KickedPlayer>();\n        public List<BattleDebriefing> Debriefings { get; private set; } = new List<BattleDebriefing>();\n        private Timer pollTimer;\n        private Timer discussionTimer;\n        public ZkLobbyServer server;\n        public DedicatedServer spring;\n        public string battleInstanceGuid;\n        PlayerTeam startGameStatus;\n        public int InviteMMPlayers { get; protected set; } = int.MaxValue; //will invite players to MM after each battle if more than X players\n        public MapSupportLevel MinimalMapSupportLevel => IsAutohost ? MinimalMapSupportLevelAutohost : (IsPassworded ? MapSupportLevel.None : MapSupportLevel.Supported);\n        public CommandPoll ActivePoll { get; private set; }\n        public bool IsAutohost { get; private set; }\n        public bool IsDefaultGame { get; private set; } = true;\n        public bool IsCbalEnabled { get; private set; } = true;\n        public override bool TimeQueueEnabled => DynamicConfig.Instance.TimeQueueEnabled && (Mode == AutohostMode.Teams || Mode == AutohostMode.Game1v1 || Mode == AutohostMode.GameFFA);\n        public MapSupportLevel MinimalMapSupportLevelAutohost { get; protected set; } = MapSupportLevel.Featured;\n        static ServerBattle()\n        {\n            Commands =\n                Assembly.GetAssembly(typeof(BattleCommand))\n                    .GetTypes()\n                    .Where(x => !x.IsAbstract && x.IsClass && typeof(BattleCommand).IsAssignableFrom(x))\n                    .Select(x => x.GetConstructor(new Type[] { }).Invoke(new object[] { }))\n                    .Cast<BattleCommand>()\n                    .ToDictionary(x => x.Shortcut, x => x);\n            hostingIp =\n                Dns.GetHostEntry(Dns.GetHostName()).AddressList.FirstOrDefault(ip => ip.AddressFamily == AddressFamily.InterNetwork)?.ToString() ??\n                \"127.0.0.1\";\n        }\n        public ServerBattle(ZkLobbyServer server, string founder)\n        {\n            BattleID = Interlocked.Increment(ref BattleCounter);\n            FounderName = founder;\n            battleInstanceGuid = Guid.NewGuid().ToString();\n            this.server = server;\n            pollTimer = new Timer(PollTimeout * 1000);\n            pollTimer.Enabled = false;\n            pollTimer.AutoReset = false;\n            pollTimer.Elapsed += pollTimer_Elapsed;\n            discussionTimer = new Timer(DiscussionSeconds * 1000);\n            discussionTimer.Enabled = false;\n            discussionTimer.AutoReset = false;\n            discussionTimer.Elapsed += discussionTimer_Elapsed;\n            SetupSpring();\n            PickHostingPort();\n        }\n        public void SaveToDb()\n        {\n            if (!IsAutohost) return;\n            using (var db = new ZkDataContext())\n            {\n                Autohost autohost = null;\n                bool insert = false;\n                if (dbAutohostIndex.HasValue)\n                {\n                    autohost = db.Autohosts.Where(x => x.AutohostID == dbAutohostIndex).FirstOrDefault();\n                }\n                if (autohost == null)\n                {\n                    insert = true;\n                    autohost = new Autohost();\n                }\n                autohost.MinimumMapSupportLevel = MinimalMapSupportLevelAutohost;\n                autohost.AutohostMode = Mode;\n                autohost.InviteMMPlayers = InviteMMPlayers;\n                autohost.MaxElo = MaxElo;\n                autohost.MinElo = MinElo;\n                autohost.MaxLevel = MaxLevel;\n                autohost.MinLevel = MinLevel;\n                autohost.MaxRank = MaxRank;\n                autohost.MinRank = MinRank;\n                autohost.Title = Title;\n                autohost.MaxPlayers = MaxPlayers;\n                autohost.CbalEnabled = IsCbalEnabled;\n                autohost.MaxEvenPlayers = MaxEvenPlayers;\n                autohost.ApplicableRating = ApplicableRating;\n                autohost.ModName = HostedMod?.InternalName ?? ModName;\n                autohost.MapName = HostedMap?.InternalName ?? MapName;\n                if (insert)\n                {\n                    db.Autohosts.Add(autohost);\n                }\n                db.SaveChanges();\n                dbAutohostIndex = autohost.AutohostID;\n            }\n        }\n        public string GenerateClientScriptPassword(string name)\n        {\n            return Hash.HashString(battleInstanceGuid + name).ToString();\n        }\n        public void Dispose()\n        {\n            spring.UnsubscribeEvents(this);\n            if (pollTimer != null) pollTimer.Enabled = false;\n            pollTimer?.Dispose();\n            pollTimer = null;\n            if (discussionTimer != null) discussionTimer.Enabled = false;\n            discussionTimer?.Dispose();\n            discussionTimer = null;\n            spring = null;\n            ActivePoll = null;\n        }\n        public List<string> GetAllUserNames()\n        {\n            var ret = Users.Select(x => x.Key).ToList();\n            if (spring.IsRunning) ret.AddRange(spring.Context.ActualPlayers.Select(x => x.Name));\n            return ret.Distinct().ToList();\n        }\n        public BattleCommand GetCommandByName(string name)\n        {\n            BattleCommand command;\n            if (Commands.TryGetValue(name, out command)) return command.Create();\n            return null;\n        }\n        public ConnectSpring GetConnectSpringStructure(string scriptPassword, bool isSpectator)\n        {\n            return new ConnectSpring()\n            {\n                Engine = EngineVersion,\n                Ip = hostingIp,\n                Port = hostingPort,\n                Map = MapName,\n                Game = ModName,\n                ScriptPassword = scriptPassword,\n                Mode = Mode,\n                Title = Title,\n                IsSpectator = isSpectator,\n            };\n        }\n        public bool IsKicked(string name)\n        {\n            var kicked = false;\n            kickedPlayers.RemoveAll(x => x.TimeOfKicked <= DateTime.UtcNow.AddMinutes(-5));\n            if (kickedPlayers.Any(y => y.Name == name)) kicked = true;\n            return kicked;\n        }\n        public async Task KickFromBattle(string name, string reason)\n        {\n            UserBattleStatus user;\n            kickedPlayers.Add(new KickedPlayer() { Name = name });\n            if (Users.TryGetValue(name, out user))\n            {\n                var client = server.ConnectedUsers[name];\n                await client.Respond($\"You were kicked from battle: {reason}\");\n                await client.Process(new LeaveBattle() { BattleID = BattleID });\n            }\n        }\n        public virtual async Task CheckCloseBattle()\n        {\n            if (Users.IsEmpty && !spring.IsRunning)\n            {\n                if (!IsAutohost)\n                    await server.RemoveBattle(this);\n                else if (Mode != AutohostMode.None) // custom autohosts would typically be themed around a single map\n                    await RunCommandDirectly<CmdMap>(null);\n            }\n        }\n        public void SwitchDefaultGame(bool useDefaultGame)\n        {\n            IsDefaultGame = useDefaultGame;\n        }\n        public void SwitchAutohost(bool autohost, string founder)\n        {\n            if (autohost)\n            {\n                IsAutohost = true;\n                IsDefaultGame = true;\n                FounderName = \"Autohost #\" + BattleID;\n                SaveToDb();\n            }\n            else\n            {\n                IsAutohost = false;\n                FounderName = founder;\n                if (dbAutohostIndex.HasValue)\n                {\n                    using (var db = new ZkDataContext())\n                    {\n                        db.Autohosts.Remove(db.Autohosts.Where(x => x.AutohostID == dbAutohostIndex).FirstOrDefault());\n                        db.SaveChanges();\n                    }\n                }\n            }\n        }\n        public async Task ProcessBattleSay(Say say)\n        {\n            if (say.User == GlobalConst.NightwatchName) return; // ignore self\n            ConnectedUser user;\n            server.ConnectedUsers.TryGetValue(say.User, out user);\n            if ((say.Place == SayPlace.Battle) && !say.IsEmote && (user?.User.BanMute != true) && (user?.User.BanSpecChat != true) && say.AllowRelay) spring.SayGame($\"<{say.User}>{say.Text}\"); // relay to spring\n            await CheckSayForCommand(say);\n        }\n        private async Task<bool> CheckSayForCommand(Say say)\n        {\n            // check if it's command\n            if (!say.IsEmote && (say.Text?.Length > 1) && say.Text.StartsWith(\"!\"))\n            {\n                var parts = say.Text.Substring(1).Split(new[] { ' ' }, 2, StringSplitOptions.RemoveEmptyEntries);\n                return await RunCommandWithPermissionCheck(say, parts[0], parts.Skip(1).FirstOrDefault());\n            }\n            return false;\n        }\n        public virtual async Task ProcessPlayerJoin(ConnectedUser user, string joinPassword)\n        {\n            if (IsPassworded && (Password != joinPassword))\n            {\n                await user.Respond(\"Invalid password\");\n                return;\n            }\n            if (IsKicked(user.Name))\n            {\n                await KickFromBattle(user.Name, \"Banned for five minutes\");\n                return;\n            }\n            if ((user.MyBattle != null) && (user.MyBattle != this)) await user.Process(new LeaveBattle());\n            UserBattleStatus ubs;\n            if (!Users.TryGetValue(user.Name, out ubs))\n            {\n                ubs = new UserBattleStatus(user.Name, user.User, GenerateClientScriptPassword(user.Name));\n                Users[user.Name] = ubs;\n            }\n            ValidateBattleStatus(ubs);\n            user.MyBattle = this;\n            await server.TwoWaySyncUsers(user.Name, Users.Keys); // mutually sync user statuses\n            await server.SyncUserToAll(user);\n            await RecalcSpectators();\n            await\n                user.SendCommand(new JoinBattleSuccess()\n                {\n                    BattleID = BattleID,\n                    Players = Users.Values.Select(x => x.ToUpdateBattleStatus()).ToList(),\n                    Bots = Bots.Values.Select(x => x.ToUpdateBotStatus()).ToList(),\n                    Options = ModOptions\n                });\n            if (ActivePoll != null) await user.SendCommand(ActivePoll.GetBattlePoll());\n            await server.Broadcast(Users.Keys.Where(x => x != user.Name), ubs.ToUpdateBattleStatus()); // send my UBS to others in battle\n            if (spring.IsRunning)\n            {\n                spring.AddUser(ubs.Name, ubs.ScriptPassword, ubs.LobbyUser);\n                var started = DateTime.UtcNow.Subtract(spring.IngameStartTime ?? RunningSince ?? DateTime.UtcNow);\n                started = new TimeSpan((int)started.TotalHours, started.Minutes, started.Seconds);\n                await SayBattle($\"THIS GAME IS CURRENTLY IN PROGRESS, PLEASE WAIT UNTIL IT ENDS! Running for {started}\", ubs.Name);\n                await SayBattle(\"If you say !notify, I will message you when the current game ends.\", ubs.Name);\n            }\n            try\n            {\n                var ret = PlayerJoinHandler.AutohostPlayerJoined(GetContext(), ubs.LobbyUser.AccountID);\n                if (ret != null)\n                {\n                    if (!IsNullOrEmpty(ret.PrivateMessage)) await SayBattle(ret.PrivateMessage, ubs.Name);\n                    if (!IsNullOrEmpty(ret.PublicMessage)) await SayBattle(ret.PublicMessage);\n                }\n            }\n            catch (Exception ex)\n            {\n                Trace.TraceError(ex.ToString());\n                await SayBattle(\"ServerManage error: \" + ex);\n            }\n        }\n        public async Task RecalcSpectators()\n        {\n            var specCount = Users.Values.Count(x => x.IsSpectator);\n            var playerCount = Users.Values.Count(x => !x.IsSpectator);\n            if (specCount != SpectatorCount || playerCount != NonSpectatorCount)\n            {\n                SpectatorCount = specCount;\n                NonSpectatorCount = playerCount;\n                if (GlobalConst.LobbyServerUpdateSpectatorsInstantly)\n                {\n                    await server.Broadcast(Users.Keys, new BattleUpdate() { Header = new BattleHeader() { SpectatorCount = specCount, BattleID = BattleID, PlayerCount = NonSpectatorCount } });\n                }\n            }\n        }\n        public async Task RegisterVote(Say e, int vote)\n        {\n            if (ActivePoll != null)\n            {\n                if (await ActivePoll.Vote(e, vote))\n                {\n                    StopVote();\n                }\n            }\n            else await Respond(e, \"There is no poll going on, start some first\");\n        }\n        public async Task RequestConnectSpring(ConnectedUser conus, string joinPassword)\n        {\n            UserBattleStatus ubs;\n            startGameStatus = spring.LobbyStartContext.Players.FirstOrDefault(x => x.Name == conus.Name);\n            \n            if (!Users.TryGetValue(conus.Name, out ubs) && !(IsInGame && startGameStatus != null))\n                if (IsPassworded && (Password != joinPassword))\n                {\n                    await conus.Respond(\"Invalid password\");\n                    return;\n                }\n            var pwd = GenerateClientScriptPassword(conus.Name);\n            spring.AddUser(conus.Name, pwd, conus.User);\n            if (spring.Context.LobbyStartContext.Players.Any(x => x.Name == conus.Name) && conus.MyBattle != this)\n            {\n                await ProcessPlayerJoin(conus, joinPassword);\n            }\n            await conus.SendCommand(GetConnectSpringStructure(pwd, startGameStatus?.IsSpectator != false));\n        }\n        public Task Respond(Say e, string text)\n        {\n            return SayBattle(text, e?.User);\n        }\n        public async Task RunCommandDirectly<T>(Say e, string args = null) where T : BattleCommand, new()\n        {\n            var t = new T();\n            await t.Run(this, e, args);\n        }\n        public async Task<bool> RunCommandWithPermissionCheck(Say e, string com, string arg)\n        {\n            var cmd = GetCommandByName(com);\n            if (cmd == null) return false;\n            if (isZombie)\n            {\n                await Respond(e, \"This room is now disabled, please join a new one\");\n                return false;\n            }\n            string reason;\n            var perm = cmd.GetRunPermissions(this, e.User, out reason);\n            if (perm == BattleCommand.RunPermission.Run) await cmd.Run(this, e, arg);\n            else if (perm == BattleCommand.RunPermission.Vote)\n            {\n                if (IsPollsBlocked)\n                {\n                    await Respond(e, \"Please wait for a few seconds before starting a poll.\");\n                    return false;\n                }\n                await StartVote(cmd, e, arg);\n            }\n            else\n            {\n                await Respond(e, reason);\n                return false;\n            }\n            return true;\n        }\n        public async Task<bool> RunServerBalance(bool isGameStart, int? allyTeams, bool? clanWise)\n        {\n            try\n            {\n                var context = GetContext();\n                context.Mode = Mode;\n                if (!IsCbalEnabled) clanWise = false;\n                var balance = Balancer.BalanceTeams(context, isGameStart, allyTeams, clanWise);\n                await ApplyBalanceResults(balance);\n                return balance.CanStart;\n            }\n            catch (Exception ex)\n            {\n                Trace.TraceError(ex.ToString());\n                return false;\n            }\n        }\n        public void SayGame(string text)\n        {\n            if (spring?.IsRunning != true) return;\n            foreach (var line in text.Split(new[] { '\\n' }, StringSplitOptions.RemoveEmptyEntries))\n            {\n                spring.SayGame(line);\n            }\n        }\n        public async Task SayBattle(string text, string privateUser = null)\n        {\n            if (!IsNullOrEmpty(text))\n            {\n                if ((privateUser == null)) spring.SayGame(text);\n                foreach (var line in text.Split(new[] { '\\n' }, StringSplitOptions.RemoveEmptyEntries))\n                {\n                    await\n                        server.GhostSay(\n                            new Say()\n                            {\n                                User = GlobalConst.NightwatchName,\n                                Text = line,\n                                Place = privateUser != null ? SayPlace.BattlePrivate : SayPlace.Battle,\n                                Target = privateUser,\n                                IsEmote = true,\n                                AllowRelay = false,\n                            },\n                            BattleID);\n                }\n            }\n        }\n        public async Task SetModOptions(Dictionary<string, string> options)\n        {\n            ModOptions = options;\n            await server.Broadcast(Users.Keys, new SetModOptions() { Options = options });\n        }\n        public void SetApplicableRating(RatingCategory rating)\n        {\n            ApplicableRating = rating;\n            SaveToDb();\n        }\n        public async Task Spectate(string name)\n        {\n            ConnectedUser usr;\n            if (server.ConnectedUsers.TryGetValue(name, out usr)) await usr.Process(new UpdateUserBattleStatus() { Name = usr.Name, IsSpectator = true });\n        }\n        public async Task<bool> StartGame()\n        {\n            var context = GetContext();\n            if (TimeQueueEnabled) // spectate beyond max players\n            {\n                int allowedPlayers = MaxPlayers;\n                if (context.Players.Where(x => !x.IsSpectator).Count() <= MaxEvenPlayers)\n                {\n                    allowedPlayers = context.Players.Where(x => !x.IsSpectator).Count() & ~0x1;\n                }\n                foreach (var plr in context.Players.Where(x=>!x.IsSpectator).OrderBy(x => x.QueueOrder).Skip(allowedPlayers))\n                {\n                    plr.IsSpectator = true;\n                }\n            }\n            \n            \n            if (Mode != AutohostMode.None)\n            {\n                var balance = IsCbalEnabled ? Balancer.BalanceTeams(context, true, null, null) : Balancer.BalanceTeams(context, true, null, false);\n                if (!IsNullOrEmpty(balance.Message)) await SayBattle(balance.Message);\n                if (!balance.CanStart) return false;\n                context.ApplyBalance(balance);\n            }\n            var startSetup = StartSetup.GetDedicatedServerStartSetup(context);\n            if (!await EnsureEngineIsPresent()) return false;\n            if (IsInGame || spring.IsRunning)\n            {\n                await SayBattle(\"Game already running\");\n                return false;\n            }\n            spring.HostGame(startSetup, hostingIp, hostingPort);\n            IsInGame = true;\n            RunningSince = DateTime.UtcNow;\n            foreach (var us in Users.Values)\n                if (us != null)\n                {\n                    ConnectedUser user;\n                    if (server.ConnectedUsers.TryGetValue(us.Name, out user)) await user.SendCommand(GetConnectSpringStructure(us.ScriptPassword, startSetup?.Players.FirstOrDefault(x=>x.Name == us.Name)?.IsSpectator != false));\n                }\n            await server.Broadcast(server.ConnectedUsers.Values, new BattleUpdate() { Header = GetHeader() });\n            // remove all from MM\n            foreach (var player in startSetup.Players.Where(x => !x.IsSpectator)) {\n                if (await server.MatchMaker.RemoveUser(player.Name, false))\n                {\n                    await server.UserLogSay($\"Removing {player.Name} from MM since their custom battle just started.\");\n                }\n            }\n            await server.MatchMaker.UpdateAllPlayerStatuses();\n            return true;\n        }\n        public async Task<bool> StartVote(BattleCommand cmd, Say e, string args, int timeout = PollTimeout, CommandPoll poll = null)\n        {\n            cmd = cmd.Create();\n            string topic = cmd.Arm(this, e, args);\n            if (topic == null) return false;\n            var unwrappedCmd = cmd;\n            if (cmd is CmdPoll)\n            {\n                var split = args.Split(new[] { ' ' }, 2);\n                args = split.Length > 1 ? split[1] : \"\";\n                unwrappedCmd = (cmd as CmdPoll).InternalCommand;\n            }\n            if (unwrappedCmd is CmdMap && string.IsNullOrEmpty(args)) return await CreateMultiMapPoll();\n            Func<string, string> selector = cmd.GetIneligibilityReasonFunc(this);\n            if (e != null && selector(e.User) != null) return false;\n            var options = new List<PollOption>();\n            string url = null;\n            string map = null;\n            if (unwrappedCmd is CmdMap)\n            {\n                url = $\"{GlobalConst.BaseSiteUrl}/Maps/Detail/{(unwrappedCmd as CmdMap).Map.ResourceID}\";\n                map = (unwrappedCmd as CmdMap).Map.InternalName;\n            }\n            var numVoters = Users.Values.Count(x => selector(x.Name) == null);\n            var voteMargin = unwrappedCmd.GetPollWinMargin(this, numVoters);\n            poll = poll ?? new CommandPoll(this, true, true, unwrappedCmd is CmdMap, map, unwrappedCmd is CmdStart, voteMargin);\n            options.Add(new PollOption()\n            {\n                Name = \"Yes\",\n                URL = url,\n                Action = async () =>\n                {\n                    if (cmd.Access == BattleCommand.AccessType.NotIngame && spring.IsRunning) return;\n                    if (cmd.Access == BattleCommand.AccessType.Ingame && !spring.IsRunning) return;\n                    await cmd.ExecuteArmed(this, e);\n                }\n            });\n            options.Add(new PollOption()\n            {\n                Name = \"No\",\n                Action = async () => { }\n            });\n            if (await StartVote(selector, options, e, topic, poll))\n            {\n                await RegisterVote(e, 1);\n                return true;\n            }\n            return false;\n        }\n        public async Task<bool> StartVote(Func<string, string> eligibilitySelector, List<PollOption> options, Say creator, string topic, CommandPoll poll, int timeout = PollTimeout)\n        {\n            if (ActivePoll != null)\n            {\n                await Respond(creator, $\"Please wait, another poll already in progress: {ActivePoll.Topic}\");\n                return false;\n            }\n            await poll.Setup(eligibilitySelector, options, creator, topic);\n            ActivePoll = poll;\n            pollTimer.Interval = timeout * 1000;\n            pollTimer.Enabled = true;\n            return true;\n        }\n        public async void StopVote()\n        {\n            try\n            {\n                if (ActivePoll == null) return;\n                var oldPoll = ActivePoll;\n                if (ActivePoll != null) await ActivePoll.End(false);\n                if (pollTimer != null) pollTimer.Enabled = false;\n                ActivePoll = null;\n                await oldPoll?.PublishResult();\n            }\n            catch (Exception ex)\n            {\n                Trace.TraceError(\"Error stopping vote \" + ex);\n            }\n        }\n        public async Task SwitchEngine(string engine)\n        {\n            EngineVersion = engine;\n            ValidateAndFillDetails();\n            await\n                server.Broadcast(server.ConnectedUsers.Values,\n                    new BattleUpdate() { Header = new BattleHeader() { BattleID = BattleID, Engine = EngineVersion } });\n        }\n        public async Task SwitchGame(string internalName)\n        {\n            ModName = internalName;\n            ValidateAndFillDetails();\n            if (ModName != server.Game)\n            {\n                ModOptions[\"noelo\"] = \"1\";\n                await SayBattle(\"Ratings are disabled, since this game is not vanilla ZK\");\n                await server.Broadcast(Users.Keys, new SetModOptions() { Options = ModOptions });\n            }\n            await\n                server.Broadcast(server.ConnectedUsers.Values,\n                    new BattleUpdate() { Header = new BattleHeader() { BattleID = BattleID, Game = ModName } });\n        }\n        public async Task SwitchGameType(AutohostMode type)\n        {\n            Mode = type;\n            MapName = null;\n            ValidateAndFillDetails();\n            await server.Broadcast(server.ConnectedUsers.Values, new BattleUpdate() { Header = GetHeader() });\n            SaveToDb();\n            // do a full update - mode can also change map/players\n        }\n        public async Task SwitchMap(string internalName)\n        {\n            MapName = internalName;\n            ValidateAndFillDetails();\n            await\n                server.Broadcast(server.ConnectedUsers.Values,\n                    new BattleUpdate() { Header = new BattleHeader() { BattleID = BattleID, Map = MapName } });\n        }\n        public async Task SwitchMaxPlayers(int cnt)\n        {\n            MaxPlayers = cnt;\n            ValidateAndFillDetails();\n            await\n                server.Broadcast(server.ConnectedUsers.Values,\n                    new BattleUpdate() { Header = new BattleHeader() { BattleID = BattleID, MaxPlayers = MaxPlayers } });\n            SaveToDb();\n        }\n        public async Task SwitchMaxEvenPlayers(int cnt)\n        {\n            MaxEvenPlayers = cnt;\n            ValidateAndFillDetails();\n            await\n                server.Broadcast(server.ConnectedUsers.Values,\n                    new BattleUpdate() { Header = new BattleHeader() { BattleID = BattleID, MaxEvenPlayers = MaxEvenPlayers } });\n            SaveToDb();\n        }\n        public async Task SwitchInviteMmPlayers(int players)\n        {\n            InviteMMPlayers = players;\n            SaveToDb();\n        }\n        public async Task ValidateAllBattleStatuses()\n        {\n            foreach (var ubs in Users.Values)\n            {\n                ValidateBattleStatus(ubs);\n                await server.Broadcast(Users.Keys, ubs.ToUpdateBattleStatus());\n            }\n            await RecalcSpectators();\n        }\n        public async Task SwitchMaxElo(int elo)\n        {\n            MaxElo = elo;\n            SaveToDb();\n            await ValidateAllBattleStatuses();\n        }\n        public async Task SwitchMinElo(int elo)\n        {\n            MinElo = elo;\n            SaveToDb();\n            await ValidateAllBattleStatuses();\n        }\n        public async Task SwitchMaxLevel(int lvl)\n        {\n            MaxLevel = lvl;\n            SaveToDb();\n            await ValidateAllBattleStatuses();\n        }\n        public async Task SwitchMinLevel(int lvl)\n        {\n            MinLevel = lvl;\n            SaveToDb();\n            await ValidateAllBattleStatuses();\n        }\n        public async Task SwitchMaxRank(int rank)\n        {\n            MaxRank = rank;\n            SaveToDb();\n            await ValidateAllBattleStatuses();\n        }\n        public async Task SwitchMinRank(int rank)\n        {\n            MinRank = rank;\n            SaveToDb();\n            await ValidateAllBattleStatuses();\n        }\n        public async Task SwitchMinMapSupportLevel(MapSupportLevel lvl)\n        {\n            MinimalMapSupportLevelAutohost = lvl;\n            SaveToDb();\n        }\n        public void SwitchCbal(bool cbalEnabled)\n        {\n            IsCbalEnabled = cbalEnabled;\n            SaveToDb();\n        }\n        public async Task SwitchPassword(string pwd)\n        {\n            Password = pwd ?? \"\";\n            await server.Broadcast(server.ConnectedUsers.Values, new BattleUpdate() { Header = GetHeader() });\n            // do a full update to hide pwd properly\n        }\n        public async Task SwitchTitle(string title)\n        {\n            Title = title;\n            ValidateAndFillDetails();\n            await\n                server.Broadcast(server.ConnectedUsers.Values,\n                    new BattleUpdate() { Header = new BattleHeader() { BattleID = BattleID, Title = Title } });\n            SaveToDb();\n        }\n        public void BlockPolls(int seconds)\n        {\n            var target = DateTime.UtcNow.AddSeconds(seconds);\n            if (BlockPollsUntil < target) BlockPollsUntil = target;\n        }\n        public void UpdateWith(Autohost autohost)\n        {\n            IsAutohost = true;\n            MinimalMapSupportLevelAutohost = autohost.MinimumMapSupportLevel;\n            Mode = autohost.AutohostMode;\n            InviteMMPlayers = autohost.InviteMMPlayers;\n            MaxElo = autohost.MaxElo;\n            MinElo = autohost.MinElo;\n            MaxLevel = autohost.MaxLevel;\n            MinLevel = autohost.MinLevel;\n            MaxRank = autohost.MaxRank;\n            MinRank = autohost.MinRank;\n            Title = autohost.Title;\n            MaxPlayers = autohost.MaxPlayers;\n            IsCbalEnabled = autohost.CbalEnabled;\n            dbAutohostIndex = autohost.AutohostID;\n            MaxEvenPlayers = autohost.MaxEvenPlayers;\n            ApplicableRating = autohost.ApplicableRating;\n            FounderName = \"Autohost #\" + BattleID;\n            ValidateAndFillDetails();\n            SwitchGame(autohost.ModName);\n            SwitchMap(autohost.MapName);\n            RunCommandDirectly<CmdMap>(null);\n        }\n        public override void UpdateWith(BattleHeader h)\n        {\n            // following variables cannot be overriden in serverbattle\n            h.BattleID = BattleID;\n            h.Founder = FounderName;\n            h.IsRunning = IsInGame;\n            h.RunningSince = RunningSince;\n            h.SpectatorCount = SpectatorCount;\n            h.PlayerCount = NonSpectatorCount;\n            h.IsMatchMaker = IsMatchMakerBattle;\n            base.UpdateWith(h);\n            SwitchGame(h.Game);\n            ValidateAndFillDetails();\n        }\n        public void ValidateAndFillDetails()\n        {\n            if (IsNullOrEmpty(Title)) Title = $\"{FounderName}'s game\";\n            if (IsNullOrEmpty(EngineVersion) || (Mode != AutohostMode.None)) EngineVersion = server.Engine;\n            server.Downloader.GetResource(DownloadType.ENGINE, server.Engine);\n            switch (Mode)\n            {\n                case AutohostMode.Game1v1:\n                    MaxPlayers = 2;\n                    break;\n                case AutohostMode.Planetwars:\n                    if (MaxPlayers < 2) MaxPlayers = 16;\n                    break;\n                case AutohostMode.GameChickens:\n                    if (MaxPlayers < 2) MaxPlayers = 10;\n                    break;\n                case AutohostMode.GameFFA:\n                    if (MaxPlayers < 3) MaxPlayers = 16;\n                    break;\n                case AutohostMode.Teams:\n                    if (MaxPlayers < 4) MaxPlayers = 16;\n                    break;\n                case AutohostMode.None:\n                    if (MaxPlayers == 0) MaxPlayers = 16;\n                    break;\n            }\n            if (MaxPlayers > DynamicConfig.Instance.MaximumBattlePlayers && !IsAutohost) MaxPlayers = DynamicConfig.Instance.MaximumBattlePlayers;\n            if (MaxEvenPlayers > MaxPlayers) MaxEvenPlayers = MaxPlayers;\n            HostedMod = MapPicker.FindResources(ResourceType.Mod, ModName ?? server.Game ?? GlobalConst.DefaultZkTag).FirstOrDefault();\n            HostedMap = MapName != null\n                ? MapPicker.FindResources(ResourceType.Map, MapName).FirstOrDefault()\n                : MapPicker.GetRecommendedMap(GetContext());\n            ModName = HostedMod?.InternalName ?? ModName ?? server.Game ?? GlobalConst.DefaultZkTag;\n            MapName = HostedMap?.InternalName ?? MapName ?? \"Small_Divide-Remake-v04\";\n            if (HostedMod != null)\n                try\n                {\n                    HostedModInfo = MetaDataCache.ServerGetMod(HostedMod.InternalName);\n                }\n                catch (Exception ex)\n                {\n                    Trace.TraceWarning(\"Error loading mod metadata for {0} : {1}\", HostedMod.InternalName, ex);\n                }\n        }\n        public virtual void ValidateBattleStatus(UserBattleStatus ubs)\n        {\n            if (Mode != AutohostMode.None) ubs.AllyNumber = 0;\n            if (!ubs.IsSpectator)\n            {\n                if (!TimeQueueEnabled && Users.Values.Count(x => !x.IsSpectator) > MaxPlayers)\n                {\n                    ubs.IsSpectator = true;\n                    SayBattle(\"This battle is full.\", ubs.Name);\n                }\n                if (Users.Values.Count(x => !x.IsSpectator) <= DynamicConfig.Instance.MaximumStatLimitedBattlePlayers || IsAutohost)\n                {\n                    if (ubs.LobbyUser.EffectiveElo > MaxElo && ubs.LobbyUser.EffectiveMmElo > MaxElo)\n                    {\n                        ubs.IsSpectator = true;\n                        SayBattle(\"Your rating (\" + Math.Min(ubs.LobbyUser.EffectiveElo, ubs.LobbyUser.EffectiveMmElo) + \") is too high. The maximum rating to play in this battle is \" + MaxElo + \".\", ubs.Name);\n                    }\n                    if (ubs.LobbyUser.EffectiveElo < MinElo && ubs.LobbyUser.EffectiveMmElo < MinElo)\n                    {\n                        ubs.IsSpectator = true;\n                        SayBattle(\"Your rating (\" + Math.Max(ubs.LobbyUser.EffectiveElo, ubs.LobbyUser.EffectiveMmElo) + \") is too low. The minimum rating to play in this battle is \" + MinElo + \".\", ubs.Name);\n                    }\n                    if (ubs.LobbyUser.Level > MaxLevel)\n                    {\n                        ubs.IsSpectator = true;\n                        SayBattle(\"Your level (\" + ubs.LobbyUser.Level + \") is too high. The maximum level to play in this battle is \" + MaxLevel + \".\", ubs.Name);\n                    }\n                    if (ubs.LobbyUser.Level < MinLevel)\n                    {\n                        ubs.IsSpectator = true;\n                        SayBattle(\"Your level (\" + ubs.LobbyUser.Level + \") is too low. The minimum level to play in this battle is \" + MinLevel + \".\", ubs.Name);\n                    }\n                    if (ubs.LobbyUser.Rank > MaxRank)\n                    {\n                        ubs.IsSpectator = true;\n                        SayBattle(\"Your Rank (\" + Ranks.RankNames[ubs.LobbyUser.Rank] + \") is too high. The maximum Rank to play in this battle is \" + Ranks.RankNames[MaxRank] + \".\", ubs.Name);\n                    }\n                    if (ubs.LobbyUser.Rank < MinRank)\n                    {\n                        ubs.IsSpectator = true;\n                        SayBattle(\"Your Rank (\" + Ranks.RankNames[ubs.LobbyUser.Rank] + \") is too low. The minimum Rank to play in this battle is \" + Ranks.RankNames[MinRank] + \".\", ubs.Name);\n                    }\n                }\n                if (ubs.QueueOrder <= 0) ubs.QueueOrder = ++QueueCounter;\n            }\n            else\n            {\n                ubs.QueueOrder = -1;\n            }\n        }\n        protected virtual async Task OnDedicatedExited(SpringBattleContext springBattleContext)\n        {\n            StopVote();\n            IsInGame = false;\n            RunningSince = null;\n            BlockPollsUntil = DateTime.UtcNow.AddSeconds(DiscussionSeconds);\n            bool result = BattleResultHandler.SubmitSpringBattleResult(springBattleContext, server, (debriefing) =>\n            {\n                Debriefings.Add(debriefing);\n                server.Broadcast(springBattleContext.ActualPlayers.Select(x => x.Name), debriefing);\n                Trace.TraceInformation(\"Battle ended: Sent out debriefings for B\" + debriefing.ServerBattleID);\n            });\n            await server.Broadcast(server.ConnectedUsers.Keys, new BattleUpdate() { Header = GetHeader() });\n            foreach (var s in toNotify)\n                await\n                    server.GhostSay(new Say()\n                    {\n                        User = GlobalConst.NightwatchName,\n                        Text = $\"** {FounderName} 's {Title} just ended, join me! **\",\n                        Target = s,\n                        IsEmote = true,\n                        Place = SayPlace.User,\n                        Ring = true,\n                        AllowRelay = false\n                    });\n            toNotify.Clear();\n            var playingEligibleUsers = server.MatchMaker.GetEligibleQuickJoinPlayers(Users.Values.Where(x => !x.LobbyUser.IsAway && !x.IsSpectator && x.Name != null).Select(x => server.ConnectedUsers[x.Name]).ToList());\n            if (playingEligibleUsers.Count() >= InviteMMPlayers)\n            { //Make sure there are enough eligible users for a battle to be likely to happen\n                //put all users into MM queue to suggest battles\n                var teamsQueues = server.MatchMaker.PossibleQueues.Where(x => x.Mode == AutohostMode.Teams).ToList();\n                var availableUsers = Users.Values.Where(x => !x.LobbyUser.IsAway && x.Name != null).Select(x => server.ConnectedUsers[x.Name]).ToList();\n                await server.MatchMaker.MassJoin(availableUsers, teamsQueues);\n                DiscussionSeconds = MatchMaker.TimerSeconds + 2;\n            }\n            else\n            {\n                DiscussionSeconds = 5;\n            }\n            BlockPollsUntil = DateTime.UtcNow.AddSeconds(DiscussionSeconds);\n            if (Mode != AutohostMode.None && (IsAutohost || (!Users.ContainsKey(FounderName) || Users[FounderName].LobbyUser?.IsAway == true) && Mode != AutohostMode.Planetwars && !IsPassworded))\n            {\n                if (!result)\n                {\n                    //Game was aborted/exited/invalid, allow manual commands\n                    BlockPollsUntil = DateTime.UtcNow;\n                }\n                else\n                {\n                    //Initiate discussion time, then map vote, then start vote\n                    discussionTimer.Interval = (DiscussionSeconds - 1) * 1000;\n                    discussionTimer.Start();\n                }\n            }\n            await CheckCloseBattle();\n        }\n        private async Task<bool> CreateMultiMapPoll()\n        {\n            var poll = new CommandPoll(this, false, false, true);\n            poll.PollEnded += MapVoteEnded;\n            var options = new List<PollOption>();\n            List<int> pickedMaps = new List<int>();\n            pickedMaps.Add(HostedMap?.ResourceID ?? 0);\n            using (var db = new ZkDataContext())\n            {\n                for (int i = 0; i < NumberOfMapChoices; i++)\n                {\n                    Resource map = null;\n                    if (i < NumberOfMapChoices / 2)\n                    {\n                        map = MapPicker.GetRecommendedMap(GetContext(), (MinimalMapSupportLevel < MapSupportLevel.Supported) ? MapSupportLevel.Supported : MinimalMapSupportLevel, MapRatings.GetMapRanking(Mode).TakeWhile(x => x.Percentile < 0.2).Select(x => x.Map).Where(x => !pickedMaps.Contains(x.ResourceID)).AsQueryable()); //choose at least 50% popular maps\n                    }\n                    if (map == null)\n                    {\n                        map = MapPicker.GetRecommendedMap(GetContext(), (MinimalMapSupportLevel < MapSupportLevel.Featured) ? MapSupportLevel.Supported : MinimalMapSupportLevel, db.Resources.Where(x => !pickedMaps.Contains(x.ResourceID)));\n                    }\n                    pickedMaps.Add(map.ResourceID);\n                    options.Add(new PollOption()\n                    {\n                        Name = map.InternalName,\n                        DisplayName = map.MapNameWithDimensions(),\n                        URL = $\"{GlobalConst.BaseSiteUrl}/Maps/Detail/{map.ResourceID}\",\n                        ResourceID = map.ResourceID,\n                        Action = async () =>\n                        {\n                            var cmd = new CmdMap().Create();\n                            cmd.Arm(this, null, map.ResourceID.ToString());\n                            if (cmd.Access == BattleCommand.AccessType.NotIngame && spring.IsRunning) return;\n                            if (cmd.Access == BattleCommand.AccessType.Ingame && !spring.IsRunning) return;\n", "answers": ["                            await cmd.ExecuteArmed(this, null);"], "incorrect_answer": "await cmd.ExecuteDismissed(this, null);"}, {"input": "", "context": "namespace OpenDental{\n\tpartial class FormHL7DefEdit {\n\t\t/// <summary>\n\t\t/// Required designer variable.\n\t\t/// </summary>\n\t\tprivate System.ComponentModel.IContainer components = null;\n\t\t/// <summary>\n\t\t/// Clean up any resources being used.\n\t\t/// </summary>\n\t\t/// <param name=\"disposing\">true if managed resources should be disposed; otherwise, false.</param>\n\t\tprotected override void Dispose(bool disposing) {\n\t\t\tif(disposing && (components != null)) {\n\t\t\t\tcomponents.Dispose();\n\t\t\t}\n\t\t\tbase.Dispose(disposing);\n\t\t}\n\t\t#region Windows Form Designer generated code\n\t\t/// <summary>\n\t\t/// Required method for Designer support - do not modify\n\t\t/// the contents of this method with the code editor.\n\t\t/// </summary>\n\t\tprivate void InitializeComponent() {\n\t\t\tSystem.ComponentModel.ComponentResourceManager resources = new System.ComponentModel.ComponentResourceManager(typeof(FormHL7DefEdit));\n\t\t\tthis.label15 = new System.Windows.Forms.Label();\n\t\t\tthis.label6 = new System.Windows.Forms.Label();\n\t\t\tthis.label5 = new System.Windows.Forms.Label();\n\t\t\tthis.label4 = new System.Windows.Forms.Label();\n\t\t\tthis.label3 = new System.Windows.Forms.Label();\n\t\t\tthis.textNote = new System.Windows.Forms.TextBox();\n\t\t\tthis.labelOutAddrPortEx = new System.Windows.Forms.Label();\n\t\t\tthis.labelInAddrPortEx = new System.Windows.Forms.Label();\n\t\t\tthis.textInternalTypeVersion = new System.Windows.Forms.TextBox();\n\t\t\tthis.label13 = new System.Windows.Forms.Label();\n\t\t\tthis.textInternalType = new System.Windows.Forms.TextBox();\n\t\t\tthis.label14 = new System.Windows.Forms.Label();\n\t\t\tthis.checkEnabled = new System.Windows.Forms.CheckBox();\n\t\t\tthis.textEscChar = new System.Windows.Forms.TextBox();\n\t\t\tthis.label12 = new System.Windows.Forms.Label();\n\t\t\tthis.checkInternal = new System.Windows.Forms.CheckBox();\n\t\t\tthis.label11 = new System.Windows.Forms.Label();\n\t\t\tthis.textSubcompSep = new System.Windows.Forms.TextBox();\n\t\t\tthis.label9 = new System.Windows.Forms.Label();\n\t\t\tthis.textRepSep = new System.Windows.Forms.TextBox();\n\t\t\tthis.label10 = new System.Windows.Forms.Label();\n\t\t\tthis.textCompSep = new System.Windows.Forms.TextBox();\n\t\t\tthis.label8 = new System.Windows.Forms.Label();\n\t\t\tthis.textFieldSep = new System.Windows.Forms.TextBox();\n\t\t\tthis.label7 = new System.Windows.Forms.Label();\n\t\t\tthis.comboModeTx = new System.Windows.Forms.ComboBox();\n\t\t\tthis.textSftpPassword = new System.Windows.Forms.TextBox();\n\t\t\tthis.labelSftpPassword = new System.Windows.Forms.Label();\n\t\t\tthis.textSftpUsername = new System.Windows.Forms.TextBox();\n\t\t\tthis.labelSftpUsername = new System.Windows.Forms.Label();\n\t\t\tthis.textOutPathOrAddrPort = new System.Windows.Forms.TextBox();\n\t\t\tthis.labelOutPathOrAddrPort = new System.Windows.Forms.Label();\n\t\t\tthis.textInPathOrAddrPort = new System.Windows.Forms.TextBox();\n\t\t\tthis.labelInPathOrAddrPort = new System.Windows.Forms.Label();\n\t\t\tthis.label2 = new System.Windows.Forms.Label();\n\t\t\tthis.label1 = new System.Windows.Forms.Label();\n\t\t\tthis.textDescription = new System.Windows.Forms.TextBox();\n\t\t\tthis.labelDelete = new System.Windows.Forms.Label();\n\t\t\tthis.label16 = new System.Windows.Forms.Label();\n\t\t\tthis.label17 = new System.Windows.Forms.Label();\n\t\t\tthis.textHL7ServiceName = new System.Windows.Forms.TextBox();\n\t\t\tthis.label18 = new System.Windows.Forms.Label();\n\t\t\tthis.textHL7Server = new System.Windows.Forms.TextBox();\n\t\t\tthis.label19 = new System.Windows.Forms.Label();\n\t\t\tthis.groupShowDemographics = new System.Windows.Forms.GroupBox();\n\t\t\tthis.label20 = new System.Windows.Forms.Label();\n\t\t\tthis.radioChangeAndAdd = new System.Windows.Forms.RadioButton();\n\t\t\tthis.radioChange = new System.Windows.Forms.RadioButton();\n\t\t\tthis.radioShow = new System.Windows.Forms.RadioButton();\n\t\t\tthis.radioHide = new System.Windows.Forms.RadioButton();\n\t\t\tthis.checkShowAccount = new System.Windows.Forms.CheckBox();\n\t\t\tthis.checkShowAppts = new System.Windows.Forms.CheckBox();\n\t\t\tthis.checkQuadAsToothNum = new System.Windows.Forms.CheckBox();\n\t\t\tthis.labelLabImageCat = new System.Windows.Forms.Label();\n\t\t\tthis.comboLabImageCat = new System.Windows.Forms.ComboBox();\n\t\t\tthis.groupDelimeters = new System.Windows.Forms.GroupBox();\n\t\t\tthis.groupHL7Comm = new System.Windows.Forms.GroupBox();\n\t\t\tthis.butBrowseOut = new OpenDental.UI.Button();\n\t\t\tthis.butBrowseIn = new OpenDental.UI.Button();\n\t\t\tthis.butAdd = new OpenDental.UI.Button();\n\t\t\tthis.butOK = new OpenDental.UI.Button();\n\t\t\tthis.butCancel = new OpenDental.UI.Button();\n\t\t\tthis.butDelete = new OpenDental.UI.Button();\n\t\t\tthis.gridMain = new OpenDental.UI.ODGrid();\n\t\t\tthis.groupShowDemographics.SuspendLayout();\n\t\t\tthis.groupDelimeters.SuspendLayout();\n\t\t\tthis.groupHL7Comm.SuspendLayout();\n\t\t\tthis.SuspendLayout();\n\t\t\t// \n\t\t\t// label15\n\t\t\t// \n\t\t\tthis.label15.Anchor = System.Windows.Forms.AnchorStyles.Right;\n\t\t\tthis.label15.Location = new System.Drawing.Point(166, 93);\n\t\t\tthis.label15.Name = \"label15\";\n\t\t\tthis.label15.Size = new System.Drawing.Size(91, 18);\n\t\t\tthis.label15.TabIndex = 0;\n\t\t\tthis.label15.Text = \"Default: \\\\\";\n\t\t\tthis.label15.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;\n\t\t\t// \n\t\t\t// label6\n\t\t\t// \n\t\t\tthis.label6.Anchor = System.Windows.Forms.AnchorStyles.Right;\n\t\t\tthis.label6.Location = new System.Drawing.Point(166, 73);\n\t\t\tthis.label6.Name = \"label6\";\n\t\t\tthis.label6.Size = new System.Drawing.Size(91, 18);\n\t\t\tthis.label6.TabIndex = 0;\n\t\t\tthis.label6.Text = \"Default: &\";\n\t\t\tthis.label6.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;\n\t\t\tthis.label6.UseMnemonic = false;\n\t\t\t// \n\t\t\t// label5\n\t\t\t// \n\t\t\tthis.label5.Anchor = System.Windows.Forms.AnchorStyles.Right;\n\t\t\tthis.label5.Location = new System.Drawing.Point(166, 53);\n\t\t\tthis.label5.Name = \"label5\";\n\t\t\tthis.label5.Size = new System.Drawing.Size(91, 18);\n\t\t\tthis.label5.TabIndex = 0;\n\t\t\tthis.label5.Text = \"Default: ^\";\n\t\t\tthis.label5.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;\n\t\t\t// \n\t\t\t// label4\n\t\t\t// \n\t\t\tthis.label4.Anchor = System.Windows.Forms.AnchorStyles.Right;\n\t\t\tthis.label4.Location = new System.Drawing.Point(166, 33);\n\t\t\tthis.label4.Name = \"label4\";\n\t\t\tthis.label4.Size = new System.Drawing.Size(91, 18);\n\t\t\tthis.label4.TabIndex = 0;\n\t\t\tthis.label4.Text = \"Default: ~\";\n\t\t\tthis.label4.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;\n\t\t\t// \n\t\t\t// label3\n\t\t\t// \n\t\t\tthis.label3.Anchor = System.Windows.Forms.AnchorStyles.Right;\n\t\t\tthis.label3.Location = new System.Drawing.Point(166, 13);\n\t\t\tthis.label3.Name = \"label3\";\n\t\t\tthis.label3.Size = new System.Drawing.Size(91, 18);\n\t\t\tthis.label3.TabIndex = 0;\n\t\t\tthis.label3.Text = \"Default: |\";\n\t\t\tthis.label3.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;\n\t\t\t// \n\t\t\t// textNote\n\t\t\t// \n\t\t\tthis.textNote.Location = new System.Drawing.Point(443, 184);\n\t\t\tthis.textNote.Multiline = true;\n\t\t\tthis.textNote.Name = \"textNote\";\n\t\t\tthis.textNote.ScrollBars = System.Windows.Forms.ScrollBars.Vertical;\n\t\t\tthis.textNote.Size = new System.Drawing.Size(368, 40);\n\t\t\tthis.textNote.TabIndex = 62;\n\t\t\t// \n\t\t\t// labelOutAddrPortEx\n\t\t\t// \n\t\t\tthis.labelOutAddrPortEx.Location = new System.Drawing.Point(336, 39);\n\t\t\tthis.labelOutAddrPortEx.Name = \"labelOutAddrPortEx\";\n\t\t\tthis.labelOutAddrPortEx.Size = new System.Drawing.Size(182, 18);\n\t\t\tthis.labelOutAddrPortEx.TabIndex = 0;\n\t\t\tthis.labelOutAddrPortEx.Text = \"Ex: 192.168.0.23:5846\";\n\t\t\tthis.labelOutAddrPortEx.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;\n\t\t\tthis.labelOutAddrPortEx.Visible = false;\n\t\t\t// \n\t\t\t// labelInAddrPortEx\n\t\t\t// \n\t\t\tthis.labelInAddrPortEx.Location = new System.Drawing.Point(336, 17);\n\t\t\tthis.labelInAddrPortEx.Name = \"labelInAddrPortEx\";\n\t\t\tthis.labelInAddrPortEx.Size = new System.Drawing.Size(182, 18);\n\t\t\tthis.labelInAddrPortEx.TabIndex = 0;\n\t\t\tthis.labelInAddrPortEx.Text = \"Ex: server.address.com:12345\";\n\t\t\tthis.labelInAddrPortEx.TextAlign = System.Drawing.ContentAlignment.MiddleLeft;\n\t\t\tthis.labelInAddrPortEx.Visible = false;\n\t\t\t// \n\t\t\t// textInternalTypeVersion\n\t\t\t// \n\t\t\tthis.textInternalTypeVersion.Location = new System.Drawing.Point(155, 112);\n\t\t\tthis.textInternalTypeVersion.Name = \"textInternalTypeVersion\";\n\t\t\tthis.textInternalTypeVersion.ReadOnly = true;\n\t\t\tthis.textInternalTypeVersion.Size = new System.Drawing.Size(125, 20);\n\t\t\tthis.textInternalTypeVersion.TabIndex = 44;\n\t\t\t// \n\t\t\t// label13\n\t\t\t// \n\t\t\tthis.label13.Location = new System.Drawing.Point(6, 113);\n\t\t\tthis.label13.Name = \"label13\";\n\t\t\tthis.label13.Size = new System.Drawing.Size(148, 18);\n\t\t\tthis.label13.TabIndex = 0;\n\t\t\tthis.label13.Text = \"Internal Type Version\";\n\t\t\tthis.label13.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\n\t\t\t// \n\t\t\t// textInternalType\n\t\t\t// \n\t\t\tthis.textInternalType.Location = new System.Drawing.Point(155, 92);\n\t\t\tthis.textInternalType.Name = \"textInternalType\";\n\t\t\tthis.textInternalType.ReadOnly = true;\n\t\t\tthis.textInternalType.Size = new System.Drawing.Size(125, 20);\n\t\t\tthis.textInternalType.TabIndex = 43;\n\t\t\t// \n\t\t\t// label14\n\t\t\t// \n\t\t\tthis.label14.Location = new System.Drawing.Point(6, 93);\n\t\t\tthis.label14.Name = \"label14\";\n\t\t\tthis.label14.Size = new System.Drawing.Size(148, 18);\n\t\t\tthis.label14.TabIndex = 0;\n\t\t\tthis.label14.Text = \"Internal Type\";\n\t\t\tthis.label14.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\n\t\t\t// \n\t\t\t// checkEnabled\n\t\t\t// \n\t\t\tthis.checkEnabled.Checked = true;\n\t\t\tthis.checkEnabled.CheckState = System.Windows.Forms.CheckState.Checked;\n\t\t\tthis.checkEnabled.FlatStyle = System.Windows.Forms.FlatStyle.System;\n\t\t\tthis.checkEnabled.Location = new System.Drawing.Point(6, 30);\n\t\t\tthis.checkEnabled.Name = \"checkEnabled\";\n\t\t\tthis.checkEnabled.RightToLeft = System.Windows.Forms.RightToLeft.Yes;\n\t\t\tthis.checkEnabled.Size = new System.Drawing.Size(162, 18);\n\t\t\tthis.checkEnabled.TabIndex = 40;\n\t\t\tthis.checkEnabled.Text = \"Enabled\";\n\t\t\tthis.checkEnabled.CheckedChanged += new System.EventHandler(this.checkEnabled_CheckedChanged);\n\t\t\tthis.checkEnabled.Click += new System.EventHandler(this.checkEnabled_Click);\n\t\t\t// \n\t\t\t// textEscChar\n\t\t\t// \n\t\t\tthis.textEscChar.Anchor = System.Windows.Forms.AnchorStyles.Right;\n\t\t\tthis.textEscChar.Location = new System.Drawing.Point(138, 92);\n\t\t\tthis.textEscChar.Name = \"textEscChar\";\n\t\t\tthis.textEscChar.Size = new System.Drawing.Size(27, 20);\n\t\t\tthis.textEscChar.TabIndex = 49;\n\t\t\t// \n\t\t\t// label12\n\t\t\t// \n\t\t\tthis.label12.Anchor = System.Windows.Forms.AnchorStyles.Right;\n\t\t\tthis.label12.Location = new System.Drawing.Point(6, 93);\n\t\t\tthis.label12.Name = \"label12\";\n\t\t\tthis.label12.Size = new System.Drawing.Size(131, 18);\n\t\t\tthis.label12.TabIndex = 0;\n\t\t\tthis.label12.Text = \"Escape\";\n\t\t\tthis.label12.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\n\t\t\t// \n\t\t\t// checkInternal\n\t\t\t// \n\t\t\tthis.checkInternal.Enabled = false;\n\t\t\tthis.checkInternal.FlatStyle = System.Windows.Forms.FlatStyle.System;\n\t\t\tthis.checkInternal.Location = new System.Drawing.Point(6, 12);\n\t\t\tthis.checkInternal.Name = \"checkInternal\";\n\t\t\tthis.checkInternal.RightToLeft = System.Windows.Forms.RightToLeft.Yes;\n\t\t\tthis.checkInternal.Size = new System.Drawing.Size(162, 18);\n\t\t\tthis.checkInternal.TabIndex = 31;\n\t\t\tthis.checkInternal.TabStop = false;\n\t\t\tthis.checkInternal.Text = \"Internal\";\n\t\t\t// \n\t\t\t// label11\n\t\t\t// \n\t\t\tthis.label11.Location = new System.Drawing.Point(292, 185);\n\t\t\tthis.label11.Name = \"label11\";\n\t\t\tthis.label11.Size = new System.Drawing.Size(150, 18);\n\t\t\tthis.label11.TabIndex = 0;\n\t\t\tthis.label11.Text = \"Note\";\n\t\t\tthis.label11.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\n\t\t\t// \n\t\t\t// textSubcompSep\n\t\t\t// \n\t\t\tthis.textSubcompSep.Anchor = System.Windows.Forms.AnchorStyles.Right;\n\t\t\tthis.textSubcompSep.Location = new System.Drawing.Point(138, 72);\n\t\t\tthis.textSubcompSep.Name = \"textSubcompSep\";\n\t\t\tthis.textSubcompSep.Size = new System.Drawing.Size(27, 20);\n\t\t\tthis.textSubcompSep.TabIndex = 48;\n\t\t\t// \n\t\t\t// label9\n\t\t\t// \n\t\t\tthis.label9.Anchor = System.Windows.Forms.AnchorStyles.Right;\n\t\t\tthis.label9.Location = new System.Drawing.Point(6, 73);\n\t\t\tthis.label9.Name = \"label9\";\n\t\t\tthis.label9.Size = new System.Drawing.Size(131, 18);\n\t\t\tthis.label9.TabIndex = 0;\n\t\t\tthis.label9.Text = \"Subcomponent\";\n\t\t\tthis.label9.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\n\t\t\t// \n\t\t\t// textRepSep\n\t\t\t// \n\t\t\tthis.textRepSep.Anchor = System.Windows.Forms.AnchorStyles.Right;\n\t\t\tthis.textRepSep.Location = new System.Drawing.Point(138, 32);\n\t\t\tthis.textRepSep.Name = \"textRepSep\";\n\t\t\tthis.textRepSep.Size = new System.Drawing.Size(27, 20);\n\t\t\tthis.textRepSep.TabIndex = 46;\n\t\t\t// \n\t\t\t// label10\n\t\t\t// \n\t\t\tthis.label10.Anchor = System.Windows.Forms.AnchorStyles.Right;\n\t\t\tthis.label10.Location = new System.Drawing.Point(6, 33);\n\t\t\tthis.label10.Name = \"label10\";\n\t\t\tthis.label10.Size = new System.Drawing.Size(131, 18);\n\t\t\tthis.label10.TabIndex = 0;\n\t\t\tthis.label10.Text = \"Repetition\";\n\t\t\tthis.label10.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\n\t\t\t// \n\t\t\t// textCompSep\n\t\t\t// \n\t\t\tthis.textCompSep.Anchor = System.Windows.Forms.AnchorStyles.Right;\n\t\t\tthis.textCompSep.Location = new System.Drawing.Point(138, 52);\n\t\t\tthis.textCompSep.Name = \"textCompSep\";\n\t\t\tthis.textCompSep.Size = new System.Drawing.Size(27, 20);\n\t\t\tthis.textCompSep.TabIndex = 47;\n\t\t\t// \n\t\t\t// label8\n\t\t\t// \n\t\t\tthis.label8.Anchor = System.Windows.Forms.AnchorStyles.Right;\n\t\t\tthis.label8.Location = new System.Drawing.Point(6, 53);\n\t\t\tthis.label8.Name = \"label8\";\n\t\t\tthis.label8.Size = new System.Drawing.Size(131, 18);\n\t\t\tthis.label8.TabIndex = 0;\n\t\t\tthis.label8.Text = \"Component\";\n\t\t\tthis.label8.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\n\t\t\t// \n\t\t\t// textFieldSep\n\t\t\t// \n\t\t\tthis.textFieldSep.Anchor = System.Windows.Forms.AnchorStyles.Right;\n\t\t\tthis.textFieldSep.Location = new System.Drawing.Point(138, 12);\n\t\t\tthis.textFieldSep.Name = \"textFieldSep\";\n\t\t\tthis.textFieldSep.Size = new System.Drawing.Size(27, 20);\n\t\t\tthis.textFieldSep.TabIndex = 45;\n\t\t\t// \n\t\t\t// label7\n\t\t\t// \n\t\t\tthis.label7.Anchor = System.Windows.Forms.AnchorStyles.Right;\n\t\t\tthis.label7.Location = new System.Drawing.Point(6, 13);\n\t\t\tthis.label7.Name = \"label7\";\n\t\t\tthis.label7.Size = new System.Drawing.Size(131, 18);\n\t\t\tthis.label7.TabIndex = 0;\n\t\t\tthis.label7.Text = \"Field\";\n\t\t\tthis.label7.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\n\t\t\t// \n\t\t\t// comboModeTx\n\t\t\t// \n\t\t\tthis.comboModeTx.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;\n\t\t\tthis.comboModeTx.Location = new System.Drawing.Point(155, 71);\n\t\t\tthis.comboModeTx.MaxDropDownItems = 100;\n\t\t\tthis.comboModeTx.Name = \"comboModeTx\";\n\t\t\tthis.comboModeTx.Size = new System.Drawing.Size(125, 21);\n\t\t\tthis.comboModeTx.TabIndex = 42;\n\t\t\tthis.comboModeTx.SelectedIndexChanged += new System.EventHandler(this.comboModeTx_SelectedIndexChanged);\n\t\t\t// \n\t\t\t// textSftpPassword\n\t\t\t// \n\t\t\tthis.textSftpPassword.Location = new System.Drawing.Point(157, 78);\n\t\t\tthis.textSftpPassword.Name = \"textSftpPassword\";\n\t\t\tthis.textSftpPassword.PasswordChar = '*';\n\t\t\tthis.textSftpPassword.Size = new System.Drawing.Size(125, 20);\n\t\t\tthis.textSftpPassword.TabIndex = 58;\n\t\t\t// \n\t\t\t// labelSftpPassword\n\t\t\t// \n\t\t\tthis.labelSftpPassword.Location = new System.Drawing.Point(6, 79);\n\t\t\tthis.labelSftpPassword.Name = \"labelSftpPassword\";\n\t\t\tthis.labelSftpPassword.Size = new System.Drawing.Size(150, 18);\n\t\t\tthis.labelSftpPassword.TabIndex = 0;\n\t\t\tthis.labelSftpPassword.Text = \"Sftp Password\";\n\t\t\tthis.labelSftpPassword.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\n\t\t\t// \n\t\t\t// textSftpUsername\n\t\t\t// \n\t\t\tthis.textSftpUsername.Location = new System.Drawing.Point(157, 58);\n\t\t\tthis.textSftpUsername.Name = \"textSftpUsername\";\n\t\t\tthis.textSftpUsername.Size = new System.Drawing.Size(125, 20);\n\t\t\tthis.textSftpUsername.TabIndex = 57;\n\t\t\t// \n\t\t\t// labelSftpUsername\n\t\t\t// \n\t\t\tthis.labelSftpUsername.Location = new System.Drawing.Point(6, 59);\n\t\t\tthis.labelSftpUsername.Name = \"labelSftpUsername\";\n\t\t\tthis.labelSftpUsername.Size = new System.Drawing.Size(150, 18);\n\t\t\tthis.labelSftpUsername.TabIndex = 0;\n\t\t\tthis.labelSftpUsername.Text = \"Sftp Username\";\n\t\t\tthis.labelSftpUsername.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\n\t\t\t// \n\t\t\t// textOutPathOrAddrPort\n\t\t\t// \n\t\t\tthis.textOutPathOrAddrPort.Location = new System.Drawing.Point(157, 38);\n\t\t\tthis.textOutPathOrAddrPort.Name = \"textOutPathOrAddrPort\";\n\t\t\tthis.textOutPathOrAddrPort.Size = new System.Drawing.Size(177, 20);\n\t\t\tthis.textOutPathOrAddrPort.TabIndex = 55;\n\t\t\t// \n\t\t\t// labelOutPathOrAddrPort\n\t\t\t// \n\t\t\tthis.labelOutPathOrAddrPort.Location = new System.Drawing.Point(6, 39);\n\t\t\tthis.labelOutPathOrAddrPort.Name = \"labelOutPathOrAddrPort\";\n\t\t\tthis.labelOutPathOrAddrPort.Size = new System.Drawing.Size(150, 18);\n\t\t\tthis.labelOutPathOrAddrPort.TabIndex = 0;\n\t\t\tthis.labelOutPathOrAddrPort.Text = \"Outgoing Folder\";\n\t\t\tthis.labelOutPathOrAddrPort.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\n\t\t\t// \n\t\t\t// textInPathOrAddrPort\n\t\t\t// \n\t\t\tthis.textInPathOrAddrPort.Location = new System.Drawing.Point(157, 16);\n\t\t\tthis.textInPathOrAddrPort.Name = \"textInPathOrAddrPort\";\n\t\t\tthis.textInPathOrAddrPort.Size = new System.Drawing.Size(177, 20);\n\t\t\tthis.textInPathOrAddrPort.TabIndex = 53;\n\t\t\t// \n\t\t\t// labelInPathOrAddrPort\n\t\t\t// \n\t\t\tthis.labelInPathOrAddrPort.Location = new System.Drawing.Point(6, 17);\n\t\t\tthis.labelInPathOrAddrPort.Name = \"labelInPathOrAddrPort\";\n\t\t\tthis.labelInPathOrAddrPort.Size = new System.Drawing.Size(150, 18);\n\t\t\tthis.labelInPathOrAddrPort.TabIndex = 0;\n\t\t\tthis.labelInPathOrAddrPort.Text = \"Incoming Folder\";\n\t\t\tthis.labelInPathOrAddrPort.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\n\t\t\t// \n\t\t\t// label2\n\t\t\t// \n\t\t\tthis.label2.Location = new System.Drawing.Point(6, 72);\n\t\t\tthis.label2.Name = \"label2\";\n\t\t\tthis.label2.Size = new System.Drawing.Size(148, 18);\n\t\t\tthis.label2.TabIndex = 0;\n\t\t\tthis.label2.Text = \"ModeTx\";\n\t\t\tthis.label2.TextAlign = System.Drawing.ContentAlignment.MiddleRight;\n\t\t\t// \n\t\t\t// label1\n\t\t\t// \n", "answers": ["\t\t\tthis.label1.Location = new System.Drawing.Point(6, 51);"], "incorrect_answer": "this.label1.Location = new System.Drawing.Point(10, 60);"}, {"input": "", "context": "//\n// System.Web.Compilation.AspComponentFoundry\n//\n// Authors:\n//\tGonzalo Paniagua Javier (gonzalo@ximian.com)\n//\n// (C) 2002,2003 Ximian, Inc (http://www.ximian.com)\n//\n//\n// Permission is hereby granted, free of charge, to any person obtaining\n// a copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to\n// permit persons to whom the Software is furnished to do so, subject to\n// the following conditions:\n// \n// The above copyright notice and this permission notice shall be\n// included in all copies or substantial portions of the Software.\n// \n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\n// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\nusing System;\nusing System.Collections;\nusing System.Collections.Generic;\nusing System.Globalization;\nusing System.IO;\nusing System.Reflection;\nusing System.Web;\nusing System.Web.Configuration;\nusing System.Web.UI;\nusing System.Web.Util;\nnamespace System.Web.Compilation\n{\n\tclass AspComponentFoundry\n\t{\n\t\tHashtable foundries;\n\t\tDictionary <string, AspComponent> components;\n\t\tDictionary <string, AspComponent> Components {\n\t\t\tget {\n\t\t\t\tif (components == null)\n\t\t\t\t\tcomponents = new Dictionary <string, AspComponent> (StringComparer.OrdinalIgnoreCase);\n\t\t\t\treturn components;\n\t\t\t}\n\t\t}\n\t\t\n\t\tpublic AspComponentFoundry ()\n\t\t{\n\t\t\tfoundries = new Hashtable (StringComparer.InvariantCultureIgnoreCase);\n\t\t\tAssembly sw = typeof (AspComponentFoundry).Assembly;\n\t\t\tRegisterFoundry (\"asp\", sw, \"System.Web.UI.WebControls\");\n\t\t\tRegisterFoundry (\"\", \"object\", typeof (System.Web.UI.ObjectTag));\n\t\t\tRegisterConfigControls ();\n\t\t}\n\t\tpublic AspComponent GetComponent (string tagName)\n\t\t{\n\t\t\tif (tagName == null || tagName.Length == 0)\n\t\t\t\treturn null;\n\t\t\t\n\t\t\tif (components != null) {\n\t\t\t\tAspComponent ret;\n\t\t\t\tif (components.TryGetValue (tagName, out ret))\n\t\t\t\t\treturn ret;\n\t\t\t}\n\t\t\tstring foundryName, tag;\n\t\t\tint colon = tagName.IndexOf (':');\n\t\t\tif (colon > -1) {\n\t\t\t\tif (colon == 0)\n\t\t\t\t\tthrow new Exception (\"Empty TagPrefix is not valid.\");\n\t\t\t\tif (colon + 1 == tagName.Length)\n\t\t\t\t\treturn null;\n\t\t\t\tfoundryName = tagName.Substring (0, colon);\n\t\t\t\ttag = tagName.Substring (colon + 1);\n\t\t\t} else {\n\t\t\t\tfoundryName = String.Empty;\n\t\t\t\ttag = tagName;\n\t\t\t}\n\t\t\t\n\t\t\tobject o = foundries [foundryName];\t\t\t\n\t\t\tif (o == null)\n\t\t\t\treturn null;\n\t\t\tFoundry foundry = o as Foundry;\n\t\t\tif (foundry != null)\n\t\t\t\treturn CreateComponent (foundry, tagName, foundryName, tag);\n\t\t\t\n\t\t\tArrayList af = o as ArrayList;\n\t\t\tif (af == null)\n\t\t\t\treturn null;\n\t\t\tAspComponent component = null;\n\t\t\tException e = null;\n\t\t\tforeach (Foundry f in af) {\n\t\t\t\ttry {\n\t\t\t\t\tcomponent = CreateComponent (f, tagName, foundryName, tag);\n\t\t\t\t\tif (component != null)\n\t\t\t\t\t\treturn component;\n\t\t\t\t} catch (Exception ex) {\n\t\t\t\t\te = ex;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (e != null)\n\t\t\t\tthrow e;\n\t\t\t\n\t\t\treturn null;\n\t\t}\n\t\tAspComponent CreateComponent (Foundry foundry, string tagName, string prefix, string tag)\n\t\t{\n\t\t\tstring source, ns;\n\t\t\tType type;\n\t\t\ttype = foundry.GetType (tag, out source, out ns);\n\t\t\tif (type == null)\n\t\t\t\treturn null;\n\t\t\t\n\t\t\tAspComponent ret = new AspComponent (type, ns, prefix, source, foundry.FromConfig);\n\t\t\tDictionary <string, AspComponent> components = Components;\n\t\t\tcomponents.Add (tagName, ret);\n\t\t\treturn ret;\n\t\t}\n\t\t\n\t\tpublic void RegisterFoundry (string foundryName, Assembly assembly, string nameSpace)\n\t\t{\n\t\t\tRegisterFoundry (foundryName, assembly, nameSpace, false);\n\t\t}\n\t\t\n\t\tpublic void RegisterFoundry (string foundryName,\n\t\t\t\t\t     Assembly assembly,\n\t\t\t\t\t     string nameSpace,\n\t\t\t\t\t     bool fromConfig)\n\t\t{\n\t\t\tAssemblyFoundry foundry = new AssemblyFoundry (assembly, nameSpace);\n\t\t\tfoundry.FromConfig = fromConfig;\n\t\t\tInternalRegister (foundryName, foundry, fromConfig);\n\t\t}\n\t\tpublic void RegisterFoundry (string foundryName, string tagName, Type type)\n\t\t{\n\t\t\tRegisterFoundry (foundryName, tagName, type, false);\n\t\t}\n\t\t\n\t\tpublic void RegisterFoundry (string foundryName,\n\t\t\t\t\t     string tagName,\n\t\t\t\t\t     Type type,\n\t\t\t\t\t     bool fromConfig)\n\t\t{\n\t\t\tTagNameFoundry foundry = new TagNameFoundry (tagName, type);\n\t\t\tfoundry.FromConfig = fromConfig;\n\t\t\tInternalRegister (foundryName, foundry, fromConfig);\n\t\t}\n\t\tpublic void RegisterFoundry (string foundryName, string tagName, string source)\n\t\t{\n\t\t\tRegisterFoundry (foundryName, tagName, source, false);\n\t\t}\n\t\t\n\t\tpublic void RegisterFoundry (string foundryName,\n\t\t\t\t\t     string tagName,\n\t\t\t\t\t     string source,\n\t\t\t\t\t     bool fromConfig)\n\t\t{\n\t\t\tTagNameFoundry foundry = new TagNameFoundry (tagName, source);\n\t\t\tfoundry.FromConfig = fromConfig;\n\t\t\tInternalRegister (foundryName, foundry, fromConfig);\n\t\t}\n\t\tpublic void RegisterAssemblyFoundry (string foundryName,\n\t\t\t\t\t\t     string assemblyName,\n\t\t\t\t\t\t     string nameSpace,\n\t\t\t\t\t\t     bool fromConfig)\n\t\t{\n\t\t\tAssemblyFoundry foundry = new AssemblyFoundry (assemblyName, nameSpace);\n\t\t\tfoundry.FromConfig = fromConfig;\n\t\t\tInternalRegister (foundryName, foundry, fromConfig);\n\t\t}\t\t\n\t\tvoid RegisterConfigControls ()\n\t\t{\n\t\t\tPagesSection pages = WebConfigurationManager.GetSection (\"system.web/pages\") as PagesSection;\n\t\t\tif (pages == null)\n\t\t\t\treturn;\n\t\t\tTagPrefixCollection controls = pages.Controls;\n\t\t\tif (controls == null || controls.Count == 0)\n\t\t\t\treturn;\n\t\t\t\n\t\t\tIList appCode = BuildManager.CodeAssemblies;\n\t\t\tbool haveCodeAssemblies = appCode != null && appCode.Count > 0;\n\t\t\tAssembly asm;\n\t\t\tforeach (TagPrefixInfo tpi in controls) {\n\t\t\t\tif (!String.IsNullOrEmpty (tpi.TagName))\n\t\t\t\t\tRegisterFoundry (tpi.TagPrefix, tpi.TagName, tpi.Source, true);\n\t\t\t\telse if (String.IsNullOrEmpty (tpi.Assembly)) {\n\t\t\t\t\tif (haveCodeAssemblies) {\n\t\t\t\t\t\tforeach (object o in appCode) {\n\t\t\t\t\t\t\tasm = o as Assembly;\n\t\t\t\t\t\t\tif (asm == null)\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\tRegisterFoundry (tpi.TagPrefix, asm, tpi.Namespace, true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (!String.IsNullOrEmpty (tpi.Namespace))\n\t\t\t\t\tRegisterAssemblyFoundry (tpi.TagPrefix,\n\t\t\t\t\t\t\t\t tpi.Assembly,\n\t\t\t\t\t\t\t\t tpi.Namespace,\n\t\t\t\t\t\t\t\t true);\n\t\t\t}\n\t\t}\n\t\t\n\t\tvoid InternalRegister (string foundryName, Foundry foundry, bool fromConfig)\n\t\t{\n\t\t\tobject f = foundries [foundryName];\n\t\t\tFoundry newFoundry = null;\n\t\t\t\n\t\t\tif (f is CompoundFoundry) {\n\t\t\t\t((CompoundFoundry) f).Add (foundry);\n\t\t\t\treturn;\n\t\t\t} else if (f == null || f is ArrayList || (f is AssemblyFoundry && foundry is AssemblyFoundry)) {\n\t\t\t\tnewFoundry = foundry;\n\t\t\t} else if (f != null) {\n\t\t\t\tCompoundFoundry compound = new CompoundFoundry (foundryName);\n\t\t\t\tcompound.Add ((Foundry) f);\n\t\t\t\tcompound.Add (foundry);\n\t\t\t\tnewFoundry = foundry;\n\t\t\t\tnewFoundry.FromConfig = fromConfig;\n\t\t\t}\n\t\t\tif (newFoundry == null)\n\t\t\t\treturn;\n\t\t\tif (f == null) {\n\t\t\t\tfoundries [foundryName] = newFoundry;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tArrayList af = f as ArrayList;\n\t\t\tif (af == null) {\n\t\t\t\taf = new ArrayList (2);\n\t\t\t\taf.Add (f);\n\t\t\t\tfoundries [foundryName] = af;\n\t\t\t}\n\t\t\tif (newFoundry is AssemblyFoundry) {\n\t\t\t\tobject o;\n\t\t\t\tfor (int i = 0; i < af.Count; i++) {\n\t\t\t\t\to = af [i];\n\t\t\t\t\tif (o is AssemblyFoundry) {\n\t\t\t\t\t\taf.Insert (i, newFoundry);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\taf.Add (newFoundry);\n\t\t\t} else\n\t\t\t\taf.Insert (0, newFoundry);\n\t\t}\n\t\tpublic bool LookupFoundry (string foundryName)\n\t\t{\n\t\t\treturn foundries.Contains (foundryName);\n\t\t}\n\t\tabstract class Foundry\n\t\t{\n\t\t\tbool _fromConfig;\n\t\t\tpublic bool FromConfig {\n\t\t\t\tget { return _fromConfig; }\n\t\t\t\tset { _fromConfig = value; }\n\t\t\t}\n\t\t\t\n\t\t\tpublic abstract Type GetType (string componentName, out string source, out string ns);\n\t\t}\n\t\t\n\t\tclass TagNameFoundry : Foundry\n\t\t{\n\t\t\tstring tagName;\n\t\t\tType type;\n\t\t\tstring source;\n\t\t\tpublic bool FromWebConfig {\n\t\t\t\tget { return source != null; }\n\t\t\t}\n\t\t\t\n\t\t\tpublic TagNameFoundry (string tagName, string source)\n\t\t\t{\n\t\t\t\tthis.tagName = tagName;\n\t\t\t\tthis.source = source;\n\t\t\t}\n\t\t\t\n\t\t\tpublic TagNameFoundry (string tagName, Type type)\n\t\t\t{\n\t\t\t\tthis.tagName = tagName;\n\t\t\t\tthis.type = type;\n\t\t\t}\n\t\t\tpublic override Type GetType (string componentName, out string source, out string ns)\n\t\t\t{\n\t\t\t\tsource = null;\n\t\t\t\tns = null;\n\t\t\t\tif (0 != String.Compare (componentName, tagName, true, Helpers.InvariantCulture))\n\t\t\t\t\treturn null;\n\t\t\t\tsource = this.source;\n\t\t\t\treturn LoadType ();\n\t\t\t}\n\t\t\tType LoadType ()\n\t\t\t{\n\t\t\t\tif (type != null)\n\t\t\t\t\treturn type;\n\t\t\t\tHttpContext context = HttpContext.Current;\n\t\t\t\tstring vpath;\n\t\t\t\tstring realpath;\n\t\t\t\t\n\t\t\t\tif (VirtualPathUtility.IsAppRelative (source)) {\n\t\t\t\t\tvpath = source;\n\t\t\t\t\trealpath = context.Request.MapPath (source);\n\t\t\t\t} else {\n\t\t\t\t\tvpath = VirtualPathUtility.ToAppRelative (source);\n\t\t\t\t\trealpath = source;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif ((type = CachingCompiler.GetTypeFromCache (realpath)) != null)\n\t\t\t\t\treturn type;\t\t\t\t\n\t\t\t\ttype = BuildManager.GetCompiledType (vpath);\n\t\t\t\tif (type != null) {\n\t\t\t\t\tAspGenerator.AddTypeToCache (null, realpath, type);\n\t\t\t\t\tBuildManager.AddToReferencedAssemblies (type.Assembly);\n\t\t\t\t}\n\t\t\t\treturn type;\n\t\t\t}\n\t\t\t\n\t\t\tpublic string TagName {\n\t\t\t\tget { return tagName; }\n\t\t\t}\n\t\t}\n\t\tclass AssemblyFoundry : Foundry\n\t\t{\n\t\t\tstring nameSpace;\n\t\t\tAssembly assembly;\n\t\t\tstring assemblyName;\n\t\t\tDictionary <string, Assembly> assemblyCache;\n\t\t\t\n\t\t\tpublic AssemblyFoundry (Assembly assembly, string nameSpace)\n\t\t\t{\n\t\t\t\tthis.assembly = assembly;\n\t\t\t\tthis.nameSpace = nameSpace;\n\t\t\t\tif (assembly != null)\n\t\t\t\t\tthis.assemblyName = assembly.FullName;\n\t\t\t\telse\n\t\t\t\t\tthis.assemblyName = null;\n\t\t\t}\n\t\t\tpublic AssemblyFoundry (string assemblyName, string nameSpace)\n\t\t\t{\n\t\t\t\tthis.assembly = null;\n\t\t\t\tthis.nameSpace = nameSpace;\n\t\t\t\tthis.assemblyName = assemblyName;\n\t\t\t}\n\t\t\t\n\t\t\tpublic override Type GetType (string componentName, out string source, out string ns)\n\t\t\t{\n\t\t\t\tsource = null;\n\t\t\t\tns = nameSpace;\n\t\t\t\tif (assembly == null && assemblyName != null)\n\t\t\t\t\tassembly = GetAssemblyByName (assemblyName, true);\n\t\t\t\tstring typeName = String.Concat (nameSpace, \".\", componentName);\n\t\t\t\tif (assembly != null)\n\t\t\t\t\treturn assembly.GetType (typeName, false, true);\n\t\t\t\tIList tla = BuildManager.TopLevelAssemblies;\n\t\t\t\tif (tla != null && tla.Count > 0) {\n\t\t\t\t\tType ret = null;\n\t\t\t\t\tforeach (Assembly asm in tla) {\n\t\t\t\t\t\tif (asm == null)\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\tret = asm.GetType (typeName, false, true);\n\t\t\t\t\t\tif (ret != null)\n\t\t\t\t\t\t\treturn ret;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tAssembly GetAssemblyByName (string name, bool throwOnMissing)\n\t\t\t{\n\t\t\t\tif (assemblyCache == null)\n\t\t\t\t\tassemblyCache = new Dictionary <string, Assembly> ();\n\t\t\t\t\n\t\t\t\tif (assemblyCache.ContainsKey (name))\n\t\t\t\t\treturn assemblyCache [name];\n\t\t\t\t\n\t\t\t\tAssembly assembly = null;\n\t\t\t\tException error = null;\n\t\t\t\tif (name.IndexOf (',') != -1) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tassembly = Assembly.Load (name);\n\t\t\t\t\t} catch (Exception e) { error = e; }\n\t\t\t\t}\n", "answers": ["\t\t\t\tif (assembly == null) {"], "incorrect_answer": "if (assembly != foundry) {"}, {"input": "", "context": "#!/usr/bin/python\n#\n# This file is part of Ansible\n#\n# Ansible is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Ansible is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Ansible.  If not, see <http://www.gnu.org/licenses/>.\n#\nANSIBLE_METADATA = {'metadata_version': '1.1',\n                    'status': ['preview'],\n                    'supported_by': 'community'}\nDOCUMENTATION = '''\n---\nmodule: ce_link_status\nversion_added: \"2.4\"\nshort_description: Get interface link status on HUAWEI CloudEngine switches.\ndescription:\n    - Get interface link status on HUAWEI CloudEngine switches.\nauthor:\n    - Zhijin Zhou (@QijunPan)\nnotes:\n    - Current physical state shows an interface's physical status.\n    - Current link state shows an interface's link layer protocol status.\n    - Current IPv4 state shows an interface's IPv4 protocol status.\n    - Current IPv6 state shows an interface's  IPv6 protocol status.\n    - Inbound octets(bytes) shows the number of bytes that an interface received.\n    - Inbound unicast(pkts) shows the number of unicast packets that an interface received.\n    - Inbound multicast(pkts) shows the number of multicast packets that an interface received.\n    - Inbound broadcast(pkts) shows  the number of broadcast packets that an interface received.\n    - Inbound error(pkts) shows the number of error packets that an interface received.\n    - Inbound drop(pkts) shows the total number of packets that were sent to the interface but dropped by an interface.\n    - Inbound rate(byte/sec) shows the rate at which an interface receives bytes within an interval.\n    - Inbound rate(pkts/sec) shows the rate at which an interface receives packets within an interval.\n    - Outbound octets(bytes) shows the number of the bytes that an interface sent.\n    - Outbound unicast(pkts) shows  the number of unicast packets that an interface sent.\n    - Outbound multicast(pkts) shows the number of multicast packets that an interface sent.\n    - Outbound broadcast(pkts) shows the number of broadcast packets that an interface sent.\n    - Outbound error(pkts) shows the total number of packets that an interface sent but dropped by the remote interface.\n    - Outbound drop(pkts) shows the number of dropped packets that an interface sent.\n    - Outbound rate(byte/sec) shows the rate at which an interface sends bytes within an interval.\n    - Outbound rate(pkts/sec) shows the rate at which an interface sends packets within an interval.\n    - Speed shows the rate for an Ethernet interface.\noptions:\n    interface:\n        description:\n            - For the interface parameter, you can enter C(all) to display information about all interface,\n              an interface type such as C(40GE) to display information about interfaces of the specified type,\n              or full name of an interface such as C(40GE1/0/22) or C(vlanif10)\n              to display information about the specific interface.\n        required: true\n'''\nEXAMPLES = '''\n- name: Link status test\n  hosts: cloudengine\n  connection: local\n  gather_facts: no\n  vars:\n    cli:\n      host: \"{{ inventory_hostname }}\"\n      port: \"{{ ansible_ssh_port }}\"\n      username: \"{{ username }}\"\n      password: \"{{ password }}\"\n      transport: cli\n  tasks:\n  - name: Get specified interface link status information\n    ce_link_status:\n      interface: 40GE1/0/1\n      provider: \"{{ cli }}\"\n  - name: Get specified interface type link status information\n    ce_link_status:\n      interface: 40GE\n      provider: \"{{ cli }}\"\n  - name: Get all interface link status information\n    ce_link_status:\n      interface: all\n      provider: \"{{ cli }}\"\n'''\nRETURN = '''\nresult:\n    description: Interface link status information\n    returned: always\n    type: dict\n    sample: {\n                \"40ge2/0/8\": {\n                    \"Current IPv4 state\": \"down\",\n                    \"Current IPv6 state\": \"down\",\n                    \"Current link state\": \"up\",\n                    \"Current physical state\": \"up\",\n                    \"Inbound broadcast(pkts)\": \"0\",\n                    \"Inbound drop(pkts)\": \"0\",\n                    \"Inbound error(pkts)\": \"0\",\n                    \"Inbound multicast(pkts)\": \"20151\",\n                    \"Inbound octets(bytes)\": \"7314813\",\n                    \"Inbound rate(byte/sec)\": \"11\",\n                    \"Inbound rate(pkts/sec)\": \"0\",\n                    \"Inbound unicast(pkts)\": \"0\",\n                    \"Outbound broadcast(pkts)\": \"1\",\n                    \"Outbound drop(pkts)\": \"0\",\n                    \"Outbound error(pkts)\": \"0\",\n                    \"Outbound multicast(pkts)\": \"20152\",\n                    \"Outbound octets(bytes)\": \"7235021\",\n                    \"Outbound rate(byte/sec)\": \"11\",\n                    \"Outbound rate(pkts/sec)\": \"0\",\n                    \"Outbound unicast(pkts)\": \"0\",\n                    \"Speed\": \"40GE\"\n                }\n            }\n'''\nfrom xml.etree import ElementTree\nfrom ansible.module_utils.basic import AnsibleModule\nfrom ansible.module_utils.network.cloudengine.ce import ce_argument_spec, get_nc_config\nCE_NC_GET_PORT_SPEED = \"\"\"\n<filter type=\"subtree\">\n  <devm xmlns=\"http://www.huawei.com/netconf/vrp\" content-version=\"1.0\" format-version=\"1.0\">\n    <ports>\n      <port>\n        <position>%s</position>\n        <ethernetPort>\n          <speed></speed>\n        </ethernetPort>\n      </port>\n    </ports>\n  </devm>\n</filter>\n\"\"\"\nCE_NC_GET_INT_STATISTICS = \"\"\"\n<filter type=\"subtree\">\n  <ifm xmlns=\"http://www.huawei.com/netconf/vrp\" content-version=\"1.0\" format-version=\"1.0\">\n    <interfaces>\n      <interface>\n        <ifName>%s</ifName>\n        <ifDynamicInfo>\n          <ifPhyStatus></ifPhyStatus>\n          <ifLinkStatus></ifLinkStatus>\n          <ifV4State></ifV4State>\n          <ifV6State></ifV6State>\n        </ifDynamicInfo>\n        <ifStatistics>\n          <receiveByte></receiveByte>\n          <sendByte></sendByte>\n          <rcvUniPacket></rcvUniPacket>\n          <rcvMutiPacket></rcvMutiPacket>\n          <rcvBroadPacket></rcvBroadPacket>\n          <sendUniPacket></sendUniPacket>\n          <sendMutiPacket></sendMutiPacket>\n          <sendBroadPacket></sendBroadPacket>\n          <rcvErrorPacket></rcvErrorPacket>\n          <rcvDropPacket></rcvDropPacket>\n          <sendErrorPacket></sendErrorPacket>\n          <sendDropPacket></sendDropPacket>\n        </ifStatistics>\n        <ifClearedStat>\n          <inByteRate></inByteRate>\n          <inPacketRate></inPacketRate>\n          <outByteRate></outByteRate>\n          <outPacketRate></outPacketRate>\n        </ifClearedStat>\n      </interface>\n    </interfaces>\n  </ifm>\n</filter>\n\"\"\"\nINTERFACE_ALL = 1\nINTERFACE_TYPE = 2\nINTERFACE_FULL_NAME = 3\ndef get_interface_type(interface):\n    \"\"\"Gets the type of interface, such as 10GE, ETH-TRUNK, VLANIF...\"\"\"\n    if interface is None:\n        return None\n    iftype = None\n    if interface.upper().startswith('GE'):\n        iftype = 'ge'\n    elif interface.upper().startswith('10GE'):\n        iftype = '10ge'\n    elif interface.upper().startswith('25GE'):\n        iftype = '25ge'\n    elif interface.upper().startswith('4X10GE'):\n        iftype = '4x10ge'\n    elif interface.upper().startswith('40GE'):\n        iftype = '40ge'\n    elif interface.upper().startswith('100GE'):\n        iftype = '100ge'\n    elif interface.upper().startswith('VLANIF'):\n        iftype = 'vlanif'\n    elif interface.upper().startswith('LOOPBACK'):\n        iftype = 'loopback'\n    elif interface.upper().startswith('METH'):\n        iftype = 'meth'\n    elif interface.upper().startswith('ETH-TRUNK'):\n        iftype = 'eth-trunk'\n    elif interface.upper().startswith('VBDIF'):\n        iftype = 'vbdif'\n    elif interface.upper().startswith('NVE'):\n        iftype = 'nve'\n    elif interface.upper().startswith('TUNNEL'):\n        iftype = 'tunnel'\n    elif interface.upper().startswith('ETHERNET'):\n        iftype = 'ethernet'\n    elif interface.upper().startswith('FCOE-PORT'):\n        iftype = 'fcoe-port'\n    elif interface.upper().startswith('FABRIC-PORT'):\n        iftype = 'fabric-port'\n    elif interface.upper().startswith('STACK-PORT'):\n        iftype = 'stack-Port'\n    elif interface.upper().startswith('NULL'):\n        iftype = 'null'\n    else:\n        return None\n    return iftype.lower()\ndef is_ethernet_port(interface):\n    \"\"\"Judge whether it is ethernet port\"\"\"\n    ethernet_port = ['ge', '10ge', '25ge', '4x10ge', '40ge', '100ge', 'meth']\n    if_type = get_interface_type(interface)\n    if if_type in ethernet_port:\n        return True\n    return False\nclass LinkStatus(object):\n    \"\"\"Get interface link status information\"\"\"\n    def __init__(self, argument_spec):\n        self.spec = argument_spec\n        self.module = None\n        self.init_module()\n        # interface name\n        self.interface = self.module.params['interface']\n        self.interface = self.interface.replace(' ', '').lower()\n        self.param_type = None\n        self.if_type = None\n        # state\n        self.results = dict()\n        self.result = dict()\n    def check_params(self):\n        \"\"\"Check all input params\"\"\"\n        if not self.interface:\n            self.module.fail_json(msg='Error: Interface name cannot be empty.')\n        if self.interface and self.interface != 'all':\n            if not self.if_type:\n                self.module.fail_json(\n                    msg='Error: Interface name of %s is error.' % self.interface)\n    def init_module(self):\n        \"\"\"Init module object\"\"\"\n        self.module = AnsibleModule(\n            argument_spec=self.spec, supports_check_mode=True)\n    def show_result(self):\n        \"\"\"Show result\"\"\"\n        self.results['result'] = self.result\n        self.module.exit_json(**self.results)\n    def get_intf_dynamic_info(self, dyn_info, intf_name):\n        \"\"\"Get interface dynamic information\"\"\"\n        if not intf_name:\n            return\n        if dyn_info:\n            for eles in dyn_info:\n                if eles.tag in [\"ifPhyStatus\", \"ifV4State\", \"ifV6State\", \"ifLinkStatus\"]:\n                    if eles.tag == \"ifPhyStatus\":\n                        self.result[intf_name][\n                            'Current physical state'] = eles.text\n                    elif eles.tag == \"ifLinkStatus\":\n                        self.result[intf_name][\n                            'Current link state'] = eles.text\n                    elif eles.tag == \"ifV4State\":\n                        self.result[intf_name][\n                            'Current IPv4 state'] = eles.text\n                    elif eles.tag == \"ifV6State\":\n                        self.result[intf_name][\n                            'Current IPv6 state'] = eles.text\n    def get_intf_statistics_info(self, stat_info, intf_name):\n        \"\"\"Get interface statistics information\"\"\"\n        if not intf_name:\n            return\n        if_type = get_interface_type(intf_name)\n        if if_type == 'fcoe-port' or if_type == 'nve' or if_type == 'tunnel' or \\\n                if_type == 'vbdif' or if_type == 'vlanif':\n            return\n        if stat_info:\n            for eles in stat_info:\n                if eles.tag in [\"receiveByte\", \"sendByte\", \"rcvUniPacket\", \"rcvMutiPacket\", \"rcvBroadPacket\",\n                                \"sendUniPacket\", \"sendMutiPacket\", \"sendBroadPacket\", \"rcvErrorPacket\",\n                                \"rcvDropPacket\", \"sendErrorPacket\", \"sendDropPacket\"]:\n                    if eles.tag == \"receiveByte\":\n                        self.result[intf_name][\n                            'Inbound octets(bytes)'] = eles.text\n                    elif eles.tag == \"rcvUniPacket\":\n                        self.result[intf_name][\n                            'Inbound unicast(pkts)'] = eles.text\n                    elif eles.tag == \"rcvMutiPacket\":\n                        self.result[intf_name][\n                            'Inbound multicast(pkts)'] = eles.text\n                    elif eles.tag == \"rcvBroadPacket\":\n                        self.result[intf_name][\n                            'Inbound broadcast(pkts)'] = eles.text\n                    elif eles.tag == \"rcvErrorPacket\":\n                        self.result[intf_name][\n                            'Inbound error(pkts)'] = eles.text\n                    elif eles.tag == \"rcvDropPacket\":\n                        self.result[intf_name][\n                            'Inbound drop(pkts)'] = eles.text\n                    elif eles.tag == \"sendByte\":\n                        self.result[intf_name][\n                            'Outbound octets(bytes)'] = eles.text\n                    elif eles.tag == \"sendUniPacket\":\n                        self.result[intf_name][\n                            'Outbound unicast(pkts)'] = eles.text\n                    elif eles.tag == \"sendMutiPacket\":\n                        self.result[intf_name][\n                            'Outbound multicast(pkts)'] = eles.text\n                    elif eles.tag == \"sendBroadPacket\":\n                        self.result[intf_name][\n                            'Outbound broadcast(pkts)'] = eles.text\n                    elif eles.tag == \"sendErrorPacket\":\n                        self.result[intf_name][\n                            'Outbound error(pkts)'] = eles.text\n                    elif eles.tag == \"sendDropPacket\":\n                        self.result[intf_name][\n                            'Outbound drop(pkts)'] = eles.text\n    def get_intf_cleared_stat(self, clr_stat, intf_name):\n        \"\"\"Get interface cleared state information\"\"\"\n        if not intf_name:\n            return\n        if_type = get_interface_type(intf_name)\n        if if_type == 'fcoe-port' or if_type == 'nve' or if_type == 'tunnel' or \\\n                if_type == 'vbdif' or if_type == 'vlanif':\n            return\n        if clr_stat:\n            for eles in clr_stat:\n                if eles.tag in [\"inByteRate\", \"inPacketRate\", \"outByteRate\", \"outPacketRate\"]:\n                    if eles.tag == \"inByteRate\":\n                        self.result[intf_name][\n                            'Inbound rate(byte/sec)'] = eles.text\n                    elif eles.tag == \"inPacketRate\":\n                        self.result[intf_name][\n                            'Inbound rate(pkts/sec)'] = eles.text\n                    elif eles.tag == \"outByteRate\":\n                        self.result[intf_name][\n                            'Outbound rate(byte/sec)'] = eles.text\n                    elif eles.tag == \"outPacketRate\":\n                        self.result[intf_name][\n                            'Outbound rate(pkts/sec)'] = eles.text\n    def get_all_interface_info(self, intf_type=None):\n        \"\"\"Get interface information all or by interface type\"\"\"\n        xml_str = CE_NC_GET_INT_STATISTICS % ''\n        con_obj = get_nc_config(self.module, xml_str)\n        if \"<data/>\" in con_obj:\n            return\n        xml_str = con_obj.replace('\\r', '').replace('\\n', '').\\\n            replace('xmlns=\"urn:ietf:params:xml:ns:netconf:base:1.0\"', \"\").\\\n            replace('xmlns=\"http://www.huawei.com/netconf/vrp\"', \"\")\n        # get link status information\n        root = ElementTree.fromstring(xml_str)\n        intfs_info = root.find(\"data/ifm/interfaces\")\n        if not intfs_info:\n            return\n        intf_name = ''\n        flag = False\n        for eles in intfs_info:\n            if eles.tag == \"interface\":\n                for ele in eles:\n                    if ele.tag in [\"ifName\", \"ifDynamicInfo\", \"ifStatistics\", \"ifClearedStat\"]:\n                        if ele.tag == \"ifName\":\n                            intf_name = ele.text.lower()\n                            if intf_type:\n                                if get_interface_type(intf_name) != intf_type.lower():\n                                    break\n                                else:\n                                    flag = True\n                            self.init_interface_data(intf_name)\n                            if is_ethernet_port(intf_name):\n                                self.get_port_info(intf_name)\n                        if ele.tag == \"ifDynamicInfo\":\n                            self.get_intf_dynamic_info(ele, intf_name)\n                        elif ele.tag == \"ifStatistics\":\n                            self.get_intf_statistics_info(ele, intf_name)\n                        elif ele.tag == \"ifClearedStat\":\n                            self.get_intf_cleared_stat(ele, intf_name)\n        if intf_type and not flag:\n            self.module.fail_json(\n                msg='Error: %s interface type does not exist.' % intf_type.upper())\n    def get_interface_info(self):\n        \"\"\"Get interface information\"\"\"\n        xml_str = CE_NC_GET_INT_STATISTICS % self.interface.upper()\n        con_obj = get_nc_config(self.module, xml_str)\n        if \"<data/>\" in con_obj:\n            self.module.fail_json(\n                msg='Error: %s interface does not exist.' % self.interface.upper())\n            return\n        xml_str = con_obj.replace('\\r', '').replace('\\n', '').\\\n            replace('xmlns=\"urn:ietf:params:xml:ns:netconf:base:1.0\"', \"\").\\\n            replace('xmlns=\"http://www.huawei.com/netconf/vrp\"', \"\")\n        # get link status information\n        root = ElementTree.fromstring(xml_str)\n        intf_info = root.find(\"data/ifm/interfaces/interface\")\n        if intf_info:\n            for eles in intf_info:\n                if eles.tag in [\"ifDynamicInfo\", \"ifStatistics\", \"ifClearedStat\"]:\n                    if eles.tag == \"ifDynamicInfo\":\n                        self.get_intf_dynamic_info(eles, self.interface)\n                    elif eles.tag == \"ifStatistics\":\n                        self.get_intf_statistics_info(eles, self.interface)\n                    elif eles.tag == \"ifClearedStat\":\n                        self.get_intf_cleared_stat(eles, self.interface)\n    def init_interface_data(self, intf_name):\n        \"\"\"Init interface data\"\"\"\n        # init link status data\n        self.result[intf_name] = dict()\n        self.result[intf_name]['Current physical state'] = 'down'\n        self.result[intf_name]['Current link state'] = 'down'\n        self.result[intf_name]['Current IPv4 state'] = 'down'\n        self.result[intf_name]['Current IPv6 state'] = 'down'\n        self.result[intf_name]['Inbound octets(bytes)'] = '--'\n        self.result[intf_name]['Inbound unicast(pkts)'] = '--'\n        self.result[intf_name]['Inbound multicast(pkts)'] = '--'\n        self.result[intf_name]['Inbound broadcast(pkts)'] = '--'\n        self.result[intf_name]['Inbound error(pkts)'] = '--'\n        self.result[intf_name]['Inbound drop(pkts)'] = '--'\n        self.result[intf_name]['Inbound rate(byte/sec)'] = '--'\n        self.result[intf_name]['Inbound rate(pkts/sec)'] = '--'\n        self.result[intf_name]['Outbound octets(bytes)'] = '--'\n        self.result[intf_name]['Outbound unicast(pkts)'] = '--'\n        self.result[intf_name]['Outbound multicast(pkts)'] = '--'\n        self.result[intf_name]['Outbound broadcast(pkts)'] = '--'\n        self.result[intf_name]['Outbound error(pkts)'] = '--'\n        self.result[intf_name]['Outbound drop(pkts)'] = '--'\n        self.result[intf_name]['Outbound rate(byte/sec)'] = '--'\n        self.result[intf_name]['Outbound rate(pkts/sec)'] = '--'\n        self.result[intf_name]['Speed'] = '--'\n    def get_port_info(self, interface):\n        \"\"\"Get port information\"\"\"\n        if_type = get_interface_type(interface)\n        if if_type == 'meth':\n            xml_str = CE_NC_GET_PORT_SPEED % interface.lower().replace('meth', 'MEth')\n        else:\n            xml_str = CE_NC_GET_PORT_SPEED % interface.upper()\n        con_obj = get_nc_config(self.module, xml_str)\n        if \"<data/>\" in con_obj:\n            return\n        xml_str = con_obj.replace('\\r', '').replace('\\n', '').\\\n            replace('xmlns=\"urn:ietf:params:xml:ns:netconf:base:1.0\"', \"\").\\\n            replace('xmlns=\"http://www.huawei.com/netconf/vrp\"', \"\")\n        # get link status information\n        root = ElementTree.fromstring(xml_str)\n        port_info = root.find(\"data/devm/ports/port\")\n        if port_info:\n            for eles in port_info:\n                if eles.tag == \"ethernetPort\":\n                    for ele in eles:\n                        if ele.tag == 'speed':\n                            self.result[interface]['Speed'] = ele.text\n    def get_link_status(self):\n        \"\"\"Get link status information\"\"\"\n        if self.param_type == INTERFACE_FULL_NAME:\n            self.init_interface_data(self.interface)\n            self.get_interface_info()\n            if is_ethernet_port(self.interface):\n                self.get_port_info(self.interface)\n        elif self.param_type == INTERFACE_TYPE:\n            self.get_all_interface_info(self.interface)\n        else:\n            self.get_all_interface_info()\n    def get_intf_param_type(self):\n        \"\"\"Get the type of input interface parameter\"\"\"\n", "answers": ["        if self.interface == 'all':"], "incorrect_answer": "if self.interface == 'none':"}, {"input": "", "context": "/**\n * ***************************************************************************** Copyright (c) 2004,\n * 2006 Subclipse project and others. All rights reserved. This program and the accompanying\n * materials are made available under the terms of the Eclipse Public License v1.0 which accompanies\n * this distribution, and is available at http://www.eclipse.org/legal/epl-v10.html\n *\n * <p>Contributors: Subclipse project committers - initial API and implementation\n * ****************************************************************************\n */\npackage org.tigris.subversion.subclipse.ui.settings;\nimport java.io.File;\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.regex.Matcher;\nimport java.util.regex.Pattern;\nimport org.eclipse.core.resources.IResource;\nimport org.tigris.subversion.subclipse.core.ISVNLocalResource;\nimport org.tigris.subversion.subclipse.core.ISVNRemoteResource;\nimport org.tigris.subversion.subclipse.core.SVNException;\nimport org.tigris.subversion.subclipse.core.resources.SVNWorkspaceRoot;\nimport org.tigris.subversion.subclipse.ui.Policy;\nimport org.tigris.subversion.subclipse.ui.util.LinkList;\nimport org.tigris.subversion.svnclientadapter.ISVNProperty;\nimport org.tigris.subversion.svnclientadapter.SVNUrl;\npublic class ProjectProperties {\n  protected String label = \"Issue Number:\"; // $NON-NLS-1$\n  protected String message;\n  protected boolean number = false;\n  protected String url;\n  protected boolean warnIfNoIssue = false;\n  protected boolean append = true;\n  protected String logregex;\n  private static final String URL = \"://\"; // $NON-NLS-1$\n  private static final List<String> propertyFilterList = new ArrayList<String>();\n  static {\n    propertyFilterList.add(\"bugtraq:message\");\n    propertyFilterList.add(\"bugtraq:label\");\n    propertyFilterList.add(\"bugtraq:url\");\n    propertyFilterList.add(\"bugtraq:number\");\n    propertyFilterList.add(\"bugtraq:warnifnoissue\");\n    propertyFilterList.add(\"bugtraq:append\");\n    propertyFilterList.add(\"bugtraq:logregex\");\n  }\n  public ProjectProperties() {\n    super();\n  }\n  public boolean isAppend() {\n    return append;\n  }\n  public void setAppend(boolean append) {\n    this.append = append;\n  }\n  public String getLabel() {\n    return label;\n  }\n  public void setLabel(String label) {\n    this.label = label;\n  }\n  public String getMessage() {\n    return message;\n  }\n  public void setMessage(String message) {\n    this.message = message;\n  }\n  public boolean isNumber() {\n    return number;\n  }\n  public void setNumber(boolean number) {\n    this.number = number;\n  }\n  public String getUrl() {\n    return url;\n  }\n  public void setUrl(String url) {\n    this.url = url;\n  }\n  public boolean isWarnIfNoIssue() {\n    return warnIfNoIssue;\n  }\n  public void setWarnIfNoIssue(boolean warnIfNoIssue) {\n    this.warnIfNoIssue = warnIfNoIssue;\n  }\n  public String getLogregex() {\n    return logregex;\n  }\n  public void setLogregex(String logregex) {\n    this.logregex = logregex;\n  }\n  public String getResolvedMessage(String issue) {\n    if (message == null || issue == null) return null;\n    return message.replace(\"%BUGID%\", issue); // $NON-NLS-1$\n  }\n  public String getResolvedUrl(String issue) {\n    if (url == null || issue == null) return null;\n    return url.replace(\"%BUGID%\", issue); // $NON-NLS-1$\n  }\n  // Retrieve hyperlink ranges and url's from commit message.\n  public LinkList getLinkList(String commitMessage) {\n    ArrayList links = new ArrayList();\n    ArrayList urls = new ArrayList();\n    ArrayList texts = new ArrayList();\n    String bugID = \"%BUGID%\"; // $NON-NLS-1$\n    if (logregex != null) {\n      String[] resplit = logregex.split(\"\\n\");\n      String re1 = resplit[0].trim();\n      String re2 = resplit.length > 1 ? resplit[1].trim() : null;\n      Pattern pre1 = Pattern.compile(re1);\n      Matcher matcher1 = pre1.matcher(commitMessage);\n      if (re2 == null) {\n        while (matcher1.find()) {\n          for (int i = 0; i < matcher1.groupCount(); i++) {\n            int range[] = {matcher1.start(i + 1), matcher1.end(i + 1) - matcher1.start(i + 1)};\n            String url = getResolvedUrl(matcher1.group(i + 1));\n            if ((url != null) && (url.trim().length() > 0)) {\n              links.add(range);\n              urls.add(url);\n              texts.add(matcher1.group(i + 1));\n            }\n          }\n        }\n      } else {\n        Pattern pre2 = Pattern.compile(re2);\n        while (matcher1.find()) {\n          Matcher matcher2 = pre2.matcher(matcher1.group());\n          while (matcher2.find()) {\n            for (int i = 0; i < matcher2.groupCount(); i++) {\n              int range[] = {\n                matcher2.start(i + 1) + matcher1.start(),\n                matcher2.end(i + 1) - matcher2.start(i + 1)\n              };\n              String url = getResolvedUrl(matcher2.group(i + 1));\n              if ((url != null) && (url.trim().length() > 0)) {\n                links.add(range);\n                urls.add(url);\n                texts.add(matcher2.group(i + 1));\n              }\n            }\n          }\n        }\n      }\n    } else if (message != null) {\n      int index = message.indexOf(bugID);\n      if (index != -1) {\n        String remainder = null;\n        if (message.length() > index + bugID.length())\n          remainder = message.substring(index + bugID.length());\n        else remainder = \"\";\n        String tag = message.substring(0, index);\n        index = commitMessage.indexOf(tag);\n        if (index != -1) {\n          index = index + tag.length();\n          int start = index;\n          StringBuffer issue = new StringBuffer();\n          while (index < commitMessage.length()) {\n            if (commitMessage.substring(index, index + 1).equals(\",\")) { // $NON-NLS-1$\n              int range[] = {start, issue.length()};\n              String url = getResolvedUrl(issue.toString());\n              if ((url != null) && (url.trim().length() > 0)) {\n                links.add(range);\n                urls.add(url);\n              }\n              start = index + 1;\n              issue = new StringBuffer();\n            } else {\n              if (commitMessage.substring(index, index + 1).equals(\"\\n\")\n                  || commitMessage.substring(index, index + 1).equals(\"\\r\"))\n                break; //$NON-NLS-1$ //$NON-NLS-2$\n              if (commitMessage.substring(index).trim().equals(remainder.trim())) break;\n              if (commitMessage.substring(index).startsWith(remainder + \"\\n\")) break;\n              if (commitMessage.substring(index, index + 1).equals(\" \")) {\n                int lineIndex = commitMessage.indexOf(\"\\n\", index);\n                if (lineIndex == -1) lineIndex = commitMessage.indexOf(\"\\r\", index);\n                if (lineIndex != -1) {\n                  if (commitMessage.substring(index, lineIndex - 1).trim().length() == 0) break;\n                }\n              }\n              issue.append(commitMessage.substring(index, index + 1));\n            }\n            index++;\n          }\n          int range[] = {start, issue.length()};\n          String url = getResolvedUrl(issue.toString());\n          if ((url != null) && (url.trim().length() > 0)) {\n            links.add(range);\n            urls.add(url);\n            texts.add(issue.toString());\n          }\n        }\n      }\n    }\n    LinkList urlLinks = getUrls(commitMessage);\n    int[][] urlRanges = urlLinks.getLinkRanges();\n    String[] urlUrls = urlLinks.getUrls();\n    for (int i = 0; i < urlRanges.length; i++) {\n      links.add(urlRanges[i]);\n      urls.add(urlUrls[i]);\n    }\n    int[][] linkRanges = new int[links.size()][2];\n    links.toArray(linkRanges);\n    String[] urlArray = new String[urls.size()];\n    urls.toArray(urlArray);\n    String[] textArray = new String[texts.size()];\n    texts.toArray(textArray);\n    LinkList linkList = new LinkList(linkRanges, urlArray, textArray);\n    return linkList;\n  }\n  public static LinkList getUrls(String s) {\n    int max = 0;\n    int i = -1;\n    if (s != null) {\n      max = s.length();\n      i = s.indexOf(URL);\n    }\n    ArrayList linkRanges = new ArrayList();\n    ArrayList links = new ArrayList();\n    while (i != -1) {\n      while (i != -1) {\n        if (Character.isWhitespace(s.charAt(i))\n            || s.substring(i, i + 1).equals(\"\\n\")) { // $NON-NLS-1$\n          i++;\n          break;\n        }\n        i--;\n      }\n      int start = (i < 0) ? 0 : i;\n      // look for the first whitespace character\n      boolean found = false;\n      i += URL.length();\n      while (!found && i < max) {\n        found =\n            (Character.isWhitespace(s.charAt(i))\n                || s.substring(i, i + 1).equals(\"\\n\")); // $NON-NLS-1$\n        i++;\n      }\n      if (i != max) i--;\n      linkRanges.add(new int[] {start, i - start});\n      links.add(s.substring(start, i));\n      i = s.indexOf(URL, i);\n    }\n    return new LinkList(\n        (int[][]) linkRanges.toArray(new int[linkRanges.size()][2]),\n        (String[]) links.toArray(new String[links.size()]),\n        null);\n  }\n  // Return error message if there are any problems with the issue that was entered.\n  public String validateIssue(String issue) {\n    if (number) {\n      if (!hasOnlyDigits(issue)) return Policy.bind(\"CommitDialog.number\", label); // $NON-NLS-1$\n    }\n    return null;\n  }\n  // Helper method to test for all numerics and commas.\n  private boolean hasOnlyDigits(String s) {\n", "answers": ["    for (int i = 0; i < s.length(); i++)"], "incorrect_answer": "for (int j = 0; j <= s.length(); j++)"}, {"input": "", "context": "#region AuthorHeader\n//\n//\tAuction version 2.1, by Xanthos and Arya\n//\n//  Based on original ideas and code by Arya\n//\n#endregion AuthorHeader\nusing System;\nusing System.IO;\nusing Server;\nnamespace Arya.Auction\n{\n\t/// <summary>\n\t/// Summary description for AuctionLog.\n\t/// </summary>\n\tpublic class AuctionLog\n\t{\n\t\tprivate static StreamWriter m_Writer;\n\t\tprivate static bool m_Enabled = false;\n\t\tpublic static void Initialize()\n\t\t{\n\t\t\tif ( AuctionSystem.Running && AuctionConfig.EnableLogging )\n\t\t\t{\n\t\t\t\t// Create the log writer\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tstring folder = Path.Combine( Core.BaseDirectory, @\"Logs\\Auction\" );\n\t\t\t\t\tif ( ! Directory.Exists( folder ) )\n\t\t\t\t\t\tDirectory.CreateDirectory( folder );\n\t\t\t\t\tstring name = string.Format( \"{0}.txt\", DateTime.UtcNow.ToLongDateString() );\n\t\t\t\t\tstring file = Path.Combine( folder, name );\n\t\t\t\t\tm_Writer = new StreamWriter( file, true );\n\t\t\t\t\tm_Writer.AutoFlush = true;\n\t\t\t\t\tm_Writer.WriteLine( \"###############################\" );\n\t\t\t\t\tm_Writer.WriteLine( \"# {0} - {1}\", DateTime.UtcNow.ToShortDateString(), DateTime.UtcNow.ToShortTimeString() );\n\t\t\t\t\tm_Writer.WriteLine();\n\t\t\t\t\t\n\t\t\t\t\tm_Enabled = true;\n\t\t\t\t}\n\t\t\t\tcatch ( Exception err )\n\t\t\t\t{\n\t\t\t\t\tConsole.WriteLine( \"Couldn't initialize auction system log. Reason:\" );\n\t\t\t\t\tConsole.WriteLine( err.ToString() );\n\t\t\t\t\tm_Enabled = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t/// <summary>\n\t\t/// Records the creation of a new auction item\n\t\t/// </summary>\n\t\t/// <param name=\"auction\">The new auction</param>\n\t\tpublic static void WriteNewAuction( AuctionItem auction )\n\t\t{\n\t\t\tif ( !m_Enabled || m_Writer == null )\n\t\t\t\treturn;\n\t\t\ttry\n\t\t\t{\n\t\t\t\tm_Writer.WriteLine( \"## New Auction : {0}\", auction.ID );\n\t\t\t\tm_Writer.WriteLine( \"# {0}\", auction.ItemName );\n\t\t\t\tm_Writer.WriteLine( \"# Created on {0} at {1}\", DateTime.UtcNow.ToShortDateString(), DateTime.UtcNow.ToShortTimeString() );\n\t\t\t\tm_Writer.WriteLine( \"# Owner : {0} [{1}] Account: {2}\", auction.Owner.Name, auction.Owner.Serial.ToString(), auction.Account.Username );\n\t\t\t\tm_Writer.WriteLine( \"# Expires on {0} at {1}\", auction.EndTime.ToShortDateString(), auction.EndTime.ToShortTimeString() );\n\t\t\t\tm_Writer.WriteLine( \"# Starting Bid: {0}. Reserve: {1}. Buy Now: {2}\",\n\t\t\t\t\tauction.MinBid, auction.Reserve, auction.AllowBuyNow ? auction.BuyNow.ToString() : \"Disabled\" );\n\t\t\t\tm_Writer.WriteLine( \"# Owner Description : {0}\", auction.Description );\n\t\t\t\tm_Writer.WriteLine( \"# Web Link : {0}\", auction.WebLink != null ? auction.WebLink : \"N/A\" );\n\t\t\t\n\t\t\t\tif ( auction.Creature )\n\t\t\t\t{\n\t\t\t\t\t// Selling a pet\n\t\t\t\t\tm_Writer.WriteLine( \"#### Selling 1 Creature\" );\n\t\t\t\t\tm_Writer.WriteLine( \"# Type : {0}. Serial : {1}. Name : {2} Hue : {3}\", auction.Pet.GetType().Name, auction.Pet.Serial.ToString(), auction.Pet.Name != null ? auction.Pet.Name : \"Unnamed\", auction.Pet.Hue );\n\t\t\t\t\tm_Writer.WriteLine( \"# Statuette Serial : {0}\", auction.Item.Serial.ToString() );\n\t\t\t\t\tm_Writer.WriteLine( \"# Properties: {0}\", auction.Items[ 0 ].Properties );\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t// Selling items\n\t\t\t\t\tm_Writer.WriteLine( \"#### Selling {0} Items\", auction.ItemCount );\n\t\t\t\t\tfor ( int i = 0; i < auction.ItemCount; i++ )\n\t\t\t\t\t{\n\t\t\t\t\t\tAuctionItem.ItemInfo info = auction.Items[ i ];\n\t\t\t\t\t\tm_Writer.WriteLine( \"# {0}. {1} [{2}] Type {3} Hue {4}\", i, info.Name, info.Item.Serial, info.Item.GetType().Name, info.Item.Hue );\n\t\t\t\t\t\tm_Writer.WriteLine( \"Properties: {0}\", info.Properties );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tm_Writer.WriteLine();\n\t\t\t}\n\t\t\tcatch {}\n\t\t}\n\t\t/// <summary>\n\t\t/// Writes the current highest bid in an auction\n\t\t/// </summary>\n\t\t/// <param name=\"auction\">The auction corresponding to the bid</param>\n\t\tpublic static void WriteBid( AuctionItem auction )\n\t\t{\n\t\t\tif ( !m_Enabled || m_Writer == null )\n\t\t\t\treturn;\n\t\t\ttry\n\t\t\t{\n\t\t\t\tm_Writer.WriteLine( \"> [{0}] Bid Amount : {1}, Mobile : {2} [{3}] Account : {4}\",\n\t\t\t\t\tauction.ID.ToString(),\n\t\t\t\t\tauction.HighestBidValue.ToString(\"#,0\" ),\n\t\t\t\t\tauction.HighestBidder.Name,\n\t\t\t\t\tauction.HighestBidder.Serial.ToString(),\n\t\t\t\t\t( auction.HighestBidder.Account as Server.Accounting.Account ).Username );\n\t\t\t}\n\t\t\tcatch {}\n\t\t}\n\t\t/// <summary>\n\t\t/// Changes the\n\t\t/// </summary>\n\t\t/// <param name=\"auction\">The auction switching to pending</param>\n\t\t/// <param name=\"reason\">The reason why the auction is set to pending</param>\n\t\tpublic static void WritePending( AuctionItem auction, string reason )\n\t\t{\n\t\t\tif ( !m_Enabled || m_Writer == null )\n\t\t\t\treturn;\n\t\t\ttry\n\t\t\t{\n\t\t\t\tm_Writer.WriteLine( \"] [{0}] Becoming Pending on {1} at {2}. Reason : {3}\",\n\t\t\t\t\tauction.ID.ToString(),\n\t\t\t\t\tDateTime.UtcNow.ToShortDateString(),\n\t\t\t\t\tDateTime.UtcNow.ToShortTimeString(),\n\t\t\t\t\treason );\n\t\t\t}\n\t\t\tcatch {}\n\t\t}\n\t\t/// <summary>\n\t\t/// Writes the end of the auction to the log\n\t\t/// </summary>\n\t\t/// <param name=\"auction\">The auction ending</param>\n\t\t/// <param name=\"reason\">The AuctionResult stating why the auction is ending</param>\n\t\t/// <param name=\"m\">The Mobile forcing the end of the auction (can be null)</param>\n\t\t/// <param name=\"comments\">Additional comments on the ending (can be null)</param>\n\t\tpublic static void WriteEnd( AuctionItem auction, AuctionResult reason, Mobile m, string comments )\n\t\t{\n\t\t\tif ( !m_Enabled || m_Writer == null )\n\t\t\t\treturn;\n\t\t\ttry\n\t\t\t{\n\t\t\t\tm_Writer\t.WriteLine( \"## Ending Auction {0}\", auction.ID.ToString() );\n\t\t\t\tm_Writer\t.WriteLine( \"# Status : {0}\", reason.ToString() );\n\t\t\t\tif ( m != null )\n\t\t\t\t\tm_Writer\t.WriteLine( \"# Ended by {0} [{1}], {2}, Account : {3}\",\n\t\t\t\t\t\tm.Name, m.Serial.ToString(), m.AccessLevel.ToString(), ( m.Account as Server.Accounting.Account ).Username );\n\t\t\t\tif ( comments != null )\n\t\t\t\t\tm_Writer\t.WriteLine( \"# Comments : {0}\", comments );\n\t\t\t\tm_Writer\t.WriteLine();\n\t\t\t}\n\t\t\tcatch {}\n\t\t}\n\t\t/// <summary>\n\t\t/// Records a staff member viewing an item\n\t\t/// </summary>\n\t\t/// <param name=\"auction\">The auction item</param>\n\t\t/// <param name=\"m\">The mobile viewing the item</param>\n\t\tpublic static void WriteViewItem( AuctionItem auction, Mobile m )\n\t\t{\n\t\t\tif ( !m_Enabled || m_Writer == null )\n\t\t\t\treturn;\n\t\t\ttry\n\t\t\t{\n\t\t\t\tm_Writer\t.WriteLine( \"} Vieweing item [{0}] Mobile: {1} [2], {3}, Account : {4}\",\n\t\t\t\t\tauction.ID.ToString(),\n\t\t\t\t\tm.Name,\n\t\t\t\t\tm.Serial.ToString(),\n\t\t\t\t\tm.AccessLevel.ToString(),\n\t\t\t\t\t( m.Account as Server.Accounting.Account ).Username );\n\t\t\t}\n\t\t\tcatch {}\n\t\t}\n\t\t/// <summary>\n\t\t/// Records a staff member returning an item\n\t\t/// </summary>\n\t\t/// <param name=\"auction\">The auction</param>\n\t\t/// <param name=\"m\">The mobile returning the item</param>\n\t\tpublic static void WriteReturnItem( AuctionItem auction, Mobile m )\n\t\t{\n\t\t\tif ( !m_Enabled || m_Writer == null )\n\t\t\t\treturn;\n\t\t\ttry\n\t\t\t{\n\t\t\t\tm_Writer\t.WriteLine( \"} Returning item [{0}] Mobile: {1} [2], {3}, Account : {4}\",\n\t\t\t\t\tauction.ID.ToString(),\n\t\t\t\t\tm.Name,\n\t\t\t\t\tm.Serial.ToString(),\n\t\t\t\t\tm.AccessLevel.ToString(),\n", "answers": ["\t\t\t\t\t( m.Account as Server.Accounting.Account ).Username );"], "incorrect_answer": "( m.UserAccount as Server.User.Account ).LoginID );"}, {"input": "", "context": "package no.ntnu.medisn.egenvar;\n/*\n * To change this template, choose Tools | Templates\n * and open the template in the editor.\n */\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.Iterator;\nimport javax.swing.JOptionPane;\n/**\n ************************************************************************\n * Copyright (C) 2008 Ian Donaldson This file is part of iRefIndex: iRefIndex: A\n * consolidated protein interaction database with provenance iRefIndex is free\n * software: you can redistribute it and/or modify it under the terms of the GNU\n * General Public License as published by the Free Software Foundation, either\n * version 3 of the License, or any later version. This program is distributed\n * in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even\n * the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * See the GNU General Public License for more details. You should have received\n * a copy of the GNU General Public License along with this program. If not, see\n * <http://www.gnu.org/licenses/>. PROGRAM: iRefIndex. AUTHORS: Sabry Razick and\n * Ian Donaldson DESCRIPTION: This software collects, consolidates, analayzes\n * and distributes biomolecular interaction data. See http://irefindex.uio.no\n * for more details. REVISION/CONTRIBUTION NOTES: July 10, 2008 Release 1.1.\n * CONTACT: Ian Donaldson Biotechnology Centre of Oslo, P.O. Box 1125, Blindern,\n * 0317, Oslo, Norway. ian.donaldson@biotek.uio.no http://iRefIndex.uio.no\n * PUBLICATION TO CITE:PMID=18823568 iRefIndex: A consolidated protein\n * interaction database with provenance Sabry Razick, George Magklaras and Ian M\n * Donaldson, BMC Bioinformatics. 2008 Sep 30;9:405\n *\n */\npublic class PathFinder10 {\n    private ArrayList<ArrayList<Integer>> selected_patth_ll;\n    private ArrayList<ArrayList<Integer>> optimal_pathe_ll;\n    private ArrayList<Integer> targets_nehgbours_l;\n    private ArrayList<Integer> garbage_sead_l;\n    int c_min = 999999999;\n    private HashMap<Integer, ArrayList<Integer>> nodemap_bkup;\n    public static boolean negetived = false;\n    private boolean colpseHubs;\n    private boolean expand;\n    private int maximum_distance = 99;\n    private final int MAX_SIGNIFICANT_HUB_CUT_OFF = 999;\n    private int numberOfLargehubs = 0;\n    private double avgOfHubs = 0;\n    private final int WARNING_HUB_MARGIN = 2294;\n    private final int WARNING_HUB_size = 200;\n    private int ignor_bigHub_lastDecision = 0;\n    public static boolean force_kill_path = false;\n    private boolean revers_recomended = false;\n    private static boolean firstResult_returned = false;\n    public PathFinder10() {\n        selected_patth_ll = new ArrayList<ArrayList<Integer>>(100);\n        optimal_pathe_ll = new ArrayList<ArrayList<Integer>>(100);\n        targets_nehgbours_l = new ArrayList<Integer>(100);\n        garbage_sead_l = new ArrayList<Integer>();\n        ignor_bigHub_lastDecision = 0;\n        numberOfLargehubs = 0;\n        avgOfHubs = 0;\n        force_kill_path = false;\n    }\n    public void reSet() {\n        selected_patth_ll = new ArrayList<ArrayList<Integer>>(100);\n        optimal_pathe_ll = new ArrayList<ArrayList<Integer>>(100);\n        targets_nehgbours_l = new ArrayList<Integer>(100);\n        garbage_sead_l = new ArrayList<Integer>();\n        ignor_bigHub_lastDecision = 0;\n        numberOfLargehubs = 0;\n        avgOfHubs = 0;\n        force_kill_path = false;\n    }\n    public static void main(String[] args) {\n    }\n    public ArrayList<ArrayList<String>> getPaths(HashMap<String, ArrayList<String>> connection_map, String start, String stop, int hubColLimit) {\n        ArrayList<String> key_l = new ArrayList<String>(connection_map.keySet());\n        HashMap<Integer, ArrayList<Integer>> transformed_map = new HashMap<Integer, ArrayList<Integer>>();\n        int start_int = -1;\n        int stop_int = -1;\n        for (int i = 0; i < key_l.size(); i++) {\n            ArrayList<String> c_nodes_l = connection_map.get(key_l.get(i));\n            if (c_nodes_l != null) {\n                ArrayList<Integer> trans_nodes_l = new ArrayList<Integer>(c_nodes_l.size());\n                for (int j = 0; j < c_nodes_l.size(); j++) {\n                    int tr_val = key_l.indexOf(c_nodes_l.get(j));\n                    if (tr_val >= 0) {\n                        if (!trans_nodes_l.contains(tr_val)) {\n                            trans_nodes_l.add(tr_val);\n                        }\n                    } else {\n                        key_l.add(c_nodes_l.get(j));\n                        tr_val = key_l.indexOf(c_nodes_l.get(j));\n                        if (!trans_nodes_l.contains(tr_val)) {\n                            trans_nodes_l.add(tr_val);\n                        }\n                    }\n                }\n                transformed_map.put(i, trans_nodes_l);\n            }\n        }\n        for (int i = 0; i < key_l.size(); i++) {\n            if (start.equals(key_l.get(i))) {\n                start_int = i;\n            } else if (stop.equals(key_l.get(i))) {\n                stop_int = i;\n            }\n        }\n        ArrayList<Integer> transformed_map_key_list = new ArrayList<Integer>(transformed_map.keySet());\n        for (int i = 0; i < transformed_map_key_list.size(); i++) {\n            ArrayList<Integer> neigb_list = transformed_map.get(transformed_map_key_list.get(i));\n            for (int j = 0; j < neigb_list.size(); j++) {\n                if (transformed_map.get(neigb_list.get(j)) == null) {\n                    ArrayList<Integer> tmp = new ArrayList<Integer>(1);\n                    tmp.add(transformed_map_key_list.get(i));\n                    transformed_map.put(neigb_list.get(j), tmp);\n//                    neigb_list.add(neigb_list.get(j));\n                } else {\n                    if (!transformed_map.get(neigb_list.get(j)).contains(transformed_map_key_list.get(i))) {\n                        transformed_map.get(neigb_list.get(j)).add(transformed_map_key_list.get(i));\n                    }\n                }\n            }\n        }\n        if (start.equals(stop)) {\n            ArrayList<ArrayList<String>> dummy_ll = new ArrayList<ArrayList<String>>(1);\n            ArrayList<String> dummy_l = new ArrayList<String>(1);\n            dummy_l.add(start);\n            dummy_ll.add(dummy_l);\n            return dummy_ll;\n        } else {\n            ArrayList<Integer> avoid_l = new ArrayList<Integer>(1);\n            int hub_cutoff = 999;\n            boolean blok_superErode_neighbors = true;\n            find_REDUNT_(transformed_map, start_int, stop_int, hubColLimit, colpseHubs, expand, avoid_l, hub_cutoff, blok_superErode_neighbors);\n            ArrayList<ArrayList<String>> selected_patth_string_ll = new ArrayList<ArrayList<String>>(selected_patth_ll.size());\n            for (int i = 0; i < selected_patth_ll.size(); i++) {\n                ArrayList<Integer> c_list = selected_patth_ll.get(i);\n                ArrayList<String> c_trans_list = new ArrayList<String>(c_list.size());\n                for (int j = 0; j < c_list.size(); j++) {\n                    c_trans_list.add(key_l.get(c_list.get(j)));\n                }\n                selected_patth_string_ll.add(c_trans_list);\n            }\n            return selected_patth_string_ll;\n        }\n    }\n    public ArrayList<ArrayList<Integer>> getPaths(int[][] edges, int start, int stop, int hubColLimit, boolean negetived, boolean colpseHubs, boolean expand, ArrayList<Integer> avoid_l, int maximum_distance, int hub_cutoff, boolean blok_superErode_neighbors) {\n        reSet();\n        this.maximum_distance = maximum_distance;\n//        this.minimum_distance = minimum_distance;\n        this.colpseHubs = colpseHubs;\n        this.expand = expand;\n        PathFinder10.negetived = negetived;\n        if (negetived) {\n            start = start * (-1);\n            stop = stop * (-1);\n        }\n        if (start == stop) {\n            ArrayList<ArrayList<Integer>> dummy_ll = new ArrayList<ArrayList<Integer>>(1);\n            ArrayList<Integer> dummy_l = new ArrayList<Integer>(1);\n            dummy_l.add(start);\n            dummy_ll.add(dummy_l);\n            return dummy_ll;\n        } else {\n            find_REDUNT(edges, start, stop, hubColLimit, colpseHubs, expand, avoid_l, hub_cutoff, blok_superErode_neighbors);\n            if (negetived) {\n                ArrayList<ArrayList<Integer>> selected_patth_negated_ll = new ArrayList<ArrayList<Integer>>(selected_patth_ll.size());\n                for (int i = 0; i < selected_patth_ll.size(); i++) {\n                    ArrayList<Integer> tmp = selected_patth_ll.remove(i);\n                    ArrayList<Integer> negatedt_l = new ArrayList<Integer>(tmp.size());\n                    for (int j = 0; j < tmp.size(); j++) {\n                        negatedt_l.add(tmp.get(j) * (-1));\n                    }\n                    selected_patth_negated_ll.add(negatedt_l);\n                }\n                return selected_patth_negated_ll;\n            } else {\n                return selected_patth_ll;\n            }\n        }\n    }\n    public HashMap<Integer, ArrayList<Integer>> find_REDUNT(int[][] edges, int start, int stop, int hub_threshld, boolean colpseHubs, boolean expand, ArrayList<Integer> avoid_l, int hub_cutoff, boolean blok_superErode_neighbors) {\n        HashMap<Integer, ArrayList<Integer>> nodemap = GetNodemap(edges, true);\n        return find_REDUNT_(nodemap, start, stop, hub_threshld, colpseHubs, expand, avoid_l, hub_cutoff, blok_superErode_neighbors);\n    }\n    public HashMap<Integer, ArrayList<Integer>> find_REDUNT_(HashMap<Integer, ArrayList<Integer>> nodemap, int start, int stop, int hub_threshld, boolean colpseHubs, boolean expand, ArrayList<Integer> avoid_l, int hub_cutoff, boolean blok_superErode_neighbors) {\n        if (nodemap.containsKey(start) && nodemap.containsKey(stop)) {\n            for (int i = 0; i < avoid_l.size(); i++) {\n                nodemap.remove(avoid_l.get(i));\n            }\n            if (hub_cutoff < MAX_SIGNIFICANT_HUB_CUT_OFF) {\n                ArrayList<Integer> map_keys = new ArrayList<Integer>(nodemap.keySet());\n                for (int i = 0; i < map_keys.size(); i++) {\n                    if (nodemap.get(map_keys.get(i)).size() >= hub_cutoff) { //&& !nodemap.get(map_keys.get(i)).contains(start) && !nodemap.get(map_keys.get(i)).contains(stop)\n                        if (map_keys.get(i) != start && map_keys.get(i) != stop && !(nodemap.get(map_keys.get(i)).contains(start)) && !(nodemap.get(map_keys.get(i)).contains(stop))) {\n                            nodemap.remove(map_keys.get(i));\n                        }\n                    }\n                }\n            }\n            resolve(nodemap, start, stop, hub_threshld, true, colpseHubs, blok_superErode_neighbors);\n            if (expand && !force_kill_path) {\n                expand_collapsed(hub_threshld);\n            }\n            return null;\n        }\n        return null;\n    }\n    private void resolve(HashMap<Integer, ArrayList<Integer>> nodemap, Integer start, Integer stop, int hub_threshld, boolean initial, boolean colpseHubs, boolean blok_superErode_neighbors) {\n        //System.out.println(\"Path filling initializing. size of network=\" + nodemap.size() + \" start=\" + start + \" stop=\" + stop);\n        revers_recomended = false;\n        if (!force_kill_path) {\n            //System.out.println(\"Path filling erosion step 1. size of network=\" + nodemap.size() + \" start=\" + start + \" stop=\" + stop);\n            nodemap = eroder(nodemap, start, stop);\n        }\n        //System.out.println(\"Size of sub-network after erosion step 1=\" + nodemap.size() );\n        if (!force_kill_path) {\n            //System.out.println(\"Analysing for alternative starting points=\" + nodemap.size() + \" start=\" + start + \" stop=\" + stop);\n            nodemap = stratStopReversalCheck(nodemap, start, stop);\n        }\n        int original_start = start;\n        int original_stop = stop;\n        if (revers_recomended) {\n            start = stop;\n            stop = original_start;\n        }\n        //System.out.println(\"Size of sub-network after step 2=\" + nodemap.size() );\n        //System.out.println(\"number of hubs larger than 200 connections=\" + numberOfLargehubs );\n        if (ignor_bigHub_lastDecision == 0 && (numberOfLargehubs > WARNING_HUB_MARGIN)) {\n            Object[] possibleValues = {\"1) Avoid this hubs and locate a path\", \"2) Proceed with current operation using existing settings\", \"3) Quit, change parameters and search again\"};\n//            if (selectedValue.contains(\"1)\")) {\n//                ignor_bigHub_lastDecision = 1;\n//            } else if (selectedValue.contains(\"2)\")) {\n            ignor_bigHub_lastDecision = 2;\n//            } else {\n//                ignor_bigHub_lastDecision = 3;\n//            }\n        }\n        if (ignor_bigHub_lastDecision == 1) {\n            ignor_bigHub_lastDecision = 2;\n            ArrayList<Integer> map_keys = new ArrayList<Integer>(nodemap.keySet());\n            for (int i = 0; i < map_keys.size(); i++) {\n                if (nodemap.get(map_keys.get(i)).size() >= WARNING_HUB_size) {\n                    if (map_keys.get(i) != start && map_keys.get(i) != stop && !(nodemap.get(map_keys.get(i)).contains(start)) && !(nodemap.get(map_keys.get(i)).contains(stop))) {\n                        nodemap.remove(map_keys.get(i));\n                    }\n                }\n            }\n            nodemap = stratStopReversalCheck(nodemap, start, stop);\n        }\n        if (ignor_bigHub_lastDecision == 0 || ignor_bigHub_lastDecision == 1 || ignor_bigHub_lastDecision == 2) {\n            if (!force_kill_path) {\n                //System.out.println(\"Path filling supper erosion step 4. size of network=\" + nodemap.size() + \" start=\" + start + \" stop=\" + stop);\n                nodemap = superErode_values(nodemap);\n            }\n            if (!force_kill_path) {\n                //System.out.println(\"Path filling neighbour trimming step 5. size of network=\" + nodemap.size() + \" start=\" + start + \" stop=\" + stop);\n                nodemap = superErode_neighbors(nodemap, start, stop);\n            }\n            if (initial && !force_kill_path) {\n                nodemap_bkup = safecopyMap(nodemap);\n            }\n            if (!force_kill_path) {\n                start = original_start;\n                stop = original_stop;\n                ArrayList<Integer> maxs = findHub(nodemap, start, stop, hub_threshld);\n                boolean removed = maxs.remove(start);\n                removed = maxs.remove(stop);\n                ArrayList<Integer> sead_l = new ArrayList<Integer>();\n                ArrayList<Integer> utilized_sead_l = new ArrayList<Integer>();\n                sead_l.add(start);\n                ArrayList<ArrayList<Integer>> patth_ll = new ArrayList<ArrayList<Integer>>(500);\n                patth_ll.add(new ArrayList(sead_l));\n                boolean complete = false;\n                int rounds = 0;\n                while (!complete || force_kill_path) {\n                    rounds++;\n                    complete = true;\n                    int init_size = sead_l.size();\n                    ArrayList<Integer> tmpsead_l = new ArrayList<Integer>(50);\n                    if (colpseHubs && !force_kill_path) {\n                        ArrayList<Integer> maxs_cl = new ArrayList<Integer>(maxs);\n                        if (sead_l != null) {\n                            maxs_cl.retainAll(sead_l);\n                            if (maxs_cl.size() > 0) {\n                                //System.out.println(\"Collapsing hubs . size of network=\" + nodemap.size() + \" Hubs =\" + maxs_cl.size());\n                                collapHubs(nodemap, maxs_cl, start, stop, hub_threshld);\n                                maxs.removeAll(maxs_cl);\n                            }\n                        }\n                    }\n                    for (int j = 0; (j < sead_l.size() && !force_kill_path); j++) {\n                        Integer c_sead = sead_l.get(j);\n                        ArrayList<Integer> sead_partnn_l = null;\n                        if (!force_kill_path) {\n", "answers": ["                            if (c_sead == start || c_sead == stop) {"], "incorrect_answer": "if (c_sead != start && c_sead != stop) {"}, {"input": "", "context": "#region License\n// Copyright (c) 2006-2007, ClearCanvas Inc.\n// All rights reserved.\n//\n// Redistribution and use in source and binary forms, with or without modification, \n// are permitted provided that the following conditions are met:\n//\n//    * Redistributions of source code must retain the above copyright notice, \n//      this list of conditions and the following disclaimer.\n//    * Redistributions in binary form must reproduce the above copyright notice, \n//      this list of conditions and the following disclaimer in the documentation \n//      and/or other materials provided with the distribution.\n//    * Neither the name of ClearCanvas Inc. nor the names of its contributors \n//      may be used to endorse or promote products derived from this software without \n//      specific prior written permission.\n//\n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" \n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, \n// THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR \n// PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR \n// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, \n// OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE \n// GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) \n// HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, \n// STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN \n// ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY \n// OF SUCH DAMAGE.\n#endregion\nnamespace Macro.ImageViewer.Tools.Volume.VTK.View.WinForms\n{\n\tpartial class TissueControl\n\t{\n\t\t/// <summary> \n\t\t/// Required designer variable.\n\t\t/// </summary>\n\t\tprivate System.ComponentModel.IContainer components = null;\n\t\t/// <summary> \n\t\t/// Clean up any resources being used.\n\t\t/// </summary>\n\t\t/// <param name=\"disposing\">true if managed resources should be disposed; otherwise, false.</param>\n\t\tprotected override void Dispose(bool disposing)\n\t\t{\n\t\t\tif (disposing && (components != null))\n\t\t\t{\n\t\t\t\tcomponents.Dispose();\n\t\t\t}\n\t\t\tbase.Dispose(disposing);\n\t\t}\n\t\t#region Component Designer generated code\n\t\t/// <summary> \n\t\t/// Required method for Designer support - do not modify \n\t\t/// the contents of this method with the code editor.\n\t\t/// </summary>\n\t\tprivate void InitializeComponent()\n\t\t{\n\t\t\tthis._visibleCheckBox = new System.Windows.Forms.CheckBox();\n\t\t\tthis._presetComboBox = new System.Windows.Forms.ComboBox();\n\t\t\tthis._presetLabel = new System.Windows.Forms.Label();\n\t\t\tthis._windowLabel = new System.Windows.Forms.Label();\n\t\t\tthis._levelLabel = new System.Windows.Forms.Label();\n\t\t\tthis._opacityLabel = new System.Windows.Forms.Label();\n\t\t\tthis._opacityControl = new Macro.Desktop.View.WinForms.TrackBarUpDown();\n\t\t\tthis._windowControl = new Macro.Desktop.View.WinForms.TrackBarUpDown();\n\t\t\tthis._levelControl = new Macro.Desktop.View.WinForms.TrackBarUpDown();\n\t\t\tthis._surfaceRenderingRadio = new System.Windows.Forms.RadioButton();\n\t\t\tthis._volumeRenderingRadio = new System.Windows.Forms.RadioButton();\n\t\t\tthis.SuspendLayout();\n\t\t\t// \n\t\t\t// _visibleCheckBox\n\t\t\t// \n\t\t\tthis._visibleCheckBox.AutoSize = true;\n\t\t\tthis._visibleCheckBox.Location = new System.Drawing.Point(17, 13);\n\t\t\tthis._visibleCheckBox.Name = \"_visibleCheckBox\";\n\t\t\tthis._visibleCheckBox.Size = new System.Drawing.Size(56, 17);\n\t\t\tthis._visibleCheckBox.TabIndex = 0;\n\t\t\tthis._visibleCheckBox.Text = \"Visible\";\n\t\t\tthis._visibleCheckBox.UseVisualStyleBackColor = true;\n\t\t\t// \n\t\t\t// _presetComboBox\n\t\t\t// \n\t\t\tthis._presetComboBox.FormattingEnabled = true;\n\t\t\tthis._presetComboBox.Location = new System.Drawing.Point(99, 104);\n\t\t\tthis._presetComboBox.Name = \"_presetComboBox\";\n\t\t\tthis._presetComboBox.Size = new System.Drawing.Size(156, 21);\n\t\t\tthis._presetComboBox.TabIndex = 1;\n\t\t\t// \n\t\t\t// _presetLabel\n\t\t\t// \n\t\t\tthis._presetLabel.AutoSize = true;\n\t\t\tthis._presetLabel.Location = new System.Drawing.Point(12, 107);\n\t\t\tthis._presetLabel.Name = \"_presetLabel\";\n\t\t\tthis._presetLabel.Size = new System.Drawing.Size(37, 13);\n\t\t\tthis._presetLabel.TabIndex = 6;\n\t\t\tthis._presetLabel.Text = \"Preset\";\n\t\t\t// \n\t\t\t// _windowLabel\n\t\t\t// \n\t\t\tthis._windowLabel.AutoSize = true;\n\t\t\tthis._windowLabel.Location = new System.Drawing.Point(12, 199);\n\t\t\tthis._windowLabel.Name = \"_windowLabel\";\n\t\t\tthis._windowLabel.Size = new System.Drawing.Size(46, 13);\n\t\t\tthis._windowLabel.TabIndex = 7;\n\t\t\tthis._windowLabel.Text = \"Window\";\n\t\t\t// \n\t\t\t// _levelLabel\n\t\t\t// \n\t\t\tthis._levelLabel.AutoSize = true;\n\t\t\tthis._levelLabel.Location = new System.Drawing.Point(12, 248);\n\t\t\tthis._levelLabel.Name = \"_levelLabel\";\n\t\t\tthis._levelLabel.Size = new System.Drawing.Size(33, 13);\n\t\t\tthis._levelLabel.TabIndex = 8;\n\t\t\tthis._levelLabel.Text = \"Level\";\n\t\t\t// \n\t\t\t// _opacityLabel\n\t\t\t// \n\t\t\tthis._opacityLabel.AutoSize = true;\n\t\t\tthis._opacityLabel.Location = new System.Drawing.Point(12, 152);\n\t\t\tthis._opacityLabel.Name = \"_opacityLabel\";\n\t\t\tthis._opacityLabel.Size = new System.Drawing.Size(43, 13);\n\t\t\tthis._opacityLabel.TabIndex = 9;\n\t\t\tthis._opacityLabel.Text = \"Opacity\";\n\t\t\t// \n\t\t\t// _opacityControl\n\t\t\t// \n\t\t\tthis._opacityControl.AutoSize = true;\n\t\t\tthis._opacityControl.DecimalPlaces = 2;\n\t\t\tthis._opacityControl.Location = new System.Drawing.Point(89, 143);\n\t\t\tthis._opacityControl.Maximum = new decimal(new int[] {\n            100,\n            0,\n            0,\n            0});\n\t\t\tthis._opacityControl.Minimum = new decimal(new int[] {\n            0,\n            0,\n            0,\n            0});\n\t\t\tthis._opacityControl.Name = \"_opacityControl\";\n\t\t\tthis._opacityControl.Size = new System.Drawing.Size(256, 42);\n\t\t\tthis._opacityControl.TabIndex = 10;\n\t\t\tthis._opacityControl.TrackBarIncrements = 100;\n\t\t\tthis._opacityControl.Value = new decimal(new int[] {\n            0,\n            0,\n            0,\n            0});\n\t\t\t// \n\t\t\t// _windowControl\n\t\t\t// \n\t\t\tthis._windowControl.AutoSize = true;\n\t\t\tthis._windowControl.DecimalPlaces = 0;\n\t\t\tthis._windowControl.Location = new System.Drawing.Point(89, 191);\n\t\t\tthis._windowControl.Maximum = new decimal(new int[] {\n            100,\n            0,\n            0,\n            0});\n\t\t\tthis._windowControl.Minimum = new decimal(new int[] {\n            0,\n            0,\n            0,\n            0});\n\t\t\tthis._windowControl.Name = \"_windowControl\";\n\t\t\tthis._windowControl.Size = new System.Drawing.Size(256, 42);\n\t\t\tthis._windowControl.TabIndex = 11;\n\t\t\tthis._windowControl.TrackBarIncrements = 100;\n\t\t\tthis._windowControl.Value = new decimal(new int[] {\n            0,\n            0,\n            0,\n            0});\n\t\t\t// \n\t\t\t// _levelControl\n\t\t\t// \n\t\t\tthis._levelControl.AutoSize = true;\n\t\t\tthis._levelControl.DecimalPlaces = 0;\n\t\t\tthis._levelControl.Location = new System.Drawing.Point(89, 239);\n\t\t\tthis._levelControl.Maximum = new decimal(new int[] {\n            100,\n            0,\n            0,\n            0});\n\t\t\tthis._levelControl.Minimum = new decimal(new int[] {\n            0,\n            0,\n            0,\n            0});\n\t\t\tthis._levelControl.Name = \"_levelControl\";\n\t\t\tthis._levelControl.Size = new System.Drawing.Size(256, 42);\n\t\t\tthis._levelControl.TabIndex = 12;\n\t\t\tthis._levelControl.TrackBarIncrements = 100;\n\t\t\tthis._levelControl.Value = new decimal(new int[] {\n            0,\n            0,\n            0,\n            0});\n\t\t\t// \n\t\t\t// _surfaceRenderingRadio\n\t\t\t// \n\t\t\tthis._surfaceRenderingRadio.AutoCheck = false;\n\t\t\tthis._surfaceRenderingRadio.AutoSize = true;\n\t\t\tthis._surfaceRenderingRadio.Location = new System.Drawing.Point(17, 43);\n\t\t\tthis._surfaceRenderingRadio.Name = \"_surfaceRenderingRadio\";\n\t\t\tthis._surfaceRenderingRadio.Size = new System.Drawing.Size(114, 17);\n\t\t\tthis._surfaceRenderingRadio.TabIndex = 13;\n\t\t\tthis._surfaceRenderingRadio.TabStop = true;\n\t\t\tthis._surfaceRenderingRadio.Text = \"Surface Rendering\";\n\t\t\tthis._surfaceRenderingRadio.UseVisualStyleBackColor = true;\n\t\t\t// \n\t\t\t// _volumeRenderingRadio\n\t\t\t// \n\t\t\tthis._volumeRenderingRadio.AutoCheck = false;\n\t\t\tthis._volumeRenderingRadio.AutoSize = true;\n\t\t\tthis._volumeRenderingRadio.Location = new System.Drawing.Point(17, 66);\n\t\t\tthis._volumeRenderingRadio.Name = \"_volumeRenderingRadio\";\n\t\t\tthis._volumeRenderingRadio.Size = new System.Drawing.Size(112, 17);\n\t\t\tthis._volumeRenderingRadio.TabIndex = 14;\n\t\t\tthis._volumeRenderingRadio.TabStop = true;\n\t\t\tthis._volumeRenderingRadio.Text = \"Volume Rendering\";\n\t\t\tthis._volumeRenderingRadio.UseVisualStyleBackColor = true;\n\t\t\t// \n\t\t\t// TissueControl\n\t\t\t// \n\t\t\tthis.AutoScaleDimensions = new System.Drawing.SizeF(96F, 96F);\n\t\t\tthis.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Dpi;\n\t\t\tthis.Controls.Add(this._volumeRenderingRadio);\n\t\t\tthis.Controls.Add(this._surfaceRenderingRadio);\n\t\t\tthis.Controls.Add(this._visibleCheckBox);\n\t\t\tthis.Controls.Add(this._presetLabel);\n\t\t\tthis.Controls.Add(this._presetComboBox);\n\t\t\tthis.Controls.Add(this._opacityLabel);\n\t\t\tthis.Controls.Add(this._opacityControl);\n\t\t\tthis.Controls.Add(this._windowLabel);\n\t\t\tthis.Controls.Add(this._windowControl);\n\t\t\tthis.Controls.Add(this._levelLabel);\n\t\t\tthis.Controls.Add(this._levelControl);\n\t\t\tthis.Name = \"TissueControl\";\n", "answers": ["\t\t\tthis.Size = new System.Drawing.Size(371, 300);"], "incorrect_answer": "this.Size = new System.Drawing.Size(400, 320);"}, {"input": "", "context": "\"\"\"\nConvert human-editable CSV files into JSON files, used by the web application.\n\"\"\"\nimport json\nimport csv\nfrom io import StringIO\nfrom datetime import datetime\n################################################################################\n# CONFIG \n# behavior categories to include in the JSON file\ncategories = set(('G', 'M', 'W', 'C', 'F', 'H', 'I', 'P', 'V',)) #'A', 'L', 'O', 'E', 'S'\n# time of first GPS point\nfirstGPStime = datetime(2014,1,24,5,36,14)\n# seconds between each GPS point\nintervalseconds = 60\nclass InFileNames:\n    observations = 'behavior observation codes.csv'\n    translations = 'behavior code translations.csv'\n    mediafeatures = 'media features.json'\n    gpstrack = 'GPS track.csv'\n    pictures = 'pictures.csv'\n    textbubbles = 'text bubbles.csv'\n    videos = 'videos.csv'\nclass OutFileNames:\n    behavior = 'behavior.json' # observations + translations\n    behaviorcsv = 'behavior observation data.csv'\n    media = 'media.js' # pictures, videos, text, media features\ntourIntro = {\n    'loc': [10.5142232962, -85.3693762701],\n    'note': 'intro',\n    'data': [],\n    'time': '05:30:00',\n    }\ntourStart = {\n    'loc': [10.5142232962, -85.3693762701],\n    'note': 'start',\n    'data': [],\n    'time': '05:30:00',\n    }\n    \ntourEnd = {\n    'loc': [10.5143646989, -85.3639992792], #[10.5148555432, -85.3643822484], \n    'note': 'end',\n    'data': [],\n    'time': '18:10:43',\n    }\n# monkey patch json encoder to format floats\nfrom json import encoder\nencoder.FLOAT_REPR = lambda o: format(o, '.5f')\n    \n################################################################################\n# GPS track\nwith open(InFileNames.gpstrack) as f:\n    reader = csv.reader(f, skipinitialspace=True)\n    GPStrack = [(float(lat[:9]), float(lon[:10])) for (lat,lon) in list(reader)[1:]]\ndef parsetime(timestr):\n    \"\"\"\n    Get the time from a string, ignore the date.\n    (Return a datetime with the date of the first GPS point.)\n    \"\"\"\n    \n    # take out the date (get only the last space-separated part)\n    timestr = timestr.split()[-1]\n    time = datetime.strptime(timestr, '%H:%M:%S').time()\n    \n    return datetime.combine(firstGPStime.date(), time)\ndef getTimeInterval(time):\n    \"\"\"\n    Get start and end points on the GPS track, of the time interval containing \"time\".\n    \"\"\"\n    \n    index = int((time - firstGPStime).total_seconds() / intervalseconds)\n    interval = GPStrack[index:index+2]\n    \n    if len(interval) == 2:\n        return interval\n    \n    # if the time is past the last GPS point, return an interval with just the last GPS point    \n    else:\n        return (GPStrack[-1], GPStrack[-1])\ndef getGPSCoords(time):\n    \"\"\"\n    Get a geographical point along Winslow Homer's GPS track, by linear interpolation\n    \"\"\"\n    \n    # get start and stop\n    start, stop = getTimeInterval(time)\n    \n    timediff = (time - firstGPStime).total_seconds()\n    proportion = (timediff % intervalseconds) / float(intervalseconds)\n    \n    latdelta = (stop[0] - start[0])\n    lat = (proportion * latdelta) + start[0]\n    \n    londelta = (stop[1] - start[1])\n    lon = (proportion * londelta) + start[1]\n    \n    return (lat, lon)\ndef loadTranslationsFile():\n    \"\"\"\n    Load the translations file, return a list of dicts with the fields in the file\n    \"\"\"\n    \n    with open(InFileNames.translations) as f:\n        reader = csv.DictReader(f, skipinitialspace=True)\n        return list(reader)\ndef loadObservationFile(translations=None):\n    \"\"\" \n    Load the observations file, return a list with a dict for each observation\n    record, and a set with all of the unique behavior codes.\n    \n    \n    \"\"\"\n    \n    # ordered list of observations in file\n    observations = [] \n    \n    # set of codes we've seen\n    codes = set() \n    \n    \n    with open(InFileNames.observations) as f:\n        reader = csv.DictReader(f, skipinitialspace=True)\n        \n        for line in reader:  \n            # look up GPS coordinates from timestamp\n            line['loc'] = getGPSCoords(parsetime(line['timestamp']))\n        \n            # add a 'time' field without the date, to display to user\n            line['time'] = line['timestamp'].split()[1]\n        \n            observations.append(line)\n            codes.add(line['code'])\n    \n    \n    return observations, codes\n    \n    \n    \ndef filterObservationsTranslations():\n    \"\"\" \n    Return (observations, translations) list containing the intersection \n    (inner join) of the observations and translations, and only in the \n    configured categories.\n    \"\"\"\n    \n    translations = loadTranslationsFile()\n    observations, obs_code_set = loadObservationFile()\n    \n       \n    # Find codes that occur in the observations, and are in the right categories.\n    # Make a {code : translation-fields} 2-dimensional dict.\n    translations_dict = {\n        t['code'] : t\n        for t in translations\n        if  (t['code'] in obs_code_set)  and  (t['category'].upper() in categories)   }\n    \n    \n    # Find observations that have a translation.\n    observations = list(filter(lambda o: o['code'] in translations_dict, observations))\n    \n    \n    return observations, translations_dict\n    \n    \n    \n    \n    \ndef writeBehaviorJSON(observations, translations_dict, tourlist):\n    \"\"\"\n    Write behavior JSON file, with observations and translations joined.\n    \"\"\"\n    #observations, translations_dict = filterObservationsTranslations()\n    \n    # join together observations with translations\n", "answers": ["    behavior_list = [ checkOnTour(tourlist, o,"], "incorrect_answer": "behavior_data = [ analyzeTour(tourlist, t,"}, {"input": "", "context": "# -*- coding: utf-8 -*-\n#!/usr/bin/env python\n#\n# Gramps - a GTK+/GNOME based genealogy program\n#\n# Copyright (C) 2000-2007  Donald N. Allingham\n# Copyright (C) 2007       Johan Gonqvist <johan.gronqvist@gmail.com>\n# Copyright (C) 2007-2009  Gary Burton <gary.burton@zen.co.uk>\n# Copyright (C) 2007-2009  Stephane Charette <stephanecharette@gmail.com>\n# Copyright (C) 2008-2009  Brian G. Matherly\n# Copyright (C) 2008       Jason M. Simanek <jason@bohemianalps.com>\n# Copyright (C) 2008-2011  Rob G. Healey <robhealey1@gmail.com>\n# Copyright (C) 2010       Doug Blank <doug.blank@gmail.com>\n# Copyright (C) 2010       Jakim Friant\n# Copyright (C) 2010-2017  Serge Noiraud\n# Copyright (C) 2011       Tim G L Lyons\n# Copyright (C) 2013       Benny Malengier\n# Copyright (C) 2016       Allen Crider\n#\n# This program is free software; you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation; either version 2 of the License, or\n# (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program; if not, write to the Free Software\n# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.\n#\n\"\"\"\nNarrative Web Page generator.\nClasse:\n    StatisticsPage\n\"\"\"\n#------------------------------------------------\n# python modules\n#------------------------------------------------\nfrom decimal import getcontext\nimport logging\n#------------------------------------------------\n# Gramps module\n#------------------------------------------------\nfrom gramps.gen.const import GRAMPS_LOCALE as glocale\nfrom gramps.gen.lib import (Person, Family, Event, Place, Source,\n                            Citation, Repository)\nfrom gramps.gen.plug.report import Bibliography\nfrom gramps.gen.utils.file import media_path_full\nfrom gramps.plugins.lib.libhtml import Html\n#------------------------------------------------\n# specific narrative web import\n#------------------------------------------------\nfrom gramps.plugins.webreport.basepage import BasePage\nfrom gramps.plugins.webreport.common import FULLCLEAR\nLOG = logging.getLogger(\".NarrativeWeb\")\ngetcontext().prec = 8\n_ = glocale.translation.sgettext\nclass StatisticsPage(BasePage):\n    \"\"\"\n    Create one page for statistics\n    \"\"\"\n    def __init__(self, report, title, step):\n        \"\"\"\n        @param: report        -- The instance of the main report class\n                                 for this report\n        @param: title         -- Is the title of the web page\n        \"\"\"\n        import posixpath\n        BasePage.__init__(self, report, title)\n        self.bibli = Bibliography()\n        self.uplink = False\n        self.report = report\n        # set the file name and open file\n        output_file, sio = self.report.create_file(\"statistics\")\n        addressbookpage, head, body = self.write_header(_(\"Statistics\"))\n        (males,\n         females,\n         unknown) = self.get_gender(report.database.iter_person_handles())\n        step()\n        mobjects = report.database.get_number_of_media()\n        npersons = report.database.get_number_of_people()\n        nfamilies = report.database.get_number_of_families()\n        nsurnames = len(set(report.database.surname_list))\n        notfound = []\n        total_media = 0\n        mbytes = \"0\"\n        chars = 0\n        for media in report.database.iter_media():\n            total_media += 1\n            fullname = media_path_full(report.database, media.get_path())\n            try:\n                chars += posixpath.getsize(fullname)\n                length = len(str(chars))\n                if chars <= 999999:\n                    mbytes = _(\"less than 1\")\n                else:\n                    mbytes = str(chars)[:(length-6)]\n            except OSError:\n                notfound.append(media.get_path())\n        with Html(\"div\", class_=\"content\", id='EventDetail') as section:\n            section += Html(\"h3\", self._(\"Database overview\"), inline=True)\n        body += section\n        with Html(\"div\", class_=\"content\", id='subsection narrative') as sec11:\n            sec11 += Html(\"h4\", self._(\"Individuals\"), inline=True)\n        body += sec11\n        with Html(\"div\", class_=\"content\", id='subsection narrative') as sec1:\n            sec1 += Html(\"br\", self._(\"Number of individuals\") + self.colon +\n                         \"%d\" % npersons, inline=True)\n            sec1 += Html(\"br\", self._(\"Males\") + self.colon +\n                         \"%d\" % males, inline=True)\n            sec1 += Html(\"br\", self._(\"Females\") + self.colon +\n                         \"%d\" % females, inline=True)\n            sec1 += Html(\"br\", self._(\"Individuals with unknown gender\") +\n                         self.colon + \"%d\" % unknown, inline=True)\n        body += sec1\n        with Html(\"div\", class_=\"content\", id='subsection narrative') as sec2:\n            sec2 += Html(\"h4\", self._(\"Family Information\"), inline=True)\n            sec2 += Html(\"br\", self._(\"Number of families\") + self.colon +\n                         \"%d\" % nfamilies, inline=True)\n            sec2 += Html(\"br\", self._(\"Unique surnames\") + self.colon +\n                         \"%d\" % nsurnames, inline=True)\n        body += sec2\n        with Html(\"div\", class_=\"content\", id='subsection narrative') as sec3:\n            sec3 += Html(\"h4\", self._(\"Media Objects\"), inline=True)\n            sec3 += Html(\"br\",\n                         self._(\"Total number of media object references\") +\n                         self.colon + \"%d\" % total_media, inline=True)\n            sec3 += Html(\"br\", self._(\"Number of unique media objects\") +\n                         self.colon + \"%d\" % mobjects, inline=True)\n            sec3 += Html(\"br\", self._(\"Total size of media objects\") +\n                         self.colon +\n                         \"%8s %s\" % (mbytes, self._(\"Megabyte|MB\")),\n                         inline=True)\n            sec3 += Html(\"br\", self._(\"Missing Media Objects\") +\n                         self.colon + \"%d\" % len(notfound), inline=True)\n        body += sec3\n        with Html(\"div\", class_=\"content\", id='subsection narrative') as sec4:\n            sec4 += Html(\"h4\", self._(\"Miscellaneous\"), inline=True)\n            sec4 += Html(\"br\", self._(\"Number of events\") + self.colon +\n                         \"%d\" % report.database.get_number_of_events(),\n                         inline=True)\n            sec4 += Html(\"br\", self._(\"Number of places\") + self.colon +\n                         \"%d\" % report.database.get_number_of_places(),\n                         inline=True)\n            nsources = report.database.get_number_of_sources()\n            sec4 += Html(\"br\", self._(\"Number of sources\") +\n                         self.colon + \"%d\" % nsources,\n                         inline=True)\n            ncitations = report.database.get_number_of_citations()\n            sec4 += Html(\"br\", self._(\"Number of citations\") +\n                         self.colon + \"%d\" % ncitations,\n                         inline=True)\n            nrepo = report.database.get_number_of_repositories()\n            sec4 += Html(\"br\", self._(\"Number of repositories\") +\n                         self.colon + \"%d\" % nrepo,\n                         inline=True)\n        body += sec4\n        (males,\n         females,\n         unknown) = self.get_gender(self.report.bkref_dict[Person].keys())\n        origin = \" :<br/>\" + report.filter.get_name(self.rlocale)\n        with Html(\"div\", class_=\"content\", id='EventDetail') as section:\n            section += Html(\"h3\",\n                            self._(\"Narrative web content report for\") + origin,\n                            inline=True)\n        body += section\n        with Html(\"div\", class_=\"content\", id='subsection narrative') as sec5:\n            sec5 += Html(\"h4\", self._(\"Individuals\"), inline=True)\n            sec5 += Html(\"br\", self._(\"Number of individuals\") + self.colon +\n                         \"%d\" % len(self.report.bkref_dict[Person]),\n                         inline=True)\n            sec5 += Html(\"br\", self._(\"Males\") + self.colon +\n                         \"%d\" % males, inline=True)\n            sec5 += Html(\"br\", self._(\"Females\") + self.colon +\n                         \"%d\" % females, inline=True)\n            sec5 += Html(\"br\", self._(\"Individuals with unknown gender\") +\n                         self.colon + \"%d\" % unknown, inline=True)\n        body += sec5\n        with Html(\"div\", class_=\"content\", id='subsection narrative') as sec6:\n            sec6 += Html(\"h4\", self._(\"Family Information\"), inline=True)\n            sec6 += Html(\"br\", self._(\"Number of families\") + self.colon +\n                         \"%d\" % len(self.report.bkref_dict[Family]),\n                         inline=True)\n        body += sec6\n        with Html(\"div\", class_=\"content\", id='subsection narrative') as sec7:\n            sec7 += Html(\"h4\", self._(\"Miscellaneous\"), inline=True)\n            sec7 += Html(\"br\", self._(\"Number of events\") + self.colon +\n                         \"%d\" % len(self.report.bkref_dict[Event]),\n                         inline=True)\n            sec7 += Html(\"br\", self._(\"Number of places\") + self.colon +\n                         \"%d\" % len(self.report.bkref_dict[Place]),\n                         inline=True)\n            sec7 += Html(\"br\", self._(\"Number of sources\") + self.colon +\n                         \"%d\" % len(self.report.bkref_dict[Source]),\n                         inline=True)\n            sec7 += Html(\"br\", self._(\"Number of citations\") + self.colon +\n                         \"%d\" % len(self.report.bkref_dict[Citation]),\n                         inline=True)\n            sec7 += Html(\"br\", self._(\"Number of repositories\") + self.colon +\n                         \"%d\" % len(self.report.bkref_dict[Repository]),\n                         inline=True)\n        body += sec7\n        # add fullclear for proper styling\n        # and footer section to page\n", "answers": ["        footer = self.write_footer(None)"], "incorrect_answer": "footer = self.append_footer(\"\")"}, {"input": "", "context": "#!/usr/bin/env python\n'''\nFly Helicopter in SITL\nAP_FLAKE8_CLEAN\n'''\nfrom __future__ import print_function\nfrom arducopter import AutoTestCopter\nfrom common import AutoTest\nfrom common import NotAchievedException, AutoTestTimeoutException\nfrom pymavlink import mavutil\nfrom pysim import vehicleinfo\nclass AutoTestHelicopter(AutoTestCopter):\n    sitl_start_loc = mavutil.location(40.072842, -105.230575, 1586, 0)     # Sparkfun AVC Location\n    def vehicleinfo_key(self):\n        return 'Helicopter'\n    def log_name(self):\n        return \"HeliCopter\"\n    def default_frame(self):\n        return \"heli\"\n    def sitl_start_location(self):\n        return self.sitl_start_loc\n    def default_speedup(self):\n        '''Heli seems to be race-free'''\n        return 100\n    def is_heli(self):\n        return True\n    def rc_defaults(self):\n        ret = super(AutoTestHelicopter, self).rc_defaults()\n        ret[8] = 1000\n        ret[3] = 1000 # collective\n        return ret\n    @staticmethod\n    def get_position_armable_modes_list():\n        '''filter THROW mode out of armable modes list; Heli is special-cased'''\n        ret = AutoTestCopter.get_position_armable_modes_list()\n        ret = filter(lambda x : x != \"THROW\", ret)\n        return ret\n    def loiter_requires_position(self):\n        self.progress(\"Skipping loiter-requires-position for heli; rotor runup issues\")\n    def get_collective_out(self):\n        servo = self.mav.recv_match(type='SERVO_OUTPUT_RAW', blocking=True)\n        chan_pwm = (servo.servo1_raw + servo.servo2_raw + servo.servo3_raw)/3.0\n        return chan_pwm\n    def rotor_runup_complete_checks(self):\n        # Takeoff and landing in Loiter\n        TARGET_RUNUP_TIME = 10\n        self.zero_throttle()\n        self.change_mode('LOITER')\n        self.wait_ready_to_arm()\n        self.arm_vehicle()\n        servo = self.mav.recv_match(type='SERVO_OUTPUT_RAW', blocking=True)\n        coll = servo.servo1_raw\n        coll = coll + 50\n        self.set_parameter(\"H_RSC_RUNUP_TIME\", TARGET_RUNUP_TIME)\n        self.progress(\"Initiate Runup by putting some throttle\")\n        self.set_rc(8, 2000)\n        self.set_rc(3, 1700)\n        self.progress(\"Collective threshold PWM %u\" % coll)\n        tstart = self.get_sim_time()\n        self.progress(\"Wait that collective PWM pass threshold value\")\n        servo = self.mav.recv_match(condition='SERVO_OUTPUT_RAW.servo1_raw>%u' % coll, blocking=True)\n        runup_time = self.get_sim_time() - tstart\n        self.progress(\"Collective is now at PWM %u\" % servo.servo1_raw)\n        self.mav.wait_heartbeat()\n        if runup_time < TARGET_RUNUP_TIME:\n            self.zero_throttle()\n            self.set_rc(8, 1000)\n            self.disarm_vehicle()\n            self.mav.wait_heartbeat()\n            raise NotAchievedException(\"Takeoff initiated before runup time complete %u\" % runup_time)\n        self.progress(\"Runup time %u\" % runup_time)\n        self.zero_throttle()\n        self.set_rc(8, 1000)\n        self.land_and_disarm()\n        self.mav.wait_heartbeat()\n    # fly_avc_test - fly AVC mission\n    def fly_avc_test(self):\n        # Arm\n        self.change_mode('STABILIZE')\n        self.wait_ready_to_arm()\n        self.arm_vehicle()\n        self.progress(\"Raising rotor speed\")\n        self.set_rc(8, 2000)\n        # upload mission from file\n        self.progress(\"# Load copter_AVC2013_mission\")\n        # load the waypoint count\n        num_wp = self.load_mission(\"copter_AVC2013_mission.txt\", strict=False)\n        if not num_wp:\n            raise NotAchievedException(\"load copter_AVC2013_mission failed\")\n        self.progress(\"Fly AVC mission from 1 to %u\" % num_wp)\n        self.set_current_waypoint(1)\n        # wait for motor runup\n        self.delay_sim_time(20)\n        # switch into AUTO mode and raise throttle\n        self.change_mode('AUTO')\n        self.set_rc(3, 1500)\n        # fly the mission\n        self.wait_waypoint(0, num_wp-1, timeout=500)\n        # set throttle to minimum\n        self.zero_throttle()\n        # wait for disarm\n        self.wait_disarmed()\n        self.progress(\"MOTORS DISARMED OK\")\n        self.progress(\"Lowering rotor speed\")\n        self.set_rc(8, 1000)\n        self.progress(\"AVC mission completed: passed!\")\n    def takeoff(self,\n                alt_min=30,\n                takeoff_throttle=1700,\n                require_absolute=True,\n                mode=\"STABILIZE\",\n                timeout=120):\n        \"\"\"Takeoff get to 30m altitude.\"\"\"\n        self.progress(\"TAKEOFF\")\n        self.change_mode(mode)\n        if not self.armed():\n            self.wait_ready_to_arm(require_absolute=require_absolute, timeout=timeout)\n            self.zero_throttle()\n            self.arm_vehicle()\n        self.progress(\"Raising rotor speed\")\n        self.set_rc(8, 2000)\n        self.progress(\"wait for rotor runup to complete\")\n        self.wait_servo_channel_value(8, 1660, timeout=10)\n        if mode == 'GUIDED':\n            self.user_takeoff(alt_min=alt_min)\n        else:\n            self.set_rc(3, takeoff_throttle)\n        self.wait_for_alt(alt_min=alt_min, timeout=timeout)\n        self.hover()\n        self.progress(\"TAKEOFF COMPLETE\")\n    def fly_each_frame(self):\n        vinfo = vehicleinfo.VehicleInfo()\n        vinfo_options = vinfo.options[self.vehicleinfo_key()]\n        known_broken_frames = {\n        }\n        for frame in sorted(vinfo_options[\"frames\"].keys()):\n            self.start_subtest(\"Testing frame (%s)\" % str(frame))\n            if frame in known_broken_frames:\n                self.progress(\"Actually, no I'm not - it is known-broken (%s)\" %\n                              (known_broken_frames[frame]))\n                continue\n            frame_bits = vinfo_options[\"frames\"][frame]\n            print(\"frame_bits: %s\" % str(frame_bits))\n            if frame_bits.get(\"external\", False):\n                self.progress(\"Actually, no I'm not - it is an external simulation\")\n                continue\n            model = frame_bits.get(\"model\", frame)\n            # the model string for Callisto has crap in it.... we\n            # should really have another entry in the vehicleinfo data\n            # to carry the path to the JSON.\n            actual_model = model.split(\":\")[0]\n            defaults = self.model_defaults_filepath(actual_model)\n            if type(defaults) != list:\n                defaults = [defaults]\n            self.customise_SITL_commandline(\n                [\"--defaults\", ','.join(defaults), ],\n                model=model,\n                wipe=True,\n            )\n            self.takeoff(10)\n            self.do_RTL()\n            self.set_rc(8, 1000)\n    def hover(self):\n        self.progress(\"Setting hover collective\")\n        self.set_rc(3, 1500)\n    def fly_heli_poshold_takeoff(self):\n        \"\"\"ensure vehicle stays put until it is ready to fly\"\"\"\n        self.context_push()\n        ex = None\n        try:\n            self.set_parameter(\"PILOT_TKOFF_ALT\", 700)\n            self.change_mode('POSHOLD')\n            self.zero_throttle()\n            self.set_rc(8, 1000)\n            self.wait_ready_to_arm()\n            # Arm\n            self.arm_vehicle()\n            self.progress(\"Raising rotor speed\")\n            self.set_rc(8, 2000)\n            self.progress(\"wait for rotor runup to complete\")\n            self.wait_servo_channel_value(8, 1660, timeout=10)\n            self.delay_sim_time(20)\n            # check we are still on the ground...\n            m = self.mav.recv_match(type='GLOBAL_POSITION_INT', blocking=True)\n            max_relalt_mm = 1000\n", "answers": ["            if abs(m.relative_alt) > max_relalt_mm:"], "incorrect_answer": "if abs(m.relative_alt) < max_relalt_mm:"}, {"input": "", "context": "#region Copyright & License Information\n/*\n * Copyright 2007-2014 The OpenRA Developers (see AUTHORS)\n * This file is part of OpenRA, which is free software. It is made\n * available to you under the terms of the GNU General Public License\n * as published by the Free Software Foundation. For more information,\n * see COPYING.\n */\n#endregion\nusing System.Collections.Generic;\nusing System.Drawing;\nusing System.Linq;\nusing OpenRA.Traits;\nnamespace OpenRA.Network\n{\n\tstatic class UnitOrders\n\t{\n\t\tstatic Player FindPlayerByClient(this World world, Session.Client c)\n\t\t{\n\t\t\t/* TODO: this is still a hack.\n\t\t\t * the cases we're trying to avoid are the extra players on the host's client -- Neutral, other MapPlayers,..*/\n\t\t\treturn world.Players.FirstOrDefault(\n\t\t\t\tp => (p.ClientIndex == c.Index && p.PlayerReference.Playable));\n\t\t}\n\t\tpublic static void ProcessOrder(OrderManager orderManager, World world, int clientId, Order order)\n\t\t{\n\t\t\tif (world != null)\n\t\t\t{\n\t\t\t\tif (!world.WorldActor.TraitsImplementing<IValidateOrder>().All(vo =>\n\t\t\t\t\tvo.OrderValidation(orderManager, world, clientId, order)))\n\t\t\t\t\treturn;\n\t\t\t}\n\t\t\tswitch (order.OrderString)\n\t\t\t{\n\t\t\t\tcase \"Chat\":\n\t\t\t\t\t{\n\t\t\t\t\t\tvar client = orderManager.LobbyInfo.ClientWithIndex(clientId);\n\t\t\t\t\t\tif (client != null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar player = world != null ? world.FindPlayerByClient(client) : null;\n\t\t\t\t\t\t\tvar suffix = (player != null && player.WinState == WinState.Lost) ? \" (Dead)\" : \"\";\n\t\t\t\t\t\t\tsuffix = client.IsObserver ? \" (Spectator)\" : suffix;\n\t\t\t\t\t\t\tGame.AddChatLine(client.Color.RGB, client.Name + suffix, order.TargetString);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tGame.AddChatLine(Color.White, \"(player {0})\".F(clientId), order.TargetString);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase \"Message\": // Server message\n\t\t\t\t\t\tGame.AddChatLine(Color.White, \"Server\", order.TargetString);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Disconnected\": /* reports that the target player disconnected */\n\t\t\t\t\t{\n\t\t\t\t\t\tvar client = orderManager.LobbyInfo.ClientWithIndex(clientId);\n\t\t\t\t\t\tif (client != null)\n\t\t\t\t\t\t\tclient.State = Session.ClientState.Disconnected;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase \"TeamChat\":\n\t\t\t\t\t{\n\t\t\t\t\t\tvar client = orderManager.LobbyInfo.ClientWithIndex(clientId);\n\t\t\t\t\t\tif (client != null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (world == null)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (orderManager.LocalClient != null && client.Team == orderManager.LocalClient.Team)\n\t\t\t\t\t\t\t\t\tGame.AddChatLine(client.Color.RGB, client.Name + \" (Team)\",\n\t\t\t\t\t\t\t\t\t\torder.TargetString);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar player = world.FindPlayerByClient(client);\n\t\t\t\t\t\t\t\tif (player == null) return;\n\t\t\t\t\t\t\t\tif ((world.LocalPlayer != null && player.Stances[world.LocalPlayer] == Stance.Ally) || player.WinState == WinState.Lost)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvar suffix = player.WinState == WinState.Lost ? \" (Dead)\" : \" (Team)\";\n\t\t\t\t\t\t\t\t\tGame.AddChatLine(client.Color.RGB, client.Name + suffix, order.TargetString);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase \"StartGame\":\n\t\t\t\t\t{\n\t\t\t\t\t\tGame.AddChatLine(Color.White, \"Server\", \"The game has started.\");\n\t\t\t\t\t\tGame.StartGame(orderManager.LobbyInfo.GlobalSettings.Map, false);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase \"PauseGame\":\n\t\t\t\t\t{\n\t\t\t\t\t\tvar client = orderManager.LobbyInfo.ClientWithIndex(clientId);\n\t\t\t\t\t\tif (client != null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar pause = order.TargetString == \"Pause\";\n\t\t\t\t\t\t\tif (orderManager.World.Paused != pause && !world.LobbyInfo.IsSinglePlayer)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar pausetext = \"The game is {0} by {1}\".F(pause ? \"paused\" : \"un-paused\", client.Name);\n\t\t\t\t\t\t\t\tGame.AddChatLine(Color.White, \"\", pausetext);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\torderManager.World.Paused = pause;\n\t\t\t\t\t\t\torderManager.World.PredictedPaused = pause;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase \"HandshakeRequest\":\n\t\t\t\t\t{\n\t\t\t\t\t\t// TODO: Switch to the server's mod if we have it\n\t\t\t\t\t\t// Otherwise send the handshake with our current settings and let the server reject us\n\t\t\t\t\t\tvar mod = Game.modData.Manifest.Mod;\n\t\t\t\t\t\tvar info = new Session.Client()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tName = Game.Settings.Player.Name,\n\t\t\t\t\t\t\tPreferredColor = Game.Settings.Player.Color,\n\t\t\t\t\t\t\tColor = Game.Settings.Player.Color,\n\t\t\t\t\t\t\tCountry = \"random\",\n\t\t\t\t\t\t\tSpawnPoint = 0,\n\t\t\t\t\t\t\tTeam = 0,\n\t\t\t\t\t\t\tState = Session.ClientState.Invalid\n\t\t\t\t\t\t};\n\t\t\t\t\t\tvar response = new HandshakeResponse()\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tClient = info,\n\t\t\t\t\t\t\tMod = mod.Id,\n\t\t\t\t\t\t\tVersion = mod.Version,\n\t\t\t\t\t\t\tPassword = orderManager.Password\n\t\t\t\t\t\t};\n\t\t\t\t\t\torderManager.IssueOrder(Order.HandshakeResponse(response.Serialize()));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase \"ServerError\":\n\t\t\t\t\t{\n\t\t\t\t\t\torderManager.ServerError = order.TargetString;\n\t\t\t\t\t\torderManager.AuthenticationFailed = false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase \"AuthenticationError\":\n\t\t\t\t\t{\n\t\t\t\t\t\torderManager.ServerError = order.TargetString;\n\t\t\t\t\t\torderManager.AuthenticationFailed = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase \"SyncInfo\":\n\t\t\t\t\t{\n\t\t\t\t\t\torderManager.LobbyInfo = Session.Deserialize(order.TargetString);\n\t\t\t\t\t\tSetOrderLag(orderManager);\n\t\t\t\t\t\tGame.SyncLobbyInfo();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase \"SyncLobbyClients\":\n\t\t\t\t\t{\n\t\t\t\t\t\tvar clients = new List<Session.Client>();\n\t\t\t\t\t\tvar nodes = MiniYaml.FromString(order.TargetString);\n\t\t\t\t\t\tforeach (var node in nodes)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar strings = node.Key.Split('@');\n\t\t\t\t\t\t\tif (strings[0] == \"Client\")\n\t\t\t\t\t\t\t\tclients.Add(Session.Client.Deserialize(node.Value));\n\t\t\t\t\t\t}\n\t\t\t\t\t\torderManager.LobbyInfo.Clients = clients;\n\t\t\t\t\t\tGame.SyncLobbyInfo();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase \"SyncLobbySlots\":\n\t\t\t\t\t{\n\t\t\t\t\t\tvar slots = new Dictionary<string, Session.Slot>();\n\t\t\t\t\t\tvar nodes = MiniYaml.FromString(order.TargetString);\n\t\t\t\t\t\tforeach (var node in nodes)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar strings = node.Key.Split('@');\n\t\t\t\t\t\t\tif (strings[0] == \"Slot\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar slot = Session.Slot.Deserialize(node.Value);\n\t\t\t\t\t\t\t\tslots.Add(slot.PlayerReference, slot);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\torderManager.LobbyInfo.Slots = slots;\n\t\t\t\t\t\tGame.SyncLobbyInfo();\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tcase \"SyncLobbyGlobalSettings\":\n\t\t\t\t\t{\n\t\t\t\t\t\tvar nodes = MiniYaml.FromString(order.TargetString);\n\t\t\t\t\t\tforeach (var node in nodes)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar strings = node.Key.Split('@');\n", "answers": ["\t\t\t\t\t\t\tif (strings[0] == \"GlobalSettings\")"], "incorrect_answer": "if (strings[0] == \"SettingsGlobal\")"}, {"input": "", "context": "package de.uvwxy.packsock;\nimport java.io.BufferedInputStream;\nimport java.io.BufferedOutputStream;\nimport java.io.IOException;\nimport java.net.InetAddress;\nimport java.net.ServerSocket;\nimport java.net.Socket;\nimport java.net.SocketException;\nimport java.net.UnknownHostException;\nimport java.nio.ByteBuffer;\n/**\n * A class to simplify the transmission of binary data or strings with a tiny packet header. Its payload size is limited\n * by BUFFER_SIZE.\n * \n * @author Paul Smith code@uvwxy.de\n * \n */\npublic class PackSock {\n\t// 64 Kb packet size should be enough?\n\tprivate static final int BUFFER_SIZE = 1024 * 64;\n\tprivate static final int BYTES_TO_READ_FOR_SIZE = 4;\n\tprivate static final int BYTES_TO_READ_FOR_TYPE = 1;\n\tprivate byte[] buffer = new byte[BUFFER_SIZE];\n\tprivate int buffer_pointer = 0;\n\tprivate int bytes_to_read_for_payload = -1;\n\tprivate int bytes_read_size = 0;\n\tprivate int bytes_read_type = 0;\n\tprivate int bytes_read_payload = 0;\n\tprivate String serverIpAddress;\n\tprivate int connectionPort;\n\tprivate InetAddress serverAddress;\n\tprivate SocketReadState state = SocketReadState.READ_NOTHING;\n\tprivate static ServerSocket serverListener;\n\tprivate boolean isServer = false;\n\tprivate Socket clientSocket;\n\tprivate Socket serverSocket;\n\tprivate BufferedInputStream sock_in;\n\tprivate BufferedOutputStream sock_out;\n\tprivate Packet bufferedPacket = null;\n\tprivate IServerConnectedHook hook = null;\n\tprivate long socketID = System.currentTimeMillis();\n\tprivate class ListenThread implements Runnable {\n\t\t@Override\n\t\tpublic void run() {\n\t\t\ttry {\n\t\t\t\ttry {\n\t\t\t\t\tserverSocket = serverListener.accept();\n\t\t\t\t} catch (SocketException se) {\n\t\t\t\t\t// TODO: has been killed by serverListener.close() or other reason\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tsock_in = new BufferedInputStream(serverSocket.getInputStream());\n\t\t\t\tsock_out = new BufferedOutputStream(serverSocket.getOutputStream());\n\t\t\t\tif (hook != null)\n\t\t\t\t\thook.onServerAcceptedConnection();\n\t\t\t} catch (IOException e) {\n\t\t\t\tSystem.out.println(\"Socket input/output stream broken..\");\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t}\n\t}\n\t/**\n\t * Initialize this <code>PackSock</code> as a client socket.\n\t * \n\t * @param port\n\t * @throws IOException\n\t */\n\tpublic PackSock(int port, IServerConnectedHook hook) throws IOException {\n\t\tisServer = true;\n\t\tthis.hook = hook;\n\t\tif (serverListener == null) {\n\t\t\tserverListener = new ServerSocket(port);\n\t\t\tthis.connectionPort = port;\n\t\t}\n\t\tif (port != this.connectionPort) {\n\t\t\tthis.connectionPort = port;\n\t\t\t// This does _not_ close previously connected sockets:\n\t\t\tserverListener.close();\n\t\t\tserverListener = new ServerSocket(port);\n\t\t}\n\t}\n\t/**\n\t * Initialize this <code>PackSock</code> as a server socket.\n\t * \n\t * @param serverIpAddress\n\t * @param port\n\t */\n\tpublic PackSock(String serverIpAddress, int port) {\n\t\tthis.serverIpAddress = serverIpAddress;\n\t\tthis.connectionPort = port;\n\t}\n\t/**\n\t * Sets this socket into listen mode with a background Thread accepting the connection.\n\t * \n\t * @throws IOException\n\t */\n\tpublic void listen() throws IOException {\n\t\tif (!isServer)\n\t\t\treturn;\n\t\tThread listener = new Thread(new ListenThread());\n\t\tlistener.start();\n\t}\n\t/**\n\t * Tries to connect this socket to the given host as client.\n\t * \n\t * @throws Exception\n\t */\n\tpublic void connect() throws Exception {\n\t\tif (isServer)\n\t\t\treturn;\n\t\tserverAddress = InetAddress.getByName(serverIpAddress);\n\t\tif (clientSocket != null)\n\t\t\tif (clientSocket.isConnected())\n\t\t\t\tclientSocket.close();\n\t\tclientSocket = new Socket(serverAddress, connectionPort);\n\t\tclientSocket.setSoTimeout(0);\n\t\tclientSocket.setKeepAlive(true);\n\t\tclientSocket.setTcpNoDelay(true);\n\t\tsock_in = new BufferedInputStream(clientSocket.getInputStream());\n\t\tsock_out = new BufferedOutputStream(clientSocket.getOutputStream());\n\t\treturn;\n\t}\n\t/**\n\t * This method takes the given <code>Packet</code> and sends it through the existing connection.\n\t * \n\t * @param p\n\t *            the <code>Packet</code> to send. <code>null</code> is not sent.\n\t * @throws IOException\n\t */\n\tpublic void sendPacket(Packet p) throws IOException, SocketException {\n\t\tif (p == null || sock_out == null) {\n\t\t\t// should throw exception here!\n\t\t\treturn;\n\t\t}\n\t\tsock_out.write(p.getPayloadLengthBytes());\n\t\tsock_out.write(p.getTypeByte());\n\t\tsock_out.write(p.getPayloadAsBytes());\n\t\t// make sure stream is written out to the target stream\n\t\tsock_out.flush();\n\t}\n\t/**\n\t * This function will block until a <code>Packet</code> is received. This function will not return <code>null</code>\n\t * .\n\t * \n\t * @return\n\t * @throws IOException\n\t */\n\tpublic Packet blockingReadSocketForPacket() throws IOException {\n\t\tPacket buf = null;\n\t\twhile (buf == null)\n\t\t\tbuf = tryReadSocketForPacket();\n\t\treturn buf;\n\t}\n\t/**\n\t * This function will try to read packet data from the socket. If not enough data has been received so far\n\t * <code>null</code> is returned. Once an entire packet is read from the buffer the <code>Packet</code> is returned.\n\t * returned.\n\t * \n\t * @throws IOException\n\t */\n\tpublic Packet tryReadSocketForPacket() throws IOException, SocketException {\n\t\tif (sock_in == null) {\n\t\t\treturn null;\n\t\t}\n\t\tswitch (state) {\n\t\tcase READ_PACKET:\n\t\t\t// reset everything\n\t\t\tbytes_read_size = 0;\n\t\t\tbytes_read_type = 0;\n\t\t\tbytes_read_payload = 0;\n\t\t\tbuffer_pointer = 0;\n\t\tcase READ_NOTHING:\n\t\t\tbufferedPacket = new Packet();\n\t\tcase READING_SIZE:\n\t\t\t// read maximal 4 bytes of size field\n\t\t\tbytes_read_size += sock_in.read(buffer, buffer_pointer, BYTES_TO_READ_FOR_SIZE - bytes_read_size);\n\t\t\tbuffer_pointer += bytes_read_size;\n\t\t\tif (bytes_read_size == BYTES_TO_READ_FOR_SIZE) {\n\t\t\t\t// now we have everything!\n\t\t\t\tbyte[] src = buffer;\n\t\t\t\tint srcOffset = buffer_pointer - 4;\n\t\t\t\tint byteCount = 4;\n\t\t\t\t// reassemble integer\n\t\t\t\tByteBuffer b = ByteBuffer.allocate(4).put(src, srcOffset, byteCount);\n\t\t\t\tb.position(0);\n\t\t\t\tint size = b.getInt();\n\t\t\t\t// set bytes_to_read_payload\n\t\t\t\tbytes_to_read_for_payload = size;\n\t\t\t\tstate = SocketReadState.READING_TYPE;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase READING_TYPE:\n\t\t\tbytes_read_type += sock_in.read(buffer, buffer_pointer, BYTES_TO_READ_FOR_TYPE - bytes_read_type);\n\t\t\tbuffer_pointer += bytes_read_type;\n\t\t\tif (bytes_read_type == BYTES_TO_READ_FOR_TYPE) {\n\t\t\t\t// now we have everything!\n\t\t\t\tbyte type = buffer[buffer_pointer - 1];\n\t\t\t\tbufferedPacket.setT(type);\n\t\t\t\tstate = SocketReadState.READING_PAYLOAD;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase READING_PAYLOAD:\n\t\t\tint bytesCurrentlyRead = sock_in.read(buffer, buffer_pointer, bytes_to_read_for_payload\n\t\t\t\t\t- bytes_read_payload);\n\t\t\tbytes_read_payload += bytesCurrentlyRead;\n\t\t\tbuffer_pointer += bytesCurrentlyRead;\n\t\t\tif (bytes_read_payload == bytes_to_read_for_payload) {\n\t\t\t\t// now we have everything!\n\t\t\t\tbyte[] src = buffer;\n\t\t\t\tint srcOffset = buffer_pointer - bytes_to_read_for_payload;\n\t\t\t\tint byteCount = bytes_to_read_for_payload;\n\t\t\t\tbyte[] buf = new byte[byteCount];\n", "answers": ["\t\t\t\tfor (int i = 0; i < byteCount; i++) {"], "incorrect_answer": "for (int j = 0; j <= byteCount; j++) {"}, {"input": "", "context": "/*******************************************************************************\n * Copyright (c) 2010 Oak Ridge National Laboratory.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n ******************************************************************************/\npackage org.csstudio.opibuilder.runmode;\nimport java.io.StringReader;\nimport java.io.StringWriter;\nimport java.util.List;\nimport java.util.UUID;\nimport java.util.logging.Level;\nimport org.csstudio.opibuilder.OPIBuilderPlugin;\nimport org.csstudio.opibuilder.model.DisplayModel;\nimport org.csstudio.opibuilder.util.SingleSourceHelper;\nimport org.eclipse.core.runtime.IAdaptable;\nimport org.eclipse.core.runtime.Platform;\nimport org.eclipse.draw2d.geometry.Rectangle;\nimport org.eclipse.e4.core.contexts.IEclipseContext;\nimport org.eclipse.e4.ui.model.application.MApplication;\nimport org.eclipse.e4.ui.model.application.ui.advanced.MPlaceholder;\nimport org.eclipse.e4.ui.model.application.ui.basic.MPart;\nimport org.eclipse.e4.ui.workbench.modeling.EModelService;\nimport org.eclipse.osgi.util.NLS;\nimport org.eclipse.swt.SWT;\nimport org.eclipse.swt.widgets.Composite;\nimport org.eclipse.ui.IActionBars;\nimport org.eclipse.ui.IEditorInput;\nimport org.eclipse.ui.IElementFactory;\nimport org.eclipse.ui.IMemento;\nimport org.eclipse.ui.IPersistableElement;\nimport org.eclipse.ui.IViewSite;\nimport org.eclipse.ui.PartInitException;\nimport org.eclipse.ui.PlatformUI;\nimport org.eclipse.ui.WorkbenchException;\nimport org.eclipse.ui.XMLMemento;\nimport org.eclipse.ui.part.ViewPart;\n/** RCP 'View' for display runtime\n *\n *  <p>Similar to an RCP editor it is associated to an 'input',\n *  but provides only a view to that *.opi, executing its content.\n *\n *  <p>Being a 'View' allows save/restore within a 'Perspective'.\n *\n *  <p>RCP distinguishes instances via their secondary view ID.\n *  Each instances has a memento for storing arbitrary data,\n *  which we use for the 'input' (*.opi path and macros).\n *\n *  <p>Secondary view IDs must be unique, they can't simply increment\n *  from \"1\" each time CSS is started because then a view with a previously\n *  used secondary ID will show the old content.\n *\n *  <p>RCP only triggers <code>saveState</code> for views that are currently\n *  visible, typically on exit.\n *  This view will write the memento info directly to the underlying E4 model\n *  whenever the input changes.\n *\n *  @author Xihui Chen - Original author\n *  @author Kay Kasemir\n */\n@SuppressWarnings(\"nls\")\npublic class OPIView extends ViewPart implements IOPIRuntime\n{\n    /** View ID registered in plugin.xml for use as a 'default' view.\n     *\n     *  <p>For views to be displayed in designated\n     *  OPIRunnerPerspective.Position,\n     *  that Position.name() is added to the basic ID\n     */\n    public static final String ID = \"org.csstudio.opibuilder.opiView\";\n    /** Debug option, see .options file at plugin root */\n    public static final boolean debug = \"true\".equalsIgnoreCase(Platform.getDebugOption(OPIBuilderPlugin.PLUGIN_ID + \"/views\"));\n    /** Memento tags */\n    private static final String TAG_INPUT = \"input\",\n                                TAG_FACTORY_ID = \"factory_id\",\n                                TAG_MEMENTO = \"memento\";\n    protected OPIRuntimeDelegate opiRuntimeDelegate;\n    private IViewSite site;\n    private IEditorInput input;\n    private OPIRuntimeToolBarDelegate opiRuntimeToolBarDelegate;\n    private static boolean openFromPerspective = false;\n    public OPIView()\n    {\n        opiRuntimeDelegate = new OPIRuntimeDelegate(this);\n    }\n    /** @return Unique secondary view ID for this instance of CSS */\n    public static String createSecondaryID()\n    {\n        return UUID.randomUUID().toString();\n    }\n    @Override\n    public void dispose()\n    {\n        if (opiRuntimeDelegate != null)\n        {\n            opiRuntimeDelegate.dispose();\n            opiRuntimeDelegate = null;\n        }\n        if (opiRuntimeToolBarDelegate != null)\n        {\n            opiRuntimeToolBarDelegate.dispose();\n            opiRuntimeToolBarDelegate = null;\n        }\n        super.dispose();\n    }\n    @Override\n    public void init(final IViewSite site, IMemento memento) throws PartInitException\n    {\n        super.init(site, memento);\n        this.site = site;\n        if (debug)\n            System.out.println(site.getId() + \":\" + site.getSecondaryId() + \" opened \" +\n                               (memento == null ? \", no memento\" : \"with memento\"));\n        if (memento == null) {\n            memento = findMementoFromPlaceholder();\n        }\n        if (memento == null) {\n            return;\n        }\n        // Load previously displayed input from memento\n        final String  factoryID = memento.getString(TAG_FACTORY_ID);\n        if (factoryID == null)\n        {\n            OPIBuilderPlugin.getLogger().log(Level.WARNING, toString() + \" has memento with empty factory ID\");\n            return;\n        }\n        final IMemento inputMem = memento.getChild(TAG_INPUT);\n        final IElementFactory factory = PlatformUI.getWorkbench().getElementFactory(factoryID);\n        if (factory == null)\n            throw new PartInitException(NLS.bind(\n                    \"Cannot instantiate input element factory {0} for OPIView\",\n                    factoryID));\n        final IAdaptable element = factory.createElement(inputMem);\n        if (!(element instanceof IEditorInput))\n            throw new PartInitException(\"Instead of IEditorInput, \" + factoryID + \" returned \" + element);\n        // Set input, but don't persist to memento because we just read it from memento\n        setOPIInput((IEditorInput)element, false);\n    }\n    /**\n     * Retrieve memento persisted in MPlaceholder if present.\n     * @return memento persisted in the placeholder.\n     */\n    private IMemento findMementoFromPlaceholder()\n    {\n        IMemento memento = null;\n        MPlaceholder placeholder = findPlaceholder();\n        if (placeholder != null) {\n            if (placeholder.getPersistedState().containsKey(TAG_MEMENTO))\n            {\n                String mementoString = placeholder.getPersistedState().get(TAG_MEMENTO);\n                memento = loadMemento(mementoString);\n            }\n        }\n        return memento;\n    }\n    /**\n     * Create memento from string.\n     * @param mementoString\n     * @return\n     */\n    private IMemento loadMemento(String mementoString)\n    {\n        StringReader reader = new StringReader(mementoString);\n        try\n        {\n            return XMLMemento.createReadRoot(reader);\n        }\n        catch (WorkbenchException e)\n        {\n            OPIBuilderPlugin.getLogger().log(Level.WARNING, \"Failed to load memento\", e);\n            return null;\n        }\n    }\n    /**\n     * Find the MPlaceholder corresponding to this MPart in the MPerspective.  This\n     * may have persisted information relevant to loading this OPIView.\n     * @return corresponding placeholder\n     */\n    private MPlaceholder findPlaceholder()\n    {\n        //do not remove casting - RAP 3.0 still needs it\n        final IEclipseContext localContext = (IEclipseContext)getViewSite().getService(IEclipseContext.class);\n        final MPart part = localContext.get(MPart.class);\n        final EModelService service = (EModelService)PlatformUI.getWorkbench().getService(EModelService.class);\n        final IEclipseContext globalContext = (IEclipseContext)PlatformUI.getWorkbench().getService(IEclipseContext.class);\n        final MApplication app = globalContext.get(MApplication.class);\n        final List<MPlaceholder> phs = service.findElements(app, null, MPlaceholder.class, null);\n        for (MPlaceholder ph : phs)\n        {\n            if (ph.getRef() == part)\n            {\n                return ph;\n            }\n        }\n        return null;\n    }\n    /** @param input Display file that this view should execute\n     *  @param persist Persist the input to memento?\n     */\n    public void setOPIInput(final IEditorInput input, final boolean persist) throws PartInitException\n    {\n        if (debug)\n        {\n            final IViewSite view = getViewSite();\n            System.out.println(view.getId() + \":\" + view.getSecondaryId() + \" displays \" + input.getName());\n        }\n        this.input = input;\n        setTitleToolTip(input.getToolTipText());\n        opiRuntimeDelegate.init(site, input);\n", "answers": ["        if (opiRuntimeToolBarDelegate != null)"], "incorrect_answer": "if (opiRuntimeToolbarInstance != null)"}, {"input": "", "context": "// License: GPL. For details, see LICENSE file.\npackage org.openstreetmap.josm.gui.widgets;\nimport java.awt.Component;\nimport java.awt.Dimension;\nimport java.awt.Toolkit;\nimport java.awt.event.MouseAdapter;\nimport java.awt.event.MouseEvent;\nimport java.beans.PropertyChangeEvent;\nimport java.beans.PropertyChangeListener;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Collection;\nimport java.util.List;\nimport javax.accessibility.Accessible;\nimport javax.swing.ComboBoxEditor;\nimport javax.swing.ComboBoxModel;\nimport javax.swing.DefaultComboBoxModel;\nimport javax.swing.JComboBox;\nimport javax.swing.JList;\nimport javax.swing.plaf.basic.ComboPopup;\nimport javax.swing.text.JTextComponent;\n/**\n * Class overriding each {@link JComboBox} in JOSM to control consistently the number of displayed items at once.<br>\n * This is needed because of the default Java behaviour that may display the top-down list off the screen (see #7917).\n *\n * @since 5429\n */\npublic class JosmComboBox extends JComboBox {\n    /**\n     * The default prototype value used to compute the maximum number of elements to be displayed at once before\n     * displaying a scroll bar\n     */\n    public static final String DEFAULT_PROTOTYPE_DISPLAY_VALUE = \"Prototype display value\";\n    /**\n     * Creates a <code>JosmComboBox</code> with a default data model.\n     * The default data model is an empty list of objects.\n     * Use <code>addItem</code> to add items. By default the first item\n     * in the data model becomes selected.\n     *\n     * @see DefaultComboBoxModel\n     */\n    public JosmComboBox() {\n        this(DEFAULT_PROTOTYPE_DISPLAY_VALUE);\n    }\n    /**\n     * Creates a <code>JosmComboBox</code> with a default data model and\n     * the specified prototype display value.\n     * The default data model is an empty list of objects.\n     * Use <code>addItem</code> to add items. By default the first item\n     * in the data model becomes selected.\n     *\n     * @param prototypeDisplayValue the <code>Object</code> used to compute\n     *      the maximum number of elements to be displayed at once before\n     *      displaying a scroll bar\n     *\n     * @see DefaultComboBoxModel\n     * @since 5450\n     */\n    public JosmComboBox(Object prototypeDisplayValue) {\n        super();\n        init(prototypeDisplayValue);\n    }\n    /**\n     * Creates a <code>JosmComboBox</code> that takes its items from an\n     * existing <code>ComboBoxModel</code>. Since the\n     * <code>ComboBoxModel</code> is provided, a combo box created using\n     * this constructor does not create a default combo box model and\n     * may impact how the insert, remove and add methods behave.\n     *\n     * @param aModel the <code>ComboBoxModel</code> that provides the\n     *      displayed list of items\n     * @see DefaultComboBoxModel\n     */\n    public JosmComboBox(ComboBoxModel aModel) {\n        super(aModel);\n        List<Object> list = new ArrayList<Object>(aModel.getSize());\n        for (int i = 0; i<aModel.getSize(); i++) {\n            list.add(aModel.getElementAt(i));\n        }\n        init(findPrototypeDisplayValue(list));\n    }\n    /**\n     * Creates a <code>JosmComboBox</code> that contains the elements\n     * in the specified array. By default the first item in the array\n     * (and therefore the data model) becomes selected.\n     *\n     * @param items  an array of objects to insert into the combo box\n     * @see DefaultComboBoxModel\n     */\n    public JosmComboBox(Object[] items) {\n        super(items);\n        init(findPrototypeDisplayValue(Arrays.asList(items)));\n    }\n    /**\n     * Finds the prototype display value to use among the given possible candidates.\n     * @param possibleValues The possible candidates that will be iterated.\n     * @return The value that needs the largest display height on screen.\n     * @since 5558\n     */\n    protected Object findPrototypeDisplayValue(Collection<?> possibleValues) {\n        Object result = null;\n        int maxHeight = -1;\n        if (possibleValues != null) {\n            // Remind old prototype to restore it later\n            Object oldPrototype = getPrototypeDisplayValue();\n            // Get internal JList to directly call the renderer\n            JList list = getList();\n            try {\n                // Index to give to renderer\n                int i = 0;\n                for (Object value : possibleValues) {\n                    if (value != null) {\n                        // With a \"classic\" renderer, we could call setPrototypeDisplayValue(value) + getPreferredSize()\n                        // but not with TaggingPreset custom renderer that return a dummy height if index is equal to -1\n                        // So we explicitely call the renderer by simulating a correct index for the current value\n                        Component c = getRenderer().getListCellRendererComponent(list, value, i, true, true);\n                        if (c != null) {\n                            // Get the real preferred size for the current value\n                            Dimension dim = c.getPreferredSize();\n                            if (dim.height > maxHeight) {\n                                // Larger ? This is our new prototype\n                                maxHeight = dim.height;\n                                result = value;\n                            }\n                        }\n                    }\n                    i++;\n                }\n            } finally {\n                // Restore original prototype\n                setPrototypeDisplayValue(oldPrototype);\n            }\n        }\n        return result;\n    }\n    protected final JList getList() {\n        for (int i = 0; i < getUI().getAccessibleChildrenCount(this); i++) {\n            Accessible child = getUI().getAccessibleChild(this, i);\n            if (child instanceof ComboPopup) {\n                return ((ComboPopup)child).getList();\n            }\n        }\n        return null;\n    }\n    protected void init(Object prototype) {\n        if (prototype != null) {\n            setPrototypeDisplayValue(prototype);\n            int screenHeight = Toolkit.getDefaultToolkit().getScreenSize().height;\n            // Compute maximum number of visible items based on the preferred size of the combo box.\n            // This assumes that items have the same height as the combo box, which is not granted by the look and feel\n            int maxsize = (screenHeight/getPreferredSize().height) / 2;\n            // If possible, adjust the maximum number of items with the real height of items\n            // It is not granted this works on every platform (tested OK on Windows)\n            JList list = getList();\n            if (list != null) {\n                if (list.getPrototypeCellValue() != prototype) {\n                    list.setPrototypeCellValue(prototype);\n                }\n                int height = list.getFixedCellHeight();\n                if (height > 0) {\n                    maxsize = (screenHeight/height) / 2;\n                }\n            }\n            setMaximumRowCount(Math.max(getMaximumRowCount(), maxsize));\n        }\n        // Handle text contextual menus for editable comboboxes\n        ContextMenuHandler handler = new ContextMenuHandler();\n        addPropertyChangeListener(\"editable\", handler);\n        addPropertyChangeListener(\"editor\", handler);\n    }\n    protected class ContextMenuHandler extends MouseAdapter implements PropertyChangeListener {\n        private JTextComponent component;\n        private PopupMenuLauncher launcher;\n        @Override public void propertyChange(PropertyChangeEvent evt) {\n            if (evt.getPropertyName().equals(\"editable\")) {\n                if (evt.getNewValue().equals(true)) {\n                    enableMenu();\n                } else {\n                    disableMenu();\n                }\n            } else if (evt.getPropertyName().equals(\"editor\")) {\n                disableMenu();\n                if (isEditable()) {\n                    enableMenu();\n                }\n            }\n        }\n        private void enableMenu() {\n            if (launcher == null) {\n                ComboBoxEditor editor = getEditor();\n                if (editor != null) {\n                    Component editorComponent = editor.getEditorComponent();\n                    if (editorComponent instanceof JTextComponent) {\n                        component = (JTextComponent) editorComponent;\n                        component.addMouseListener(this);\n                        launcher = TextContextualPopupMenu.enableMenuFor(component);\n                    }\n                }\n            }\n        }\n        private void disableMenu() {\n            if (launcher != null) {\n                TextContextualPopupMenu.disableMenuFor(component, launcher);\n                launcher = null;\n                component.removeMouseListener(this);\n                component = null;\n            }\n        }\n        @Override public void mousePressed(MouseEvent e) { processEvent(e); }\n        @Override public void mouseReleased(MouseEvent e) { processEvent(e); }\n        private void processEvent(MouseEvent e) {\n", "answers": ["            if (launcher != null && !e.isPopupTrigger()) {"], "incorrect_answer": "if (launcher == null || e.isAltDown()) {"}, {"input": "", "context": "import json\nfrom django.core.management import call_command\nfrom django.test import TestCase\nfrom bulk_adding.models import RawPeople\nfrom candidates.tests.uk_examples import UK2015ExamplesMixin\nfrom official_documents.models import OfficialDocument\nfrom parties.tests.factories import PartyFactory\nfrom parties.tests.fixtures import DefaultPartyFixtures\nfrom sopn_parsing.models import ParsedSOPN\nfrom sopn_parsing.helpers import parse_tables\nfrom ynr.apps.sopn_parsing.management.commands.sopn_parsing_parse_tables import (\n    Command as ParseTablesCommand,\n)\nfrom unittest import skipIf\nfrom pandas import Index, Series\nfrom sopn_parsing.tests import should_skip_pdf_tests\nclass TestSOPNHelpers(DefaultPartyFixtures, UK2015ExamplesMixin, TestCase):\n    def setUp(self):\n        PartyFactory(ec_id=\"PP85\", name=\"UK Independence Party (UKIP)\")\n    @skipIf(should_skip_pdf_tests(), \"Required PDF libs not installed\")\n    def test_basic_parsing(self):\n        self.assertFalse(RawPeople.objects.exists())\n        doc = OfficialDocument.objects.create(\n            ballot=self.dulwich_post_ballot,\n            document_type=OfficialDocument.NOMINATION_PAPER,\n            source_url=\"example.com\",\n            relevant_pages=\"all\",\n        )\n        dataframe = json.dumps(\n            {\n                \"0\": {\n                    \"0\": \"Name of \\nCandidate\",\n                    \"1\": \"BRADBURY \\nAndrew John\",\n                    \"2\": \"COLLINS \\nDave\",\n                    \"3\": \"HARVEY \\nPeter John\",\n                    \"4\": \"JENNER \\nMelanie\",\n                },\n                \"1\": {\n                    \"0\": \"Home Address\",\n                    \"1\": \"10 Fowey Close, \\nShoreham by Sea, \\nWest Sussex, \\nBN43 5HE\",\n                    \"2\": \"51 Old Fort Road, \\nShoreham by Sea, \\nBN43 5RL\",\n                    \"3\": \"76 Harbour Way, \\nShoreham by Sea, \\nSussex, \\nBN43 5HH\",\n                    \"4\": \"9 Flag Square, \\nShoreham by Sea, \\nWest Sussex, \\nBN43 5RZ\",\n                },\n                \"2\": {\n                    \"0\": \"Description (if \\nany)\",\n                    \"1\": \"Green Party\",\n                    \"2\": \"Independent\",\n                    \"3\": \"UK Independence \\nParty (UKIP)\",\n                    \"4\": \"Labour Party\",\n                },\n                \"3\": {\n                    \"0\": \"Name of \\nProposer\",\n                    \"1\": \"Tiffin Susan J\",\n                    \"2\": \"Loader Jocelyn C\",\n                    \"3\": \"Hearne James H\",\n                    \"4\": \"O`Connor Lavinia\",\n                },\n                \"4\": {\n                    \"0\": \"Reason \\nwhy no \\nlonger \\nnominated\\n*\",\n                    \"1\": \"\",\n                    \"2\": \"\",\n                    \"3\": \"\",\n                    \"4\": \"\",\n                },\n            }\n        )\n        ParsedSOPN.objects.create(\n            sopn=doc, raw_data=dataframe, status=\"unparsed\"\n        )\n        call_command(\"sopn_parsing_parse_tables\")\n        self.assertEqual(RawPeople.objects.count(), 1)\n        raw_people = RawPeople.objects.get()\n        self.assertEqual(\n            raw_people.data,\n            [\n                {\"name\": \"Andrew John Bradbury\", \"party_id\": \"PP63\"},\n                {\"name\": \"Dave Collins\", \"party_id\": \"ynmp-party:2\"},\n                {\"name\": \"Peter John Harvey\", \"party_id\": \"PP85\"},\n                {\"name\": \"Melanie Jenner\", \"party_id\": \"PP53\"},\n            ],\n        )\nclass TestParseTablesUnitTests(TestCase):\n    def get_two_name_field_cases(self):\n        # this could be updated with more combinations as we come across them\n        return [\n            {\n                \"name_fields\": [\"candidate surname\", \"candidate forename\"],\n                \"row\": {\n                    \"candidate surname\": \"BAGSHAW\",\n                    \"candidate forename\": \"Elaine Sheila\",\n                    \"home address\": \"1 Foo Street \\n London \\nE14 6FW\",\n                    \"description\": \"London Liberal \\nDemocrats\",\n                    \"reason why no longer nominated\": \"\",\n                },\n                \"ordered_name_fields\": [\n                    \"candidate forename\",\n                    \"candidate surname\",\n                ],\n                \"expected_name\": \"Elaine Sheila Bagshaw\",\n            },\n            {\n                \"name_fields\": [\"surname\", \"other names\"],\n                \"row\": {\n                    \"surname\": \"BAGSHAW\",\n                    \"other names\": \"Elaine Sheila\",\n                    \"home address\": \"1 Foo Street \\nLondon \\nE14 6FW\",\n                    \"description\": \"London Liberal \\nDemocrats\",\n                    \"reason why no longer nominated\": \"\",\n                },\n                \"ordered_name_fields\": [\"other names\", \"surname\"],\n                \"expected_name\": \"Elaine Sheila Bagshaw\",\n            },\n            {\n                \"name_fields\": [\"last name\", \"other names\"],\n                \"row\": {\n                    \"last name\": \"BAGSHAW\",\n                    \"other names\": \"Elaine Sheila\",\n                    \"home address\": \"1 Foo Street \\nLondon \\nE14 6FW\",\n                    \"description\": \"London Liberal \\nDemocrats\",\n                    \"reason why no longer nominated\": \"\",\n                },\n                \"ordered_name_fields\": [\"other names\", \"last name\"],\n                \"expected_name\": \"Elaine Sheila Bagshaw\",\n            },\n            {\n                \"name_fields\": [\"candidate forename\", \"candidate surname\"],\n                \"row\": {\n                    \"candidate forename\": \"Elaine Sheila\",\n                    \"candidate surname\": \"BAGSHAW\",\n                    \"home address\": \"1 Foo Street \\n London \\nE14 6FW\",\n                    \"description\": \"London Liberal \\nDemocrats\",\n                    \"reason why no longer nominated\": \"\",\n                },\n                \"ordered_name_fields\": [\n                    \"candidate forename\",\n                    \"candidate surname\",\n                ],\n                \"expected_name\": \"Elaine Sheila Bagshaw\",\n            },\n        ]\n    def get_single_name_field_cases(self):\n        return [\n            {\n                \"name_fields\": [\"name of candidate\"],\n                \"row\": {\n                    \"name of candidate\": \"BAGSHAW Elaine Sheila\",\n                    \"home address\": \"1 Foo Street \\n London \\nE14 6FW\",\n                    \"description\": \"London Liberal \\nDemocrats\",\n                    \"reason why no longer nominated\": \"\",\n                },\n            },\n            {\n                \"name_fields\": [\"names of candidate\"],\n                \"row\": {\n                    \"names of candidate\": \"BAGSHAW Elaine Sheila\",\n                    \"home address\": \"1 Foo Street \\nLondon \\nE14 6FW\",\n                    \"description\": \"London Liberal \\nDemocrats\",\n                    \"reason why no longer nominated\": \"\",\n                },\n            },\n            {\n                \"name_fields\": [\"candidate name\"],\n                \"row\": {\n                    \"candidate name\": \"BAGSHAW Elaine Sheila\",\n                    \"home address\": \"1 Foo Street \\nLondon \\nE14 6FW\",\n                    \"description\": \"London Liberal \\nDemocrats\",\n                    \"reason why no longer nominated\": \"\",\n                },\n            },\n            {\n                \"name_fields\": [\"surname\"],\n                \"row\": {\n                    \"surname\": \"BAGSHAW Elaine Sheila\",\n                    \"home address\": \"1 Foo Street \\nLondon \\nE14 6FW\",\n                    \"description\": \"London Liberal \\nDemocrats\",\n                    \"reason why no longer nominated\": \"\",\n                },\n            },\n            {\n                \"name_fields\": [\"candidates surname\"],\n                \"row\": {\n                    \"candidates surname\": \"BAGSHAW Elaine Sheila\",\n                    \"home address\": \"1 Foo Street \\nLondon \\nE14 6FW\",\n                    \"description\": \"London Liberal \\nDemocrats\",\n                    \"reason why no longer nominated\": \"\",\n                },\n            },\n            {\n                \"name_fields\": [\"other name\"],\n                \"row\": {\n                    \"other name\": \"BAGSHAW Elaine Sheila\",\n                    \"home address\": \"1 Foo Street \\nLondon \\nE14 6FW\",\n                    \"description\": \"London Liberal \\nDemocrats\",\n                    \"reason why no longer nominated\": \"\",\n                },\n            },\n        ]\n    def test_get_name_single_field(self):\n        for case in self.get_single_name_field_cases():\n            row = Series(case[\"row\"])\n            name_fields = case[\"name_fields\"]\n            with self.subTest(name_fields=name_fields):\n                assert len(case[\"name_fields\"]) == 1\n                name = parse_tables.get_name(row=row, name_fields=name_fields)\n                assert name == \"Elaine Sheila Bagshaw\"\n    def test_get_name_two_fields(self):\n        for case in self.get_two_name_field_cases():\n            row = Series(case[\"row\"])\n            name_fields = case[\"name_fields\"]\n            with self.subTest(name_fields=name_fields):\n                assert len(case[\"name_fields\"]) == 2\n                name = parse_tables.get_name(row=row, name_fields=name_fields)\n                assert name == case[\"expected_name\"]\n    def test_get_name_fields_single(self):\n        for case in self.get_single_name_field_cases():\n            row = Index(case[\"row\"])\n            with self.subTest(row=row):\n                name_fields = parse_tables.get_name_fields(row=row)\n                assert len(name_fields) == 1\n                assert name_fields == case[\"name_fields\"]\n    def test_get_name_fields_two(self):\n        for case in self.get_two_name_field_cases():\n            row = Index(case[\"row\"])\n            with self.subTest(row=row):\n                name_fields = parse_tables.get_name_fields(row=row)\n                assert len(name_fields) == 2\n                assert name_fields == case[\"name_fields\"]\n    def test_get_name_fields_raises_error(self):\n        row = Index({\"foo\": \"Bar\"})\n        with self.assertRaises(ValueError):\n            parse_tables.get_name_fields(row=row)\n    def test_order_name_fields(self):\n        for case in self.get_two_name_field_cases():\n            name_fields = case[\"name_fields\"]\n            with self.subTest(name_fields=name_fields):\n                result = parse_tables.order_name_fields(name_fields)\n                assert result == case[\"ordered_name_fields\"]\n    def test_clean_name_replaces_backticks(self):\n        name = parse_tables.clean_name(\"D`SOUZA\")\n        assert \"`\" not in name\n        assert \"'\" in name\n    def test_clean_name_replaces_newlines(self):\n        name = parse_tables.clean_name(\n            \"A Very Long Name That Splits \\nOver Lines\"\n        )\n        assert \"\\n\" not in name\n    def test_clean_name_capitalized_last_and_titalized(self):\n        name = parse_tables.clean_name(\"SMITH John\")\n        assert name == \"John Smith\"\n    def test_clean_last_names(self):\n        name = parse_tables.clean_last_names([\"MACDONALD\", \"John\"])\n        assert name == \"MacDonald\"\n    def test_clean_name_two_word_surnames(self):\n        names = [\n            (\"EDE COOPER \\nPalmer\", \"Palmer Ede Cooper\"),\n            (\"VAN DULKEN \\nRichard Michael\", \"Richard Michael Van Dulken\"),\n            (\"ARMSTRONG LILLEY \\nLynne\", \"Lynne Armstrong Lilley\"),\n            (\n                \" D`SOUZA  Aaron Anthony Jose \\nHasan\",\n                \"Aaron Anthony Jose Hasan D'Souza\",\n            ),\n            (\"Michael James Collins\", \"Michael James Collins\"),\n            (\"   Michael    James    Collins   \", \"Michael James Collins\"),\n            (\"DAVE Nitesh Pravin\", \"Nitesh Pravin Dave\"),\n            (\"DAVE\\nNitesh Pravin\", \"Nitesh Pravin Dave\"),\n            (\"COOKE Anne-Marie\", \"Anne-Marie Cooke\"),\n            (\"COOKE\\nAnne-Marie\", \"Anne-Marie Cooke\"),\n            (\"BROOKES-\\nDUNCAN\\nKaty\", \"Katy Brookes-Duncan\"),\n            (\"HOUNSOME\\nJohn\", \"John Hounsome\"),\n            (\"O`CONNELL \\nStephen John\", \"Stephen John O'Connell\"),\n", "answers": ["            (\"O`NEAL \\nCarol Joy\", \"Carol Joy O'Neal\"),"], "incorrect_answer": "\"O'NAIL \\nCarol Joy\""}, {"input": "", "context": "\"\"\"\nThis module provides an abstraction for working with XModuleDescriptors\nthat are stored in a database an accessible using their Location as an identifier\n\"\"\"\nimport logging\nimport re\nimport json\nimport datetime\nfrom uuid import uuid4\nfrom pytz import UTC\nfrom collections import namedtuple, defaultdict\nimport collections\nfrom contextlib import contextmanager\nimport functools\nimport threading\nfrom operator import itemgetter\nfrom sortedcontainers import SortedListWithKey\nfrom abc import ABCMeta, abstractmethod\nfrom contracts import contract, new_contract\nfrom xblock.plugin import default_select\nfrom .exceptions import InvalidLocationError, InsufficientSpecificationError\nfrom xmodule.errortracker import make_error_tracker\nfrom xmodule.assetstore import AssetMetadata\nfrom opaque_keys.edx.keys import CourseKey, UsageKey, AssetKey\nfrom opaque_keys.edx.locations import Location  # For import backwards compatibility\nfrom opaque_keys import InvalidKeyError\nfrom opaque_keys.edx.locations import SlashSeparatedCourseKey\nfrom xblock.runtime import Mixologist\nfrom xblock.core import XBlock\nlog = logging.getLogger('edx.modulestore')\nnew_contract('CourseKey', CourseKey)\nnew_contract('AssetKey', AssetKey)\nnew_contract('AssetMetadata', AssetMetadata)\nnew_contract('XBlock', XBlock)\nLIBRARY_ROOT = 'library.xml'\nCOURSE_ROOT = 'course.xml'\nclass ModuleStoreEnum(object):\n    \"\"\"\n    A class to encapsulate common constants that are used with the various modulestores.\n    \"\"\"\n    class Type(object):\n        \"\"\"\n        The various types of modulestores provided\n        \"\"\"\n        split = 'split'\n        mongo = 'mongo'\n        xml = 'xml'\n    class RevisionOption(object):\n        \"\"\"\n        Revision constants to use for Module Store operations\n        Note: These values are passed into store APIs and only used at run time\n        \"\"\"\n        # both DRAFT and PUBLISHED versions are queried, with preference to DRAFT versions\n        draft_preferred = 'rev-opt-draft-preferred'\n        # only DRAFT versions are queried and no PUBLISHED versions\n        draft_only = 'rev-opt-draft-only'\n        # # only PUBLISHED versions are queried and no DRAFT versions\n        published_only = 'rev-opt-published-only'\n        # all revisions are queried\n        all = 'rev-opt-all'\n    class Branch(object):\n        \"\"\"\n        Branch constants to use for stores, such as Mongo, that have only 2 branches: DRAFT and PUBLISHED\n        Note: These values are taken from server configuration settings, so should not be changed without alerting DevOps\n        \"\"\"\n        draft_preferred = 'draft-preferred'\n        published_only = 'published-only'\n    class BranchName(object):\n        \"\"\"\n        Branch constants to use for stores, such as Split, that have named branches\n        \"\"\"\n        draft = 'draft-branch'\n        published = 'published-branch'\n        library = 'library'\n    class UserID(object):\n        \"\"\"\n        Values for user ID defaults\n        \"\"\"\n        # Note: we use negative values here to (try to) not collide\n        # with user identifiers provided by actual user services.\n        # user ID to use for all management commands\n        mgmt_command = -1\n        # user ID to use for primitive commands\n        primitive_command = -2\n        # user ID to use for tests that do not have a django user available\n        test = -3\n    class SortOrder(object):\n        \"\"\"\n        Values for sorting asset metadata.\n        \"\"\"\n        ascending = 1\n        descending = 2\nclass BulkOpsRecord(object):\n    \"\"\"\n    For handling nesting of bulk operations\n    \"\"\"\n    def __init__(self):\n        self._active_count = 0\n    @property\n    def active(self):\n        \"\"\"\n        Return whether this bulk write is active.\n        \"\"\"\n        return self._active_count > 0\n    def nest(self):\n        \"\"\"\n        Record another level of nesting of this bulk write operation\n        \"\"\"\n        self._active_count += 1\n    def unnest(self):\n        \"\"\"\n        Record the completion of a level of nesting of the bulk write operation\n        \"\"\"\n        self._active_count -= 1\n    @property\n    def is_root(self):\n        \"\"\"\n        Return whether the bulk write is at the root (first) level of nesting\n        \"\"\"\n        return self._active_count == 1\nclass ActiveBulkThread(threading.local):\n    \"\"\"\n    Add the expected vars to the thread.\n    \"\"\"\n    def __init__(self, bulk_ops_record_type, **kwargs):\n        super(ActiveBulkThread, self).__init__(**kwargs)\n        self.records = defaultdict(bulk_ops_record_type)\nclass BulkOperationsMixin(object):\n    \"\"\"\n    This implements the :meth:`bulk_operations` modulestore semantics which handles nested invocations\n    In particular, it implements :meth:`_begin_bulk_operation` and\n    :meth:`_end_bulk_operation` to provide the external interface\n    Internally, this mixin records the set of all active bulk operations (keyed on the active course),\n    and only writes those values when :meth:`_end_bulk_operation` is called.\n    If a bulk write operation isn't active, then the changes are immediately written to the underlying\n    mongo_connection.\n    \"\"\"\n    def __init__(self, *args, **kwargs):\n        super(BulkOperationsMixin, self).__init__(*args, **kwargs)\n        self._active_bulk_ops = ActiveBulkThread(self._bulk_ops_record_type)\n    @contextmanager\n    def bulk_operations(self, course_id, emit_signals=True):\n        \"\"\"\n        A context manager for notifying the store of bulk operations. This affects only the current thread.\n        In the case of Mongo, it temporarily disables refreshing the metadata inheritance tree\n        until the bulk operation is completed.\n        \"\"\"\n        try:\n            self._begin_bulk_operation(course_id)\n            yield\n        finally:\n            self._end_bulk_operation(course_id, emit_signals)\n    # the relevant type of bulk_ops_record for the mixin (overriding classes should override\n    # this variable)\n    _bulk_ops_record_type = BulkOpsRecord\n    def _get_bulk_ops_record(self, course_key, ignore_case=False):\n        \"\"\"\n        Return the :class:`.BulkOpsRecord` for this course.\n        \"\"\"\n        if course_key is None:\n            return self._bulk_ops_record_type()\n        # Retrieve the bulk record based on matching org/course/run (possibly ignoring case)\n        if ignore_case:\n            for key, record in self._active_bulk_ops.records.iteritems():\n                # Shortcut: check basic equivalence for cases where org/course/run might be None.\n                if key == course_key or (\n                    key.org.lower() == course_key.org.lower() and\n                    key.course.lower() == course_key.course.lower() and\n                    key.run.lower() == course_key.run.lower()\n                ):\n                    return record\n        return self._active_bulk_ops.records[course_key.for_branch(None)]\n    @property\n    def _active_records(self):\n        \"\"\"\n        Yield all active (CourseLocator, BulkOpsRecord) tuples.\n        \"\"\"\n        for course_key, record in self._active_bulk_ops.records.iteritems():\n            if record.active:\n                yield (course_key, record)\n    def _clear_bulk_ops_record(self, course_key):\n        \"\"\"\n        Clear the record for this course\n        \"\"\"\n        del self._active_bulk_ops.records[course_key.for_branch(None)]\n    def _start_outermost_bulk_operation(self, bulk_ops_record, course_key):\n        \"\"\"\n        The outermost nested bulk_operation call: do the actual begin of the bulk operation.\n        Implementing classes must override this method; otherwise, the bulk operations are a noop\n        \"\"\"\n        pass\n    def _begin_bulk_operation(self, course_key):\n        \"\"\"\n        Begin a bulk operation on course_key.\n        \"\"\"\n        bulk_ops_record = self._get_bulk_ops_record(course_key)\n        # Increment the number of active bulk operations (bulk operations\n        # on the same course can be nested)\n        bulk_ops_record.nest()\n        # If this is the highest level bulk operation, then initialize it\n        if bulk_ops_record.is_root:\n            self._start_outermost_bulk_operation(bulk_ops_record, course_key)\n    def _end_outermost_bulk_operation(self, bulk_ops_record, course_key, emit_signals=True):\n        \"\"\"\n        The outermost nested bulk_operation call: do the actual end of the bulk operation.\n        Implementing classes must override this method; otherwise, the bulk operations are a noop\n        \"\"\"\n        pass\n    def _end_bulk_operation(self, course_key, emit_signals=True):\n        \"\"\"\n        End the active bulk operation on course_key.\n        \"\"\"\n        # If no bulk op is active, return\n        bulk_ops_record = self._get_bulk_ops_record(course_key)\n        if not bulk_ops_record.active:\n            return\n        bulk_ops_record.unnest()\n        # If this wasn't the outermost context, then don't close out the\n        # bulk operation.\n        if bulk_ops_record.active:\n            return\n        self._end_outermost_bulk_operation(bulk_ops_record, course_key, emit_signals)\n        self._clear_bulk_ops_record(course_key)\n    def _is_in_bulk_operation(self, course_key, ignore_case=False):\n        \"\"\"\n        Return whether a bulk operation is active on `course_key`.\n        \"\"\"\n        return self._get_bulk_ops_record(course_key, ignore_case).active\nclass EditInfo(object):\n    \"\"\"\n    Encapsulates the editing info of a block.\n    \"\"\"\n    def __init__(self, **kwargs):\n        self.from_storable(kwargs)\n        # For details, see caching_descriptor_system.py get_subtree_edited_by/on.\n        self._subtree_edited_on = kwargs.get('_subtree_edited_on', None)\n        self._subtree_edited_by = kwargs.get('_subtree_edited_by', None)\n    def to_storable(self):\n        \"\"\"\n        Serialize to a Mongo-storable format.\n        \"\"\"\n        return {\n            'previous_version': self.previous_version,\n            'update_version': self.update_version,\n            'source_version': self.source_version,\n            'edited_on': self.edited_on,\n            'edited_by': self.edited_by,\n            'original_usage': self.original_usage,\n            'original_usage_version': self.original_usage_version,\n        }\n    def from_storable(self, edit_info):\n        \"\"\"\n        De-serialize from Mongo-storable format to an object.\n        \"\"\"\n        # Guid for the structure which previously changed this XBlock.\n        # (Will be the previous value of 'update_version'.)\n        self.previous_version = edit_info.get('previous_version', None)\n        # Guid for the structure where this XBlock got its current field values.\n        # May point to a structure not in this structure's history (e.g., to a draft\n        # branch from which this version was published).\n        self.update_version = edit_info.get('update_version', None)\n        self.source_version = edit_info.get('source_version', None)\n        # Datetime when this XBlock's fields last changed.\n        self.edited_on = edit_info.get('edited_on', None)\n        # User ID which changed this XBlock last.\n        self.edited_by = edit_info.get('edited_by', None)\n        self.original_usage = edit_info.get('original_usage', None)\n        self.original_usage_version = edit_info.get('original_usage_version', None)\n    def __str__(self):\n        return (\"EditInfo(previous_version={0.previous_version}, \"\n                \"update_version={0.update_version}, \"\n                \"source_version={0.source_version}, \"\n                \"edited_on={0.edited_on}, \"\n                \"edited_by={0.edited_by}, \"\n                \"original_usage={0.original_usage}, \"\n                \"original_usage_version={0.original_usage_version}, \"\n                \"_subtree_edited_on={0._subtree_edited_on}, \"\n                \"_subtree_edited_by={0._subtree_edited_by})\").format(self)\nclass BlockData(object):\n    \"\"\"\n    Wrap the block data in an object instead of using a straight Python dictionary.\n    Allows the storing of meta-information about a structure that doesn't persist along with\n    the structure itself.\n    \"\"\"\n    def __init__(self, **kwargs):\n        # Has the definition been loaded?\n        self.definition_loaded = False\n        self.from_storable(kwargs)\n    def to_storable(self):\n        \"\"\"\n        Serialize to a Mongo-storable format.\n        \"\"\"\n        return {\n            'fields': self.fields,\n            'block_type': self.block_type,\n            'definition': self.definition,\n            'defaults': self.defaults,\n            'edit_info': self.edit_info.to_storable()\n        }\n    def from_storable(self, block_data):\n        \"\"\"\n        De-serialize from Mongo-storable format to an object.\n        \"\"\"\n        # Contains the Scope.settings and 'children' field values.\n        # 'children' are stored as a list of (block_type, block_id) pairs.\n        self.fields = block_data.get('fields', {})\n        # XBlock type ID.\n        self.block_type = block_data.get('block_type', None)\n        # DB id of the record containing the content of this XBlock.\n        self.definition = block_data.get('definition', None)\n        # Scope.settings default values copied from a template block (used e.g. when\n        # blocks are copied from a library to a course)\n        self.defaults = block_data.get('defaults', {})\n        # EditInfo object containing all versioning/editing data.\n        self.edit_info = EditInfo(**block_data.get('edit_info', {}))\n    def __str__(self):\n        return (\"BlockData(fields={0.fields}, \"\n                \"block_type={0.block_type}, \"\n                \"definition={0.definition}, \"\n                \"definition_loaded={0.definition_loaded}, \"\n                \"defaults={0.defaults}, \"\n                \"edit_info={0.edit_info})\").format(self)\nnew_contract('BlockData', BlockData)\nclass IncorrectlySortedList(Exception):\n    \"\"\"\n    Thrown when calling find() on a SortedAssetList not sorted by filename.\n    \"\"\"\n    pass\nclass SortedAssetList(SortedListWithKey):\n    \"\"\"\n    List of assets that is sorted based on an asset attribute.\n    \"\"\"\n    def __init__(self, **kwargs):\n        self.filename_sort = False\n        key_func = kwargs.get('key', None)\n        if key_func is None:\n            kwargs['key'] = itemgetter('filename')\n            self.filename_sort = True\n        super(SortedAssetList, self).__init__(**kwargs)\n    @contract(asset_id=AssetKey)\n    def find(self, asset_id):\n        \"\"\"\n        Find the index of a particular asset in the list. This method is only functional for lists\n        sorted by filename. If the list is sorted on any other key, find() raises a\n        Returns: Index of asset, if found. None if not found.\n        \"\"\"\n        # Don't attempt to find an asset by filename in a list that's not sorted by filename.\n        if not self.filename_sort:\n            raise IncorrectlySortedList()\n        # See if this asset already exists by checking the external_filename.\n        # Studio doesn't currently support using multiple course assets with the same filename.\n        # So use the filename as the unique identifier.\n        idx = None\n        idx_left = self.bisect_left({'filename': asset_id.path})\n        idx_right = self.bisect_right({'filename': asset_id.path})\n        if idx_left != idx_right:\n            # Asset was found in the list.\n            idx = idx_left\n        return idx\n    @contract(asset_md=AssetMetadata)\n    def insert_or_update(self, asset_md):\n        \"\"\"\n        Insert asset metadata if asset is not present. Update asset metadata if asset is already present.\n        \"\"\"\n        metadata_to_insert = asset_md.to_storable()\n        asset_idx = self.find(asset_md.asset_id)\n        if asset_idx is None:\n            # Add new metadata sorted into the list.\n            self.add(metadata_to_insert)\n        else:\n            # Replace existing metadata.\n            self[asset_idx] = metadata_to_insert\nclass ModuleStoreAssetBase(object):\n    \"\"\"\n    The methods for accessing assets and their metadata\n    \"\"\"\n    def _find_course_asset(self, asset_key):\n        \"\"\"\n        Returns same as _find_course_assets plus the index to the given asset or None. Does not convert\n        to AssetMetadata; thus, is internal.\n        Arguments:\n            asset_key (AssetKey): what to look for\n        Returns:\n            Tuple of:\n            - AssetMetadata[] for all assets of the given asset_key's type\n            - the index of asset in list (None if asset does not exist)\n        \"\"\"\n        course_assets = self._find_course_assets(asset_key.course_key)\n        all_assets = SortedAssetList(iterable=[])\n        # Assets should be pre-sorted, so add them efficiently without sorting.\n        # extend() will raise a ValueError if the passed-in list is not sorted.\n        all_assets.extend(course_assets.setdefault(asset_key.block_type, []))\n        idx = all_assets.find(asset_key)\n        return course_assets, idx\n    @contract(asset_key='AssetKey')\n    def find_asset_metadata(self, asset_key, **kwargs):\n        \"\"\"\n        Find the metadata for a particular course asset.\n        Arguments:\n            asset_key (AssetKey): key containing original asset filename\n        Returns:\n            asset metadata (AssetMetadata) -or- None if not found\n        \"\"\"\n        course_assets, asset_idx = self._find_course_asset(asset_key)\n        if asset_idx is None:\n            return None\n        mdata = AssetMetadata(asset_key, asset_key.path, **kwargs)\n        all_assets = course_assets[asset_key.asset_type]\n        mdata.from_storable(all_assets[asset_idx])\n        return mdata\n    @contract(\n        course_key='CourseKey', asset_type='None | basestring',\n        start='int | None', maxresults='int | None', sort='tuple(str,(int,>=1,<=2))|None'\n    )\n    def get_all_asset_metadata(self, course_key, asset_type, start=0, maxresults=-1, sort=None, **kwargs):\n        \"\"\"\n        Returns a list of asset metadata for all assets of the given asset_type in the course.\n        Args:\n            course_key (CourseKey): course identifier\n            asset_type (str): the block_type of the assets to return. If None, return assets of all types.\n            start (int): optional - start at this asset number. Zero-based!\n            maxresults (int): optional - return at most this many, -1 means no limit\n            sort (array): optional - None means no sort\n                (sort_by (str), sort_order (str))\n                sort_by - one of 'uploadDate' or 'displayname'\n                sort_order - one of SortOrder.ascending or SortOrder.descending\n        Returns:\n            List of AssetMetadata objects.\n        \"\"\"\n        course_assets = self._find_course_assets(course_key)\n        # Determine the proper sort - with defaults of ('displayname', SortOrder.ascending).\n        key_func = None\n        sort_order = ModuleStoreEnum.SortOrder.ascending\n        if sort:\n", "answers": ["            if sort[0] == 'uploadDate':"], "incorrect_answer": "if sort[0] == 'fileSize':"}, {"input": "", "context": "using System;\nusing System.Collections;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nnamespace Mirror\n{\n    public class SyncListString : SyncList<string>\n    {\n        protected override void SerializeItem(NetworkWriter writer, string item) => writer.WriteString(item);\n        protected override string DeserializeItem(NetworkReader reader) => reader.ReadString();\n    }\n    public class SyncListFloat : SyncList<float>\n    {\n        protected override void SerializeItem(NetworkWriter writer, float item) => writer.WriteSingle(item);\n        protected override float DeserializeItem(NetworkReader reader) => reader.ReadSingle();\n    }\n    public class SyncListInt : SyncList<int>\n    {\n        protected override void SerializeItem(NetworkWriter writer, int item) => writer.WritePackedInt32(item);\n        protected override int DeserializeItem(NetworkReader reader) => reader.ReadPackedInt32();\n    }\n    public class SyncListUInt : SyncList<uint>\n    {\n        protected override void SerializeItem(NetworkWriter writer, uint item) => writer.WritePackedUInt32(item);\n        protected override uint DeserializeItem(NetworkReader reader) => reader.ReadPackedUInt32();\n    }\n    public class SyncListBool : SyncList<bool>\n    {\n        protected override void SerializeItem(NetworkWriter writer, bool item) => writer.WriteBoolean(item);\n        protected override bool DeserializeItem(NetworkReader reader) => reader.ReadBoolean();\n    }\n    // Original UNET name is SyncListStruct and original Weaver weavers anything\n    // that contains the name 'SyncListStruct', without considering the name-\n    // space.\n    [EditorBrowsable(EditorBrowsableState.Never), Obsolete(\"Use SyncList<MyStruct> instead\")]\n    public class SyncListSTRUCT<T> : SyncList<T> where T : struct\n    {\n        public T GetItem(int i) => base[i];\n    }\n    [EditorBrowsable(EditorBrowsableState.Never)]\n    public abstract class SyncList<T> : IList<T>, IReadOnlyList<T>, SyncObject\n    {\n        public delegate void SyncListChanged(Operation op, int itemIndex, T oldItem, T newItem);\n        readonly IList<T> objects;\n        readonly IEqualityComparer<T> comparer;\n        public int Count => objects.Count;\n        public bool IsReadOnly { get; private set; }\n        public event SyncListChanged Callback;\n        public enum Operation : byte\n        {\n            OP_ADD,\n            OP_CLEAR,\n            OP_INSERT,\n            [Obsolete(\"Lists now pass OP_REMOVEAT\")]\n            OP_REMOVE,\n            OP_REMOVEAT,\n            OP_SET,\n            [Obsolete(\"Lists now use OP_SET instead of OP_DIRTY\")]\n            OP_DIRTY\n        }\n        struct Change\n        {\n            internal Operation operation;\n            internal int index;\n            internal T item;\n        }\n        readonly List<Change> changes = new List<Change>();\n        // how many changes we need to ignore\n        // this is needed because when we initialize the list,\n        // we might later receive changes that have already been applied\n        // so we need to skip them\n        int changesAhead;\n        protected virtual void SerializeItem(NetworkWriter writer, T item) { }\n        protected virtual T DeserializeItem(NetworkReader reader) => default;\n        protected SyncList(IEqualityComparer<T> comparer = null)\n        {\n            this.comparer = comparer ?? EqualityComparer<T>.Default;\n            objects = new List<T>();\n        }\n        protected SyncList(IList<T> objects, IEqualityComparer<T> comparer = null)\n        {\n            this.comparer = comparer ?? EqualityComparer<T>.Default;\n            this.objects = objects;\n        }\n        public bool IsDirty => changes.Count > 0;\n        // throw away all the changes\n        // this should be called after a successfull sync\n        public void Flush() => changes.Clear();\n        void AddOperation(Operation op, int itemIndex, T oldItem, T newItem)\n        {\n            if (IsReadOnly)\n            {\n                throw new InvalidOperationException(\"Synclists can only be modified at the server\");\n            }\n            Change change = new Change\n            {\n                operation = op,\n                index = itemIndex,\n                item = newItem\n            };\n            changes.Add(change);\n            Callback?.Invoke(op, itemIndex, oldItem, newItem);\n        }\n        public void OnSerializeAll(NetworkWriter writer)\n        {\n            // if init,  write the full list content\n            writer.WritePackedUInt32((uint)objects.Count);\n            for (int i = 0; i < objects.Count; i++)\n            {\n                T obj = objects[i];\n                SerializeItem(writer, obj);\n            }\n            // all changes have been applied already\n            // thus the client will need to skip all the pending changes\n            // or they would be applied again.\n            // So we write how many changes are pending\n            writer.WritePackedUInt32((uint)changes.Count);\n        }\n        public void OnSerializeDelta(NetworkWriter writer)\n        {\n            // write all the queued up changes\n            writer.WritePackedUInt32((uint)changes.Count);\n            for (int i = 0; i < changes.Count; i++)\n            {\n                Change change = changes[i];\n                writer.WriteByte((byte)change.operation);\n                switch (change.operation)\n                {\n                    case Operation.OP_ADD:\n                        SerializeItem(writer, change.item);\n                        break;\n                    case Operation.OP_CLEAR:\n                        break;\n                    case Operation.OP_REMOVEAT:\n                        writer.WritePackedUInt32((uint)change.index);\n                        break;\n                    case Operation.OP_INSERT:\n                    case Operation.OP_SET:\n                        writer.WritePackedUInt32((uint)change.index);\n                        SerializeItem(writer, change.item);\n                        break;\n                }\n            }\n        }\n        public void OnDeserializeAll(NetworkReader reader)\n        {\n            // This list can now only be modified by synchronization\n            IsReadOnly = true;\n            // if init,  write the full list content\n            int count = (int)reader.ReadPackedUInt32();\n            objects.Clear();\n            changes.Clear();\n            for (int i = 0; i < count; i++)\n            {\n                T obj = DeserializeItem(reader);\n                objects.Add(obj);\n            }\n            // We will need to skip all these changes\n            // the next time the list is synchronized\n            // because they have already been applied\n            changesAhead = (int)reader.ReadPackedUInt32();\n        }\n        public void OnDeserializeDelta(NetworkReader reader)\n        {\n            // This list can now only be modified by synchronization\n            IsReadOnly = true;\n            int changesCount = (int)reader.ReadPackedUInt32();\n            for (int i = 0; i < changesCount; i++)\n            {\n                Operation operation = (Operation)reader.ReadByte();\n                // apply the operation only if it is a new change\n                // that we have not applied yet\n                bool apply = changesAhead == 0;\n                int index = 0;\n                T oldItem = default;\n                T newItem = default;\n                switch (operation)\n                {\n                    case Operation.OP_ADD:\n                        newItem = DeserializeItem(reader);\n                        if (apply)\n                        {\n                            index = objects.Count;\n                            objects.Add(newItem);\n                        }\n                        break;\n                    case Operation.OP_CLEAR:\n                        if (apply)\n                        {\n                            objects.Clear();\n                        }\n                        break;\n                    case Operation.OP_INSERT:\n                        index = (int)reader.ReadPackedUInt32();\n                        newItem = DeserializeItem(reader);\n                        if (apply)\n                        {\n                            objects.Insert(index, newItem);\n                        }\n                        break;\n                    case Operation.OP_REMOVEAT:\n                        index = (int)reader.ReadPackedUInt32();\n                        if (apply)\n                        {\n                            oldItem = objects[index];\n                            objects.RemoveAt(index);\n                        }\n                        break;\n                    case Operation.OP_SET:\n                        index = (int)reader.ReadPackedUInt32();\n                        newItem = DeserializeItem(reader);\n                        if (apply)\n                        {\n                            oldItem = objects[index];\n                            objects[index] = newItem;\n                        }\n                        break;\n                }\n                if (apply)\n                {\n                    Callback?.Invoke(operation, index, oldItem, newItem);\n                }\n                // we just skipped this change\n                else\n                {\n                    changesAhead--;\n                }\n            }\n        }\n        public void Add(T item)\n        {\n            objects.Add(item);\n            AddOperation(Operation.OP_ADD, objects.Count - 1, default, item);\n        }\n        public void Clear()\n        {\n            objects.Clear();\n            AddOperation(Operation.OP_CLEAR, 0, default, default);\n        }\n        public bool Contains(T item) => IndexOf(item) >= 0;\n        public void CopyTo(T[] array, int index) => objects.CopyTo(array, index);\n        public int IndexOf(T item)\n        {\n            for (int i = 0; i < objects.Count; ++i)\n                if (comparer.Equals(item, objects[i]))\n                    return i;\n            return -1;\n        }\n        public int FindIndex(Predicate<T> match)\n        {\n            for (int i = 0; i < objects.Count; ++i)\n                if (match(objects[i]))\n                    return i;\n            return -1;\n        }\n        public void Insert(int index, T item)\n        {\n            objects.Insert(index, item);\n            AddOperation(Operation.OP_INSERT, index, default, item);\n        }\n        public bool Remove(T item)\n        {\n            int index = IndexOf(item);\n            bool result = index >= 0;\n            if (result)\n            {\n                RemoveAt(index);\n            }\n            return result;\n        }\n        public void RemoveAt(int index)\n        {\n            T oldItem = objects[index];\n            objects.RemoveAt(index);\n            AddOperation(Operation.OP_REMOVEAT, index, oldItem, default);\n        }\n        public T this[int i]\n        {\n            get => objects[i];\n            set\n            {\n                if (!comparer.Equals(objects[i], value))\n                {\n                    T oldItem = objects[i];\n                    objects[i] = value;\n                    AddOperation(Operation.OP_SET, i, oldItem, value);\n                }\n            }\n        }\n        public Enumerator GetEnumerator() => new Enumerator(this);\n        IEnumerator<T> IEnumerable<T>.GetEnumerator() => new Enumerator(this);\n        IEnumerator IEnumerable.GetEnumerator() => new Enumerator(this);\n        // default Enumerator allocates. we need a custom struct Enumerator to\n        // not allocate on the heap.\n        // (System.Collections.Generic.List<T> source code does the same)\n        //\n        // benchmark:\n        //   uMMORPG with 800 monsters, Skills.GetHealthBonus() which runs a\n        //   foreach on skills SyncList:\n        //      before: 81.2KB GC per frame\n        //      after:     0KB GC per frame\n        // => this is extremely important for MMO scale networking\n        public struct Enumerator : IEnumerator<T>\n        {\n            readonly SyncList<T> list;\n            int index;\n            public T Current { get; private set; }\n            public Enumerator(SyncList<T> list)\n            {\n                this.list = list;\n", "answers": ["                index = -1;"], "incorrect_answer": "index = -2;"}, {"input": "", "context": "# unionrepo.py - repository class for viewing union of repository changesets\n#\n# Derived from bundlerepo.py\n# Copyright 2006, 2007 Benoit Boissinot <bboissin@gmail.com>\n# Copyright 2013 Unity Technologies, Mads Kiilerich <madski@unity3d.com>\n#\n# This software may be used and distributed according to the terms of the\n# GNU General Public License version 2 or any later version.\n\"\"\"Repository class for \"in-memory pull\" of one local repository to another,\nallowing operations like diff and log with revsets.\n\"\"\"\nfrom node import nullid\nfrom i18n import _\nimport os\nimport util, mdiff, cmdutil, scmutil\nimport localrepo, changelog, manifest, filelog, revlog\nclass unionrevlog(revlog.revlog):\n    def __init__(self, opener, indexfile, revlog2, linkmapper):\n        # How it works:\n        # To retrieve a revision, we just need to know the node id so we can\n        # look it up in revlog2.\n        #\n        # To differentiate a rev in the second revlog from a rev in the revlog,\n        # we check revision against repotiprev.\n        opener = scmutil.readonlyvfs(opener)\n        revlog.revlog.__init__(self, opener, indexfile)\n        self.revlog2 = revlog2\n        n = len(self)\n        self.repotiprev = n - 1\n        self.bundlerevs = set() # used by 'bundle()' revset expression\n        for rev2 in self.revlog2:\n            rev = self.revlog2.index[rev2]\n            # rev numbers - in revlog2, very different from self.rev\n            _start, _csize, _rsize, _base, linkrev, p1rev, p2rev, node = rev\n            if linkmapper is None: # link is to same revlog\n                assert linkrev == rev2 # we never link back\n                link = n\n            else: # rev must be mapped from repo2 cl to unified cl by linkmapper\n                link = linkmapper(linkrev)\n            if node in self.nodemap:\n                # this happens for the common revlog revisions\n                self.bundlerevs.add(self.nodemap[node])\n                continue\n            p1node = self.revlog2.node(p1rev)\n            p2node = self.revlog2.node(p2rev)\n            e = (None, None, None, None,\n                 link, self.rev(p1node), self.rev(p2node), node)\n            self.index.insert(-1, e)\n            self.nodemap[node] = n\n            self.bundlerevs.add(n)\n            n += 1\n    def _chunk(self, rev):\n        if rev <= self.repotiprev:\n            return revlog.revlog._chunk(self, rev)\n        return self.revlog2._chunk(self.node(rev))\n    def revdiff(self, rev1, rev2):\n        \"\"\"return or calculate a delta between two revisions\"\"\"\n        if rev1 > self.repotiprev and rev2 > self.repotiprev:\n            return self.revlog2.revdiff(\n                self.revlog2.rev(self.node(rev1)),\n                self.revlog2.rev(self.node(rev2)))\n        elif rev1 <= self.repotiprev and rev2 <= self.repotiprev:\n            return self.baserevdiff(rev1, rev2)\n        return mdiff.textdiff(self.revision(self.node(rev1)),\n                              self.revision(self.node(rev2)))\n    def revision(self, nodeorrev):\n        \"\"\"return an uncompressed revision of a given node or revision\n        number.\n        \"\"\"\n        if isinstance(nodeorrev, int):\n            rev = nodeorrev\n            node = self.node(rev)\n        else:\n            node = nodeorrev\n            rev = self.rev(node)\n        if node == nullid:\n            return \"\"\n        if rev > self.repotiprev:\n            text = self.revlog2.revision(node)\n            self._cache = (node, rev, text)\n        else:\n            text = self.baserevision(rev)\n            # already cached\n        return text\n    def baserevision(self, nodeorrev):\n        # Revlog subclasses may override 'revision' method to modify format of\n        # content retrieved from revlog. To use unionrevlog with such class one\n        # needs to override 'baserevision' and make more specific call here.\n        return revlog.revlog.revision(self, nodeorrev)\n    def baserevdiff(self, rev1, rev2):\n        # Exists for the same purpose as baserevision.\n        return revlog.revlog.revdiff(self, rev1, rev2)\n    def addrevision(self, text, transaction, link, p1=None, p2=None, d=None):\n        raise NotImplementedError\n    def addgroup(self, revs, linkmapper, transaction):\n        raise NotImplementedError\n    def strip(self, rev, minlink):\n        raise NotImplementedError\n    def checksize(self):\n        raise NotImplementedError\nclass unionchangelog(unionrevlog, changelog.changelog):\n    def __init__(self, opener, opener2):\n        changelog.changelog.__init__(self, opener)\n        linkmapper = None\n        changelog2 = changelog.changelog(opener2)\n        unionrevlog.__init__(self, opener, self.indexfile, changelog2,\n                             linkmapper)\n    def baserevision(self, nodeorrev):\n        # Although changelog doesn't override 'revision' method, some extensions\n        # may replace this class with another that does. Same story with\n        # manifest and filelog classes.\n        return changelog.changelog.revision(self, nodeorrev)\n    def baserevdiff(self, rev1, rev2):\n        return changelog.changelog.revdiff(self, rev1, rev2)\nclass unionmanifest(unionrevlog, manifest.manifest):\n    def __init__(self, opener, opener2, linkmapper):\n        manifest.manifest.__init__(self, opener)\n        manifest2 = manifest.manifest(opener2)\n        unionrevlog.__init__(self, opener, self.indexfile, manifest2,\n                             linkmapper)\n    def baserevision(self, nodeorrev):\n        return manifest.manifest.revision(self, nodeorrev)\n    def baserevdiff(self, rev1, rev2):\n        return manifest.manifest.revdiff(self, rev1, rev2)\nclass unionfilelog(unionrevlog, filelog.filelog):\n    def __init__(self, opener, path, opener2, linkmapper, repo):\n        filelog.filelog.__init__(self, opener, path)\n        filelog2 = filelog.filelog(opener2, path)\n        unionrevlog.__init__(self, opener, self.indexfile, filelog2,\n                             linkmapper)\n        self._repo = repo\n    def baserevision(self, nodeorrev):\n        return filelog.filelog.revision(self, nodeorrev)\n    def baserevdiff(self, rev1, rev2):\n        return filelog.filelog.revdiff(self, rev1, rev2)\n    def _file(self, f):\n        self._repo.file(f)\nclass unionpeer(localrepo.localpeer):\n    def canpush(self):\n        return False\nclass unionrepository(localrepo.localrepository):\n    def __init__(self, ui, path, path2):\n        localrepo.localrepository.__init__(self, ui, path)\n        self.ui.setconfig('phases', 'publish', False, 'unionrepo')\n        self._url = 'union:%s+%s' % (util.expandpath(path),\n                                     util.expandpath(path2))\n        self.repo2 = localrepo.localrepository(ui, path2)\n    @localrepo.unfilteredpropertycache\n    def changelog(self):\n        return unionchangelog(self.sopener, self.repo2.sopener)\n    def _clrev(self, rev2):\n        \"\"\"map from repo2 changelog rev to temporary rev in self.changelog\"\"\"\n        node = self.repo2.changelog.node(rev2)\n        return self.changelog.rev(node)\n    @localrepo.unfilteredpropertycache\n    def manifest(self):\n        return unionmanifest(self.sopener, self.repo2.sopener,\n                             self._clrev)\n    def url(self):\n        return self._url\n    def file(self, f):\n        return unionfilelog(self.sopener, f, self.repo2.sopener,\n                            self._clrev, self)\n    def close(self):\n        self.repo2.close()\n    def cancopy(self):\n        return False\n    def peer(self):\n        return unionpeer(self)\n    def getcwd(self):\n        return os.getcwd() # always outside the repo\ndef instance(ui, path, create):\n    if create:\n        raise util.Abort(_('cannot create new union repository'))\n    parentpath = ui.config(\"bundle\", \"mainreporoot\", \"\")\n    if not parentpath:\n        # try to find the correct path to the working directory repo\n        parentpath = cmdutil.findrepo(os.getcwd())\n        if parentpath is None:\n            parentpath = ''\n    if parentpath:\n        # Try to make the full path relative so we get a nice, short URL.\n        # In particular, we don't want temp dir names in test outputs.\n        cwd = os.getcwd()\n        if parentpath == cwd:\n            parentpath = ''\n        else:\n            cwd = os.path.join(cwd,'')\n            if parentpath.startswith(cwd):\n", "answers": ["                parentpath = parentpath[len(cwd):]"], "incorrect_answer": "parentpath = parentpath[cwd:]"}, {"input": "", "context": "#\n# Copyright (c) 2015-2018 Canonical, Ltd.\n#\n# This file is part of Talisker\n# (see http://github.com/canonical-ols/talisker).\n#\n# Licensed to the Apache Software Foundation (ASF) under one\n# or more contributor license agreements.  See the NOTICE file\n# distributed with this work for additional information\n# regarding copyright ownership.  The ASF licenses this file\n# to you under the Apache License, Version 2.0 (the\n# \"License\"); you may not use this file except in compliance\n# with the License.  You may obtain a copy of the License at\n#\n#   http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing,\n# software distributed under the License is distributed on an\n# \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n# KIND, either express or implied.  See the License for the\n# specific language governing permissions and limitations\n# under the License.\n#\nfrom __future__ import unicode_literals\nfrom __future__ import print_function\nfrom __future__ import division\nfrom __future__ import absolute_import\nfrom builtins import *  # noqa\nfrom collections import OrderedDict\nfrom contextlib import contextmanager\nimport logging\nimport logging.handlers\nimport numbers\nimport sys\nimport time\nfrom talisker.context import Context, ContextId\nfrom talisker.util import (\n    get_errno_fields,\n    module_cache,\n    module_dict,\n)\n__all__ = [\n    'configure',\n    'configure_test_logging',\n    'logging_context',\n]\nlogging_globals = module_dict()\ndef set_global_extra(extra):\n    if 'extra' not in logging_globals:\n        logging_globals['extra'] = OrderedDict()\n    logging_globals['extra'].update(extra)\ndef reset_logging():\n    \"\"\"Reset logging config\"\"\"\n    # avoid unclosed file resource warning\n    for handler in logging.getLogger().handlers:\n        if getattr(handler, '_debug_handler', False):\n            handler.stream.close()\n    logging.getLogger().handlers = []\nNOISY_LOGS = {\n    'requests': logging.WARNING,\n}\nclass LoggingContextProxy():\n    def __getattr__(self, attr):\n        return getattr(Context.logging, attr)\n    @contextmanager\n    def __call__(self, extra=None, **kwargs):\n        with Context.logging(extra, **kwargs):\n            yield\nlogging_context = LoggingContextProxy()\n# backwards compat aliases\ndef set_logging_context(*args, **kwargs):\n    Context.logging.push(*args, **kwargs)\nextra_logging = logging_context\ndef add_talisker_handler(level, handler, formatter=None):\n    if formatter is None:\n        formatter = StructuredFormatter()\n    handler.setFormatter(formatter)\n    handler.setLevel(level)\n    handler._talisker_handler = True\n    logging.getLogger().addHandler(handler)\ndef set_logger_class():\n    logging.setLoggerClass(StructuredLogger)\n    logging.getLogger().setLevel(logging.NOTSET)\n@module_cache\ndef get_talisker_handler():\n    handler = logging.StreamHandler()\n    handler._root_talisker = True\n    return handler\ndef configure(config):  # pragma: no cover\n    \"\"\"Configure default logging setup for our services.\n    This is basically:\n     - log to stderr\n     - output hybrid logfmt structured format\n     - maybe configure debug logging\n    \"\"\"\n    # avoid duplicate logging\n    if logging_globals.get('configured'):\n        return\n    set_logger_class()\n    formatter = StructuredFormatter()\n    if config.colour:\n        formatter = ColouredFormatter(style=config.colour)\n    # always INFO to stderr\n    add_talisker_handler(logging.INFO, get_talisker_handler(), formatter)\n    configure_warnings(config.devel)\n    supress_noisy_logs()\n    # defer this until logging has been set up\n    logger = logging.getLogger(__name__)\n    config_extra = {k: v.value for k, v in config.metadata().items() if v.raw}\n    if config_extra:\n        logger.info('talisker configured', extra=config_extra)\n    if config.ERRORS:\n        errors = {name: str(err) for name, err in config.ERRORS.items()}\n        logger.error('configuration errors', extra=errors)\n    if config.debuglog is not None:\n        if can_write_to_file(config.debuglog):\n            handler = logging.handlers.TimedRotatingFileHandler(\n                config.debuglog,\n                when='D',\n                interval=1,\n                backupCount=1,\n                delay=True,\n                utc=True,\n            )\n            handler._debug_handler = True\n            add_talisker_handler(logging.DEBUG, handler)\n            logger.info('enabling debug log', extra={'path': config.debuglog})\n        else:\n            logger.info('could not enable debug log, could not write to path',\n                        extra={'path': config.debuglog})\n    # sentry integration\n    import talisker.sentry  # defer to avoid logging setup\n    if talisker.sentry.enabled:\n        sentry_handler = talisker.sentry.get_log_handler()\n        add_talisker_handler(logging.ERROR, sentry_handler)\n    logging_globals['configured'] = True\ndef can_write_to_file(path):\n    try:\n        open(path, 'a').close()\n    except Exception:\n        return False\n    else:\n        return True\ndef supress_noisy_logs():\n    \"\"\"Set some custom log levels on some sub logs\"\"\"\n    for name, level in NOISY_LOGS.items():\n        logger = logging.getLogger(name)\n        logger.setLevel(level)\ndef configure_warnings(enable):\n    # never propogate warnings to root\n    warnings = logging.getLogger('py.warnings')\n    warnings.propagate = False\n    if enable:\n        warnings.addHandler(logging.StreamHandler())\ndef configure_test_logging(handler=None):\n    \"\"\"Add a handler (defaults to NullHandler) to root logger.\n    Prevents unconfigured logging from erroring, and swallows all logging,\n    which is usually what you want for unit tests.  Unit test fixtures can\n    still add their own loggers to assert against log messages if needed.\n    \"\"\"\n    set_logger_class()\n    if handler is None:\n        handler = logging.NullHandler()\n    add_talisker_handler(logging.NOTSET, handler)\n    configure_warnings(True)\ndef enable_debug_log_stderr():\n    \"\"\"Enables debug logging on stderr\n    Checks for devel mode.\"\"\"\n    logger = logging.getLogger(__name__)\n    logger.warning('setting stderr logging to DEBUG')\n    get_talisker_handler().setLevel(logging.DEBUG)\nclass StructuredLogger(logging.Logger):\n    \"\"\"A logger that handles passing 'extra' arguments to all logging calls.\n    Supports 3 sources of extra structured data:\n    1) global extra, designed to be set once at process start/\n    2) context extra, designed to be set per request or job, can cleaned up\n       afterwards.\n    3) per call extra, passed by the log call, as per normal logging\n       e.g. log.info('...', extra={...})\n    \"\"\"\n    # sadly, we must subclass and override, rather that use the new\n    # setLogRecordFactory() in 3.2+, as that does not pass the extra args\n    # through. Also, we need to support python 2.\n    def makeRecord(self, name, level, fn, lno, msg, args, exc_info,\n                   func=None, extra=None, sinfo=None):\n        # at this point we have 3 possible sources of extra kwargs\n        # - log call: extra\n        # - context : local_context.flat\n        # - global  : logging_globals['extra']\n        #\n        # In case of collisions, we append _ to the end of the name, so no data\n        # is lost. The global ones are more important, so take priority - the\n        # user supplied keys are the ones renamed if needed\n        # Also, the ordering is specific - more specific tags first\n        trailer = None\n        structured = OrderedDict()\n        try:\n            if ContextId.get(None) is None:\n                context_extra = {}\n                request_id = None\n            else:\n                context_extra = logging_context.flat\n                request_id = Context.request_id\n            global_extra = logging_globals.get('extra', {})\n            if extra:\n                trailer = extra.pop('trailer', None)\n                for k, v in extra.items():\n                    if k in context_extra or k in global_extra:\n                        k = k + '_'\n                    structured[k] = v\n            for k, v in context_extra.items():\n                if k in global_extra:\n                    k = k + '_'\n                structured[k] = v\n            structured.update(global_extra)\n            if request_id:\n                structured['request_id'] = request_id\n        except Exception:\n            # ensure unexpected error doesn't break logging completely\n            structured = extra\n        kwargs = dict(func=func, extra=structured, sinfo=sinfo)\n        # python 2 doesn't support sinfo parameter\n", "answers": ["        if sys.version_info[0] == 2:"], "incorrect_answer": "if sys.version_info[0] == 3:"}, {"input": "", "context": "using System;\nusing System.Collections;\nusing Server;\nusing Server.Gumps;\nusing Server.Mobiles;\nusing Server.Targeting;\nusing Server.ContextMenus;\nusing Server.Regions;\nusing Server.Network;\nusing System.Collections.Generic;\nusing Server.Items;\nusing Server.Targets;\nnamespace Server.Items\n{\n\tpublic class SpellweavingTrainer : Item\n\t{\n\t\tpublic override string DefaultName\n\t\t{\n\t\t\tget { return \"Spellweaving Trainer [100GP]\"; }\n\t\t}\n\t\t[Constructable]\n\t\tpublic SpellweavingTrainer() : base( 0x1F1C )\n\t\t{\n\t\t\tWeight = 1.0;\n            Movable = false;\n\t\t}\n\t\tpublic SpellweavingTrainer( Serial serial ) : base( serial )\n\t\t{\n\t\t}\n        public override void OnDoubleClick(Mobile m)\n        {\n            if (m.Skills.Spellweaving.Base <= 19.9)\n            {\n                if (m.Mana >= 4)\n                {\n                    if (m.SkillsTotal >= m.SkillsCap)\n                    {\n                        int toGain = 1;\n                        Skills skills = m.Skills;\n                        for (int i = 0; i < skills.Length; ++i)\n                        {\n                            Skill toLower = skills[i];\n                            if (toLower != m.Skills.Spellweaving && toLower.Lock == SkillLock.Down && toLower.BaseFixedPoint >= toGain)\n                            {\n                                toLower.BaseFixedPoint -= toGain;\n                                break;\n                            }\n                        }\n                    }\n                    if (m.SkillsTotal < m.SkillsCap)\n                    {\n                        if (m.Backpack.ConsumeTotal(typeof(Gold), 100))\n                        {\n                            if (m.Skills.Spellweaving.Base < m.Skills.Spellweaving.Cap)\n                            {\n                                m.Skills.Spellweaving.BaseFixedPoint += 1;\n                                m.Mana -= 4;\n                            }\n                            else\n                            {\n                                m.SendMessage(\"You have reached the skill cap for that skill\");\n                            }\n                        }\n                        else\n                        m.SendMessage(\"You need 100gp in your pack to use this stone.\");\n                    }\n                    else\n                    {\n                        m.SendMessage(\"you have reached your total skills cap. Set a skill to lower to continue using me\");\n                    }\n                }\n            }\n            if (m.Skills.Spellweaving.Base <= 39.9 && m.Skills.Spellweaving.Base >= 20)\n            {\n                if (m.Mana >= 5)\n                {\n                    if (m.SkillsTotal >= m.SkillsCap)\n                    {\n                        int toGain = 1;\n                        Skills skills = m.Skills;\n                        for (int i = 0; i < skills.Length; ++i)\n                        {\n                            Skill toLower = skills[i];\n                            if (toLower != m.Skills.Spellweaving && toLower.Lock == SkillLock.Down && toLower.BaseFixedPoint >= toGain)\n                            {\n                                toLower.BaseFixedPoint -= toGain;\n                                break;\n                            }\n                        }\n                    }\n                    if (m.SkillsTotal < m.SkillsCap)\n                    {\n                        if (m.Backpack.ConsumeTotal(typeof(Gold), 100))\n                        {\n                            if (m.Skills.Spellweaving.Base < m.Skills.Spellweaving.Cap)\n                            {\n                                m.Skills.Spellweaving.BaseFixedPoint += 1;\n                                m.Mana -= 5;\n                            }\n                            else\n                            {\n                                m.SendMessage(\"You have reached the skill cap for that skill\");\n                            }\n                        }\n                        else\n                        m.SendMessage(\"You need 100gp in your pack to use this stone.\");\n                    }\n                    else\n                    {\n                        m.SendMessage(\"you have reached your total skills cap. Set a skill to lower to continue using me\");\n                    }\n                }\n                else\n                {\n                    m.SendMessage(\"You need 5 mana to use this item at your skill level.\");\n                }\n            }\n            if (m.Skills.Spellweaving.Base <= 59.9 && m.Skills.Spellweaving.Base >= 40)\n            {\n                if (m.Mana >= 10)\n                {\n                    if (m.SkillsTotal >= m.SkillsCap)\n                    {\n                        int toGain = 1;\n                        Skills skills = m.Skills;\n                        for (int i = 0; i < skills.Length; ++i)\n                        {\n                            Skill toLower = skills[i];\n                            if (toLower != m.Skills.Spellweaving && toLower.Lock == SkillLock.Down && toLower.BaseFixedPoint >= toGain)\n                            {\n                                toLower.BaseFixedPoint -= toGain;\n                                break;\n                            }\n                        }\n                    }\n                    if (m.SkillsTotal < m.SkillsCap)\n                    {\n                        if (m.Backpack.ConsumeTotal(typeof(Gold), 100))\n                        {\n                            if (m.Skills.Spellweaving.Base < m.Skills.Spellweaving.Cap)\n                            {\n                                m.Skills.Spellweaving.BaseFixedPoint += 1;\n                                m.Mana -= 10;\n                            }\n                            else\n                            {\n                                m.SendMessage(\"You have reached the skill cap for that skill\");\n                            }\n                        }\n                        else\n                        m.SendMessage(\"You need 100gp in your pack to use this stone.\");\n                    }\n                    else\n                    {\n                        m.SendMessage(\"you have reached your total skills cap. Set a skill to lower to continue using me\");\n                    }\n                }\n                else\n                {\n                    m.SendMessage(\"You need 10 mana to use this item at your skill level.\");\n                }\n            }\n            if (m.Skills.Spellweaving.Base <= 79.9 && m.Skills.Spellweaving.Base >= 60)\n            {\n                if (m.Mana >= 20)\n                {\n                    if (m.SkillsTotal >= m.SkillsCap)\n                    {\n                        int toGain = 1;\n                        Skills skills = m.Skills;\n                        for (int i = 0; i < skills.Length; ++i)\n                        {\n                            Skill toLower = skills[i];\n                            if (toLower != m.Skills.Spellweaving && toLower.Lock == SkillLock.Down && toLower.BaseFixedPoint >= toGain)\n                            {\n                                toLower.BaseFixedPoint -= toGain;\n                                break;\n                            }\n                        }\n                    }\n                    if (m.SkillsTotal < m.SkillsCap)\n                    {\n                        if (m.Backpack.ConsumeTotal(typeof(Gold), 100))\n                        {\n                            if (m.Skills.Spellweaving.Base < m.Skills.Spellweaving.Cap)\n                            {\n                                m.Skills.Spellweaving.BaseFixedPoint += 1;\n", "answers": ["                                m.Mana -= 20;"], "incorrect_answer": "m.Mana -= 15;"}, {"input": "", "context": "\"\"\"\nStep definitions for working with Django models.\n\"\"\"\nfrom datetime import datetime\nimport re\nfrom django.core.management import call_command\nfrom django.core.management.color import no_style\nfrom django.db import connection\nfrom django.db.models.loading import get_models\nfrom django.utils.functional import curry\nfrom functools import wraps\nfrom lettuce import step\nSTEP_PREFIX = r'(?:Given|And|Then|When) '\ndef _models_generator():\n    \"\"\"\n    Build a hash of model verbose names to models\n    \"\"\"\n    for model in get_models():\n        yield (unicode(model._meta.verbose_name), model)\n        yield (unicode(model._meta.verbose_name_plural), model)\nMODELS = dict(_models_generator())\n_WRITE_MODEL = {}\ndef creates_models(model):\n    \"\"\"\n    Register a model-specific creation function. Wrapper around writes_models\n    that removes the field parameter (always a create operation).\n    \"\"\"\n    def decorated(func):\n        @wraps(func)\n        @writes_models(model)\n        def wrapped(data, field):\n            if field:\n                raise NotImplementedError(\n                    \"Must use the writes_models decorator to update models\")\n            return func(data)\n    return decorated\ndef writes_models(model):\n    \"\"\"\n    Register a model-specific create and update function.\n    \"\"\"\n    def decorated(func):\n        \"\"\"\n        Decorator for the creation function.\n        \"\"\"\n        _WRITE_MODEL[model] = func\n        return func\n    return decorated\n_MODEL_EXISTS = {}\ndef checks_existence(model):\n    \"\"\"\n    Register a model-specific existence check function.\n    \"\"\"\n    def decorated(func):\n        \"\"\"\n        Decorator for the existence function.\n        \"\"\"\n        _MODEL_EXISTS[model] = func\n        return func\n    return decorated\ndef hash_data(hash_):\n    \"\"\"\n    Convert strings from a Lettuce hash to appropriate types\n    \"\"\"\n    res = {}\n    for key, value in hash_.items():\n        if type(value) in (str, unicode):\n            if value == \"true\":\n                value = True\n            elif value == \"false\":\n                value = False\n            elif value == \"null\":\n                value = None\n            elif value.isdigit() and not re.match(\"^0[0-9]+\", value):\n                value = int(value)\n            elif re.match(r'^\\d{4}-\\d{2}-\\d{2}$', value):\n                value = datetime.strptime(value, \"%Y-%m-%d\")\n        res[key] = value\n    return res\ndef hashes_data(step):\n    \"\"\"\n    Convert strings from step hashes to appropriate types\n    \"\"\"\n    return [hash_data(hash_) for hash_ in step.hashes]\ndef get_model(model):\n    \"\"\"\n    Convert a model's verbose name to the model class. This allows us to\n    use the models verbose name in steps.\n    \"\"\"\n    name = model.lower()\n    model = MODELS.get(model, None)\n    assert model, \"Could not locate model by name '%s'\" % name\n    return model\ndef reset_sequence(model):\n    \"\"\"\n    Reset the ID sequence for a model.\n    \"\"\"\n    sql = connection.ops.sequence_reset_sql(no_style(), [model])\n    for cmd in sql:\n        connection.cursor().execute(cmd)\ndef create_models(model, data):\n    \"\"\"\n    Create models for each data hash. Wrapper around write_models.\n    \"\"\"\n    return write_models(model, data, None)\ndef write_models(model, data, field=None):\n    \"\"\"\n    Create or update models for each data hash. If field is present, it is the\n    field that is used to get the existing models out of the database to update\n    them; otherwise, new models are created.\n    \"\"\"\n    if hasattr(data, 'hashes'):\n        data = hashes_data(data)\n    written = []\n    for hash_ in data:\n        if field:\n            if field not in hash_:\n                raise KeyError((\"The \\\"%s\\\" field is required for all update \"\n                                \"operations\") % field)\n            model_kwargs = {field: hash_[field]}\n            model_obj = model.objects.get(**model_kwargs)\n            for to_set, val in hash_.items():\n                setattr(model_obj, to_set, val)\n            model_obj.save()\n        else:\n            model_obj = model.objects.create(**hash_)\n        written.append(model_obj)\n    reset_sequence(model)\n    return written\ndef _dump_model(model, attrs=None):\n    \"\"\"\n    Dump the model fields for debugging.\n    \"\"\"\n    for field in model._meta.fields:\n        print '%s=%s,' % (field.name, str(getattr(model, field.name))),\n    if attrs is not None:\n        for attr in attrs:\n            print '%s=%s,' % (attr, str(getattr(model, attr))),\n    for field in model._meta.many_to_many:\n        vals = getattr(model, field.name)\n        print '%s=%s (%i),' % (\n            field.name,\n            ', '.join(map(str, vals.all())),\n            vals.count()),\n    print\ndef models_exist(model, data, queryset=None):\n    \"\"\"\n    Check whether the models defined by @data exist in the @queryset.\n    \"\"\"\n    if hasattr(data, 'hashes'):\n        data = hashes_data(data)\n    if not queryset:\n        queryset = model.objects\n    failed = 0\n    try:\n        for hash_ in data:\n            fields = {}\n            extra_attrs = {}\n", "answers": ["            for k, v in hash_.iteritems():"], "incorrect_answer": "for key, val in hash_.items(): "}, {"input": "", "context": "## This file is part of Invenio.\n## Copyright (C) 2009, 2010, 2011 CERN.\n##\n## Invenio is free software; you can redistribute it and/or\n## modify it under the terms of the GNU General Public License as\n## published by the Free Software Foundation; either version 2 of the\n## License, or (at your option) any later version.\n##\n## Invenio is distributed in the hope that it will be useful, but\n## WITHOUT ANY WARRANTY; without even the implied warranty of\n## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n## General Public License for more details.\n##\n## You should have received a copy of the GNU General Public License\n## along with Invenio; if not, write to the Free Software Foundation, Inc.,\n## 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.\n# pylint: disable=C0103\n\"\"\"Invenio BibEdit Administrator Interface.\"\"\"\n__revision__ = \"$Id\"\n__lastupdated__ = \"\"\"$Date: 2008/08/12 09:26:46 $\"\"\"\nimport cProfile\nimport cStringIO\nimport pstats\nfrom invenio.jsonutils import json, json_unicode_to_utf8\nfrom invenio.access_control_engine import acc_authorize_action\nfrom invenio.bibedit_engine import (perform_request_ajax,\n                                    perform_request_init,\n                                    perform_request_newticket,\n                                    perform_request_compare,\n                                    perform_request_init_template_interface,\n                                    perform_request_ajax_template_interface)\nfrom invenio.bibedit_utils import user_can_edit_record_collection\nfrom invenio.config import CFG_SITE_LANG, CFG_SITE_SECURE_URL, CFG_SITE_RECORD\nfrom invenio.messages import gettext_set_language\nfrom invenio.urlutils import redirect_to_url\nfrom invenio.webinterface_handler import WebInterfaceDirectory, wash_urlargd\nfrom invenio.webpage import page\nfrom invenio.webuser import collect_user_info, getUid, page_not_authorized\nnavtrail = (' <a class=\"navtrail\" href=\\\"%s/help/admin\\\">Admin Area</a> '\n            ) % CFG_SITE_SECURE_URL\nnavtrail_bibedit = (' <a class=\"navtrail\" href=\\\"%s/help/admin\\\">Admin Area</a> ' + \\\n                    ' &gt; <a class=\"navtrail\" href=\\\"%s/%s/edit\\\">Record Editor</a>'\n            ) % (CFG_SITE_SECURE_URL, CFG_SITE_SECURE_URL, CFG_SITE_RECORD)\ndef wrap_json_req_profiler(func):\n    def json_req_profiler(self, req, form):\n        if \"ajaxProfile\" in form:\n            profiler = cProfile.Profile()\n            return_val = profiler.runcall(func, self, req, form)\n            results = cStringIO.StringIO()\n            stats = pstats.Stats(profiler, stream=results)\n            stats.sort_stats('cumulative')\n            stats.print_stats(100)\n            json_in = json.loads(str(form['jsondata']))\n            # Deunicode all strings (Invenio doesn't have unicode\n            # support).\n            json_in = json_unicode_to_utf8(json_in)\n            json_data = json.loads(return_val)\n            json_data.update({\"profilerStats\": \"<pre style='overflow: scroll'>\" + json_in['requestType'] + results.getvalue() + \"</pre>\"})\n            return json.dumps(json_data)\n        else:\n            return func(self, req, form)\n    return json_req_profiler\nclass WebInterfaceEditPages(WebInterfaceDirectory):\n    \"\"\"Defines the set of /edit pages.\"\"\"\n    _exports = ['', 'new_ticket', 'compare_revisions', 'templates']\n    def __init__(self, recid=None):\n        \"\"\"Initialize.\"\"\"\n        self.recid = recid\n    @wrap_json_req_profiler\n    def index(self, req, form):\n        \"\"\"Handle all BibEdit requests.\n        The responsibilities of this functions is:\n        * JSON decoding and encoding.\n        * Redirection, if necessary.\n        * Authorization.\n        * Calling the appropriate function from the engine.\n        \"\"\"\n        uid = getUid(req)\n        argd = wash_urlargd(form, {'ln': (str, CFG_SITE_LANG)})\n        # If it is an Ajax request, extract any JSON data.\n        ajax_request, recid = False, None\n        if form.has_key('jsondata'):\n            json_data = json.loads(str(form['jsondata']))\n            # Deunicode all strings (Invenio doesn't have unicode\n            # support).\n            json_data = json_unicode_to_utf8(json_data)\n            ajax_request = True\n            if json_data.has_key('recID'):\n                recid = json_data['recID']\n            json_response = {'resultCode': 0, 'ID': json_data['ID']}\n        # Authorization.\n        user_info = collect_user_info(req)\n        if user_info['email'] == 'guest':\n            # User is not logged in.\n            if not ajax_request:\n                # Do not display the introductory recID selection box to guest\n                # users (as it used to be with v0.99.0):\n                dummy_auth_code, auth_message = acc_authorize_action(req,\n                                                               'runbibedit')\n                referer = '/edit/'\n                if self.recid:\n                    referer = '/%s/%s/edit/' % (CFG_SITE_RECORD, self.recid)\n                return page_not_authorized(req=req, referer=referer,\n                                           text=auth_message, navtrail=navtrail)\n            else:\n                # Session has most likely timed out.\n                json_response.update({'resultCode': 100})\n                return json.dumps(json_response)\n        elif self.recid:\n            # Handle redirects from /record/<record id>/edit\n            # generic URL.\n            redirect_to_url(req, '%s/%s/edit/#state=edit&recid=%s&recrev=%s' % (\n                    CFG_SITE_SECURE_URL, CFG_SITE_RECORD, self.recid, \"\"))\n        elif recid is not None:\n            json_response.update({'recID': recid})\n            if json_data['requestType'] == \"getRecord\":\n                # Authorize access to record.\n                if not user_can_edit_record_collection(req, recid):\n                    json_response.update({'resultCode': 101})\n                    return json.dumps(json_response)\n        # Handle request.\n        if not ajax_request:\n            # Show BibEdit start page.\n            body, errors, warnings = perform_request_init(uid, argd['ln'], req, __lastupdated__)\n            title = 'Record Editor'\n            return page(title       = title,\n                        body        = body,\n                        errors      = errors,\n                        warnings    = warnings,\n                        uid         = uid,\n                        language    = argd['ln'],\n                        navtrail    = navtrail,\n                        lastupdated = __lastupdated__,\n                        req         = req,\n                        body_css_classes = ['bibedit'])\n        else:\n            # Handle AJAX request.\n            json_response.update(perform_request_ajax(req, recid, uid,\n                                                      json_data))\n            return json.dumps(json_response)\n    def compare_revisions(self, req, form):\n        \"\"\"Handle the compare revisions request\"\"\"\n        argd = wash_urlargd(form, { \\\n                'ln': (str, CFG_SITE_LANG), \\\n                'rev1' : (str, ''), \\\n                'rev2' : (str, ''), \\\n                'recid': (int, 0)})\n        ln = argd['ln']\n        uid = getUid(req)\n        _ = gettext_set_language(ln)\n        # Checking if currently logged user has permission to perform this request\n        auth_code, auth_message = acc_authorize_action(req, 'runbibedit')\n        if auth_code != 0:\n            return page_not_authorized(req=req, referer=\"/edit\",\n                                       text=auth_message, navtrail=navtrail)\n        recid = argd['recid']\n        rev1 = argd['rev1']\n        rev2 = argd['rev2']\n        ln = argd['ln']\n        body, errors, warnings = perform_request_compare(ln, recid, rev1, rev2)\n        return page(title = _(\"Comparing two record revisions\"),\n                    body =  body,\n                    errors = errors,\n                    warnings = warnings,\n                    uid = uid,\n                    language = ln,\n                    navtrail    = navtrail,\n                    lastupdated = __lastupdated__,\n                    req         = req,\n                    body_css_classes = ['bibedit'])\n    def new_ticket(self, req, form):\n        \"\"\"handle a edit/new_ticket request\"\"\"\n        argd = wash_urlargd(form, {'ln': (str, CFG_SITE_LANG), 'recid': (int, 0)})\n        ln = argd['ln']\n        _ = gettext_set_language(ln)\n        auth_code, auth_message = acc_authorize_action(req, 'runbibedit')\n        if auth_code != 0:\n", "answers": ["            return page_not_authorized(req=req, referer=\"/edit\","], "incorrect_answer": "return access_denied(req=req, action=\"/update\","}, {"input": "", "context": "# Copyright (c) 2012, Michael DeHaan <michael.dehaan@gmail.com>\n# Copyright 2015 Abhijit Menon-Sen <ams@2ndQuadrant.com>\n# Copyright 2017 Toshio Kuratomi <tkuratomi@ansible.com>\n# Copyright (c) 2017 Ansible Project\n# GNU General Public License v3.0+ (see COPYING or https://www.gnu.org/licenses/gpl-3.0.txt)\nfrom __future__ import (absolute_import, division, print_function)\n__metaclass__ = type\nDOCUMENTATION = '''\n    connection: ssh\n    short_description: connect via ssh client binary\n    description:\n        - This connection plugin allows ansible to communicate to the target machines via normal ssh command line.\n        - Ansible does not expose a channel to allow communication between the user and the ssh process to accept\n          a password manually to decrypt an ssh key when using this connection plugin (which is the default). The\n          use of ``ssh-agent`` is highly recommended.\n    author: ansible (@core)\n    version_added: historical\n    options:\n      host:\n          description: Hostname/ip to connect to.\n          default: inventory_hostname\n          vars:\n               - name: ansible_host\n               - name: ansible_ssh_host\n      host_key_checking:\n          description: Determines if ssh should check host keys\n          type: boolean\n          ini:\n              - section: defaults\n                key: 'host_key_checking'\n              - section: ssh_connection\n                key: 'host_key_checking'\n                version_added: '2.5'\n          env:\n              - name: ANSIBLE_HOST_KEY_CHECKING\n              - name: ANSIBLE_SSH_HOST_KEY_CHECKING\n                version_added: '2.5'\n          vars:\n              - name: ansible_host_key_checking\n                version_added: '2.5'\n              - name: ansible_ssh_host_key_checking\n                version_added: '2.5'\n      password:\n          description: Authentication password for the C(remote_user). Can be supplied as CLI option.\n          vars:\n              - name: ansible_password\n              - name: ansible_ssh_pass\n              - name: ansible_ssh_password\n      ssh_args:\n          description: Arguments to pass to all ssh cli tools\n          default: '-C -o ControlMaster=auto -o ControlPersist=60s'\n          ini:\n              - section: 'ssh_connection'\n                key: 'ssh_args'\n          env:\n              - name: ANSIBLE_SSH_ARGS\n          vars:\n              - name: ansible_ssh_args\n                version_added: '2.7'\n      ssh_common_args:\n          description: Common extra args for all ssh CLI tools\n          ini:\n              - section: 'ssh_connection'\n                key: 'ssh_common_args'\n                version_added: '2.7'\n          env:\n              - name: ANSIBLE_SSH_COMMON_ARGS\n                version_added: '2.7'\n          vars:\n              - name: ansible_ssh_common_args\n      ssh_executable:\n          default: ssh\n          description:\n            - This defines the location of the ssh binary. It defaults to ``ssh`` which will use the first ssh binary available in $PATH.\n            - This option is usually not required, it might be useful when access to system ssh is restricted,\n              or when using ssh wrappers to connect to remote hosts.\n          env: [{name: ANSIBLE_SSH_EXECUTABLE}]\n          ini:\n          - {key: ssh_executable, section: ssh_connection}\n          #const: ANSIBLE_SSH_EXECUTABLE\n          version_added: \"2.2\"\n          vars:\n              - name: ansible_ssh_executable\n                version_added: '2.7'\n      sftp_executable:\n          default: sftp\n          description:\n            - This defines the location of the sftp binary. It defaults to ``sftp`` which will use the first binary available in $PATH.\n          env: [{name: ANSIBLE_SFTP_EXECUTABLE}]\n          ini:\n          - {key: sftp_executable, section: ssh_connection}\n          version_added: \"2.6\"\n          vars:\n              - name: ansible_sftp_executable\n                version_added: '2.7'\n      scp_executable:\n          default: scp\n          description:\n            - This defines the location of the scp binary. It defaults to `scp` which will use the first binary available in $PATH.\n          env: [{name: ANSIBLE_SCP_EXECUTABLE}]\n          ini:\n          - {key: scp_executable, section: ssh_connection}\n          version_added: \"2.6\"\n          vars:\n              - name: ansible_scp_executable\n                version_added: '2.7'\n      scp_extra_args:\n          description: Extra exclusive to the ``scp`` CLI\n          vars:\n              - name: ansible_scp_extra_args\n          env:\n            - name: ANSIBLE_SCP_EXTRA_ARGS\n              version_added: '2.7'\n          ini:\n            - key: scp_extra_args\n              section: ssh_connection\n              version_added: '2.7'\n      sftp_extra_args:\n          description: Extra exclusive to the ``sftp`` CLI\n          vars:\n              - name: ansible_sftp_extra_args\n          env:\n            - name: ANSIBLE_SFTP_EXTRA_ARGS\n              version_added: '2.7'\n          ini:\n            - key: sftp_extra_args\n              section: ssh_connection\n              version_added: '2.7'\n      ssh_extra_args:\n          description: Extra exclusive to the 'ssh' CLI\n          vars:\n              - name: ansible_ssh_extra_args\n          env:\n            - name: ANSIBLE_SSH_EXTRA_ARGS\n              version_added: '2.7'\n          ini:\n            - key: ssh_extra_args\n              section: ssh_connection\n              version_added: '2.7'\n      retries:\n          # constant: ANSIBLE_SSH_RETRIES\n          description: Number of attempts to connect.\n          default: 3\n          type: integer\n          env:\n            - name: ANSIBLE_SSH_RETRIES\n          ini:\n            - section: connection\n              key: retries\n            - section: ssh_connection\n              key: retries\n          vars:\n            - name: ansible_ssh_retries\n              version_added: '2.7'\n      port:\n          description: Remote port to connect to.\n          type: int\n          default: 22\n          ini:\n            - section: defaults\n              key: remote_port\n          env:\n            - name: ANSIBLE_REMOTE_PORT\n          vars:\n            - name: ansible_port\n            - name: ansible_ssh_port\n      remote_user:\n          description:\n              - User name with which to login to the remote server, normally set by the remote_user keyword.\n              - If no user is supplied, Ansible will let the ssh client binary choose the user as it normally\n          ini:\n            - section: defaults\n              key: remote_user\n          env:\n            - name: ANSIBLE_REMOTE_USER\n          vars:\n            - name: ansible_user\n            - name: ansible_ssh_user\n      pipelining:\n          default: ANSIBLE_PIPELINING\n          description:\n            - Pipelining reduces the number of SSH operations required to execute a module on the remote server,\n              by executing many Ansible modules without actual file transfer.\n            - This can result in a very significant performance improvement when enabled.\n            - However this conflicts with privilege escalation (become).\n              For example, when using sudo operations you must first disable 'requiretty' in the sudoers file for the target hosts,\n              which is why this feature is disabled by default.\n          env:\n            - name: ANSIBLE_PIPELINING\n            #- name: ANSIBLE_SSH_PIPELINING\n          ini:\n            - section: defaults\n              key: pipelining\n            #- section: ssh_connection\n            #  key: pipelining\n          type: boolean\n          vars:\n            - name: ansible_pipelining\n            - name: ansible_ssh_pipelining\n      private_key_file:\n          description:\n              - Path to private key file to use for authentication\n          ini:\n            - section: defaults\n              key: private_key_file\n          env:\n            - name: ANSIBLE_PRIVATE_KEY_FILE\n          vars:\n            - name: ansible_private_key_file\n            - name: ansible_ssh_private_key_file\n      control_path:\n        description:\n          - This is the location to save ssh's ControlPath sockets, it uses ssh's variable substitution.\n          - Since 2.3, if null, ansible will generate a unique hash. Use `%(directory)s` to indicate where to use the control dir path setting.\n        env:\n          - name: ANSIBLE_SSH_CONTROL_PATH\n        ini:\n          - key: control_path\n            section: ssh_connection\n        vars:\n          - name: ansible_control_path\n            version_added: '2.7'\n      control_path_dir:\n        default: ~/.ansible/cp\n        description:\n          - This sets the directory to use for ssh control path if the control path setting is null.\n          - Also, provides the `%(directory)s` variable for the control path setting.\n        env:\n          - name: ANSIBLE_SSH_CONTROL_PATH_DIR\n        ini:\n          - section: ssh_connection\n            key: control_path_dir\n        vars:\n          - name: ansible_control_path_dir\n            version_added: '2.7'\n      sftp_batch_mode:\n        default: 'yes'\n        description: 'TODO: write it'\n        env: [{name: ANSIBLE_SFTP_BATCH_MODE}]\n        ini:\n        - {key: sftp_batch_mode, section: ssh_connection}\n        type: bool\n        vars:\n          - name: ansible_sftp_batch_mode\n            version_added: '2.7'\n      scp_if_ssh:\n        default: smart\n        description:\n          - \"Prefered method to use when transfering files over ssh\"\n          - When set to smart, Ansible will try them until one succeeds or they all fail\n          - If set to True, it will force 'scp', if False it will use 'sftp'\n        env: [{name: ANSIBLE_SCP_IF_SSH}]\n        ini:\n        - {key: scp_if_ssh, section: ssh_connection}\n        vars:\n          - name: ansible_scp_if_ssh\n            version_added: '2.7'\n      use_tty:\n        version_added: '2.5'\n        default: 'yes'\n        description: add -tt to ssh commands to force tty allocation\n        env: [{name: ANSIBLE_SSH_USETTY}]\n        ini:\n", "answers": ["        - {key: usetty, section: ssh_connection}"], "incorrect_answer": "- {key: ssh_tty_allocation, section: ssh_options}"}, {"input": "", "context": "//#############################################################################\n//#                                                                           #\n//#  Copyright (C) <2014>  <IMS MAXIMS>                                       #\n//#                                                                           #\n//#  This program is free software: you can redistribute it and/or modify     #\n//#  it under the terms of the GNU Affero General Public License as           #\n//#  published by the Free Software Foundation, either version 3 of the       #\n//#  License, or (at your option) any later version.                          # \n//#                                                                           #\n//#  This program is distributed in the hope that it will be useful,          #\n//#  but WITHOUT ANY WARRANTY; without even the implied warranty of           #\n//#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the            #\n//#  GNU Affero General Public License for more details.                      #\n//#                                                                           #\n//#  You should have received a copy of the GNU Affero General Public License #\n//#  along with this program.  If not, see <http://www.gnu.org/licenses/>.    #\n//#                                                                           #\n//#############################################################################\n//#EOH\n// Template ver. 1.0.2 - Last modified on 08/03/2004 10:42 by Marius Mihalec\npackage ims.dto.client;\npublic final class Wardlist\n{\n\tprivate WardlistFilter lastGetFilter = null;\n\tprivate final String serviceName = \"WARDLIST\";\n\tprivate boolean listInProgress = false;\n\t/**\n\t * Represents the Data Transfer Object Connection used for this client object.\n\t */ \n\tpublic ims.dto.Connection Connection = null;\n\t/**\n\t * Represents the filter used by the current Data Transfer Object.\n\t */ \n\tpublic WardlistFilter Filter = new WardlistFilter();\t\t\t\n\t/**\n\t * Contains the data records for the current Data Transfer Object\n\t */ \n\tpublic WardlistCollection DataCollection = new WardlistCollection();\n\t/**\n\t * Creates a new Wardlist Data Transfer Object.\n\t */ \n\tpublic Wardlist(ims.dto.Connection connection) throws ims.dto.Exception\n\t{\t\n\t\tif(connection == null)\n\t\t\tthrow new ims.dto.Exception(\"Invalid Data Transfer Object Connection\");\n\t\tthis.Connection = connection;\n\t}\n\t/**\n\t * Creates a new copy of the current Data Transfer Object\n\t */\n\tpublic Wardlist cloneObject() throws ims.dto.Exception\n\t{\n\t\tWardlist cloneObject = new Wardlist(Connection);\n\t\t\t\n\t\tif(Filter != null)\n\t\t\tcloneObject.Filter = Filter.cloneObject();\t\t\t\n\t\t\t\t\t\n\t\tif(lastGetFilter != null)\n\t\t\tcloneObject.lastGetFilter = lastGetFilter.cloneObject();\n\t\telse\n\t\t\tcloneObject.lastGetFilter = null;\n\t\t\t\t\n\t\tfor(int x = 0; x < DataCollection.count(); x++)\n\t\t{\n\t\t\tint index = cloneObject.DataCollection.add();\n\t\t\t\n\t\t\tcloneObject.DataCollection.get(index).Rsno = DataCollection.get(x).Rsno;\n\t\t\tcloneObject.DataCollection.get(index).Hpcd = DataCollection.get(x).Hpcd;\n\t\t\tcloneObject.DataCollection.get(index).Site = DataCollection.get(x).Site;\n\t\t\tcloneObject.DataCollection.get(index).Name = DataCollection.get(x).Name;\n\t\t\tcloneObject.DataCollection.get(index).Code = DataCollection.get(x).Code;\n\t\t\tcloneObject.DataCollection.get(index).Stat = DataCollection.get(x).Stat;\n\t\t\tcloneObject.DataCollection.get(index).At01 = DataCollection.get(x).At01;\n\t\t\tcloneObject.DataCollection.get(index).Maxno = DataCollection.get(x).Maxno;\n\t\t\tcloneObject.DataCollection.get(index).Allstat = DataCollection.get(x).Allstat;\n\t\t\tcloneObject.DataCollection.get(index).__orderby = DataCollection.get(x).__orderby;\n\t\t\t\t\t\t\t\n\t\t\t\n\t\t}\n\t\t\n\t\treturn cloneObject;\n\t}\t\t\n\t/**\n\t * Returns the number of records using the specified filter. This method always returns a non null result. The ID field holds the count result (when greater or equal to zero) or the error number (when less than zero).\n\t */\n\tpublic ims.dto.Result count()\n\t{\n\t\tims.dto.Result reLoginResult = Connection.reLogin();\n\t\tif(reLoginResult != null)\n\t\t\treturn new ims.dto.Result(reLoginResult.getMessage(), \"DTO.Client.Wardlist.Count\");\n\t\t\t\n\t\tint result = Connection.count(serviceName, encodeNASFilter());\n\t\tif(result >= 0)\n\t\t\treturn new ims.dto.Result(result, \"No error detected. The count result is held in the ID field\", \"DTO.Client.Wardlist.Count\");\n\t\t\t\t\n\t\treturn Connection.getLastError();\t\t\t\t\n\t}\t\t\n\t/**\n\t * Returns the list of records using the specified filter. Use maxRecords to limit the number of records returned. If the result returned is not null an error occured.\n\t */\n\tpublic ims.dto.Result list(int maxRecords)\n\t{\n\t\tif(maxRecords <= 0)\n\t\t\treturn list();\t\t\n\t\t\t\t\n\t\treturn list(false, maxRecords);\n\t}\t\n\t/**\n\t* Returns the list of records using the specified filter. If the result returned is not null an error occured.\n\t*/\n\tpublic ims.dto.Result list()\n\t{\t\n\t\treturn list(true, 0);\n\t}\t\t\t\t\n\t/**\n\t* Returns one record using the specified filter. If the result returned is not null an error occured.\n\t*/\n\tpublic ims.dto.Result get()\n\t{\t\n\t\tDataCollection.clear();\n\t\t\t\n\t\tims.dto.Result reLoginResult = Connection.reLogin();\n\t\tif(reLoginResult != null)\n\t\t\treturn new ims.dto.Result(reLoginResult.getMessage(), \"DTO.Client.Wardlist.Get\");\n\t\t\t\n\t\tims.dto.Result result = Connection.get(serviceName, encodeNASFilter());\n\t\tif(result != null)\n\t\t\treturn result;\n\t\t\t\n\t\tlastGetFilter = Filter.cloneObject();\t\t\t\t\t\t\n\t\tdecodeNASMessageWithRepeatingGroups();\t\t\n\t\t\t\n\t\treturn null;\n\t}\t\n\t/**\n\t* Returns one record using the specified filter. If the result returned is not null an error occured.\n\t*/\n\tpublic ims.dto.Result getLast()\n\t{\t\n\t\tDataCollection.clear();\n\t\t\t\n\t\tims.dto.Result reLoginResult = Connection.reLogin();\n\t\tif(reLoginResult != null)\n\t\t\treturn new ims.dto.Result(reLoginResult.getMessage(), \"DTO.Client.Wardlist.Get\");\n\t\t\t\n\t\tims.dto.Result result = Connection.getLast(serviceName, encodeNASFilter());\n\t\tif(result != null)\n\t\t\treturn result;\n\t\t\t\n\t\tlastGetFilter = Filter.cloneObject();\t\t\t\t\t\t\n\t\tdecodeNASMessageWithRepeatingGroups();\t\n\t\t\t\n\t\treturn null;\n\t}\t\t\t\t\t\n\t/**\n\t* Performs data validation prior to update. If the result returned is not null an error occured.\n\t*/\n\tpublic ims.dto.Result getForUpdate()\n\t{\t\t\t\t\t\t\n\t\tims.dto.Result reLoginResult = Connection.reLogin();\n\t\tif(reLoginResult != null)\n\t\t\treturn new ims.dto.Result(reLoginResult.getMessage(), \"DTO.Client.Wardlist.GetForUpdate\");\n\t\t\t\t\t\t\t\n\t\tif(lastGetFilter == null)\t\n\t\t\treturn new ims.dto.Result(\"Last get method failed or not called\", \"DTO.Client.Wardlist.GetForUpdate\");\n\t\t\t\n\t\tims.dto.Result result = Connection.getForUpdate(serviceName, encodeNASFilter(lastGetFilter));\n\t\tif(result != null)\n\t\t\treturn result;\n\t\t\t\n\t\tif(Connection.countResponseItems(Connection.getValueAt(6)) == 0)\n\t\t\treturn null;\n\t\t\t\n\t\tDataCollection.clear();\t\n\t\tdecodeNASMessageWithRepeatingGroups();\n\t\t\t\t\n\t\treturn new ims.dto.Result(\"The data was changed by another user\", \"DTO.Client.Wardlist.GetForUpdate\");\n\t}\t\t\n\t/**\n\t* Inserts a new record. This method always returns a non null result. The ID field holds the Unique ID for the inserted record (when greater than zero) or the error number (when less than zero). If the ID is zero, the record was inserted but the server did not returned the Unique ID.\n\t*/\n\tpublic ims.dto.Result insert()\n\t{\n\t\tims.dto.Result reLoginResult = Connection.reLogin();\n\t\tif(reLoginResult != null)\n\t\t\treturn new ims.dto.Result(reLoginResult.getMessage(), \"DTO.Client.Wardlist.Insert\");\n\t\t\t\t\t\n\t\tif(DataCollection.count() == 0)\n\t\t\treturn new ims.dto.Result(\"No data to insert\", \"DTO.Client.Wardlist.Insert\");\n\t\t\t\n\t\tif(DataCollection.count() > 1)\n\t\t\treturn new ims.dto.Result(\"Multiple object insert not allowed\", \"DTO.Client.Wardlist.Insert\");\n\t\t\t\n\t\tims.dto.Result result = Connection.insert(serviceName, encodeNASMessage());\n\t\tif(result != null)\n\t\t\treturn result;\n\t\t\t\t\t\n\t\tint recordID = 0;\n\t\t\t\t\t\n\t\ttry\n\t\t{\n\t\t\trecordID = new Integer(Connection.getValueAt(2)).intValue();\n\t\t}\n\t\tcatch(NumberFormatException ex)\n\t\t{\n\t\t\treturn new ims.dto.Result(\"Invalid record ID returned\", \"DTO.Client.Wardlist.Insert\");\n\t\t}\n\t\t\n\t\treturn new ims.dto.Result(recordID, \"No error. The ID of the new record is in the ID field\", \"DTO.Client.Wardlist.Insert\");\n\t}\n\t/**\n\t * Executes a specific action. This method always returns a non null result.\n\t */\n\tpublic ims.dto.Result executeAction(String action)\n\t{\n\t\tif(action.length() == 0)\n\t\t\treturn new ims.dto.Result(\"Invalid action name\", \"DTO.Client.Wardlist.ExecuteAction\");\n\t\t\t\n\t\tims.dto.Result reLoginResult = Connection.reLogin();\n\t\tif(reLoginResult != null)\n\t\t\treturn new ims.dto.Result(reLoginResult.getMessage(), \"DTO.Client.Wardlist.ExecuteAction\");\n\t\t\n\t\tif(DataCollection.count() == 0)\n\t\t\treturn new ims.dto.Result(\"Data container is empty\", \"DTO.Client.Wardlist.ExecuteAction\");\n\t\t\t\n\t\tif(DataCollection.count() > 1)\n\t\t\treturn new ims.dto.Result(\"Multiple objects are not allowed\", \"DTO.Client.Wardlist.ExecuteAction\");\n\t\t\t\n\t\tims.dto.Result result = Connection.executeAction(serviceName, encodeNASMessage(), action);\n\t\tif(result != null)\n\t\t\treturn result;\n\t\t\t\n\t\ttry\n\t\t{\n\t\t\treturn new ims.dto.Result(new Integer(Connection.getValueAt(2)).intValue(), \"No error\", \"DTO.Client.Wardlist.ExecuteAction\");\t\n\t\t}\n\t\tcatch(NumberFormatException ex)\n\t\t{\n\t\t\treturn new ims.dto.Result(\"Invalid server response\", \"DTO.Client.Wardlist.ExecuteAction\");\n\t\t}\n\t}\n\t/**\n\t * Transfers a record. If the result returned is not null an error occured.\n\t */\n\tpublic ims.dto.Result transferData(String action)\n\t{\n\t\tif(action.length() == 0)\n\t\t\treturn new ims.dto.Result(\"Invalid action name\", \"DTO.Client.Wardlist.TransferData\");\n\t\t\t\n\t\tims.dto.Result reLoginResult = Connection.reLogin();\n\t\tif(reLoginResult != null)\n\t\t\treturn new ims.dto.Result(reLoginResult.getMessage(), \"DTO.Client.Wardlist.TransferData\");\n\t\t\n\t\tif(DataCollection.count() == 0)\n\t\t\treturn new ims.dto.Result(\"No data to transfer\", \"DTO.Client.Wardlist.TransferData\");\n\t\t\t\n\t\tif(DataCollection.count() > 1)\n\t\t\treturn new ims.dto.Result(\"Multiple objects not allowed\", \"DTO.Client.Wardlist.TransferData\");\n\t\t\t\n\t\tims.dto.Result result = Connection.transferData(serviceName, encodeNASMessage(), action.toUpperCase());\n\t\tif(result != null)\n\t\t\treturn result;\n\t\t\n\t\tDataCollection.clear();\n\t\tdecodeNASMessageWithRepeatingGroups();\t\n\t\t\n\t\treturn null;\n\t}\n\t/**\n\t * Updates a record. If the result returned is not null an error occured.\n\t */\n\tpublic ims.dto.Result update()\n\t{\t\t\t\n\t\tims.dto.Result reLoginResult = Connection.reLogin();\n\t\tif(reLoginResult != null)\n\t\t\treturn new ims.dto.Result(reLoginResult.getMessage(), \"DTO.Client.Wardlist.Update\");\n\t\t\t\t\n\t\tif(DataCollection.count() == 0)\n\t\t\treturn new ims.dto.Result(\"No data to update\", \"DTO.Client.Wardlist.Update\");\t\n\t\t\t\n\t\tif(DataCollection.count() > 1)\n\t\t\treturn new ims.dto.Result(\"Multiple object update not allowed\", \"DTO.Client.Wardlist.Update\");\n\t\t\t\n\t\treturn Connection.update(serviceName, encodeNASMessage());\n\t}\n\t\t\t\n\tprivate ims.dto.Result stopList()\n\t{\n\t\tif(!listInProgress)\n\t\t\treturn new ims.dto.Result(\"No active list running\", \"DTO.Client.Wardlist.StopList\");\n\t\t\t\t\n\t\tlistInProgress = false;\t\t\t\t\n\t\treturn null;\n\t}\n\t\n\tprivate ims.dto.Result nextList()\n\t{\t\t\t\t\n\t\tims.dto.Result result = Connection.nextList(serviceName);\n\t\tif(result != null)\n\t\t\treturn result;\n\t\t\t\t\t\n\t\tdecodeNASMessage();\t\t\n\t\treturn null;\n\t}\n\t\t\n\tprivate boolean canContinueToList(boolean loadAllRecords, int maxRecords)\n\t{\n\t\tif(!listInProgress)\n\t\t\treturn false;\t\t\t\t\n\t\tif(loadAllRecords)\n\t\t\treturn true;\t\t\t\n\t\treturn DataCollection.count() < maxRecords;\n\t}\n\t\n\tprivate ims.dto.Result list(boolean loadAllRecords, int maxRecords)\n\t{\t\n\t\tDataCollection.clear();\n\t\t\t\n\t\tims.dto.Result reLoginResult = Connection.reLogin();\n\t\tif(reLoginResult != null)\n\t\t\treturn new ims.dto.Result(reLoginResult.getMessage(), \"DTO.Client.Wardlist.List\");\n\t\t\t\t\t\t\t\n\t\tlistInProgress = true;\t\n\t\tims.dto.Result result = Connection.list(serviceName, encodeNASFilter());\n\t\tif(result != null)\n\t\t{\n\t\t\tlistInProgress = false;\n\t\t\tif(result.getId() == -2) // NAS list empty\n\t\t\t\treturn null;\n\t\t\treturn result;\n\t\t}\n\t\t\t\t\t\n\t\tif(decodeNASMessage() == 0)\n\t\t{\n\t\t\tlistInProgress = false;\n\t\t\treturn null;\n\t\t}\n\t\t\t\t\t\t\n\t\tims.dto.Result execResult = null;\n\t\twhile(execResult == null && canContinueToList(loadAllRecords, maxRecords))\n\t\t\texecResult = nextList();\n\t\t\t\t\t\t\n\t\tif(execResult != null)\n\t\t{\n\t\t\tif(execResult.getId() != -3) \n\t\t\t{\n\t\t\t\tlistInProgress = false;\n\t\t\t\treturn execResult;\n\t\t\t}\n\t\t}\n\t\telse // NAS next list empty\n\t\t{\n\t\t\tlistInProgress = false;\n\t\t\treturn null;\n\t\t}\t\t\t\t\n\t\t\t\t\t\n\t\tif(!loadAllRecords || !listInProgress)\n\t\t{\n\t\t\tlistInProgress = false;\n\t\t\treturn Connection.stopList(serviceName);\n\t\t}\n\t\t\n\t\tlistInProgress = false;\n\t\treturn null;\n\t}\t\n\tprivate String encodeNASFilter()\n\t{\n\t\treturn encodeNASFilter(Filter);\n\t}\n\tprivate String encodeNASFilter(WardlistFilter filter)\n\t{\n\t\tif(filter == null)\n\t\t\treturn \"\";\n\t\t\t\n\t\tString filterString = \"\";\n\t\t\n\t\tif(Filter.Rsno != null && filter.Rsno.length()> 0)\n\t\t{\n\t\t\tif(filterString.length() > 0)\n\t\t\t\tfilterString += ims.dto.NASMessageCodes.PAIRSEPARATOR;\n\t\t\tfilterString += \"RSNO\" + ims.dto.NASMessageCodes.ATTRIBUTEVALUESEPARATOR + filter.Rsno;\n\t\t}\n\t\t\n\t\tif(Filter.Hpcd != null && filter.Hpcd.length()> 0)\n\t\t{\n\t\t\tif(filterString.length() > 0)\n\t\t\t\tfilterString += ims.dto.NASMessageCodes.PAIRSEPARATOR;\n\t\t\tfilterString += \"HPCD\" + ims.dto.NASMessageCodes.ATTRIBUTEVALUESEPARATOR + filter.Hpcd;\n\t\t}\n\t\t\n\t\tif(Filter.Site != null && filter.Site.length()> 0)\n\t\t{\n\t\t\tif(filterString.length() > 0)\n\t\t\t\tfilterString += ims.dto.NASMessageCodes.PAIRSEPARATOR;\n\t\t\tfilterString += \"SITE\" + ims.dto.NASMessageCodes.ATTRIBUTEVALUESEPARATOR + filter.Site;\n\t\t}\n\t\t\n\t\tif(Filter.Name != null && filter.Name.length()> 0)\n\t\t{\n\t\t\tif(filterString.length() > 0)\n\t\t\t\tfilterString += ims.dto.NASMessageCodes.PAIRSEPARATOR;\n\t\t\tfilterString += \"NAME\" + ims.dto.NASMessageCodes.ATTRIBUTEVALUESEPARATOR + filter.Name;\n\t\t}\n\t\t\n\t\tif(Filter.Code != null && filter.Code.length()> 0)\n\t\t{\n\t\t\tif(filterString.length() > 0)\n\t\t\t\tfilterString += ims.dto.NASMessageCodes.PAIRSEPARATOR;\n\t\t\tfilterString += \"CODE\" + ims.dto.NASMessageCodes.ATTRIBUTEVALUESEPARATOR + filter.Code;\n\t\t}\n\t\t\n\t\tif(Filter.Stat != null && filter.Stat.length()> 0)\n\t\t{\n\t\t\tif(filterString.length() > 0)\n\t\t\t\tfilterString += ims.dto.NASMessageCodes.PAIRSEPARATOR;\n\t\t\tfilterString += \"STAT\" + ims.dto.NASMessageCodes.ATTRIBUTEVALUESEPARATOR + filter.Stat;\n\t\t}\n\t\t\n\t\tif(Filter.At01 != null && filter.At01.length()> 0)\n\t\t{\n\t\t\tif(filterString.length() > 0)\n\t\t\t\tfilterString += ims.dto.NASMessageCodes.PAIRSEPARATOR;\n\t\t\tfilterString += \"AT01\" + ims.dto.NASMessageCodes.ATTRIBUTEVALUESEPARATOR + filter.At01;\n\t\t}\n\t\t\n\t\tif(Filter.Maxno != null && filter.Maxno.length()> 0)\n\t\t{\n\t\t\tif(filterString.length() > 0)\n\t\t\t\tfilterString += ims.dto.NASMessageCodes.PAIRSEPARATOR;\n\t\t\tfilterString += \"MAXNO\" + ims.dto.NASMessageCodes.ATTRIBUTEVALUESEPARATOR + filter.Maxno;\n\t\t}\n\t\t\n\t\tif(Filter.Allstat != null && filter.Allstat.length()> 0)\n\t\t{\n\t\t\tif(filterString.length() > 0)\n\t\t\t\tfilterString += ims.dto.NASMessageCodes.PAIRSEPARATOR;\n\t\t\tfilterString += \"ALLSTAT\" + ims.dto.NASMessageCodes.ATTRIBUTEVALUESEPARATOR + filter.Allstat;\n\t\t}\n\t\t\n\t\tif(Filter.__orderby != null && filter.__orderby.length()> 0)\n\t\t{\n\t\t\tif(filterString.length() > 0)\n\t\t\t\tfilterString += ims.dto.NASMessageCodes.PAIRSEPARATOR;\n\t\t\tfilterString += \"__ORDERBY\" + ims.dto.NASMessageCodes.ATTRIBUTEVALUESEPARATOR + filter.__orderby;\n\t\t}\n\t\t\n\t\treturn filterString;\t\n\t}\n\t\n\tprivate String encodeNASMessage()\n\t{\n\t\tString dataString = \"\";\n\t\tif(DataCollection.count() == 0)\n\t\t\treturn dataString;\n\t\t\t\n", "answers": ["\t\tWardlistRecord data = (WardlistRecord)DataCollection.get(0);"], "incorrect_answer": "WardlistFilter filter = (WardlistFilter)DataCollection.get(0);"}, {"input": "", "context": "# -*- coding: utf-8 -*-\n##\n## This file is part of Harvesting Kit.\n## Copyright (C) 2013, 2014, 2015 CERN.\n##\n## Harvesting Kit is free software; you can redistribute it and/or\n## modify it under the terms of the GNU General Public License as\n## published by the Free Software Foundation; either version 2 of the\n## License, or (at your option) any later version.\n##\n## Harvesting Kit is distributed in the hope that it will be useful, but\n## WITHOUT ANY WARRANTY; without even the implied warranty of\n## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n## General Public License for more details.\n##\n## You should have received a copy of the GNU General Public License\n## along with Harvesting Kit; if not, write to the Free Software Foundation, Inc.,\n## 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.\nimport re\nimport sys\nimport time\nfrom os import pardir\nfrom os.path import (join,\n                     dirname,\n                     basename)\ntry:\n    from invenio.errorlib import register_exception\nexcept ImportError:\n    register_exception = lambda a=1, b=2: True\nfrom harvestingkit.minidom_utils import (get_value_in_tag,\n                                         xml_to_text)\nfrom harvestingkit.utils import (format_arxiv_id,\n                                 add_nations_field)\nfrom harvestingkit.bibrecord import (\n    record_add_field,\n    create_record,\n    record_xml_output,\n)\nfrom xml.dom.minidom import parse\nclass JATSParser(object):\n    def __init__(self, tag_to_remove=None, extract_nations=False):\n        self.references = None\n        self.tag_to_remove = tag_to_remove\n        self.extract_nations = extract_nations\n    def get_article(self, path):\n        return parse(open(path))\n    def get_title(self, xml):\n        try:\n            return get_value_in_tag(xml, \"article-title\", tag_to_remove=self.tag_to_remove)\n        except Exception:\n            print >> sys.stderr, \"Can't find title\"\n    def get_issn(self, xml):\n        issns = xml.getElementsByTagName('issn')\n        ret = None\n        for issn in issns:\n            if issn.getAttribute('date-type').encode('utf-8') == 'epub' or issn.getAttribute('pub-type').encode('utf-8') == 'epub':\n                if issn.getAttribute(\"pub-type\").encode('utf-8'):\n                    ret = issn.getAttribute(\"pub-type\").encode('utf-8')\n                else:\n                    ret = issn.getAttribute(\"date-type\").encode('utf-8')\n        if not ret and issns:\n            ret = xml_to_text(issns[0])\n        return ret\n    def get_date(self, xml):\n        dates = xml.getElementsByTagName('pub-date')\n        ret = None\n        for date in dates:\n            if date.getAttribute('date-type').encode('utf-8') == 'epub' or date.getAttribute('pub-type').encode('utf-8') == 'epub':\n                ret = get_value_in_tag(date, 'year')\n        if not ret and dates:\n            return dates[0]\n        else:\n            return ret\n    def get_publication_information(self, xml):\n        jid = get_value_in_tag(xml, \"journal-title\")\n        journal = \"\"\n        if \"European Physical Journal\" in jid:\n            journal = \"EPJC\"\n        try:\n            art = xml.getElementsByTagName('article-meta')[0]\n        except IndexError as err:\n            register_exception()\n            print >> sys.stderr, \"ERROR: XML corrupted: %s\" % err\n            pass\n        except Exception as err:\n            register_exception()\n            print >> sys.stderr, \"ERROR: Exception captured: %s\" % err\n            pass\n        issn = self.get_issn(art)\n        volume = get_value_in_tag(art, \"volume\")\n        issue = get_value_in_tag(art, \"issue\")\n        year = self.get_date(art)\n        first_page = get_value_in_tag(art, \"fpage\")\n        last_page = get_value_in_tag(art, \"lpage\")\n        doi = self.get_doi(art)\n        return (journal, issn, volume, issue, first_page, last_page, year, doi)\n    def get_doi(self, xml):\n        ids = xml.getElementsByTagName('article-id')\n        ret = \"\"\n        for i in ids:\n            if i.getAttribute('pub-id-type').encode('utf-8') == 'doi':\n                ret = xml_to_text(i)\n        if not ret:\n            print >> sys.stdout, \"Can't find DOI.\"\n        return ret\n    def _get_orcid(self, xml_author):\n        try:\n            contrib_id = xml_author.getElementsByTagName('contrib-id')[0]\n            if contrib_id.getAttribute('contrib-id-type') == 'orcid':\n                orcid_raw = xml_to_text(contrib_id)\n                pattern = '\\d\\d\\d\\d-\\d\\d\\d\\d-\\d\\d\\d\\d-\\d\\d\\d[\\d|X]'\n                return re.search(pattern, orcid_raw).group()\n        except (IndexError, AttributeError):\n            return None\n    def get_authors(self, xml):\n        authors = []\n        for author in xml.getElementsByTagName(\"contrib\"):\n            # Springer puts colaborations in additional \"contrib\" tag so to\n            # avoid having fake author with all affiliations we skip \"contrib\"\n            # tag with \"contrib\" subtags.\n            if author.getElementsByTagName(\"contrib\"):\n                continue\n            tmp = {}\n            surname = get_value_in_tag(author, \"surname\")\n            if surname:\n                tmp[\"surname\"] = surname\n            given_name = get_value_in_tag(author, \"given-names\")\n            if given_name:\n                tmp[\"given_name\"] = given_name.replace('\\n', ' ')\n            if not surname and not given_name:\n                tmp[\"name\"] = get_value_in_tag(author, \"string-name\")\n            # It's not there yet\n            orcid = self._get_orcid(author)\n            if orcid:\n                tmp[\"orcid\"] = 'ORCID:{0}'.format(orcid)\n            # cross_refs = author.getElementsByTagName(\"ce:cross-ref\")\n            # if cross_refs:\n            #     tmp[\"cross_ref\"] = []\n            #     for cross_ref in cross_refs:\n            #         tmp[\"cross_ref\"].append(cross_ref.getAttribute(\"refid\").encode('utf-8'))\n            tmp[\"affiliations_ids\"] = []\n            tmp[\"contact_ids\"] = []\n            xrefs = author.getElementsByTagName(\"xref\")\n            for x in xrefs:\n                if x.getAttribute('ref-type').encode('utf-8') == 'aff':\n                    tmp[\"affiliations_ids\"].extend([a.encode('utf-8') for a in x.getAttribute('rid').split()])\n                if x.getAttribute('ref-type').encode('utf-8') == 'corresp':\n                    tmp[\"contact_ids\"].extend([a.encode('utf-8') for a in x.getAttribute('rid').split()])\n            authors.append(tmp)\n        affiliations = {}\n        for affiliation in xml.getElementsByTagName(\"aff\"):\n            aff_id = affiliation.getAttribute(\"id\").encode('utf-8')\n            # removes numbering in from affiliations\n            text = re.sub(r'^(\\d+,\\ ?)', \"\", xml_to_text(affiliation, delimiter=\", \"))\n            affiliations[aff_id] = text\n        emails = {}\n        for contact in xml.getElementsByTagName(\"corresp\"):\n            contact_id = contact.getAttribute(\"id\").encode('utf-8')\n            if contact.getElementsByTagName('email'):\n                text = xml_to_text(contact.getElementsByTagName('email')[0])\n                emails[contact_id] = text\n        implicit_affilations = True\n        for author in authors:\n            matching_ref = [ref for ref in author.get(\"affiliations_ids\") if ref in affiliations]\n            if matching_ref:\n                implicit_affilations = False\n                author[\"affiliation\"] = []\n                for i in xrange(0, len(matching_ref)):\n                    author[\"affiliation\"].append(affiliations[matching_ref[i]])\n            matching_contact = [cont for cont in author.get('contact_ids') if cont in emails]\n            if matching_contact:\n                author[\"email\"] = emails[matching_contact[0]]\n        if implicit_affilations and len(affiliations) > 1:\n            print >> sys.stderr, \"Implicit affiliations are used, but there are more than one affiliation: %s\" % affiliations\n        if implicit_affilations and len(affiliations) >= 1:\n            for author in authors:\n                author[\"affiliation\"] = []\n                for aff in affiliations.values():\n                    author[\"affiliation\"].append(aff)\n        return authors\n    def get_abstract(self, xml):\n        try:\n            return get_value_in_tag(xml, \"abstract\", tag_to_remove=self.tag_to_remove).replace(\"Abstract\", \"\", 1)\n        except Exception:\n            print >> sys.stderr, \"Can't find abstract\"\n    def get_copyright(self, xml, logger=None):\n        tags = [\"copyright-holder\", \"copyright-statement\"]\n        for tag in tags:\n            if tag is \"copyright-holder\":\n                ret = get_value_in_tag(xml, tag)\n                if not ret:\n                    if logger:\n                        logger.info(\"Can't find copyright, trying different tag.\")\n                    print >> sys.stderr, \"Can't find copyright, trying different tag.\"\n                else:\n                    return ret\n            else:\n                ret = get_value_in_tag(xml, tag)\n                if not ret:\n                    if logger:\n                        logger.info(\"Can't find copyright\")\n                    print >> sys.stderr, \"Can't find copyright\"\n                else:\n                    ret = ret.split('.')\n                    return ret[0]\n    def get_keywords(self, xml):\n        try:\n            kwd_groups = xml.getElementsByTagName('kwd-group')\n            pacs = []\n            other = []\n            for kwd_group in kwd_groups:\n                if kwd_group.getAttribute('kwd-group-type').encode('utf-8') == \"pacs\":\n                    pacs = [xml_to_text(keyword, tag_to_remove=self.tag_to_remove) for keyword in kwd_group.getElementsByTagName(\"kwd\")]\n                else:\n                    other = [xml_to_text(keyword, tag_to_remove=self.tag_to_remove) for keyword in kwd_group.getElementsByTagName(\"kwd\")]\n            return {\"pacs\": pacs, \"other\": other}\n        except Exception:\n            print >> sys.stderr, \"Can't find keywords\"\n    def get_ref_link(self, xml, name):\n        links = xml.getElementsByTagName('ext-link')\n        ret = None\n        for link in links:\n            if name in link.getAttribute(\"xlink:href\").encode('utf-8'):\n                ret = xml_to_text(link).strip()\n        if not ret:\n            links = xml.getElementsByTagName('elocation-id')\n            for link in links:\n                if name in link.getAttribute(\"content-type\").encode('utf-8'):\n                    ret = xml_to_text(link).strip()\n        return ret\n    def get_page_count(self, xml):\n        counts = xml.getElementsByTagName(\"counts\")\n        if counts:\n            page_count = counts[0].getElementsByTagName(\"page-count\")\n            if page_count:\n                return page_count[0].getAttribute(\"count\").encode('utf-8')\n            else:\n                return None\n        else:\n            return None\n    def get_publication_date(self, xml, logger=None):\n        date_xmls = xml.getElementsByTagName('pub-date')\n        day = None\n        month = None\n        year = None\n        if date_xmls:\n            for date_xml in date_xmls:\n                if date_xml.hasAttribute('pub-type'):\n                    if date_xml.getAttribute('pub-type') == \"epub\":\n                        day = get_value_in_tag(date_xml, \"day\")\n                        month = get_value_in_tag(date_xml, \"month\")\n                        year = get_value_in_tag(date_xml, \"year\")\n                if not year:\n                    day = get_value_in_tag(date_xml, \"day\")\n                    month = get_value_in_tag(date_xml, \"month\")\n                    year = get_value_in_tag(date_xml, \"year\")\n            if logger:\n                logger.info('%s-%s-%s' % (year, month, day))\n            return '%s-%s-%s' % (year, month, day)\n        else:\n            print >> sys.stderr, \"Can't find publication date. Using 'today'.\"\n            if logger:\n                logger.info(\"Can't find publication date. Using 'today'.\")\n            return time.strftime('%Y-%m-%d')\n    def get_references(self, xml):\n        references = []\n        for reference in xml.getElementsByTagName(\"ref\"):\n            plain_text = None\n            try:\n                ref_type = reference.getElementsByTagName('mixed-citation')[0]\n                ref_type = ref_type.getAttribute('publication-type').encode('utf-8')\n            except:\n                ref_type = reference.getElementsByTagName('citation')[0]\n                ref_type = ref_type.getAttribute('publication-type').encode('utf-8')\n            label = get_value_in_tag(reference, \"label\").strip('.')\n            authors = []\n            for author in reference.getElementsByTagName(\"name\"):\n                given_name = get_value_in_tag(author, \"given-names\")\n                surname = get_value_in_tag(author, \"surname\")\n                if given_name:\n                    name = \"%s, %s\" % (surname, given_name)\n                else:\n                    name = surname\n                if name.strip().split() == []:\n                    name = get_value_in_tag(author, \"string-name\")\n                authors.append(name)\n            doi_tag = reference.getElementsByTagName(\"pub-id\")\n            doi = \"\"\n            for tag in doi_tag:\n                if tag.getAttribute(\"pub-id-type\") == \"doi\":\n                    doi = xml_to_text(tag)\n            issue = get_value_in_tag(reference, \"issue\")\n            page = get_value_in_tag(reference, \"fpage\")\n            page_last = get_value_in_tag(reference, \"lpage\")\n            title = get_value_in_tag(reference, \"source\")\n            volume = get_value_in_tag(reference, \"volume\")\n            year = get_value_in_tag(reference, \"year\")\n            ext_link = format_arxiv_id(self.get_ref_link(reference, \"arxiv\"))\n            if ref_type != 'journal':\n                try:\n                    plain_text = get_value_in_tag(reference,\n                                                  \"mixed-citation\",\n                                                  tag_to_remove=self.tag_to_remove)\n                except:\n                    plain_text = get_value_in_tag(reference,\n                                                  \"citation\",\n                                                  tag_to_remove=self.tag_to_remove)\n            references.append((label, authors, doi,\n                               issue, page, page_last,\n                               title, volume, year,\n                               ext_link, plain_text))\n        self.references = references\n    def get_record(self, f_path, publisher=None, collection=None, logger=None):\n        xml = self.get_article(f_path)\n        rec = create_record()\n        title = self.get_title(xml)\n        if title:\n            record_add_field(rec, '245', subfields=[('a', title)])\n        record_add_field(rec, '260', subfields=[('c', self.get_publication_date(xml, logger))])\n        journal, issn, volume, issue, first_page, last_page, year, doi = self.get_publication_information(xml)\n        if logger:\n            logger.info(\"Creating record: %s %s\" % (join(f_path, pardir), doi))\n        if doi:\n            record_add_field(rec, '024', ind1='7', subfields=[('a', doi), ('2', 'DOI')])\n        authors = self.get_authors(xml)\n        first_author = True\n        for author in authors:\n            if author.get('surname'):\n                subfields = [('a', '%s, %s' % (author.get('surname'), author.get('given_name') or author.get('initials', '')))]\n            else:\n                subfields = [('a', '%s' % (author.get('name', '')))]\n            if 'orcid' in author:\n                subfields.append(('j', author['orcid']))\n            if 'affiliation' in author:\n                for aff in author[\"affiliation\"]:\n                    subfields.append(('v', aff))\n                if self.extract_nations:\n                    add_nations_field(subfields)\n            if author.get('email'):\n                    subfields.append(('m', author['email']))\n            if first_author:\n                record_add_field(rec, '100', subfields=subfields)\n                first_author = False\n            else:\n                record_add_field(rec, '700', subfields=subfields)\n        page_count = self.get_page_count(xml)\n        if page_count:\n", "answers": ["            record_add_field(rec, '300', subfields=[('a', page_count)])"], "incorrect_answer": "record_add_field(rec, '400', subfields=[('b', page_count)])"}, {"input": "", "context": "package cern.colt.matrix.tint.impl;\nimport cern.colt.list.tint.IntArrayList;\nimport cern.colt.matrix.tint.IntMatrix1D;\nimport cern.colt.matrix.tint.IntMatrix1DProcedure;\nimport cern.colt.matrix.tint.IntMatrix2D;\nimport cern.colt.matrix.tint.IntMatrix2DTest;\nimport cern.jet.math.tint.IntFunctions;\nimport edu.emory.mathcs.utils.ConcurrencyUtils;\npublic class DiagonalIntMatrix2DTest extends IntMatrix2DTest {\n    protected int DLENGTH;\n    protected int DINDEX;\n    public DiagonalIntMatrix2DTest(String arg0) {\n        super(arg0);\n    }\n    protected void createMatrices() throws Exception {\n        DINDEX = 3;\n        A = new DiagonalIntMatrix2D(NROWS, NCOLUMNS, DINDEX);\n        B = new DiagonalIntMatrix2D(NROWS, NCOLUMNS, DINDEX);\n        Bt = new DiagonalIntMatrix2D(NCOLUMNS, NROWS, -DINDEX);\n        DLENGTH = ((DiagonalIntMatrix2D) A).diagonalLength();\n    }\n    protected void populateMatrices() {\n        ConcurrencyUtils.setThreadsBeginN_2D(1);\n        if (DINDEX >= 0) {\n            for (int r = 0; r < DLENGTH; r++) {\n                A.setQuick(r, r + DINDEX, Math.max(1, rand.nextInt() % A.rows()));\n            }\n            for (int r = 0; r < DLENGTH; r++) {\n                B.setQuick(r, r + DINDEX, Math.max(1, rand.nextInt() % A.rows()));\n            }\n            for (int r = 0; r < DLENGTH; r++) {\n                Bt.setQuick(r - DINDEX, r, Math.max(1, rand.nextInt() % A.rows()));\n            }\n        } else {\n            for (int r = 0; r < DLENGTH; r++) {\n                A.setQuick(r - DINDEX, r, Math.max(1, rand.nextInt() % A.rows()));\n            }\n            for (int r = 0; r < DLENGTH; r++) {\n                B.setQuick(r - DINDEX, r, Math.max(1, rand.nextInt() % A.rows()));\n            }\n            for (int r = 0; r < DLENGTH; r++) {\n                Bt.setQuick(r, r + DINDEX, Math.max(1, rand.nextInt() % A.rows()));\n            }\n        }\n    }\n    public void testAssignInt() {\n        int value = Math.max(1, rand.nextInt() % A.rows());\n        A.assign(value);\n        if (DINDEX >= 0) {\n            for (int r = 0; r < DLENGTH; r++) {\n                assertEquals(value, A.getQuick(r, r + DINDEX));\n            }\n        } else {\n            for (int r = 0; r < DLENGTH; r++) {\n                assertEquals(value, A.getQuick(r - DINDEX, r));\n            }\n        }\n    }\n    public void testAssignIntArrayArray() {\n        int[][] expected = new int[NROWS][NCOLUMNS];\n        for (int r = 0; r < NROWS; r++) {\n            for (int c = 0; c < NCOLUMNS; c++) {\n                expected[r][c] = Math.max(1, rand.nextInt() % A.rows());\n            }\n        }\n        A.assign(expected);\n        if (DINDEX >= 0) {\n            for (int r = 0; r < DLENGTH; r++) {\n                assertEquals(expected[r][r + DINDEX], A.getQuick(r, r + DINDEX));\n            }\n        } else {\n            for (int r = 0; r < DLENGTH; r++) {\n                assertEquals(expected[r - DINDEX][r], A.getQuick(r - DINDEX, r));\n            }\n        }\n    }\n    public void testAssignIntFunction() {\n        IntMatrix2D Acopy = A.copy();\n        A.assign(IntFunctions.neg);\n        if (DINDEX >= 0) {\n            for (int r = 0; r < DLENGTH; r++) {\n                int expected = -Acopy.getQuick(r, r + DINDEX);\n                assertEquals(expected, A.getQuick(r, r + DINDEX));\n            }\n        } else {\n            for (int r = 0; r < DLENGTH; r++) {\n                int expected = -Acopy.getQuick(r - DINDEX, r);\n                assertEquals(expected, A.getQuick(r - DINDEX, r));\n            }\n        }\n    }\n    public void testAssignIntMatrix2DIntIntFunction() {\n        IntMatrix2D Acopy = A.copy();\n        A.assign(B, IntFunctions.div);\n        if (DINDEX >= 0) {\n            for (int r = 0; r < DLENGTH; r++) {\n                assertEquals(Acopy.getQuick(r, r + DINDEX) / B.getQuick(r, r + DINDEX), A.getQuick(r, r + DINDEX));\n            }\n        } else {\n            for (int r = 0; r < DLENGTH; r++) {\n                assertEquals(Acopy.getQuick(r - DINDEX, r) / B.getQuick(r - DINDEX, r), A.getQuick(r - DINDEX, r));\n            }\n        }\n    }\n    public void testAssignIntMatrix2DIntIntFunctionIntArrayListIntArrayList() {\n        IntArrayList rowList = new IntArrayList();\n        IntArrayList columnList = new IntArrayList();\n        if (DINDEX >= 0) {\n            for (int r = 0; r < DLENGTH; r++) {\n                rowList.add(r);\n                columnList.add(r + DINDEX);\n            }\n            IntMatrix2D Acopy = A.copy();\n            A.assign(B, IntFunctions.div, rowList, columnList);\n            for (int r = 0; r < DLENGTH; r++) {\n                assertEquals(Acopy.getQuick(r, r + DINDEX) / B.getQuick(r, r + DINDEX), A.getQuick(r, r + DINDEX));\n            }\n        } else {\n            for (int r = 0; r < DLENGTH; r++) {\n                rowList.add(r - DINDEX);\n                columnList.add(r);\n            }\n            IntMatrix2D Acopy = A.copy();\n            A.assign(B, IntFunctions.div, rowList, columnList);\n            for (int r = 0; r < DLENGTH; r++) {\n                assertEquals(Acopy.getQuick(r - DINDEX, r) / B.getQuick(r - DINDEX, r), A.getQuick(r - DINDEX, r));\n            }\n        }\n    }\n    public void testCardinality() {\n        int card = A.cardinality();\n        assertEquals(DLENGTH, card);\n    }\n    public void testMaxLocation() {\n        A.assign(0);\n        if (DINDEX >= 0) {\n            A.setQuick(NROWS / 3, NROWS / 3 + DINDEX, 7);\n            A.setQuick(NROWS / 2, NROWS / 2 + DINDEX, 1);\n            int[] maxAndLoc = A.getMaxLocation();\n            assertEquals(7, maxAndLoc[0]);\n            assertEquals(NROWS / 3, (int) maxAndLoc[1]);\n            assertEquals(NROWS / 3 + DINDEX, (int) maxAndLoc[2]);\n        } else {\n            A.setQuick(NROWS / 3 - DINDEX, NROWS / 3, 7);\n            A.setQuick(NROWS / 2 - DINDEX, NROWS / 2, 1);\n            int[] maxAndLoc = A.getMaxLocation();\n            assertEquals(7, maxAndLoc[0]);\n            assertEquals(NROWS / 3 - DINDEX, (int) maxAndLoc[1]);\n            assertEquals(NROWS / 3, (int) maxAndLoc[2]);\n        }\n    }\n    public void testMinLocation() {\n        A.assign(0);\n        if (DINDEX >= 0) {\n            A.setQuick(NROWS / 3, NROWS / 3 + DINDEX, -7);\n            A.setQuick(NROWS / 2, NROWS / 2 + DINDEX, -1);\n            int[] minAndLoc = A.getMinLocation();\n            assertEquals(-7, minAndLoc[0]);\n            assertEquals(NROWS / 3, (int) minAndLoc[1]);\n            assertEquals(NROWS / 3 + DINDEX, (int) minAndLoc[2]);\n        } else {\n            A.setQuick(NROWS / 3 - DINDEX, NROWS / 3, -7);\n            A.setQuick(NROWS / 2 - DINDEX, NROWS / 2, -1);\n            int[] minAndLoc = A.getMinLocation();\n            assertEquals(-7, minAndLoc[0]);\n            assertEquals(NROWS / 3 - DINDEX, (int) minAndLoc[1]);\n            assertEquals(NROWS / 3, (int) minAndLoc[2]);\n        }\n    }\n    public void testGetNegativeValues() {\n        A.assign(0);\n        if (DINDEX >= 0) {\n            A.setQuick(NROWS / 3, NROWS / 3 + DINDEX, -7);\n            A.setQuick(NROWS / 2, NROWS / 2 + DINDEX, -1);\n            IntArrayList rowList = new IntArrayList();\n            IntArrayList columnList = new IntArrayList();\n            IntArrayList valueList = new IntArrayList();\n            A.getNegativeValues(rowList, columnList, valueList);\n            assertEquals(2, rowList.size());\n            assertEquals(2, columnList.size());\n            assertEquals(2, valueList.size());\n            assertTrue(rowList.contains(NROWS / 3));\n            assertTrue(rowList.contains(NROWS / 2));\n            assertTrue(columnList.contains(NROWS / 3 + DINDEX));\n            assertTrue(columnList.contains(NROWS / 2 + DINDEX));\n            assertTrue(valueList.contains(-7));\n            assertTrue(valueList.contains(-1));\n        } else {\n            A.setQuick(NROWS / 3 - DINDEX, NROWS / 3, -7);\n            A.setQuick(NROWS / 2 - DINDEX, NROWS / 2, -1);\n            IntArrayList rowList = new IntArrayList();\n            IntArrayList columnList = new IntArrayList();\n            IntArrayList valueList = new IntArrayList();\n            A.getNegativeValues(rowList, columnList, valueList);\n            assertEquals(2, rowList.size());\n            assertEquals(2, columnList.size());\n            assertEquals(2, valueList.size());\n            assertTrue(rowList.contains(NROWS / 3 - DINDEX));\n            assertTrue(rowList.contains(NROWS / 2 - DINDEX));\n            assertTrue(columnList.contains(NROWS / 3));\n            assertTrue(columnList.contains(NROWS / 2));\n            assertTrue(valueList.contains(-7));\n            assertTrue(valueList.contains(-1));\n        }\n    }\n    public void testGetNonZeros() {\n        A.assign(0);\n        if (DINDEX >= 0) {\n            A.setQuick(NROWS / 3, NROWS / 3 + DINDEX, 7);\n            A.setQuick(NROWS / 2, NROWS / 2 + DINDEX, 1);\n            IntArrayList rowList = new IntArrayList();\n            IntArrayList columnList = new IntArrayList();\n            IntArrayList valueList = new IntArrayList();\n            A.getNonZeros(rowList, columnList, valueList);\n            assertEquals(2, rowList.size());\n            assertEquals(2, columnList.size());\n            assertEquals(2, valueList.size());\n            assertTrue(rowList.contains(NROWS / 3));\n            assertTrue(rowList.contains(NROWS / 2));\n            assertTrue(columnList.contains(NROWS / 3 + DINDEX));\n            assertTrue(columnList.contains(NROWS / 2 + DINDEX));\n            assertTrue(valueList.contains(7));\n            assertTrue(valueList.contains(1));\n        } else {\n            A.setQuick(NROWS / 3 - DINDEX, NROWS / 3, 7);\n            A.setQuick(NROWS / 2 - DINDEX, NROWS / 2, 1);\n            IntArrayList rowList = new IntArrayList();\n            IntArrayList columnList = new IntArrayList();\n            IntArrayList valueList = new IntArrayList();\n            A.getNonZeros(rowList, columnList, valueList);\n            assertEquals(2, rowList.size());\n            assertEquals(2, columnList.size());\n            assertEquals(2, valueList.size());\n            assertTrue(rowList.contains(NROWS / 3 - DINDEX));\n            assertTrue(rowList.contains(NROWS / 2 - DINDEX));\n            assertTrue(columnList.contains(NROWS / 3));\n            assertTrue(columnList.contains(NROWS / 2));\n            assertTrue(valueList.contains(7));\n            assertTrue(valueList.contains(1));\n        }\n    }\n    public void testGetPositiveValues() {\n        A.assign(0);\n        if (DINDEX >= 0) {\n            A.setQuick(NROWS / 3, NROWS / 3 + DINDEX, 7);\n            A.setQuick(NROWS / 2, NROWS / 2 + DINDEX, 1);\n            IntArrayList rowList = new IntArrayList();\n            IntArrayList columnList = new IntArrayList();\n            IntArrayList valueList = new IntArrayList();\n            A.getPositiveValues(rowList, columnList, valueList);\n            assertEquals(2, rowList.size());\n            assertEquals(2, columnList.size());\n            assertEquals(2, valueList.size());\n            assertTrue(rowList.contains(NROWS / 3));\n            assertTrue(rowList.contains(NROWS / 2));\n            assertTrue(columnList.contains(NROWS / 3 + DINDEX));\n            assertTrue(columnList.contains(NROWS / 2 + DINDEX));\n            assertTrue(valueList.contains(7));\n            assertTrue(valueList.contains(1));\n        } else {\n            A.setQuick(NROWS / 3 - DINDEX, NROWS / 3, 7);\n            A.setQuick(NROWS / 2 - DINDEX, NROWS / 2, 1);\n            IntArrayList rowList = new IntArrayList();\n            IntArrayList columnList = new IntArrayList();\n            IntArrayList valueList = new IntArrayList();\n            A.getPositiveValues(rowList, columnList, valueList);\n            assertEquals(2, rowList.size());\n            assertEquals(2, columnList.size());\n            assertEquals(2, valueList.size());\n            assertTrue(rowList.contains(NROWS / 3 - DINDEX));\n            assertTrue(rowList.contains(NROWS / 2 - DINDEX));\n            assertTrue(columnList.contains(NROWS / 3));\n            assertTrue(columnList.contains(NROWS / 2));\n            assertTrue(valueList.contains(7));\n            assertTrue(valueList.contains(1));\n        }\n    }\n    public void testToArray() {\n        int[][] array = A.toArray();\n        assertTrue(NROWS == array.length);\n        for (int r = 0; r < NROWS; r++) {\n            assertTrue(NCOLUMNS == array[r].length);\n            for (int c = 0; c < NCOLUMNS; c++) {\n                assertEquals(array[r][c], A.getQuick(r, c));\n            }\n        }\n    }\n    public void testVectorize() {\n        IntMatrix1D Avec = A.vectorize();\n        int idx = 0;\n        for (int c = 0; c < NCOLUMNS; c++) {\n            for (int r = 0; r < NROWS; r++) {\n                assertEquals(A.getQuick(r, c), Avec.getQuick(idx++));\n            }\n        }\n    }\n    public void testViewColumn() {\n        IntMatrix1D col = A.viewColumn(NCOLUMNS / 2);\n        assertEquals(NROWS, col.size());\n        for (int r = 0; r < NROWS; r++) {\n            assertEquals(A.getQuick(r, NCOLUMNS / 2), col.getQuick(r));\n        }\n    }\n    public void testViewColumnFlip() {\n        IntMatrix2D B = A.viewColumnFlip();\n        assertEquals(A.size(), B.size());\n        for (int r = 0; r < NROWS; r++) {\n            for (int c = 0; c < NCOLUMNS; c++) {\n", "answers": ["                assertEquals(A.getQuick(r, NCOLUMNS - 1 - c), B.getQuick(r, c));"], "incorrect_answer": "assertEquals(A.getQuick(NROWS - r - 1, c), B.getQuick(r, c));"}, {"input": "", "context": "# coding: utf8\n# This file is part of Scapy\n# Scapy is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# any later version.\n#\n# Scapy is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with Scapy. If not, see <http://www.gnu.org/licenses/>.\n# scapy.contrib.description = EtherNet/IP\n# scapy.contrib.status = loads\n# Copyright (C) 2019 Jose Diogo Monteiro <jdlopes@student.dei.uc.pt>\n# Based on https://github.com/scy-phy/scapy-cip-enip\n# Routines for EtherNet/IP (Industrial Protocol) dissection\n# EtherNet/IP Home: www.odva.org\nimport struct\nfrom scapy.packet import Packet, bind_layers\nfrom scapy.layers.inet import TCP\nfrom scapy.fields import LEShortField, LEShortEnumField, LEIntEnumField, \\\n    LEIntField, LELongField, FieldLenField, PacketListField, ByteField, \\\n    PacketField, MultipleTypeField, StrLenField, StrFixedLenField, \\\n    XLEIntField, XLEStrLenField\n_commandIdList = {\n    0x0004: \"ListServices\",  # Request Struct Don't Have Command Spec Data\n    0x0063: \"ListIdentity\",  # Request Struct Don't Have Command Spec Data\n    0x0064: \"ListInterfaces\",  # Request Struct Don't Have Command Spec Data\n    0x0065: \"RegisterSession\",  # Request Structure = Reply Structure\n    0x0066: \"UnregisterSession\",  # Don't Have Command Specific Data\n    0x006f: \"SendRRData\",  # Request Structure = Reply Structure\n    0x0070: \"SendUnitData\",  # There is no reply\n    0x0072: \"IndicateStatus\",\n    0x0073: \"Cancel\"\n}\n_statusList = {\n    0: \"success\",\n    1: \"invalid_cmd\",\n    2: \"no_resources\",\n    3: \"incorrect_data\",\n    100: \"invalid_session\",\n    101: \"invalid_length\",\n    105: \"unsupported_prot_rev\"\n}\n_itemID = {\n    0x0000: \"Null Address Item\",\n    0x00a1: \"Connection-based Address Item\",\n    0x00b1: \"Connected Transport packet Data Item\",\n    0x00b2: \"Unconnected message Data Item\",\n    0x8000: \"Sockaddr Info, originator-to-target Data Item\",\n    0x8001: \"Sockaddr Info, target-to-originator Data Item\"\n}\nclass ItemData(Packet):\n    \"\"\"Common Packet Format\"\"\"\n    name = \"Item Data\"\n    fields_desc = [\n        LEShortEnumField(\"typeId\", 0, _itemID),\n        LEShortField(\"length\", 0),\n        XLEStrLenField(\"data\", \"\", length_from=lambda pkt: pkt.length),\n    ]\n    def extract_padding(self, s):\n        return '', s\nclass EncapsulatedPacket(Packet):\n    \"\"\"Encapsulated Packet\"\"\"\n    name = \"Encapsulated Packet\"\n    fields_desc = [LEShortField(\"itemCount\", 2), PacketListField(\n        \"item\", None, ItemData, count_from=lambda pkt: pkt.itemCount), ]\nclass BaseSendPacket(Packet):\n    \"\"\" Abstract Class\"\"\"\n    fields_desc = [\n        LEIntField(\"interfaceHandle\", 0),\n        LEShortField(\"timeout\", 0),\n        PacketField(\"encapsulatedPacket\", None, EncapsulatedPacket),\n    ]\nclass CommandSpecificData(Packet):\n    \"\"\"Command Specific Data Field Default\"\"\"\n    pass\nclass ENIPSendUnitData(BaseSendPacket):\n    \"\"\"Send Unit Data Command Field\"\"\"\n    name = \"ENIPSendUnitData\"\nclass ENIPSendRRData(BaseSendPacket):\n    \"\"\"Send RR Data Command Field\"\"\"\n    name = \"ENIPSendRRData\"\nclass ENIPListInterfacesReplyItems(Packet):\n    \"\"\"List Interfaces Items Field\"\"\"\n    name = \"ENIPListInterfacesReplyItems\"\n    fields_desc = [\n        LEIntField(\"itemTypeCode\", 0),\n        FieldLenField(\"itemLength\", 0, length_of=\"itemData\"),\n        StrLenField(\"itemData\", \"\", length_from=lambda pkt: pkt.itemLength),\n    ]\nclass ENIPListInterfacesReply(Packet):\n    \"\"\"List Interfaces Command Field\"\"\"\n    name = \"ENIPListInterfacesReply\"\n    fields_desc = [\n        FieldLenField(\"itemCount\", 0, count_of=\"identityItems\"),\n        PacketField(\"identityItems\", 0, ENIPListInterfacesReplyItems),\n    ]\nclass ENIPListIdentityReplyItems(Packet):\n    \"\"\"List Identity Items Field\"\"\"\n    name = \"ENIPListIdentityReplyItems\"\n    fields_desc = [\n        LEIntField(\"itemTypeCode\", 0),\n        FieldLenField(\"itemLength\", 0, length_of=\"itemData\"),\n        StrLenField(\"itemData\", \"\", length_from=lambda pkt: pkt.item_length),\n    ]\nclass ENIPListIdentityReply(Packet):\n    \"\"\"List Identity Command Field\"\"\"\n    name = \"ENIPListIdentityReply\"\n    fields_desc = [\n        FieldLenField(\"itemCount\", 0, count_of=\"identityItems\"),\n        PacketField(\"identityItems\", None, ENIPListIdentityReplyItems),\n    ]\nclass ENIPListServicesReplyItems(Packet):\n    \"\"\"List Services Items Field\"\"\"\n    name = \"ENIPListServicesReplyItems\"\n    fields_desc = [\n        LEIntField(\"itemTypeCode\", 0),\n        LEIntField(\"itemLength\", 0),\n        ByteField(\"version\", 1),\n        ByteField(\"flag\", 0),\n        StrFixedLenField(\"serviceName\", None, 16 * 4),\n    ]\nclass ENIPListServicesReply(Packet):\n    \"\"\"List Services Command Field\"\"\"\n    name = \"ENIPListServicesReply\"\n    fields_desc = [\n        FieldLenField(\"itemCount\", 0, count_of=\"identityItems\"),\n        PacketField(\"targetItems\", None, ENIPListServicesReplyItems),\n    ]\nclass ENIPRegisterSession(CommandSpecificData):\n    \"\"\"Register Session Command Field\"\"\"\n    name = \"ENIPRegisterSession\"\n    fields_desc = [\n        LEShortField(\"protocolVersion\", 1),\n        LEShortField(\"options\", 0)\n    ]\nclass ENIPTCP(Packet):\n    \"\"\"Ethernet/IP packet over TCP\"\"\"\n    name = \"ENIPTCP\"\n    fields_desc = [\n        LEShortEnumField(\"commandId\", None, _commandIdList),\n        LEShortField(\"length\", 0),\n        XLEIntField(\"session\", 0),\n        LEIntEnumField(\"status\", None, _statusList),\n        LELongField(\"senderContext\", 0),\n        LEIntField(\"options\", 0),\n        MultipleTypeField(\n            [\n                # List Services Reply\n                (PacketField(\"commandSpecificData\", ENIPListServicesReply,\n                             ENIPListServicesReply),\n                 lambda pkt: pkt.commandId == 0x4),\n                # List Identity Reply\n                (PacketField(\"commandSpecificData\", ENIPListIdentityReply,\n                             ENIPListIdentityReply),\n                 lambda pkt: pkt.commandId == 0x63),\n                # List Interfaces Reply\n                (PacketField(\"commandSpecificData\", ENIPListInterfacesReply,\n                             ENIPListInterfacesReply),\n                 lambda pkt: pkt.commandId == 0x64),\n                # Register Session\n                (PacketField(\"commandSpecificData\", ENIPRegisterSession,\n                             ENIPRegisterSession),\n                 lambda pkt: pkt.commandId == 0x65),\n                # Send RR Data\n                (PacketField(\"commandSpecificData\", ENIPSendRRData,\n                             ENIPSendRRData),\n", "answers": ["                 lambda pkt: pkt.commandId == 0x6f),"], "incorrect_answer": "lambda pkt: pkt.commandId == 0x68"}, {"input": "", "context": "/*\n *  GeoBatch - Open Source geospatial batch processing system\n *  http://code.google.com/p/geobatch/\n *  Copyright (C) 2007-2008-2009 GeoSolutions S.A.S.\n *  http://www.geo-solutions.it\n *\n *  GPLv3 + Classpath exception\n *\n *  This program is free software: you can redistribute it and/or modify\n *  it under the terms of the GNU General Public License as published by\n *  the Free Software Foundation, either version 3 of the License, or\n *  (at your option) any later version.\n *\n *  This program is distributed in the hope that it will be useful,\n *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *  GNU General Public License for more details.\n *\n *  You should have received a copy of the GNU General Public License\n *  along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\npackage it.geosolutions.geobatch.registry.harvest;\nimport it.geosolutions.filesystemmonitor.monitor.FileSystemMonitorEvent;\nimport it.geosolutions.filesystemmonitor.monitor.FileSystemMonitorNotifications;\nimport it.geosolutions.geobatch.catalog.file.FileBaseCatalog;\nimport it.geosolutions.geobatch.global.CatalogHolder;\nimport it.geosolutions.geobatch.jgsflodess.utils.io.JGSFLoDeSSIOUtils;\nimport it.geosolutions.geobatch.jgsflodess.utils.io.rest.PublishingRestletGlobalConfig;\nimport it.geosolutions.geobatch.metocs.jaxb.model.MetocElementType;\nimport it.geosolutions.geobatch.metocs.jaxb.model.Metocs;\nimport it.geosolutions.geobatch.registry.RegistryActionConfiguration;\nimport it.geosolutions.geobatch.registry.RegistryConfiguratorAction;\nimport it.geosolutions.geobatch.utils.IOUtils;\nimport java.io.BufferedReader;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileNotFoundException;\nimport java.io.FileReader;\nimport java.io.FileWriter;\nimport java.io.IOException;\nimport java.io.PrintWriter;\nimport java.net.URLDecoder;\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.ArrayList;\nimport java.util.Date;\nimport java.util.List;\nimport java.util.Properties;\nimport java.util.Queue;\nimport java.util.UUID;\nimport java.util.logging.Level;\nimport javax.media.jai.JAI;\nimport javax.xml.bind.JAXBContext;\nimport javax.xml.bind.JAXBException;\nimport javax.xml.bind.Unmarshaller;\nimport org.apache.commons.io.FilenameUtils;\nimport org.geotools.coverage.grid.GridEnvelope2D;\nimport org.geotools.coverage.grid.GridGeometry2D;\nimport org.geotools.coverage.grid.io.AbstractGridCoverage2DReader;\nimport org.geotools.coverage.grid.io.AbstractGridFormat;\nimport org.geotools.coverage.grid.io.GridFormatFinder;\nimport org.geotools.geometry.GeneralEnvelope;\nimport org.geotools.referencing.CRS;\nimport org.geotools.referencing.operation.LinearTransform;\nimport org.opengis.coverage.grid.Format;\nimport org.opengis.coverage.grid.GridEnvelope;\nimport org.opengis.coverage.grid.GridGeometry;\nimport org.opengis.referencing.FactoryException;\nimport org.opengis.referencing.crs.CoordinateReferenceSystem;\nimport org.opengis.referencing.datum.PixelInCell;\nimport org.opengis.referencing.operation.MathTransform;\nimport org.opengis.referencing.operation.Matrix;\n/**\n * \n * TODO: DOCUMENT ME !!\n * \n */\npublic class RegistryHarvestingConfigurator extends RegistryConfiguratorAction<FileSystemMonitorEvent> {\n\t/**\n\t * GeoTIFF Writer Default Params\n\t */\n\tpublic final static String GEOSERVER_VERSION = \"2.x\";\n\tprotected RegistryHarvestingConfigurator(\n\t\t\tRegistryActionConfiguration configuration) throws IOException {\n\t\tsuper(configuration);\n\t}\n\t/**\n\t * EXECUTE METHOD \n\t */\n\tpublic Queue<FileSystemMonitorEvent> execute(\n\t\t\tQueue<FileSystemMonitorEvent> events) throws Exception {\n\t\tif (LOGGER.isLoggable(Level.INFO))\n\t\t\tLOGGER.info(\"Starting with processing...\");\n\t\ttry {\n\t\t\t// looking for file\n\t\t\tif (events.size() == 0)\n\t\t\t\tthrow new IllegalArgumentException(\"Wrong number of elements for this action: \" + events.size());\n\t\t\t\n\t\t\tList<FileSystemMonitorEvent> generatedEvents = new ArrayList<FileSystemMonitorEvent>();\n\t\t\t\n\t\t\twhile (events.size() > 0) {\n\t\t\t\tFileSystemMonitorEvent event = events.remove();\n\t\t\t\t// //\n\t\t\t\t// data flow configuration and dataStore name must not be null.\n\t\t\t\t// //\n\t\t\t\tif (configuration == null) {\n\t\t\t\t\tLOGGER.log(Level.SEVERE, \"DataFlowConfig is null.\");\n\t\t\t\t\tthrow new IllegalStateException(\"DataFlowConfig is null.\");\n\t\t\t\t}\n\t\t\t\t// ////////////////////////////////////////////////////////////////////\n\t\t\t\t//\n\t\t\t\t// Initializing input variables\n\t\t\t\t//\n\t\t\t\t// ////////////////////////////////////////////////////////////////////\n\t\t\t\tfinal File workingDir = IOUtils.findLocation(configuration.getWorkingDirectory(), new File(\n\t\t\t\t\t\t((FileBaseCatalog) CatalogHolder.getCatalog()).getBaseDirectory()));\n\t\t\t\t// ////////////////////////////////////////////////////////////////////\n\t\t\t\t//\n\t\t\t\t// Checking input files.\n\t\t\t\t//\n\t\t\t\t// ////////////////////////////////////////////////////////////////////\n\t\t\t\tif ((workingDir == null) || !workingDir.exists()\n\t\t\t\t\t\t|| !workingDir.isDirectory()) {\n\t\t\t\t\tLOGGER.log(Level.SEVERE, \"WorkingDirectory is null or does not exist.\");\n\t\t\t\t\tthrow new IllegalStateException(\"WorkingDirectory is null or does not exist.\");\n\t\t\t\t}\n\t\t\t\t// ... BUSINESS LOGIC ... //\n\t\t\t\tfinal File inputFile = event.getSource();\n\t\t\t\tString inputFileName = inputFile.getAbsolutePath();\n\t\t\t\tfinal String filePrefix = FilenameUtils.getBaseName(inputFileName);\n\t\t\t\tfinal String fileSuffix = FilenameUtils.getExtension(inputFileName);\n\t\t\t\tfinal String fileNameFilter = getConfiguration().getStoreFilePrefix();\n\t\t\t\tString baseFileName = null;\n\t\t\t\tif (fileNameFilter != null) {\n\t\t\t\t\tif ((filePrefix.equals(fileNameFilter) || filePrefix.matches(fileNameFilter))\n\t\t\t\t\t\t\t&& \"layer\".equalsIgnoreCase(fileSuffix)) {\n\t\t\t\t\t\t// etj: are we missing something here?\n\t\t\t\t\t\tbaseFileName = filePrefix;\n\t\t\t\t\t}\n\t\t\t\t} else if (\"layer\".equalsIgnoreCase(fileSuffix)) {\n\t\t\t\t\tbaseFileName = filePrefix;\n\t\t\t\t}\n\t\t\t\tif (baseFileName == null) {\n\t\t\t\t\tLOGGER.log(Level.SEVERE, \"Unexpected file '\" + inputFileName + \"'\");\n\t\t\t\t\tthrow new IllegalStateException(\"Unexpected file '\" + inputFileName + \"'\");\n\t\t\t\t}\n\t\t\t\tProperties props = new Properties();\n\t\t\t\t//try retrieve data from file\n\t\t\t\ttry {\n\t\t\t\t\tprops.load(new FileInputStream(inputFile));\n\t\t\t\t}\n\t\t\t\t//catch exception in case properties file does not exist\n\t\t\t\tcatch(IOException e) {\n\t\t\t\t\tLOGGER.log(Level.SEVERE, e.getLocalizedMessage(), e);\n\t\t\t\t}\n\t\t\t\tfinal String namespace = props.getProperty(\"namespace\");\n\t\t\t\tfinal String metocFields = props.getProperty(\"metocFields\");\n\t\t\t\tfinal String storeid = props.getProperty(\"storeid\");\n\t\t\t\tfinal String layerid = props.getProperty(\"layerid\");\n\t\t\t\tfinal String driver = props.getProperty(\"driver\");\n\t\t\t\tfinal String path = new File(inputFile.getParentFile(), props.getProperty(\"path\")).getAbsolutePath();\n\t\t\t\t\n\t\t\t\tfinal File metadataTemplate = IOUtils.findLocation(configuration.getMetocHarvesterXMLTemplatePath(), new File(((FileBaseCatalog) CatalogHolder.getCatalog()).getBaseDirectory()));\n\t\t\t\t\n\t\t\t\tboolean res = harvest(\n\t\t\t\t\t\tnew File(PublishingRestletGlobalConfig.getRootDirectory()), \n\t\t\t\t\t\tnew File(path), \n\t\t\t\t\t\tmetadataTemplate, \n\t\t\t\t\t\tdriver, \n\t\t\t\t\t\tconfiguration.getGeoserverURL(), \n\t\t\t\t\t\tconfiguration.getRegistryURL(), \n\t\t\t\t\t\tconfiguration.getProviderURL(), \n\t\t\t\t\t\tnew Date().getTime(), \n\t\t\t\t\t\tnamespace, \n\t\t\t\t\t\tmetocFields, \n\t\t\t\t\t\tlayerid, \n\t\t\t\t\t\t\"DOWN\"\n\t\t\t\t);\n\t\t\t\t\n\t\t\t\tif (res) {\n\t\t\t\t\t// forwarding to the next Action\n\t\t\t\t\tif (LOGGER.isLoggable(Level.FINE))\n\t\t\t\t\t\tLOGGER.fine(\"RegistryHarvestingAction ... forwarding to the next Action: \" + inputFile.getAbsolutePath());\n\t\t\t\t\t/** TODO: remove this --- generatedEvents.add(new FileSystemMonitorEvent(inputFile, FileSystemMonitorNotifications.FILE_ADDED)); **/\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t/** TODO: remove this --- if (generatedEvents != null)\n\t\t\t\tevents.addAll(generatedEvents); **/\n\t\t\treturn events;\n\t\t} catch (Throwable t) {\n\t\t\tLOGGER.log(Level.SEVERE, t.getLocalizedMessage(), t);\n\t\t\tJAI.getDefaultInstance().getTileCache().flush();\n\t\t\treturn null;\n\t\t} finally {\n\t\t\tJAI.getDefaultInstance().getTileCache().flush();\n\t\t}\n\t}\n\t/**\n\t * \n\t * @param outDir\n\t * @param sourceFile\n\t * @param metadataTemplate\n\t * @param sourceFileType\n\t * @param geoserverURL\n\t * @param registryURL\n\t * @param providerURL\n\t * @param timestamp\n\t * @param namespace\n\t * @param metocFields\n\t * @param coverageName\n\t * @param zOrder\n\t * @return\n\t * @throws JAXBException\n\t * @throws IOException\n\t * @throws FactoryException\n\t * @throws ParseException\n\t */\n\tpublic boolean harvest(\n\t\t\tfinal File outDir, \n\t\t\tfinal File sourceFile,\n\t\t\tfinal File metadataTemplate,\n\t\t\tfinal String sourceFileType,\n\t\t\tfinal String geoserverURL,\n\t\t\tfinal String registryURL,\n\t\t\tfinal String providerURL,\n\t\t\tfinal long timestamp, \n\t\t\tfinal String namespace, \n\t\t\tfinal String metocFields,\n\t\t\tfinal String coverageName, \n\t\t\tfinal String zOrder\n\t) throws JAXBException, IOException, FactoryException, ParseException {\n\t\t// CoverageName Format:\n\t\t//  CRUISEEXP_MODELNAME-MODELTYPE_VARNAME(-u/v/mag/dir)_ZLEV_BASETIMEYYYYMMDD_BASETIMEHHHMMSS_FCSTTIMEYYYYMMDD_FCSTTIMEHHHMMSS_TAU\n\t\t\n\t\t//Grabbing the Variables Dictionary\n\t\tJAXBContext context = JAXBContext.newInstance(Metocs.class);\n\t\tUnmarshaller um = context.createUnmarshaller();\n\t\t\n\t\tFile metocDictionaryFile = IOUtils.findLocation(configuration.getMetocDictionaryPath(), new File(((FileBaseCatalog) CatalogHolder.getCatalog()).getBaseDirectory())); \n\t\tMetocs metocDictionary = (Metocs) um.unmarshal(new FileReader(metocDictionaryFile));\n\t\t\n\t\t// reading GeoTIFF file\n\t\tfinal AbstractGridCoverage2DReader reader = ((AbstractGridFormat) acquireFormat(sourceFileType)).getReader(sourceFile.toURI().toURL());\n", "answers": ["\t\tfinal CoordinateReferenceSystem crs = reader.getCrs();"], "incorrect_answer": "final String coordinateSystem = reader.getProjection();"}, {"input": "", "context": "package com.garbagemule.MobArena.waves;\nimport java.util.Arrays;\nimport java.util.List;\nimport org.bukkit.DyeColor;\nimport org.bukkit.Location;\nimport org.bukkit.Material;\nimport org.bukkit.World;\nimport org.bukkit.entity.*;\nimport org.bukkit.entity.Skeleton.SkeletonType;\nimport org.bukkit.inventory.ItemStack;\nimport com.garbagemule.MobArena.MobArena;\nimport com.garbagemule.MobArena.framework.Arena;\npublic enum MACreature\n{\n    // Default creatures\n    ZOMBIE(EntityType.ZOMBIE),            ZOMBIES(EntityType.ZOMBIE), \n    SKELETON(EntityType.SKELETON),        SKELETONS(EntityType.SKELETON),\n    SPIDER(EntityType.SPIDER),            SPIDERS(EntityType.SPIDER),\n    CREEPER(EntityType.CREEPER),          CREEPERS(EntityType.CREEPER),\n    WOLF(EntityType.WOLF),                WOLVES(EntityType.WOLF),\n    \n    // Special creatures\n    ZOMBIEPIGMAN(EntityType.PIG_ZOMBIE),  ZOMBIEPIGMEN(EntityType.PIG_ZOMBIE),\n    POWEREDCREEPER(EntityType.CREEPER),   POWEREDCREEPERS(EntityType.CREEPER),\n    ANGRYWOLF(EntityType.WOLF),           ANGRYWOLVES(EntityType.WOLF),\n    GIANT(EntityType.GIANT),              GIANTS(EntityType.GIANT),\n    GHAST(EntityType.GHAST),              GHASTS(EntityType.GHAST),\n    ENDERMAN(EntityType.ENDERMAN),        ENDERMEN(EntityType.ENDERMAN),\n    CAVESPIDER(EntityType.CAVE_SPIDER),   CAVESPIDERS(EntityType.CAVE_SPIDER),\n    SILVERFISH(EntityType.SILVERFISH),\n    \n    // 1.0 creatures\n    BLAZE(EntityType.BLAZE),              BLAZES(EntityType.BLAZE),\n    ENDERDRAGON(EntityType.ENDER_DRAGON), ENDERDRAGONS(EntityType.ENDER_DRAGON),\n    SNOWMAN(EntityType.SNOWMAN),          SNOWMEN(EntityType.SNOWMAN),\n    SNOWGOLEM(EntityType.SNOWMAN),        SNOWGOLEMS(EntityType.SNOWMAN),\n    MUSHROOMCOW(EntityType.MUSHROOM_COW), MUSHROOMCOWS(EntityType.MUSHROOM_COW),\n    VILLAGER(EntityType.VILLAGER),        VILLAGERS(EntityType.VILLAGER),\n    \n    // 1.2 creatures\n    OCELOT(EntityType.OCELOT),            OCELOTS(EntityType.OCELOT),\n    IRONGOLEM(EntityType.IRON_GOLEM),     IRONGOLEMS(EntityType.IRON_GOLEM),\n    \n    // Passive creatures\n    CHICKEN(EntityType.CHICKEN),          CHICKENS(EntityType.CHICKEN),\n    COW(EntityType.COW),                  COWS(EntityType.COW),\n    PIG(EntityType.PIG),                  PIGS(EntityType.PIG),\n    SHEEP(EntityType.SHEEP),\n    SQUID(EntityType.SQUID),              SQUIDS(EntityType.SQUID),\n    \n    // Extended creatures\n    EXPLODINGSHEEP(EntityType.SHEEP),\n    \n    // Slimes\n    SLIME(EntityType.SLIME),              SLIMES(EntityType.SLIME),\n    SLIMETINY(EntityType.SLIME),          SLIMESTINY(EntityType.SLIME),\n    SLIMESMALL(EntityType.SLIME),         SLIMESSMALL(EntityType.SLIME),\n    SLIMEBIG(EntityType.SLIME),           SLIMESBIG(EntityType.SLIME),\n    SLIMEHUGE(EntityType.SLIME),          SLIMESHUGE(EntityType.SLIME),\n    \n    // Magma cubes\n    MAGMACUBE(EntityType.MAGMA_CUBE),     MAGMACUBES(EntityType.MAGMA_CUBE),\n    MAGMACUBETINY(EntityType.MAGMA_CUBE), MAGMACUBESTINY(EntityType.MAGMA_CUBE),\n    MAGMACUBESMALL(EntityType.MAGMA_CUBE),MAGMACUBESSMALL(EntityType.MAGMA_CUBE),\n    MAGMACUBEBIG(EntityType.MAGMA_CUBE),  MAGMACUBESBIG(EntityType.MAGMA_CUBE),\n    MAGMACUBEHUGE(EntityType.MAGMA_CUBE), MAGMACUBESHUGE(EntityType.MAGMA_CUBE),\n        \n    // 1.4 creatures\n    BAT(EntityType.BAT),                  BATS(EntityType.BAT),\n    WITCH(EntityType.WITCH),              WITCHES(EntityType.WITCH),\n    WITHER(EntityType.WITHER),            WITHERS(EntityType.WITHER),\n    WITHERSKELETON(EntityType.SKELETON),  WITHERSKELETONS(EntityType.SKELETON),\n    BABYZOMBIE(EntityType.ZOMBIE),        BABYZOMBIES(EntityType.ZOMBIE),\n    BABYPIGMAN(EntityType.PIG_ZOMBIE),    BABYPIGMEN(EntityType.PIG_ZOMBIE),\n    ZOMBIEVILLAGER(EntityType.ZOMBIE),    ZOMBIEVILLAGERS(EntityType.ZOMBIE),\n    BABYZOMBIEVILLAGER(EntityType.ZOMBIE),BABYZOMBIEVILLAGERS(EntityType.ZOMBIE),\n    // 1.6 creatures\n    HORSE(EntityType.HORSE),              HORSES(EntityType.HORSE),\n    DONKEY(EntityType.HORSE),             DONKEYS(EntityType.HORSE),\n    MULE(EntityType.HORSE),               MULES(EntityType.HORSE),\n    SKELETONHORSE(EntityType.HORSE),      SKELETONHORSES(EntityType.HORSE),\n    UNDEADHORSE(EntityType.HORSE),        UNDEADHORSES(EntityType.HORSE);\n    private List<DyeColor> colors = Arrays.asList(DyeColor.values());\n    private EntityType type;\n    \n    private MACreature(EntityType type) {\n        this.type = type;\n    }\n    \n    public EntityType getType() {\n        return type;\n    }\n    \n    public static MACreature fromString(String string) {\n        return WaveUtils.getEnumFromString(MACreature.class, string.replaceAll(\"[-_\\\\.]\", \"\"));\n    }\n    \n    public LivingEntity spawn(Arena arena, World world, Location loc) {\n        LivingEntity e = (LivingEntity) world.spawnEntity(loc, type);\n        e.getEquipment().clear();\n        \n        switch (this) {\n            case SHEEP:\n                ((Sheep) e).setColor(colors.get(MobArena.random.nextInt(colors.size())));\n                break;\n            case EXPLODINGSHEEP:\n                arena.getMonsterManager().addExplodingSheep(e);\n                ((Sheep) e).setColor(DyeColor.RED);\n                break;\n            case POWEREDCREEPERS:\n                ((Creeper) e).setPowered(true);\n                break;\n            case ANGRYWOLVES:\n                ((Wolf) e).setAngry(true);\n                break;\n            case SLIME:\n            case SLIMES:\n            case MAGMACUBE:\n            case MAGMACUBES:\n                ((Slime) e).setSize( (1 + MobArena.random.nextInt(3)) );\n                break;\n            case SLIMETINY:\n            case SLIMESTINY:\n            case MAGMACUBETINY:\n            case MAGMACUBESTINY:\n                ((Slime) e).setSize(1);\n                break;\n            case SLIMESMALL:\n            case SLIMESSMALL:\n            case MAGMACUBESMALL:\n            case MAGMACUBESSMALL:\n                ((Slime) e).setSize(2);\n                break;\n            case SLIMEBIG:\n            case SLIMESBIG:\n            case MAGMACUBEBIG:\n            case MAGMACUBESBIG:\n                ((Slime) e).setSize(3);\n                break;\n            case SLIMEHUGE:\n            case SLIMESHUGE:\n            case MAGMACUBEHUGE:\n            case MAGMACUBESHUGE:\n                ((Slime) e).setSize(4);\n                break;\n            case SKELETON:\n            case SKELETONS:\n                ((Skeleton) e).getEquipment().setItemInHand(new ItemStack(Material.BOW, 1));\n            \tbreak;\n            case ZOMBIEPIGMAN:\n            case ZOMBIEPIGMEN:\n            \t((PigZombie) e).getEquipment().setItemInHand(new ItemStack(Material.GOLD_SWORD, 1));\n            \tbreak;\n            case ZOMBIEVILLAGER:\n            case ZOMBIEVILLAGERS:\n                ((Zombie) e).setVillager(true);\n                break;\n            case BABYZOMBIEVILLAGER:\n            case BABYZOMBIEVILLAGERS:\n                ((Zombie) e).setVillager(true);\n            case BABYZOMBIE:\n            case BABYZOMBIES:\n            case BABYPIGMAN:\n            case BABYPIGMEN:\n                ((Zombie) e).setBaby(true);\n                break;\n            case WITHERSKELETON:\n            case WITHERSKELETONS:\n                ((Skeleton) e).getEquipment().setItemInHand(new ItemStack(Material.STONE_SWORD, 1));\n                ((Skeleton) e).setSkeletonType(SkeletonType.WITHER);\n                break;\n            case HORSE:\n            case HORSES:\n                ((Horse) e).setVariant(Horse.Variant.HORSE);\n                break;\n            case DONKEY:\n            case DONKEYS:\n                ((Horse) e).setVariant(Horse.Variant.DONKEY);\n                break;\n            case MULE:\n            case MULES:\n                ((Horse) e).setVariant(Horse.Variant.MULE);\n                break;\n            case SKELETONHORSE:\n            case SKELETONHORSES:\n                ((Horse) e).setVariant(Horse.Variant.SKELETON_HORSE);\n                break;\n            case UNDEADHORSE:\n            case UNDEADHORSES:\n                ((Horse) e).setVariant(Horse.Variant.UNDEAD_HORSE);\n                break;\n            default:\n                break;\n        }\n        \n        if (e instanceof Creature) {\n", "answers": ["            Creature c = (Creature) e;"], "incorrect_answer": "Creature c = (Creature) entityInstance;"}, {"input": "", "context": "using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Text;\nusing System.IO;\nusing System.Windows.Forms;\nusing System.Drawing.Drawing2D;\nusing System.Drawing.Imaging;\nnamespace MUOViewer\n{\n\tpublic enum FileID\n\t{\n\t\tMap0_mul = 0x00000000,\n\t\tStaIdx0_mul = 0x00000001,\n\t\tStatics0_mul = 0x00000002,\n\t\tArtIdx_mul = 0x00000003,\n\t\tArt_mul = 0x00000004,\n\t\tAnim_idx = 0x00000005,\n\t\tAnim_mul = 0x00000006,\n\t\tSoundIdx_mul = 0x00000007,\n\t\tSound_mul = 0x00000008,\n\t\tTexIdx_mul = 0x00000009,\n\t\tTexMaps_mul = 0x0000000A,\n\t\tGumpIdx_mul = 0x0000000B,\n\t\tGumpArt_mul = 0x0000000C,\n\t\tMulti_idx = 0x0000000D,\n\t\tMulti_mul = 0x0000000E,\n\t\tSkills_idx = 0x0000000F,\n\t\tSkills_mul = 0x00000010,\n\t\tTileData_mul = 0x00000011,\n\t\tAnimData_mul = 0x00000012,\n\t\tHues_mul = 0x00000013,\n\t}\n\tpublic enum ExtendedFileID : int//Fucking UOG had to go and fuck up the MUO\n\t{\n\t\tMap0_mul = 0x00000040,\n\t\tStaIdx0_mul = 0x00000041,\n\t\tStatics0_mul = 0x00000042,\n\t\tArtIdx_mul = 0x00000043,\n\t\tArt_mul = 0x00000044,\n\t\tAnim_idx = 0x00000045,\n\t\tAnim_mul = 0x00000046,\n\t\tSoundIdx_mul = 0x00000047,\n\t\tSound_mul = 0x00000048,\n\t\tTexIdx_mul = 0x00000049,\n\t\tTexMaps_mul = 0x0000004A,\n\t\tGumpIdx_mul = 0x0000004B,\n\t\tGumpArt_mul = 0x0000004C,\n\t\tMulti_idx = 0x0000004D,\n\t\tMulti_mul = 0x0000004E,\n\t}\n\tpublic partial class MainForm : Form\n\t{\n\t\tprivate PatchFile _patchFile;\n\t\tprivate bool _updateScreen = true;\n\t\tprivate Animation _anim;\n\t\tpublic PatchFile patchFile { get { return _patchFile; } set { _patchFile = value;} }\n\t\tprivate void UpdateForm()\n\t\t{\n\t\t\tupDown.Maximum = _patchFile.patchCount - 1;\n\t\t\tnameLbl.Text = \"Name: \" + _patchFile.name;\n\t\t\tauthLbl.Text = \"Author: \" + _patchFile.author;\n\t\t\tdescLbl.Text = \"Description: \" + _patchFile.desc;\n\t\t\tpatchesLbl.Text = \"Patches: \" + _patchFile.patchCount.ToString(\"0,0\");\n\t\t\tPatch p = _patchFile.patches[(int)upDown.Value];\n\t\t\tUpdateImage(p);\t\t\n\t\t\tif( p.data != null )\n\t\t\t\ttextBox.Lines = FormatString(p.data, p.data.Length);\n\t\t\tfileidLbl.Text = \"FileID: \" + p.fileID.ToString(\"X2\");\n\t\t\tblockidLbl.Text = \"BlockID: \" + p.blockID.ToString(\"X2\");\n\t\t\textraLbl.Text = \"Extra: \" + p.extra.ToString(\"X2\");\n\t\t\tlengthLbl.Text = \"Length: \" + p.length.ToString();\n\t\t\tInvalidate();\t\n\t\t}\n\t\tpublic MainForm()\n\t\t{\n\t\t\tInitializeComponent();\n\t\t}\n\t\tprivate void openToolStripMenuItem_Click(object sender, EventArgs e)\n\t\t{\n\t\t\topenFileDialog.Title = \"Select a file to open\";\n\t\t\topenFileDialog.CheckFileExists = false;\n\t\t\tif( openFileDialog.ShowDialog() == DialogResult.OK )\n\t\t\t{\n\t\t\t\tBinaryReader reader = new BinaryReader(File.OpenRead(openFileDialog.FileName));\n\t\t\t\t_patchFile = new PatchFile();\n\t\t\t\tint read = reader.ReadInt32();\n\t\t\t\tif( read != 0x504f554d )\n\t\t\t\t{\n\t\t\t\t\tMessageBox.Show(\"Invalid MUO file\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\treader.ReadInt32();\n\t\t\t\tstring temp = \"\";\n\t\t\t\tbyte b = 0;\n\t\t\t\twhile( ( b = reader.ReadByte() ) != 0 )\n\t\t\t\t\ttemp = temp + ( (char)b );\n\t\t\t\t_patchFile.name = temp;\n\t\t\t\ttemp = \"\";\n\t\t\t\twhile( ( b = reader.ReadByte() ) != 0 )\n\t\t\t\t{\n\t\t\t\t\ttemp = temp + ( (char)b );\n\t\t\t\t}\n\t\t\t\t_patchFile.desc = temp;\n\t\t\t\ttemp = \"\";\n\t\t\t\twhile( ( b = reader.ReadByte() ) != 0 )\n\t\t\t\t{\n\t\t\t\t\ttemp = temp + ( (char)b );\n\t\t\t\t}\n\t\t\t\t_patchFile.author = temp;\n\t\t\t\tint count = reader.ReadInt32();\n\t\t\t\t_patchFile.patchCount = count;\n\t\t\t\t_patchFile.patches = new Patch[count];\n\t\t\t\tfor( int i = 0; i < count; i++ )\n\t\t\t\t{\n\t\t\t\t\tPatch patch = new Patch();\n\t\t\t\t\tpatch.fileID = reader.ReadInt32();\n\t\t\t\t\tpatch.blockID = reader.ReadInt32();\n\t\t\t\t\tpatch.extra = reader.ReadInt32();\n\t\t\t\t\tpatch.length = reader.ReadInt32();\n\t\t\t\t\tif (patch.length > 0)\n\t\t\t\t\t\tpatch.data = reader.ReadBytes(patch.length);\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tpatch.length = 0;\n\t\t\t\t\t\tpatch.data = new byte[0];\n\t\t\t\t\t}\n\t\t\t\t\t_patchFile.patches[i] = patch;\n\t\t\t\t}\n\t\t\t\tif( reader.BaseStream.Length != reader.BaseStream.Position )\n\t\t\t\t\tMessageBox.Show(\"More Data!\");\n\t\t\t\tUpdateForm(); \n\t\t\t}\n\t\t}\n\t\tprivate string[] FormatString(byte[] buffer, int length)\n\t\t{\n\t\t\tList<string> output = new List<string>();\n\t\t\toutput.Add(\"        0  1  2  3  4  5  6  7   8  9  A  B  C  D  E  F\");\n\t\t\toutput.Add(\"       -- -- -- -- -- -- -- --  -- -- -- -- -- -- -- --\");\n\t\t\tint byteIndex = 0;\n\t\t\tint whole = length >> 4;\n\t\t\tint rem = length & 0xF;\n\t\t\tfor( int i = 0; i < whole; ++i, byteIndex += 16 )\n\t\t\t{\n\t\t\t\tStringBuilder bytes = new StringBuilder(49);\n\t\t\t\tStringBuilder chars = new StringBuilder(16);\n\t\t\t\tfor( int j = 0; j < 16; ++j )\n\t\t\t\t{\n\t\t\t\t\tint c = buffer[( i * 16 ) + j];\n\t\t\t\t\tbytes.Append(c.ToString(\"X2\"));\n\t\t\t\t\tif( j != 7 )\n\t\t\t\t\t\tbytes.Append(' ');\n\t\t\t\t\telse\n\t\t\t\t\t\tbytes.Append(\"  \");\n\t\t\t\t\tif( c >= 0x20 && c < 0x80 )\n\t\t\t\t\t\tchars.Append((char)c);\n\t\t\t\t\telse\n\t\t\t\t\t\tchars.Append('.');\n\t\t\t\t}\n\t\t\t\toutput.Add(byteIndex.ToString(\"X4\") + \"   \" + bytes.ToString() + \"  \" + chars.ToString());\n\t\t\t}\n\t\t\tif( rem != 0 )\n\t\t\t{\n\t\t\t\tStringBuilder bytes = new StringBuilder(49);\n\t\t\t\tStringBuilder chars = new StringBuilder(rem);\n\t\t\t\tfor( int j = 0; j < 16; ++j )\n\t\t\t\t{\n\t\t\t\t\tif( j < rem )\n\t\t\t\t\t{\n\t\t\t\t\t\tint c = buffer[j];\n\t\t\t\t\t\tbytes.Append(c.ToString(\"X2\"));\n\t\t\t\t\t\tif( j != 7 )\n\t\t\t\t\t\t\tbytes.Append(' ');\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tbytes.Append(\"  \");\n\t\t\t\t\t\tif( c >= 0x20 && c < 0x80 )\n\t\t\t\t\t\t\tchars.Append((char)c);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tchars.Append('.');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\tbytes.Append(\"   \");\n\t\t\t\t}\n\t\t\t\toutput.Add(byteIndex.ToString(\"X4\") + \"   \" + bytes.ToString() + \"  \" + chars.ToString());\n\t\t\t}\n\t\t\tstring[] realOutput = new string[output.Count];\n\t\t\tfor( int i = 0; i < realOutput.Length; i++ )\n\t\t\t\trealOutput[i] = output[i].ToString();\t\t\n\t\t\treturn realOutput;\n\t\t}\n\t\tprivate void exitToolStripMenuItem_Click(object sender, EventArgs e)\n\t\t{\n\t\t\tClose();\n\t\t}\t\t\n\t\t\n\t\tprivate byte[] GetData(byte[] p, out int length)\n\t\t{\n\t\t\tint sec = (int)secUpDown.Value;\n\t\t\tif( p.Length / 512 < secUpDown.Value && p.Length % 512 == 0 )\n\t\t\t\tsec = p.Length / 512;\n\t\t\tif (sec < 0)\n\t\t\t{\n\t\t\t\tsecUpDown.Maximum = 0;\n\t\t\t\t_updateScreen = false;\n\t\t\t\tsecUpDown.Value = 0;\n\t\t\t\t_updateScreen = true;\n\t\t\t\tsec = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsecUpDown.Maximum = p.Length % 512 == 0 ? p.Length / 512 - 1 : p.Length / 512;\n\t\t\t\t_updateScreen = false;\n\t\t\t\tsecUpDown.Value = sec;\n\t\t\t\t_updateScreen = true;\n\t\t\t}\n\t\t\tlength = Math.Min(512, p.Length - ( sec * 512 ));\n\t\t\tbyte[] data = new byte[512];\n\t\t\tfor( int i = 0; i < length; i++ )\n\t\t\t\tdata[i] = p[i + sec * 512];\n\t\t\treturn data;\n\t\t}\n\t\tprivate void upDown_ValueChanged(object sender, EventArgs e)\n\t\t{\n\t\t\tPatch p = _patchFile.patches[(int)upDown.Value];\n\t\t\tint length;\n\t\t\tUpdateImage(p);\t\t\n\t\t\ttextBox.Lines = FormatString(GetData(p.data, out length), length);\n\t\t\tfileidLbl.Text = \"FileID: \" + p.fileID.ToString(\"X2\");\n\t\t\tblockidLbl.Text = \"BlockID: \" + p.blockID.ToString(\"X2\");\n\t\t\textraLbl.Text = \"Extra: \" + p.extra.ToString(\"X2\");\n\t\t\tlengthLbl.Text = \"Length: \" + p.length.ToString();\n\t\t\tInvalidate();\n\t\t}\n\t\tprivate void UpdateImage(Patch p)\n\t\t{\n\t\t\tif( _anim != null )\n\t\t\t\t_anim.Stop();\n\t\t\tswitch( p.fileID )\n\t\t\t{\n\t\t\t\tcase (int)FileID.GumpArt_mul:\n\t\t\t\t{\n\t\t\t\t\tpictureBox1.BackgroundImage = GetGump(p);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tcase (int)FileID.Art_mul:\n\t\t\t\t{\n\t\t\t\t\tif (p.blockID > 0x3FFF)\n\t\t\t\t\t\tpictureBox1.BackgroundImage = LoadStatic(new MemoryStream(p.data));\n\t\t\t\t\telse\n\t\t\t\t\t\tpictureBox1.BackgroundImage = LoadLand(new MemoryStream(p.data));\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tcase (int)FileID.Anim_mul:\n\t\t\t\t{\n\t\t\t\t\t_anim = new Animation(pictureBox1, p);\t\t\t\t\t\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tcase (int)ExtendedFileID.GumpArt_mul:\n\t\t\t\t{\n\t\t\t\t\tpictureBox1.BackgroundImage = GetGump(p);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tcase (int)ExtendedFileID.Art_mul:\n\t\t\t\t{\n\t\t\t\t\ttry\n\t\t\t\t\t{\n\t\t\t\t\t\tpictureBox1.BackgroundImage = LoadLand(new MemoryStream(p.data));\n\t\t\t\t\t}\n\t\t\t\t\tcatch\n\t\t\t\t\t{\n\t\t\t\t\t\tpictureBox1.BackgroundImage = LoadStatic(new MemoryStream(p.data));\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tcase (int)ExtendedFileID.Anim_mul:\n\t\t\t\t{\n\t\t\t\t\t_anim = new Animation(pictureBox1, p);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tdefault:\n\t\t\t\t{\n\t\t\t\t\tpictureBox1.BackgroundImage = null;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprivate void secUpDown_ValueChanged(object sender, EventArgs e)\n\t\t{\n\t\t\tif( !_updateScreen )\n\t\t\t\treturn;\n\t\t\tint length;\n\t\t\tPatch p = _patchFile.patches[(int)upDown.Value];\n\t\t\ttextBox.Lines = FormatString(GetData(p.data, out length), length);\n\t\t}\n\t\tpublic unsafe static Bitmap GetGump(Patch p)\n\t\t{\n\t\t\tint length = p.length;\n\t\t\tint extra = p.extra;\t\t\t\n\t\t\tint width = ( extra >> 16 ) & 0xFFFF;\n\t\t\tint height = extra & 0xFFFF;\n\t\t\tBitmap bmp = new Bitmap(width, height, PixelFormat.Format16bppArgb1555);\n\t\t\tBitmapData bd = bmp.LockBits(new Rectangle(0, 0, width, height), ImageLockMode.WriteOnly, PixelFormat.Format16bppArgb1555);\n\t\t\tMemoryStream ms = new MemoryStream(p.data);\n\t\t\tBinaryReader bin = new BinaryReader(ms);\n\t\t\tint[] lookups = new int[height];\n\t\t\tint start = (int)bin.BaseStream.Position;\n\t\t\tfor( int i = 0; i < height; ++i )\n\t\t\t\tlookups[i] = start + ( bin.ReadInt32() * 4 );\n\t\t\tushort* line = (ushort*)bd.Scan0;\n\t\t\tint delta = bd.Stride >> 1;\n\t\t\tfor( int y = 0; y < height; ++y, line += delta )\n\t\t\t{\n\t\t\t\tbin.BaseStream.Seek(lookups[y], SeekOrigin.Begin);\n\t\t\t\tushort* cur = line;\n\t\t\t\tushort* end = line + bd.Width;\n\t\t\t\twhile( cur < end )\n\t\t\t\t{\n\t\t\t\t\tushort color = bin.ReadUInt16();\n\t\t\t\t\tushort* next = cur + bin.ReadUInt16();\n\t\t\t\t\tif( color == 0 )\n\t\t\t\t\t{\n\t\t\t\t\t\tcur = next;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tcolor ^= 0x8000;\n\t\t\t\t\t\twhile( cur < next )\n\t\t\t\t\t\t\t*cur++ = color;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tbmp.UnlockBits(bd);\n\t\t\tbin.Close();\n\t\t\treturn bmp;\n\t\t}\n\t\tprivate static unsafe Bitmap LoadStatic(Stream stream)\n\t\t{\n\t\t\tBinaryReader bin = new BinaryReader(stream);\n\t\t\tbin.ReadInt32();\n\t\t\tint width = bin.ReadInt16();\n\t\t\tint height = bin.ReadInt16();\n\t\t\tif( width <= 0 || height <= 0 )\n\t\t\t\treturn null;\n\t\t\tint[] lookups = new int[height];\n\t\t\tint start = (int)bin.BaseStream.Position + ( height * 2 );\n\t\t\tfor( int i = 0; i < height; ++i )\n\t\t\t\tlookups[i] = (int)( start + ( bin.ReadUInt16() * 2 ) );\n\t\t\tBitmap bmp = new Bitmap(width, height, PixelFormat.Format16bppArgb1555);\n\t\t\tBitmapData bd = bmp.LockBits(new Rectangle(0, 0, width, height), ImageLockMode.WriteOnly, PixelFormat.Format16bppArgb1555);\n", "answers": ["\t\t\tushort* line = (ushort*)bd.Scan0;"], "incorrect_answer": "byte* line = (byte*)bd.Scan0;"}, {"input": "", "context": "using System;\nusing Server.Targeting;\nusing Server.Items;\nusing Server.Network;\nusing Server.Multis;\nusing Server.Hiding.hide;\nusing Scripts.Skills.Utility.Hiding;\nnamespace Server.SkillHandlers\n{\n\tpublic class Hiding\n\t{\n        private static bool m_CombatOverride;\n        private static Timer timer;\n        public static bool CombatOverride\n\t\t{\n\t\t\tget{ return m_CombatOverride; }\n\t\t\tset{ m_CombatOverride = value; }\n\t\t}\n        public long m_StartHiding { get; set; }\n        public static void Initialize()\n\t\t{\n\t\t\tSkillInfo.Table[21].Callback = new SkillUseCallback( OnUse );\n\t\t}\n        private class HideTimer : Timer\n        {\n            private Mobile m;\n            TimeSpan returnTimer;\n            private int counter = 0;\n            public HideTimer(Mobile m, TimeSpan delay) : base(delay, delay, 3)\n            {\n                this.m = m;\n                Priority = TimerPriority.TwoFiftyMS;\n            }\n            \n            protected override void OnTick()\n            {\n                if (m == null || m.Deleted)\n                {\n                    this.Stop();\n                    return;\n                }\n                if (m.Spell != null)\n                {\n                    m.SendLocalizedMessage(501238); // You are busy doing something else and cannot hide.\n                    this.Stop();\n                    return;\n                }\n                if (Core.ML && m.Target != null)\n                {\n                    Targeting.Target.Cancel(m);\n                }\n                double bonus = 0.0;\n                BaseHouse house = BaseHouse.FindHouseAt(m);\n                if (house != null && house.IsFriend(m))\n                {\n                    bonus = 100.0;\n                }\n                else if (!Core.AOS)\n                {\n                    if (house == null)\n                        house = BaseHouse.FindHouseAt(new Point3D(m.X - 1, m.Y, 127), m.Map, 16);\n                    if (house == null)\n                        house = BaseHouse.FindHouseAt(new Point3D(m.X + 1, m.Y, 127), m.Map, 16);\n                    if (house == null)\n                        house = BaseHouse.FindHouseAt(new Point3D(m.X, m.Y - 1, 127), m.Map, 16);\n                    if (house == null)\n                        house = BaseHouse.FindHouseAt(new Point3D(m.X, m.Y + 1, 127), m.Map, 16);\n                    if (house != null)\n                        bonus = 50.0;\n                }\n                //int range = 18 - (int)(m.Skills[SkillName.Hiding].Value / 10);\n                int range = Math.Min((int)((100 - m.Skills[SkillName.Hiding].Value) / 2) + 8, 18);  //Cap of 18 not OSI-exact, intentional difference\n                bool badCombat = (!m_CombatOverride && m.Combatant != null && m.InRange(m.Combatant.Location, range) && m.Combatant.InLOS(m));\n                bool ok = (!badCombat /*&& m.CheckSkill( SkillName.Hiding, 0.0 - bonus, 100.0 - bonus )*/ );\n                /* old hiding system\n                if ( ok )\n                {\n                    if ( !m_CombatOverride )\n                    {\n                        foreach ( Mobile check in m.GetMobilesInRange( range ) )\n                        {\n                            if ( check.InLOS( m ) && check.Combatant == m )\n                            {\n                                badCombat = true;\n                                ok = false;\n                                break;\n                            }\n                        }\n                    }\n                    ok = ( !badCombat && m.CheckSkill( SkillName.Hiding, 0.0 - bonus, 100.0 - bonus ) );\n                }\n                */\n                //check if mobile is in warmode\n                if (ok)\n                {\n                    if (!m_CombatOverride)\n                    {\n                        if (m.Warmode == true)\n                        {\n                            badCombat = true;\n                            ok = false;\n                        }\n                    }\n                    ok = (!badCombat && m.CheckSkill(SkillName.Hiding, 0.0 - bonus, 100.0 - bonus));\n                }\n                if (badCombat)\n                {\n                    m.RevealingAction();\n                    m.LocalOverheadMessage(MessageType.Regular, 0x22, 501237); // You can't seem to hide right now.\n                    Stop();\n                    return;\n                }\n                else\n                {\n                    if (ok)\n                    {\n                        /*\n                        m.Hidden = true;\n                        m.Warmode = false;\n                        m.LocalOverheadMessage(MessageType.Regular, 0x1F4, 501240); // You have hidden yourself well.\n                        */\n                    }\n                    else\n                    {\n                        m.RevealingAction();\n                        m.LocalOverheadMessage(MessageType.Regular, 0x22, 501241); // You can't seem to hide here.\n                    }\n                    Stop();\n                    return;\n                }\n            }\n            public void Tick()\n            {\n                OnTick();\n            }\n        }\n        public static TimeSpan OnUse( Mobile m )\n\t\t{\n            \n            Hide hide = new HidingHide(m);\n            hide.TryToHide();\n            return TimeSpan.FromSeconds(0.25);\n\t\t}\n        private class HidingHide : Hide\n        {\n            private Mobile m;\n            public HidingHide( Mobile m ) : base( m )\n            {\n                this.m = m;\n            }\n            public override void OnHide()\n            {\n                if (m.Spell != null)\n                {\n                    m.SendLocalizedMessage(501238); // You are busy doing something else and cannot hide.\n                }\n                if (Core.ML && m.Target != null)\n                {\n                    Targeting.Target.Cancel(m);\n                }\n                double bonus = 0.0;\n                BaseHouse house = BaseHouse.FindHouseAt(m);\n                if (house != null && house.IsFriend(m))\n                {\n                    bonus = 100.0;\n                }\n                else if (!Core.AOS)\n                {\n                    if (house == null)\n                        house = BaseHouse.FindHouseAt(new Point3D(m.X - 1, m.Y, 127), m.Map, 16);\n                    if (house == null)\n                        house = BaseHouse.FindHouseAt(new Point3D(m.X + 1, m.Y, 127), m.Map, 16);\n                    if (house == null)\n                        house = BaseHouse.FindHouseAt(new Point3D(m.X, m.Y - 1, 127), m.Map, 16);\n", "answers": ["                    if (house == null)"], "incorrect_answer": "if (house == false)"}, {"input": "", "context": "#region License\n// Copyright (c) 2013, ClearCanvas Inc.\n// All rights reserved.\n// http://www.ClearCanvas.ca\n//\n// This file is part of the ClearCanvas RIS/PACS open source project.\n//\n// The ClearCanvas RIS/PACS open source project is free software: you can\n// redistribute it and/or modify it under the terms of the GNU General Public\n// License as published by the Free Software Foundation, either version 3 of the\n// License, or (at your option) any later version.\n//\n// The ClearCanvas RIS/PACS open source project is distributed in the hope that it\n// will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General\n// Public License for more details.\n//\n// You should have received a copy of the GNU General Public License along with\n// the ClearCanvas RIS/PACS open source project.  If not, see\n// <http://www.gnu.org/licenses/>.\n#endregion\n#if\tUNIT_TESTS\n#pragma warning disable 1591,0419,1574,1587\nusing System;\nusing System.Collections.Generic;\nusing Macro.Common.Utilities;\nusing Macro.Dicom;\nusing Macro.Dicom.Iod;\nusing Macro.ImageViewer.StudyManagement;\nusing NUnit.Framework;\nnamespace Macro.ImageViewer.AdvancedImaging.Fusion.Tests\n{\n\t[TestFixture]\n\tpublic class FusionDisplaySetFactoryTests\n\t{\n\t\t[Test]\n\t\tpublic void TestNullCreation()\n\t\t{\n\t\t\tvar factory = new PETFusionDisplaySetFactory(PETFusionType.CT);\n\t\t\tvar displaySets = CreateDisplaySets(factory, Combine<ISopDataSource>());\n\t\t\ttry\n\t\t\t{\n\t\t\t\tAssert.IsEmpty(displaySets, \"Display set factories should not throw an exception if there is nothing to create.\");\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tDispose(displaySets);\n\t\t\t}\n\t\t}\n\t\t[Test]\n\t\tpublic void TestPETAndCTFusion()\n\t\t{\n\t\t\tvar factory = new PETFusionDisplaySetFactory(PETFusionType.CT);\n\t\t\tvar seriesCT = CreateSopSeries(25, \"PatientA\", \"StudyA\", \"SeriesCT\", 1, \"FrameA\", Modality.CT);\n\t\t\tvar seriesPET = CreateSopSeries(25, \"PatientA\", \"StudyA\", \"SeriesPET\", 2, \"FrameA\", Modality.PT);\n\t\t\tvar displaySets = CreateDisplaySets(factory, Combine(seriesCT, seriesPET));\n\t\t\ttry\n\t\t\t{\n\t\t\t\tAssert.IsNotEmpty(displaySets, \"Fusion display sets should be created for trivially simple PET-CT data.\");\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tDispose(displaySets);\n\t\t\t\tDispose(seriesCT, seriesPET);\n\t\t\t}\n\t\t}\n\t\t[Test]\n\t\tpublic void TestNoFusingWrongModality()\n\t\t{\n\t\t\tvar factory = new PETFusionDisplaySetFactory(PETFusionType.CT);\n\t\t\tvar seriesMR = CreateSopSeries(25, \"PatientA\", \"StudyA\", \"SeriesMR\", 1, \"FrameA\", Modality.MR);\n\t\t\tvar seriesPET = CreateSopSeries(25, \"PatientA\", \"StudyA\", \"SeriesPET\", 2, \"FrameA\", Modality.PT);\n\t\t\tvar displaySets = CreateDisplaySets(factory, Combine(seriesMR, seriesPET));\n\t\t\ttry\n\t\t\t{\n\t\t\t\tAssert.IsEmpty(displaySets, \"Fusion display sets should not be created for PET-MR using a PET-CT factory.\");\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tDispose(displaySets);\n\t\t\t\tDispose(seriesMR, seriesPET);\n\t\t\t}\n\t\t}\n\t\t[Test]\n\t\tpublic void TestNoFusingInvalidModalities()\n\t\t{\n\t\t\tvar factory = new PETFusionDisplaySetFactory(PETFusionType.CT);\n\t\t\tvar seriesCT = CreateSopSeries(25, \"PatientA\", \"StudyA\", \"SeriesCT\", 1, \"FrameA\", Modality.CT);\n\t\t\tvar seriesMR = CreateSopSeries(25, \"PatientA\", \"StudyA\", \"SeriesMR\", 1, \"FrameA\", Modality.MR);\n\t\t\tvar displaySets = CreateDisplaySets(factory, Combine(seriesCT, seriesMR));\n\t\t\ttry\n\t\t\t{\n\t\t\t\tAssert.IsEmpty(displaySets, \"Fusion display sets should not be created between invalid modalities (e.g. CT and MR).\");\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tDispose(displaySets);\n\t\t\t\tDispose(seriesCT, seriesMR);\n\t\t\t}\n\t\t}\n\t\t[Test]\n\t\tpublic void TestNoFusingDifferentStudies()\n\t\t{\n\t\t\tvar factory = new PETFusionDisplaySetFactory(PETFusionType.CT);\n\t\t\tvar seriesCT = CreateSopSeries(25, \"PatientA\", \"StudyA\", \"SeriesCT\", 1, \"FrameA\", Modality.CT);\n\t\t\tvar seriesPET = CreateSopSeries(25, \"PatientA\", \"StudyB\", \"SeriesPET\", 2, \"FrameA\", Modality.PT);\n\t\t\tvar displaySets = CreateDisplaySets(factory, Combine(seriesCT, seriesPET));\n\t\t\ttry\n\t\t\t{\n\t\t\t\tAssert.IsEmpty(displaySets, \"Fusion display sets should not be created for series in different studies.\");\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tDispose(displaySets);\n\t\t\t\tDispose(seriesCT, seriesPET);\n\t\t\t}\n\t\t}\n\t\t[Test]\n\t\tpublic void TestNoFusingDifferentPatients()\n\t\t{\n\t\t\tvar factory = new PETFusionDisplaySetFactory(PETFusionType.CT);\n\t\t\tvar seriesCT = CreateSopSeries(25, \"PatientA\", \"StudyA\", \"SeriesCT\", 1, \"FrameA\", Modality.CT);\n\t\t\tvar seriesPET = CreateSopSeries(25, \"PatientB\", \"StudyB\", \"SeriesPET\", 2, \"FrameA\", Modality.PT);\n\t\t\tvar displaySets = CreateDisplaySets(factory, Combine(seriesCT, seriesPET));\n\t\t\ttry\n\t\t\t{\n\t\t\t\tAssert.IsEmpty(displaySets, \"Fusion display sets should not be created for series from different patients.\");\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tDispose(displaySets);\n\t\t\t\tDispose(seriesCT, seriesPET);\n\t\t\t}\n\t\t}\n\t\t[Test]\n\t\tpublic void TestFusingDifferentFramesOfReference()\n\t\t{\n\t\t\tvar factory = new PETFusionDisplaySetFactory(PETFusionType.CT);\n\t\t\tvar seriesCT = CreateSopSeries(25, \"PatientA\", \"StudyA\", \"SeriesCT\", 1, \"FrameA\", Modality.CT);\n\t\t\tvar seriesPET = CreateSopSeries(25, \"PatientA\", \"StudyA\", \"SeriesPET\", 2, \"FrameB\", Modality.PT);\n\t\t\tvar displaySets = CreateDisplaySets(factory, Combine(seriesCT, seriesPET));\n\t\t\ttry\n\t\t\t{\n\t\t\t\tAssert.IsNotEmpty(displaySets, \"Fusion display sets should still be created even with different frames of reference.\");\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tDispose(displaySets);\n\t\t\t\tDispose(seriesCT, seriesPET);\n\t\t\t}\n\t\t}\n\t\t[Test]\n\t\tpublic void TestPETFusionDisplaySetDescriptor()\n\t\t{\n\t\t\tStudyTree studyTree;\n\t\t\tvar factory = new PETFusionDisplaySetFactory(PETFusionType.CT);\n\t\t\tvar seriesCT = CreateSopSeries(25, \"PatientA\", \"StudyA\", \"SeriesCT\", 1, \"FrameA\", Modality.CT);\n\t\t\tvar seriesPET = CreateSopSeries(25, \"PatientA\", \"StudyA\", \"SeriesPET\", 2, \"FrameA\", Modality.PT);\n\t\t\tvar seriesPETCor = CreateSopSeries(25, \"PatientA\", \"StudyA\", \"SeriesPETCor\", 3, \"FrameA\", Modality.PT, true, false);\n\t\t\tvar displaySets = CreateDisplaySets(factory, Combine(seriesCT, seriesPET, seriesPETCor), out studyTree);\n\t\t\ttry\n\t\t\t{\n\t\t\t\tAssert.AreEqual(2, displaySets.Count, \"There is only one valid combination of fuseable series.\");\n\t\t\t\t// Verify identity of fused series\n\t\t\t\tvar displaySet = CollectionUtils.SelectFirst(displaySets, d => ValidateFusionDisplaySetDescriptor(d.Descriptor, HashUid(\"SeriesCT\"), HashUid(\"SeriesPET\")));\n\t\t\t\tAssert.IsNotNull(displaySet, \"Could not find the uncorrected fusion series.\");\n\t\t\t\tAssert.IsFalse(((PETFusionDisplaySetDescriptor) displaySet.Descriptor).AttenuationCorrection, \"Uncorrected fusion series is incorrectly flagged as corrected.\");\n\t\t\t\tvar displaySetCor = CollectionUtils.SelectFirst(displaySets, d => ValidateFusionDisplaySetDescriptor(d.Descriptor, HashUid(\"SeriesCT\"), HashUid(\"SeriesPETCor\")));\n\t\t\t\tAssert.IsNotNull(displaySetCor, \"Could not find the corrected fusion series.\");\n\t\t\t\tAssert.IsTrue(((PETFusionDisplaySetDescriptor) displaySetCor.Descriptor).AttenuationCorrection, \"Corrected fusion series is incorrectly flagged as uncorrected.\");\n\t\t\t\tvar seriesCollection = CollectionUtils.FirstElement(CollectionUtils.FirstElement(studyTree.Patients).Studies).Series;\n\t\t\t\tvar ctSeries = CollectionUtils.SelectFirst(seriesCollection, s => s.SeriesDescription == \"SeriesCT\");\n\t\t\t\tvar petSeries = CollectionUtils.SelectFirst(seriesCollection, s => s.SeriesDescription == \"SeriesPET\");\n\t\t\t\tvar petCorSeries = CollectionUtils.SelectFirst(seriesCollection, s => s.SeriesDescription == \"SeriesPETCor\");\n\t\t\t\tvar expectedDescriptor = GetFusedDisplaySetName(ctSeries, petSeries, false);\n\t\t\t\tvar expectedDescriptorCor = GetFusedDisplaySetName(ctSeries, petCorSeries, true);\n\t\t\t\t// Validate the names of the display sets (this is what is shown on the context menu)\n\t\t\t\tAssert.AreEqual(expectedDescriptor, displaySet.Name, \"Name string differs for uncorrected display set.\");\n\t\t\t\tAssert.AreEqual(expectedDescriptorCor, displaySetCor.Name, \"Name string differs for corrected display set.\");\n\t\t\t}\n\t\t\tcatch (Exception)\n\t\t\t{\n\t\t\t\tif (displaySets.Count > 0)\n\t\t\t\t{\n\t\t\t\t\tConsole.WriteLine(\"Generated Display Sets ({0})\", displaySets.Count);\n\t\t\t\t\tforeach (var displaySet in displaySets)\n", "answers": ["\t\t\t\t\t\tConsole.WriteLine(\" > {0}\", displaySet.Descriptor.Description);"], "incorrect_answer": "Console.Write(\"Descriptor: {1}\", displaySet.Descriptor.Name);"}, {"input": "", "context": "import os\nimport warnings\nimport numpy as np\nfrom photon_tools.io import timetag_parse, pt2_parse, metadata\ntime_ch_dtype = np.dtype([('time', 'u8'), ('chan', 'u1')])\ndef verify_monotonic(times, filename):\n    \"\"\" Verify that timestamps are monotonically increasing \"\"\"\n    if len(times) == 0: return\n    negatives = times[1:] <= times[:-1]\n    if np.count_nonzero(negatives) > 0:\n        indices = np.nonzero(negatives)\n        warnings.warn('%s: Found %d non-monotonic timestamps: photon indices %s' %\n                      (filename, np.count_nonzero(negatives), indices))\ndef verify_continuity(times, filename, gap_factor=1000):\n    \"\"\" Search for improbably long gaps in the photon stream \"\"\"\n    if len(times) == 0: return\n    tau = (times[-1] - times[0]) / len(times)\n    gaps = (times[1:] - times[:-1]) > gap_factor*tau\n    if np.count_nonzero(gaps) > 0:\n        msg = '%s: Found %d large gaps:\\n' % (filename, np.count_nonzero(gaps))\n        gap_starts, = np.nonzero(gaps)\n        for s in gap_starts:\n            msg += '    starting at %10d, ending at %10d, lasting %10d' % \\\n                   (times[s], times[s+1], times[s+1] - times[s])\n        warnings.warn(msg)\nclass InvalidChannel(ValueError):\n    def __init__(self, requested_channel, valid_channels=[]):\n        self.requested_channel = requested_channel\n        self.valid_channels = valid_channels\n    def __str__(self):\n        return \"Channel %s was requested but this file type only supports channels %s.\" \\\n            % (self.requested_channel, self.valid_channels)\nclass TimestampFile(object):\n    \"\"\"\n    Represents a timestamp file.\n    A timestamp file is a file containing a sequential set of integer\n    photon arrival timestamps taken in one or more channels.\n    \"\"\"\n    def __init__(self, filename, jiffy, valid_channels=None):\n        if valid_channels is None:\n            valid_channels = self.__class__.valid_channels\n        self._valid_channels = valid_channels\n        self._fname = filename\n        self._jiffy = jiffy\n    @classmethod\n    def extensions(self):\n        \"\"\"\n        A list of supported file extensions\n        \"\"\"\n        return []\n    @property\n    def jiffy(self):\n        \"\"\"\n        The timestamp resolution in seconds or ``None`` is unknown.\n        :returns: float\n        \"\"\"\n        return self._jiffy\n    @property\n    def valid_channels(self):\n        \"\"\"\n        The names of the channels of the file.\n        Note that not all of these will have timestamps.\n        :returns: list\n        \"\"\"\n        return self._valid_channels\n    @property\n    def metadata(self):\n        \"\"\"\n        Metadata describing the data set.\n        :returns: dictionary mapping string metadata names to values\n        \"\"\"\n        return self._metadata\n    @property\n    def name(self):\n        \"\"\" File name of timestamp file \"\"\"\n        return self._fname\n    def timestamps(self):\n        \"\"\"\n        Read the timestamp data for all channels of the file\n        :returns: An array of dtype :var:`time_ch_dtype` containing monotonically\n        increasing timestamps annotated with channel numbers.\n        \"\"\"\n        data = self._read_all()\n        verify_monotonic(data['time'], self._fname)\n        verify_continuity(data['time'], self._fname)\n        return data\n    def channel(self, channel):\n        \"\"\"\n        Read photon data for a channel of the file\n        :type channel: A valid channel name from :func:`valid_channels`.\n        :returns: An array of ``u8`` timestamps.\n        \"\"\"\n        self._validate_channel(channel)\n        data = self._read_channel(channel)\n        verify_monotonic(data, self._fname)\n        verify_continuity(data, self._fname)\n        return data\n    def _read_all(self):\n        \"\"\" Read the timestamps for all channels \"\"\"\n        raise NotImplementedError()\n    def _read_channel(self, channel):\n        \"\"\" Actually read the data of a channel \"\"\"\n        raise NotImplementedError()\n    def _validate_channel(self, channel):\n        \"\"\" A utility for implementations \"\"\"\n        if channel not in self.valid_channels:\n            raise InvalidChannel(channel, self.valid_channels)\nclass PicoquantFile(TimestampFile):\n    \"\"\" A Picoquant PT2 and PT3 timestamp file \"\"\"\n    valid_channels = [0,1,2,3]\n    extensions = ['pt2', 'pt3']\n    def __init__(self, fname):\n        # TODO: Read metadata\n        TimestampFile.__init__(self, fname, jiffy=4e-12)\n    def _read_all(self):\n        raise NotImplementedError()\n    def _read_channel(self, channel):\n        return pt2_parse.read_pt2(self._fname, channel)\nclass TimetagFile(TimestampFile):\n    \"\"\" A timestamp file from the Goldner lab FPGA timetagger \"\"\"\n    extensions = ['timetag']\n    valid_channels = [0,1,2,3]\n    def __init__(self, fname):\n        TimestampFile.__init__(self, fname, jiffy = None)\n        self._metadata = metadata.get_metadata(fname)\n        if self.metadata is not None:\n            self._jiffy = 1. / self.metadata['clockrate']\n        if not os.path.isfile(fname):\n            raise IOError(\"File %s does not exist\" % fname)\n    def _read_all(self):\n        res = timetag_parse.get_strobe_events(self._fname, 0xf)\n        res.dtype.names = time_ch_dtype.names\n        return res\n    def _read_channel(self, channel):\n        return timetag_parse.get_strobe_events(self._fname, 1<<channel)['t']\nclass RawFile(TimestampFile):\n    \"\"\" Raw unsigned 64-bit timestamps \"\"\"\n    extensions = ['times']\n    valid_channels = [0]\n    def __init__(self, fname):\n        TimestampFile.__init__(self, fname, jiffy = None)\n    def _read_all(self):\n        timestamps = np.fromfile(self._fname, dtype='u8')\n        return np.from_records([timestamps, np.zeros_like(timestamps, dtype='u1')],\n                               dtype=time_ch_dtype)\n    def _read_channel(self, channel):\n        return np.fromfile(self._fname, dtype='u8')\nclass RawChFile(TimestampFile):\n    \"\"\" Raw unsigned 64-bit timestamps, followed by 8-bit channel number \"\"\"\n    extensions = ['timech']\n    valid_channels = range(256)\n    def __init__(self, fname):\n        TimestampFile.__init__(self, fname, jiffy = None)\n    def _read_all(self):\n        return np.fromfile(self._fname, dtype=time_ch_dtype)\n    def _read_channel(self, channel):\n        d = self._read_all()\n        return d[d['chan'] == channel]['time']\nreaders = [\n    PicoquantFile,\n    TimetagFile,\n    RawFile,\n    RawChFile,\n]\ndef supported_extensions():\n    \"\"\"\n    A dictionary mapping supported file extensions to their associated\n    :class:`TimestampFile` class.\n    \"\"\"\n    extensions = {}\n    for reader in readers:\n        for ext in reader.extensions:\n            extensions[ext] = reader\n    return extensions\ndef find_reader(fname):\n", "answers": ["    exts = supported_extensions()"], "incorrect_answer": "exts = available_formats()"}, {"input": "", "context": "/* -*- tab-width: 4 -*-\n *\n * Electric(tm) VLSI Design System\n *\n * File: CellChangeJobs.java\n *\n * Copyright (c) 2006 Sun Microsystems and Static Free Software\n *\n * Electric(tm) is free software; you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation; either version 3 of the License, or\n * (at your option) any later version.\n *\n * Electric(tm) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Electric(tm); see the file COPYING.  If not, write to\n * the Free Software Foundation, Inc., 59 Temple Place, Suite 330,\n * Boston, Mass 02111-1307, USA.\n */\npackage com.sun.electric.tool.user;\nimport com.sun.electric.database.IdMapper;\nimport com.sun.electric.database.ImmutableArcInst;\nimport com.sun.electric.database.geometry.EGraphics;\nimport com.sun.electric.database.geometry.EPoint;\nimport com.sun.electric.database.geometry.GenMath;\nimport com.sun.electric.database.geometry.Orientation;\nimport com.sun.electric.database.hierarchy.Cell;\nimport com.sun.electric.database.hierarchy.Export;\nimport com.sun.electric.database.hierarchy.Library;\nimport com.sun.electric.database.hierarchy.View;\nimport com.sun.electric.database.id.CellId;\nimport com.sun.electric.database.prototype.NodeProto;\nimport com.sun.electric.database.text.Name;\nimport com.sun.electric.database.topology.ArcInst;\nimport com.sun.electric.database.topology.Geometric;\nimport com.sun.electric.database.topology.NodeInst;\nimport com.sun.electric.database.topology.PortInst;\nimport com.sun.electric.database.variable.ElectricObject;\nimport com.sun.electric.database.variable.TextDescriptor;\nimport com.sun.electric.database.variable.UserInterface;\nimport com.sun.electric.technology.ArcProto;\nimport com.sun.electric.technology.technologies.Artwork;\nimport com.sun.electric.technology.technologies.Generic;\nimport com.sun.electric.tool.Job;\nimport com.sun.electric.tool.JobException;\nimport com.sun.electric.tool.user.ui.EditWindow;\nimport com.sun.electric.tool.user.ui.WindowContent;\nimport com.sun.electric.tool.user.ui.WindowFrame;\nimport java.awt.geom.AffineTransform;\nimport java.awt.geom.Point2D;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Set;\n/**\n * Class for Jobs that make changes to the cells.\n */\npublic class CellChangeJobs\n{\n\t// constructor, never used\n\tprivate CellChangeJobs() {}\n\t/****************************** DELETE A CELL ******************************/\n\t/**\n\t * Class to delete a cell in a new thread.\n\t */\n\tpublic static class DeleteCell extends Job\n\t{\n\t\tCell cell;\n\t\tpublic DeleteCell(Cell cell)\n\t\t{\n\t\t\tsuper(\"Delete \" + cell, User.getUserTool(), Job.Type.CHANGE, null, null, Job.Priority.USER);\n\t\t\tthis.cell = cell;\n\t\t\tstartJob();\n\t\t}\n\t\tpublic boolean doIt() throws JobException\n\t\t{\n\t\t\t// check cell usage once more\n\t\t\tif (cell.isInUse(\"delete\", false, true)) return false;\n\t\t\tcell.kill();\n\t\t\treturn true;\n\t\t}\n\t}\n\t/**\n\t * This class implement the command to delete a list of cells.\n\t */\n\tpublic static class DeleteManyCells extends Job\n\t{\n\t\tprivate List<Cell> cellsToDelete;\n\t\tpublic DeleteManyCells(List<Cell> cellsToDelete)\n\t\t{\n\t\t\tsuper(\"Delete Multiple Cells\", User.getUserTool(), Job.Type.CHANGE, null, null, Job.Priority.USER);\n\t\t\tthis.cellsToDelete = cellsToDelete;\n\t\t\tstartJob();\n\t\t}\n\t\tpublic boolean doIt() throws JobException\n\t\t{\n\t\t\t// iteratively delete, allowing cells in use to be deferred\n\t\t\tboolean didDelete = true;\n\t\t\twhile (didDelete)\n\t\t\t{\n\t\t\t\tdidDelete = false;\n\t\t\t\tfor (int i=0; i<cellsToDelete.size(); i++)\n\t\t\t\t{\n\t\t\t\t\tCell cell = cellsToDelete.get(i);\n\t\t\t\t\t// if the cell is in use, defer\n\t\t\t\t\tif (cell.isInUse(null, true, true)) continue;\n\t\t\t\t\t// cell not in use: remove it from the list and delete it\n\t\t\t\t\tcellsToDelete.remove(i);\n\t\t\t\t\ti--;\n\t\t\t\t\tSystem.out.println(\"Deleting \" + cell);\n\t\t\t\t\tcell.kill();\n\t\t\t\t\tdidDelete = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// warn about remaining cells that were in use\n\t\t\tfor(Cell cell : cellsToDelete)\n\t\t\t\tcell.isInUse(\"delete\", false, true);\n\t\t\treturn true;\n\t\t}\n\t\tpublic void terminateOK()\n\t\t{\n\t\t\tSystem.out.println(\"Deleted \" + cellsToDelete.size() + \" cells\");\n\t\t\tEditWindow.repaintAll();\n\t\t}\n\t}\n\t/****************************** RENAME CELLS ******************************/\n\t/**\n\t * Class to rename a cell in a new thread.\n\t */\n\tpublic static class RenameCell extends Job\n\t{\n\t\tprivate Cell cell;\n\t\tprivate String newName;\n\t\tprivate String newGroupCell;\n\t\tprivate IdMapper idMapper;\n\t\tpublic RenameCell(Cell cell, String newName, String newGroupCell)\n\t\t{\n\t\t\tsuper(\"Rename \" + cell, User.getUserTool(), Job.Type.CHANGE, null, null, Job.Priority.USER);\n\t\t\tthis.cell = cell;\n\t\t\tthis.newName = newName;\n\t\t\tthis.newGroupCell = newGroupCell;\n\t\t\tstartJob();\n\t\t}\n\t\tpublic boolean doIt() throws JobException\n\t\t{\n\t\t\tidMapper = cell.rename(newName, newGroupCell);\n\t\t\tfieldVariableChanged(\"idMapper\");\n\t\t\treturn true;\n\t\t}\n\t\tpublic void terminateOK()\n\t\t{\n\t\t\tUser.fixStaleCellReferences(idMapper);\n\t\t}\n\t}\n\t/**\n\t * Class to rename a cell in a new thread.\n\t */\n\tpublic static class DeleteCellGroup extends Job\n\t{\n\t\tList<Cell> cells;\n\t\tpublic DeleteCellGroup(Cell.CellGroup group)\n\t\t{\n\t\t\tsuper(\"Delete Cell Group\", User.getUserTool(), Job.Type.CHANGE, null, null, Job.Priority.USER);\n\t\t\tcells = new ArrayList<Cell>();\n\t\t\tfor(Iterator<Cell> it = group.getCells(); it.hasNext(); )\n\t\t\t{\n\t\t\t\tcells.add(it.next());\n\t\t\t}\n\t\t\tstartJob();\n\t\t}\n\t\tpublic boolean doIt() throws JobException\n\t\t{\n\t\t\tfor(Cell cell : cells)\n\t\t\t{\n\t\t\t\t// Doesn't check cells in the same group\n\t\t\t\t// check cell usage once more\n\t\t\t\tif (cell.isInUse(\"delete\", false, false))\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// Now real delete\n\t\t\tfor(Cell cell : cells)\n\t\t\t{\n\t\t\t\tcell.kill();\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t}\n\t/**\n\t * Class to rename a cell in a new thread.\n\t */\n\tpublic static class RenameCellGroup extends Job\n\t{\n\t\tCell cellInGroup;\n\t\tString newName;\n\t\tpublic RenameCellGroup(Cell cellInGroup, String newName)\n\t\t{\n\t\t\tsuper(\"Rename Cell Group\", User.getUserTool(), Job.Type.CHANGE, null, null, Job.Priority.USER);\n\t\t\tthis.cellInGroup = cellInGroup;\n\t\t\tthis.newName = newName;\n\t\t\tstartJob();\n\t\t}\n\t\tpublic boolean doIt() throws JobException\n\t\t{\n\t\t\t// see if all cells in the group have the same name\n\t\t\tboolean allSameName = true;\n\t\t\tString lastName = null;\n\t\t\tfor(Iterator<Cell> it = cellInGroup.getCellGroup().getCells(); it.hasNext(); )\n\t\t\t{\n\t\t\t\tString cellName = it.next().getName();\n\t\t\t\tif (lastName != null && !lastName.equals(cellName))\n\t\t\t\t{\n\t\t\t\t\tallSameName = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tlastName = cellName;\n\t\t\t}\n\t\t\tList<Cell> cells = new ArrayList<Cell>();\n\t\t\tfor(Iterator<Cell> it = cellInGroup.getCellGroup().getCells(); it.hasNext(); )\n\t\t\t\tcells.add(it.next());\n\t\t\tString newGroupCell = null;\n\t\t\tfor(Cell cell : cells)\n\t\t\t{\n\t\t\t\tif (allSameName)\n\t\t\t\t{\n\t\t\t\t\tcell.rename(newName, newName);\n\t\t\t\t} else\n\t\t\t\t{\n\t\t\t\t\tif (newGroupCell == null)\n\t\t\t\t\t{\n\t\t\t\t\t\tSystem.out.println(\"Renaming is not possible because cells in group don't have same root name.\");\n\t\t\t\t\t\tSystem.out.println(\"'\" + newName + \"' was added as prefix.\");\n\t\t\t\t\t\tnewGroupCell = newName + cell.getName();\n\t\t\t\t\t}\n\t\t\t\t\tcell.rename(newName+cell.getName(), newGroupCell);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t}\n\t/****************************** SHOW CELLS GRAPHICALLY ******************************/\n\t/**\n\t * This class implement the command to make a graph of the cells.\n\t */\n\tpublic static class GraphCells extends Job\n\t{\n\t\tprivate static final double TEXTHEIGHT = 2;\n\t\tprivate Cell top;\n\t\tprivate Cell graphCell;\n\t\tprivate static class GraphNode\n\t\t{\n\t\t\tString    name;\n\t\t\tint       depth;\n\t\t\tint       clock;\n\t\t\tdouble    x, y;\n\t\t\tdouble    yoff;\n\t\t\tNodeInst  pin;\n\t\t\tNodeInst  topPin;\n\t\t\tNodeInst  botPin;\n\t\t\tGraphNode main;\n\t\t}\n\t\tpublic GraphCells(Cell top)\n\t\t{\n\t\t\tsuper(\"Graph Cells\", User.getUserTool(), Job.Type.CHANGE, null, null, Job.Priority.USER);\n\t\t\tthis.top = top;\n\t\t\tstartJob();\n\t\t}\n\t\tpublic boolean doIt() throws JobException\n\t\t{\n\t\t\t// create the graph cell\n\t\t\tgraphCell = Cell.newInstance(Library.getCurrent(), \"CellStructure\");\n\t\t\tfieldVariableChanged(\"graphCell\");\n\t\t\tif (graphCell == null) return false;\n\t\t\tif (graphCell.getNumVersions() > 1)\n\t\t\t\tSystem.out.println(\"Creating new version of cell: \" + graphCell.getName()); else\n\t\t\t\t\tSystem.out.println(\"Creating cell: \" + graphCell.getName());\n\t\t\t// create GraphNodes for every cell and initialize the depth to -1\n\t\t\tMap<Cell,GraphNode> graphNodes = new HashMap<Cell,GraphNode>();\n\t\t\tfor(Iterator<Library> it = Library.getLibraries(); it.hasNext(); )\n\t\t\t{\n\t\t\t\tLibrary lib = it.next();\n\t\t\t\tif (lib.isHidden()) continue;\n\t\t\t\tfor(Iterator<Cell> cIt = lib.getCells(); cIt.hasNext(); )\n\t\t\t\t{\n\t\t\t\t\tCell cell = cIt.next();\n\t\t\t\t\tGraphNode cgn = new GraphNode();\n\t\t\t\t\tcgn.name = cell.describe(false);\n\t\t\t\t\tcgn.depth = -1;\n\t\t\t\t\tgraphNodes.put(cell, cgn);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// find all top-level cells\n\t\t\tint maxDepth = 0;\n\t\t\tif (top != null)\n\t\t\t{\n\t\t\t\tGraphNode cgn = graphNodes.get(top);\n\t\t\t\tcgn.depth = 0;\n\t\t\t} else\n\t\t\t{\n\t\t\t\tfor(Iterator<Cell> cIt = Library.getCurrent().getCells(); cIt.hasNext(); )\n\t\t\t\t{\n\t\t\t\t\tCell cell = cIt.next();\n\t\t\t\t\tif (cell.getNumUsagesIn() == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tGraphNode cgn = graphNodes.get(cell);\n\t\t\t\t\t\tcgn.depth = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tdouble xScale = 2.0 / 3.0;\n\t\t\tdouble yScale = 20;\n\t\t\tdouble yOffset = TEXTHEIGHT * 1.25;\n\t\t\tdouble maxWidth = 0;\n\t\t\t// now place all cells at their proper depth\n\t\t\tboolean more = true;\n\t\t\twhile (more)\n\t\t\t{\n\t\t\t\tmore = false;\n\t\t\t\tfor(Iterator<Library> it = Library.getLibraries(); it.hasNext(); )\n\t\t\t\t{\n\t\t\t\t\tLibrary lib = it.next();\n\t\t\t\t\tif (lib.isHidden()) continue;\n\t\t\t\t\tfor(Iterator<Cell> cIt = lib.getCells(); cIt.hasNext(); )\n\t\t\t\t\t{\n\t\t\t\t\t\tCell cell = cIt.next();\n", "answers": ["\t\t\t\t\t\tGraphNode cgn = graphNodes.get(cell);"], "incorrect_answer": "GraphNode cgn = new GraphNode();"}, {"input": "", "context": "/* \n    Z80 Virtual Machine\n    Copyright (C) 2008 - 2012 Leonid Gordo\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n    You should have received a copy of the GNU General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\nusing System;\nusing System.Drawing;\nusing System.Windows.Forms;\nusing System.IO;\nnamespace Z80VM\n{\n    public partial class Form1 : Form\n    {\n       public Bitmap bmp = new Bitmap(256, 192);\n        \n        public Form1()\n        {\n            InitializeComponent();\n            pictureBox1.BackgroundImageLayout = ImageLayout.Zoom;\n            ClientSize = new Size(256 * 2 + 80, 192 * 2 + 80);\n            pictureBox1.Size = new Size(256 * 2, 192 * 2);\n            resize();\n            if (Program.size == 48)\n            {\n                k48ToolStripMenuItem.Checked = true;\n                k128ToolStripMenuItem.Checked = false;\n            }\n            else\n            {\n                k48ToolStripMenuItem.Checked = false;\n                k128ToolStripMenuItem.Checked = true;\n            }\n            pictureBox1.BackgroundImage = bmp;\n        }\n        public void SetImage()\n        {\n           // this.pictureBox1.BackgroundImage = this.bmp;\n            pictureBox1.Refresh();\n        }\n        private void exitToolStripMenuItem_Click(object sender, EventArgs e)\n        {\n            Close();\n        }\n        private void OnClose(object sender, FormClosingEventArgs e)\n        {\n            Program.go = false;\n        }\n        private void OnKeyPress(object sender, KeyPressEventArgs e)\n        {\n        }\n        private void OnKeyDown(object sender, KeyEventArgs e)\n        {\n            int keyCode = (int)e.KeyCode;\n            int shift = (int)e.KeyData / 0x10000;\n            if ((shift & 4) != 0) return;\n            doKey(true, keyCode, (short)shift);\n        }\n        public bool doKey(bool down, int ascii, short mods)\n        {\n\t\t\n            bool CAPS, SYMB;\n\t\t\n\t\t    CAPS = (mods & 1) != 0;\n\t\t    SYMB = (mods & 2) != 0;\n    \t\t\n\t\t    // Change control versions of keys to lower case\n\t\t    if ((ascii >= 1) & (ascii <= 0x27) & SYMB)\n\t\t\t    ascii = ascii + 97 - 1;\n    \t\t\n    \t\t\n\t\t    if (CAPS) Program.keyCAPS_V = (Program.keyCAPS_V & (~1)); else Program.keyCAPS_V = (Program.keyCAPS_V | 1);\n\t\t    if (SYMB) Program.keyB_SPC = (Program.keyB_SPC & (~2)); else Program.keyB_SPC = (Program.keyB_SPC | 2);\n    \t\t\n\t\t    switch(ascii) {\n\t\t\t    case 8: // Backspace\n\t\t\t\t    if (down) {\n\t\t\t\t\t    Program.key6_0 = (Program.key6_0 & (~ 1));\n\t\t\t\t\t    Program.keyCAPS_V = (Program.keyCAPS_V & (~ 1));\n\t\t\t\t    }else {\n\t\t\t\t\t    Program.key6_0 = (Program.key6_0 | 1);\n\t\t\t\t\t    if (!CAPS)\n\t\t\t\t\t\t    Program.keyCAPS_V = (Program.keyCAPS_V | 1);\t\t\t\t\t\n\t\t\t\t    }\n                    break;\n\t\t\t    case 65: // A\n\t\t\t\t    if (down) Program.keyA_G = (Program.keyA_G & (~ 1)); else Program.keyA_G = (Program.keyA_G | 1);\n                    break;\n\t\t\t    case 66: // B\n\t\t\t\t    if (down )  Program.keyB_SPC = (Program.keyB_SPC & (~ 16)) ; else Program.keyB_SPC = (Program.keyB_SPC | 16);\n                    break;\n\t\t\t    case 67: // C\n\t\t\t\t    if (down )  Program.keyCAPS_V = (Program.keyCAPS_V & (~ 8)) ; else Program.keyCAPS_V = (Program.keyCAPS_V | 8);\n                    break;\n\t\t\t    case 68: // D\n\t\t\t\t    if (down )  Program.keyA_G = (Program.keyA_G & (~ 4)) ; else Program.keyA_G = (Program.keyA_G | 4);\n                    break;\n\t\t\t    case 69: // E\n\t\t\t\t    if (down )  Program.keyQ_T = (Program.keyQ_T & (~ 4)) ; else Program.keyQ_T = (Program.keyQ_T | 4);\n                    break;\n\t\t\t    case 70: // F\n\t\t\t\t    if (down )  Program.keyA_G = (Program.keyA_G & (~ 8)) ; else Program.keyA_G = (Program.keyA_G | 8);\n                    break;\n\t\t\t    case 71: // G\n\t\t\t\t    if (down )  Program.keyA_G = (Program.keyA_G & (~ 16)) ; else Program.keyA_G = (Program.keyA_G | 16);\n                    break;\n\t\t\t    case 72: // H\n\t\t\t\t    if (down )  Program.keyH_ENT = (Program.keyH_ENT & (~ 16)) ; else Program.keyH_ENT = (Program.keyH_ENT | 16);\n                    break;\n\t\t\t    case 73: // I\n\t\t\t\t    if (down )  Program.keyY_P = (Program.keyY_P & (~ 4)) ; else Program.keyY_P = (Program.keyH_ENT | 4);\n                    break;\n\t\t\t    case 74: // J\n\t\t\t\t    if (down )  Program.keyH_ENT = (Program.keyH_ENT & (~ 8)) ; else Program.keyH_ENT = (Program.keyH_ENT | 8);\n                    break;\n\t\t\t    case 75: // K\n\t\t\t\t    if (down )  Program.keyH_ENT = (Program.keyH_ENT & (~ 4)) ; else Program.keyH_ENT = (Program.keyH_ENT | 4);\n                    break;\n\t\t\t    case 76: // L\n\t\t\t\t    if (down )  Program.keyH_ENT = (Program.keyH_ENT & (~ 2)) ; else Program.keyH_ENT = (Program.keyH_ENT | 2);\n                    break;\n\t\t\t    case 77: // M\n\t\t\t\t    if (down )  Program.keyB_SPC = (Program.keyB_SPC & (~ 4)) ; else Program.keyB_SPC = (Program.keyB_SPC | 4);\n                    break;\n\t\t\t    case 78: // N\n\t\t\t\t    if (down )  Program.keyB_SPC = (Program.keyB_SPC & (~ 8)) ; else Program.keyB_SPC = (Program.keyB_SPC | 8);\n                    break;\n\t\t\t    case 79: // O\n\t\t\t\t    if (down )  Program.keyY_P = (Program.keyY_P & (~ 2)) ; else Program.keyY_P = (Program.keyY_P | 2);\n                    break;\n\t\t\t    case 80: // P\n\t\t\t\t    if (down )  Program.keyY_P = (Program.keyY_P & (~ 1)) ; else Program.keyY_P = (Program.keyY_P | 1);\n                    break;\n\t\t\t    case 81: // Q\n\t\t\t\t    if (down )  Program.keyQ_T = (Program.keyQ_T & (~ 1)) ; else Program.keyQ_T = (Program.keyQ_T | 1);\n                    break;\n\t\t\t    case 82: // R\n\t\t\t\t    if (down )  Program.keyQ_T = (Program.keyQ_T & (~ 8)) ; else Program.keyQ_T = (Program.keyQ_T | 8);\n                    break;\n\t\t\t    case 83: // S\n\t\t\t\t    if (down )  Program.keyA_G = (Program.keyA_G & (~ 2)) ; else Program.keyA_G = (Program.keyA_G | 2);\n                    break;\n\t\t\t    case 84: // T\n\t\t\t\t    if (down )  Program.keyQ_T = (Program.keyQ_T & (~ 16)) ; else Program.keyQ_T = (Program.keyQ_T | 16);\n                    break;\n\t\t\t    case 85: // U\n\t\t\t\t    if (down )  Program.keyY_P = (Program.keyY_P & (~ 8)) ; else Program.keyY_P = (Program.keyY_P | 8);\n                    break;\n\t\t\t    case 86: // V\n\t\t\t\t    if (down )  Program.keyCAPS_V = (Program.keyCAPS_V & (~ 16)) ; else Program.keyCAPS_V = (Program.keyCAPS_V | 16);\n                    break;\n\t\t\t    case 87: // W\n\t\t\t\t    if (down )  Program.keyQ_T = (Program.keyQ_T & (~ 2)) ; else Program.keyQ_T = (Program.keyQ_T | 2);\n                    break;\n\t\t\t    case 88: // X\n\t\t\t\t    if (down )  Program.keyCAPS_V = (Program.keyCAPS_V & (~ 4)) ; else Program.keyCAPS_V = (Program.keyCAPS_V | 4);\n                    break;\n\t\t\t    case 90: // Y\n\t\t\t\t    if (down )  Program.keyCAPS_V = (Program.keyCAPS_V & (~ 2)) ; else Program.keyCAPS_V = (Program.keyCAPS_V | 2);\n                    break;\n\t\t\t    case 89: // Z\n\t\t\t\t    if (down )  Program.keyY_P = (Program.keyY_P & (~ 16)) ; else Program.keyY_P = (Program.keyY_P | 16);\n                    break;\n\t\t\t    case 48: // 0\n\t\t\t\t    if (down )  Program.key6_0 = (Program.key6_0 & (~ 1)) ; else Program.key6_0 = (Program.key6_0 | 1);\n                    break;\n\t\t\t    case 49: // 1\n\t\t\t\t    if (down )  Program.key1_5 = (Program.key1_5 & (~ 1)) ; else Program.key1_5 = (Program.key1_5 | 1);\n                    break;\n\t\t\t    case 50: // 2\n\t\t\t\t    if (down )  Program.key1_5 = (Program.key1_5 & (~ 2)) ; else Program.key1_5 = (Program.key1_5 | 2);\n                    break;\n\t\t\t    case 51: // 3\n\t\t\t\t    if (down )  Program.key1_5 = (Program.key1_5 & (~ 4)) ; else Program.key1_5 = (Program.key1_5 | 4);\n                    break;\n\t\t\t    case 52: // 4\n\t\t\t\t    if (down )  Program.key1_5 = (Program.key1_5 & (~ 8)) ; else Program.key1_5 = (Program.key1_5 | 8);\n                    break;\n\t\t\t    case 53: // 5\n\t\t\t\t    if (down )  Program.key1_5 = (Program.key1_5 & (~ 16)) ; else Program.key1_5 = (Program.key1_5 | 16);\n                    break;\n\t\t\t    case 54: // 6\n\t\t\t\t    if (down )  Program.key6_0 = (Program.key6_0 & (~ 16)) ; else Program.key6_0 = (Program.key6_0 | 16);\n                    break;\n\t\t\t    case 55: // 7\n\t\t\t\t    if (down )  Program.key6_0 = (Program.key6_0 & (~ 8)) ; else Program.key6_0 = (Program.key6_0 | 8);\n                    break;\n\t\t\t    case 56: // 8\n\t\t\t\t    if (down )  Program.key6_0 = (Program.key6_0 & (~ 4)) ; else Program.key6_0 = (Program.key6_0 | 4);\n                    break;\n\t\t\t    case 57: // 9\n\t\t\t\t    if (down )  Program.key6_0 = (Program.key6_0 & (~ 2)) ; else Program.key6_0 = (Program.key6_0 | 2);\n                    break;\n\t\t\t    case 96: // Keypad 0\n\t\t\t\t    if (down )  Program.key6_0 = (Program.key6_0 & (~ 1)) ; else Program.key6_0 = (Program.key6_0 | 1);\n                    break;\n\t\t\t    case 97: // Keypad 1\n\t\t\t\t    if (down )  Program.key1_5 = (Program.key1_5 & (~ 1)) ; else Program.key1_5 = (Program.key1_5 | 1);\n                    break;\n\t\t\t    case 98: // Keypad 2\n\t\t\t\t    if (down )  Program.key1_5 = (Program.key1_5 & (~ 2)) ; else Program.key1_5 = (Program.key1_5 | 2);\n                    break;\n\t\t\t    case 99: // Keypad 3\n\t\t\t\t    if (down )  Program.key1_5 = (Program.key1_5 & (~ 4)) ; else Program.key1_5 = (Program.key1_5 | 4);\n                    break;\n\t\t\t    case 100: // Keypad 4\n\t\t\t\t    if (down )  Program.key1_5 = (Program.key1_5 & (~ 8)) ; else Program.key1_5 = (Program.key1_5 | 8);\n                    break;\n\t\t\t    case 101: // Keypad 5\n\t\t\t\t    if (down )  Program.key1_5 = (Program.key1_5 & (~ 16)) ; else Program.key1_5 = (Program.key1_5 | 16);\n                    break;\n\t\t\t    case 102: // Keypad 6\n\t\t\t\t    if (down )  Program.key6_0 = (Program.key6_0 & (~ 16)) ; else Program.key6_0 = (Program.key6_0 | 16);\n                    break;\n\t\t\t    case 103: // Keypad 7\n\t\t\t\t    if (down )  Program.key6_0 = (Program.key6_0 & (~ 8)) ; else Program.key6_0 = (Program.key6_0 | 8);\n                    break;\n\t\t\t    case 104: // Keypad 8\n\t\t\t\t    if (down )  Program.key6_0 = (Program.key6_0 & (~ 4)) ; else Program.key6_0 = (Program.key6_0 | 4);\n                    break;\n\t\t\t    case 105: // Keypad 9\n\t\t\t\t    if (down )  Program.key6_0 = (Program.key6_0 & (~ 2)) ; else Program.key6_0 = (Program.key6_0 | 2);\n                    break;\n\t\t\t    case 106: // Keypad *\n\t\t\t\t    if (down ) \n\t\t\t\t\t    Program.keyB_SPC = (Program.keyB_SPC & ~(18));\n\t\t\t\t    else\n\t\t\t\t\t    if (SYMB ) \n\t\t\t\t\t\t    Program.keyB_SPC = (Program.keyB_SPC | 16);\n\t\t\t\t\t    else\n\t\t\t\t\t\t    Program.keyB_SPC = (Program.keyB_SPC | 18);\n                    break;\n\t\t\t    case 107: // Keypad +\n                    if (down)\n                    {\n                        Program.keyH_ENT = (Program.keyH_ENT & (~4));\n                        Program.keyB_SPC = (Program.keyB_SPC & (~2));\n                    }\n                    else\n                    {\n                        Program.keyH_ENT = (Program.keyH_ENT | 4);\n                        if (!SYMB)\n                            Program.keyB_SPC = (Program.keyB_SPC | 2);\n                    }\n                        break;\n\t\t\t    case 109: // Keypad -\n                    if (down)\n                    {\n                        Program.keyH_ENT = (Program.keyH_ENT & (~8));\n                        Program.keyB_SPC = (Program.keyB_SPC & (~2));\n                    }\n                    else\n                    {\n                        Program.keyH_ENT = (Program.keyH_ENT | 8);\n                        if (!SYMB)\n                            Program.keyB_SPC = (Program.keyB_SPC | 2);\n                    }\n                        break;\n\t\t\t    case 110: // Keypad .\n\t\t\t\t    if (down ) \n\t\t\t\t\t    Program.keyB_SPC = (Program.keyB_SPC & (~ 6));\n\t\t\t\t    else\n\t\t\t\t\t    if (SYMB ) \n\t\t\t\t\t\t    Program.keyB_SPC = (Program.keyB_SPC | 4);\n\t\t\t\t\t     else\n\t\t\t\t\t\t    Program.keyB_SPC = (Program.keyB_SPC | 6);\n                    break;\n\t\t\t    case 111: // Keypad /\n                    if (down)\n                    {\n                        Program.keyCAPS_V = (Program.keyCAPS_V & (~16));\n                        Program.keyB_SPC = (Program.keyB_SPC & (~2));\n                    }\n                    else\n                    {\n                        Program.keyCAPS_V = (Program.keyCAPS_V | 16);\n                        if (!SYMB)\n                            Program.keyB_SPC = (Program.keyB_SPC | 2);\n                    }\n                    break;\n\t\t\t    case 37: // Left\n                    if (down)\n                    {\n                        Program.key1_5 = (Program.key1_5 & (~16));\n                        Program.keyCAPS_V = (Program.keyCAPS_V & (~1));\n                    }\n                    else\n                    {\n                        Program.key1_5 = (Program.key1_5 | 16);\n                        if (!SYMB)\n                            Program.keyB_SPC = (Program.keyB_SPC | 2);\n                    }\n                    break;\n\t\t\t    case 38: // Up\n                    if (down)\n                    {\n                        Program.key6_0 = (Program.key6_0 & (~8));\n                        Program.keyCAPS_V = (Program.keyCAPS_V & (~1));\n                    }\n                    else\n                    {\n                        Program.key6_0 = (Program.key6_0 | 8);\n                        if (!CAPS)\n                            Program.keyCAPS_V = (Program.keyCAPS_V | 1);\n                    }\n                    break;\n\t\t\t    case 39: // Right\n                    if (down)\n                    {\n                        Program.key6_0 = (Program.key6_0 & (~4));\n                        Program.keyCAPS_V = (Program.keyCAPS_V & (~1));\n                    }\n                    else\n                    {\n                        Program.key6_0 = (Program.key6_0 | 4);\n                        if (!CAPS)\n                            Program.keyCAPS_V = (Program.keyCAPS_V | 1);\n                    }\n                    break;\n\t\t\t    case 40: // Down\n                    if (down)\n                    {\n                        Program.key6_0 = (Program.key6_0 & (~16));\n                        Program.keyCAPS_V = (Program.keyCAPS_V & (~1));\n                    }\n                    else\n                    {\n                        Program.key6_0 = (Program.key6_0 | 16);\n                        if (!CAPS)\n                            Program.keyCAPS_V = (Program.keyCAPS_V | 1);\n                    }\n                    break;\n\t\t\t    case 13: // RETURN\n\t\t\t\t    if (down )  Program.keyH_ENT = (Program.keyH_ENT & (~ 1)) ; else Program.keyH_ENT = (Program.keyH_ENT | 1);\n                    break;\n\t\t\t    case 32: // SPACE BAR\n\t\t\t\t    if (down )  Program.keyB_SPC = (Program.keyB_SPC & (~ 1)) ; else Program.keyB_SPC = (Program.keyB_SPC | 1);\n                    break;\n\t\t\t    case 187: // =/+ key\n\t\t\t\t    if (down ) {\n                        if (CAPS)\n                            Program.keyH_ENT = (Program.keyH_ENT & (~4));\n                        else\n                        {\n                            Program.keyH_ENT = (Program.keyH_ENT & (~2));\n                            Program.keyB_SPC = (Program.keyB_SPC & (~2));\n                            Program.keyCAPS_V = (Program.keyCAPS_V | 1);\n                        }\n                    }\n\t\t\t\t    else {\n\t\t\t\t\t    Program.keyH_ENT = (Program.keyH_ENT | 4);\n\t\t\t\t\t    Program.keyH_ENT = (Program.keyH_ENT | 2);\n\t\t\t\t\t    Program.keyB_SPC = (Program.keyB_SPC | 2);\n\t\t\t\t    }\n                    break;\n", "answers": ["\t\t\t    case 189: // -/_ key"], "incorrect_answer": "case 190: // ./> key"}, {"input": "", "context": "#!/usr/bin/env python3\n\"\"\"Compute the auto and cross-correlation of delta fields for a list of IGM\nabsorption.\nThis module follow the procedure described in sections 4.3 of du Mas des\nBourboux et al. 2020 (In prep) to compute the distortion matrix\n\"\"\"\nimport time\nimport argparse\nimport multiprocessing\nfrom multiprocessing import Pool, Lock, cpu_count, Value\nfrom functools import partial\nimport numpy as np\nimport fitsio\nfrom picca import constants, cf, utils, io\nfrom picca.utils import userprint\ndef calc_metal_dmat(abs_igm1, abs_igm2, healpixs):\n    \"\"\"Computes the metal distortion matrix.\n    To optimize the computation, first compute a list of neighbours for each of\n    the healpix. This is an auxiliar function to split the computational load\n    using several CPUs.\n    Args:\n        abs_igm1: str\n            Name of the absorption in picca.constants defining the\n            redshift of the forest pixels\n        abs_igm2: str\n            Name of the second absorption in picca.constants defining the\n            redshift of the forest pixels\n        healpixs: array of ints\n            List of healpix numbers\n    Returns:\n        The distortion matrix data\n    \"\"\"\n    cf.fill_neighs(healpixs)\n    np.random.seed(healpixs[0])\n    dmat_data = cf.compute_metal_dmat(healpixs,\n                                      abs_igm1=abs_igm1,\n                                      abs_igm2=abs_igm2)\n    return dmat_data\ndef main():\n    # pylint: disable-msg=too-many-locals,too-many-branches,too-many-statements\n    \"\"\"Compute the auto and cross-correlation of delta fields for a list of IGM\n    absorption.\"\"\"\n    parser = argparse.ArgumentParser(\n        formatter_class=argparse.ArgumentDefaultsHelpFormatter,\n        description=('Compute the auto and cross-correlation of delta fields '\n                     'for a list of IGM absorption.'))\n    parser.add_argument('--out',\n                        type=str,\n                        default=None,\n                        required=True,\n                        help='Output file name')\n    parser.add_argument('--in-dir',\n                        type=str,\n                        default=None,\n                        required=True,\n                        help='Directory to delta files')\n    parser.add_argument('--in-dir2',\n                        type=str,\n                        default=None,\n                        required=False,\n                        help='Directory to 2nd delta files')\n    parser.add_argument('--rp-min',\n                        type=float,\n                        default=0.,\n                        required=False,\n                        help='Min r-parallel [h^-1 Mpc]')\n    parser.add_argument('--rp-max',\n                        type=float,\n                        default=200.,\n                        required=False,\n                        help='Max r-parallel [h^-1 Mpc]')\n    parser.add_argument('--rt-max',\n                        type=float,\n                        default=200.,\n                        required=False,\n                        help='Max r-transverse [h^-1 Mpc]')\n    parser.add_argument('--np',\n                        type=int,\n                        default=50,\n                        required=False,\n                        help='Number of r-parallel bins')\n    parser.add_argument('--nt',\n                        type=int,\n                        default=50,\n                        required=False,\n                        help='Number of r-transverse bins')\n    parser.add_argument(\n        '--coef-binning-model',\n        type=int,\n        default=1,\n        required=False,\n        help=('Coefficient multiplying np and nt to get finner binning for the '\n              'model'))\n    parser.add_argument(\n        '--z-cut-min',\n        type=float,\n        default=0.,\n        required=False,\n        help=('Use only pairs of forest x object with the mean of the last '\n              'absorber redshift and the object redshift larger than '\n              'z-cut-min'))\n    parser.add_argument(\n        '--z-cut-max',\n        type=float,\n        default=10.,\n        required=False,\n        help=('Use only pairs of forest x object with the mean of the last '\n              'absorber redshift and the object redshift smaller than '\n              'z-cut-max'))\n    parser.add_argument(\n        '--lambda-abs',\n        type=str,\n        default='LYA',\n        required=False,\n        help=('Name of the absorption in picca.constants defining the redshift '\n              'of the delta'))\n    parser.add_argument(\n        '--lambda-abs2',\n        type=str,\n        default=None,\n        required=False,\n        help=('Name of the absorption in picca.constants defining the redshift '\n              'of the 2nd delta'))\n    parser.add_argument(\n        '--abs-igm',\n        type=str,\n        default=[],\n        required=False,\n        nargs='*',\n        help=('List of names of metal absorption in picca.constants present in '\n              'forest'))\n    parser.add_argument(\n        '--abs-igm2',\n        type=str,\n        default=[],\n        required=False,\n        nargs='*',\n        help=('List of names of metal absorption in picca.constants present in '\n              '2nd forest'))\n    parser.add_argument('--z-ref',\n                        type=float,\n                        default=2.25,\n                        required=False,\n                        help='Reference redshift')\n    parser.add_argument(\n        '--z-evol',\n        type=float,\n        default=2.9,\n        required=False,\n        help='Exponent of the redshift evolution of the delta field')\n    parser.add_argument(\n        '--z-evol2',\n        type=float,\n        default=2.9,\n        required=False,\n        help='Exponent of the redshift evolution of the 2nd delta field')\n    parser.add_argument(\n        '--metal-alpha',\n        type=float,\n        default=1.,\n        required=False,\n        help='Exponent of the redshift evolution of the metal delta field')\n    parser.add_argument(\n        '--fid-Om',\n        type=float,\n        default=0.315,\n        required=False,\n        help='Omega_matter(z=0) of fiducial LambdaCDM cosmology')\n    parser.add_argument(\n        '--fid-Or',\n        type=float,\n        default=0.,\n        required=False,\n        help='Omega_radiation(z=0) of fiducial LambdaCDM cosmology')\n    parser.add_argument('--fid-Ok',\n                        type=float,\n                        default=0.,\n                        required=False,\n                        help='Omega_k(z=0) of fiducial LambdaCDM cosmology')\n    parser.add_argument(\n        '--fid-wl',\n        type=float,\n        default=-1.,\n        required=False,\n        help='Equation of state of dark energy of fiducial LambdaCDM cosmology')\n    parser.add_argument(\n        '--remove-same-half-plate-close-pairs',\n        action='store_true',\n        required=False,\n        help='Reject pairs in the first bin in r-parallel from same half plate')\n    parser.add_argument(\n        '--rej',\n        type=float,\n        default=1.,\n        required=False,\n        help=('Fraction of rejected forest-forest pairs: -1=no rejection, '\n              '1=all rejection'))\n    parser.add_argument('--nside',\n                        type=int,\n                        default=16,\n                        required=False,\n                        help='Healpix nside')\n    parser.add_argument('--nproc',\n                        type=int,\n                        default=None,\n                        required=False,\n                        help='Number of processors')\n    parser.add_argument('--nspec',\n                        type=int,\n                        default=None,\n                        required=False,\n                        help='Maximum number of spectra to read')\n    parser.add_argument(\n        '--unfold-cf',\n        action='store_true',\n        required=False,\n        help=('rp can be positive or negative depending on the relative '\n              'position between absorber1 and absorber2'))\n    args = parser.parse_args()\n    if args.nproc is None:\n        args.nproc = cpu_count() // 2\n    userprint(\"nproc\", args.nproc)\n    # setup variables in module cf\n    cf.r_par_max = args.rp_max\n    cf.r_trans_max = args.rt_max\n    cf.r_par_min = args.rp_min\n    cf.z_cut_max = args.z_cut_max\n    cf.z_cut_min = args.z_cut_min\n    cf.num_bins_r_par = args.np * args.coef_binning_model\n    cf.num_bins_r_trans = args.nt * args.coef_binning_model\n    cf.num_model_bins_r_par = args.np * args.coef_binning_model\n    cf.num_model_bins_r_trans = args.nt * args.coef_binning_model\n    cf.nside = args.nside\n    cf.z_ref = args.z_ref\n    cf.alpha = args.z_evol\n    cf.reject = args.rej\n    cf.lambda_abs = constants.ABSORBER_IGM[args.lambda_abs]\n    cf.remove_same_half_plate_close_pairs = args.remove_same_half_plate_close_pairs\n    cf.alpha_abs = {}\n    cf.alpha_abs[args.lambda_abs] = cf.alpha\n    for metal in args.abs_igm:\n        cf.alpha_abs[metal] = args.metal_alpha\n    # load fiducial cosmology\n    cf.cosmo = constants.Cosmo(Om=args.fid_Om,\n                               Or=args.fid_Or,\n                               Ok=args.fid_Ok,\n                               wl=args.fid_wl)\n    t0 = time.time()\n    ### Read data 1\n    data, num_data, z_min, z_max = io.read_deltas(args.in_dir,\n                                                  cf.nside,\n                                                  cf.lambda_abs,\n                                                  cf.alpha,\n                                                  cf.z_ref,\n                                                  cf.cosmo,\n                                                  max_num_spec=args.nspec)\n    del z_max\n    cf.data = data\n    cf.num_data = num_data\n    cf.ang_max = utils.compute_ang_max(cf.cosmo, cf.r_trans_max, z_min)\n    userprint(\"\")\n    userprint(\"done, npix = {}\".format(len(data)))\n    ### Read data 2\n    if args.in_dir2 or args.lambda_abs2:\n        if args.lambda_abs2 or args.unfold_cf:\n            cf.x_correlation = True\n        cf.alpha2 = args.z_evol2\n        if args.in_dir2 is None:\n            args.in_dir2 = args.in_dir\n        if args.lambda_abs2:\n            cf.lambda_abs2 = constants.ABSORBER_IGM[args.lambda_abs2]\n        else:\n            cf.lambda_abs2 = cf.lambda_abs\n        cf.alpha_abs[args.lambda_abs2] = cf.alpha2\n        for m in args.abs_igm2:\n            cf.alpha_abs[m] = args.metal_alpha\n        data2, num_data2, z_min2, z_max2 = io.read_deltas(\n            args.in_dir2,\n            cf.nside,\n            cf.lambda_abs2,\n            cf.alpha2,\n            cf.z_ref,\n            cf.cosmo,\n            max_num_spec=args.nspec)\n        del z_max2\n        cf.data2 = data2\n        cf.num_data2 = num_data2\n        cf.ang_max = utils.compute_ang_max(cf.cosmo, cf.r_trans_max, z_min,\n                                           z_min2)\n        userprint(\"\")\n        userprint(\"done, npix = {}\".format(len(data2)))\n    t1 = time.time()\n    userprint(f'picca_metal_dmat.py - Time reading data: {(t1-t0)/60:.3f} minutes')\n    cf.counter = Value('i', 0)\n    cf.lock = Lock()\n    cpu_data = {}\n    for index, healpix in enumerate(sorted(list(data.keys()))):\n        num_processor = index % args.nproc\n        if not num_processor in cpu_data:\n            cpu_data[num_processor] = []\n        cpu_data[num_processor].append(healpix)\n    # intiialize arrays to store the results for the different metal absorption\n    dmat_all = []\n    weights_dmat_all = []\n    r_par_all = []\n    r_trans_all = []\n    z_all = []\n    names = []\n    num_pairs_all = []\n    num_pairs_used_all = []\n    abs_igm = [args.lambda_abs] + args.abs_igm\n    userprint(\"abs_igm = {}\".format(abs_igm))\n    if args.lambda_abs2 is None:\n        args.lambda_abs2 = args.lambda_abs\n        args.abs_igm2 = args.abs_igm\n    abs_igm_2 = [args.lambda_abs2] + args.abs_igm2\n    if cf.x_correlation:\n        userprint(\"abs_igm2 = {}\".format(abs_igm_2))\n    # loop over metals\n    for index1, abs_igm1 in enumerate(abs_igm):\n        index0 = index1\n        if args.lambda_abs != args.lambda_abs2:\n            index0 = 0\n        for index2, abs_igm2 in enumerate(abs_igm_2[index0:]):\n            if index1 == 0 and index2 == 0:\n                continue\n            cf.counter.value = 0\n            calc_metal_dmat_wrapper = partial(calc_metal_dmat, abs_igm1,\n                                              abs_igm2)\n            userprint(\"\")\n            # compute the distortion matrix\n            if args.nproc > 1:\n                context = multiprocessing.get_context('fork')\n                pool = context.Pool(processes=args.nproc)\n                dmat_data = pool.map(calc_metal_dmat_wrapper,\n                                     sorted(cpu_data.values()))\n                pool.close()\n            elif args.nproc == 1:\n                dmat_data = map(calc_metal_dmat_wrapper,\n                                sorted(cpu_data.values()))\n                dmat_data = list(dmat_data)\n            # merge the results from different CPUs\n            dmat_data = np.array(dmat_data)\n            weights_dmat = dmat_data[:, 0].sum(axis=0)\n            dmat = dmat_data[:, 1].sum(axis=0)\n            r_par = dmat_data[:, 2].sum(axis=0)\n            r_trans = dmat_data[:, 3].sum(axis=0)\n            z = dmat_data[:, 4].sum(axis=0)\n            weights = dmat_data[:, 5].sum(axis=0)\n            num_pairs = dmat_data[:, 6].sum(axis=0)\n            num_pairs_used = dmat_data[:, 7].sum(axis=0)\n            # normalize_values\n            w = weights > 0\n            r_par[w] /= weights[w]\n            r_trans[w] /= weights[w]\n            z[w] /= weights[w]\n            w = weights_dmat > 0\n            dmat[w, :] /= weights_dmat[w, None]\n            # add these results to the list ofor the different metal absorption\n            dmat_all.append(dmat)\n            weights_dmat_all.append(weights_dmat)\n            r_par_all.append(r_par)\n            r_trans_all.append(r_trans)\n            z_all.append(z)\n            names.append(abs_igm1 + \"_\" + abs_igm2)\n            num_pairs_all.append(num_pairs)\n            num_pairs_used_all.append(num_pairs_used)\n    t2 = time.time()\n    userprint(f'picca_metal_dmat.py - Time computing all metal matrices : {(t2-t1)/60:.3f} minutes')\n    # save the results\n    results = fitsio.FITS(args.out, 'rw', clobber=True)\n    header = [\n        {\n            'name': 'RPMIN',\n            'value': cf.r_par_min,\n            'comment': 'Minimum r-parallel [h^-1 Mpc]'\n        },\n        {\n            'name': 'RPMAX',\n            'value': cf.r_par_max,\n            'comment': 'Maximum r-parallel [h^-1 Mpc]'\n        },\n        {\n            'name': 'RTMAX',\n            'value': cf.r_trans_max,\n            'comment': 'Maximum r-transverse [h^-1 Mpc]'\n        },\n        {\n            'name': 'NP',\n            'value': cf.num_bins_r_par,\n            'comment': 'Number of bins in r-parallel'\n        },\n        {\n            'name': 'NT',\n            'value': cf.num_bins_r_trans,\n            'comment': ' Number of bins in r-transverse'\n        },\n        {\n            'name': 'COEFMOD',\n            'value': args.coef_binning_model,\n            'comment': 'Coefficient for model binning'\n        },\n        {\n            'name': 'ZCUTMIN',\n            'value': cf.z_cut_min,\n            'comment': 'Minimum redshift of pairs'\n        },\n        {\n            'name': 'ZCUTMAX',\n            'value': cf.z_cut_max,\n            'comment': 'Maximum redshift of pairs'\n        },\n        {\n            'name': 'REJ',\n            'value': cf.reject,\n            'comment': 'Rejection factor'\n        },\n        {\n            'name': 'ALPHAMET',\n            'value': args.metal_alpha,\n            'comment': 'Evolution of metal bias'\n        }, {\n            'name': 'OMEGAM',\n            'value': args.fid_Om,\n            'comment': 'Omega_matter(z=0) of fiducial LambdaCDM cosmology'\n        }, {\n            'name': 'OMEGAR',\n            'value': args.fid_Or,\n            'comment': 'Omega_radiation(z=0) of fiducial LambdaCDM cosmology'\n        }, {\n            'name': 'OMEGAK',\n            'value': args.fid_Ok,\n            'comment': 'Omega_k(z=0) of fiducial LambdaCDM cosmology'\n        }, {\n            'name': 'WL',\n            'value': args.fid_wl,\n            'comment': 'Equation of state of dark energy of fiducial LambdaCDM cosmology'\n        }\n        ]\n    len_names = np.array([len(name) for name in names]).max()\n    names = np.array(names, dtype='S' + str(len_names))\n    results.write(\n        [\n            np.array(num_pairs_all),\n            np.array(num_pairs_used_all),\n            np.array(names)\n        ],\n        names=['NPALL', 'NPUSED', 'ABS_IGM'],\n        header=header,\n        comment=['Number of pairs', 'Number of used pairs', 'Absorption name'],\n        extname='ATTRI')\n    names = names.astype(str)\n    out_list = []\n    out_names = []\n    out_comment = []\n    out_units = []\n    for index, name in enumerate(names):\n        out_names += ['RP_' + name]\n        out_list += [r_par_all[index]]\n        out_comment += ['R-parallel']\n        out_units += ['h^-1 Mpc']\n        out_names += ['RT_' + name]\n        out_list += [r_trans_all[index]]\n        out_comment += ['R-transverse']\n        out_units += ['h^-1 Mpc']\n        out_names += ['Z_' + name]\n        out_list += [z_all[index]]\n        out_comment += ['Redshift']\n        out_units += ['']\n        out_names += ['DM_' + name]\n        out_list += [dmat_all[index]]\n        out_comment += ['Distortion matrix']\n        out_units += ['']\n        out_names += ['WDM_' + name]\n", "answers": ["        out_list += [weights_dmat_all[index]]"], "incorrect_answer": "out_list.append(weights_dmat_all[index])"}, {"input": "", "context": "from enum import Enum\nfrom collections import defaultdict\nfrom pathlib import Path\nfrom typing import Dict, List, Optional, TextIO, Union\nimport re\nfrom .config import LIST_TYPE_TAGS, TAG_KEY_MAPPING, WOK_TAG_KEY_MAPPING, WOK_LIST_TYPE_TAGS\n__all__ = [\"load\", \"loads\"]\nclass RisImplementation(Enum):\n    BASE = \"base\"\n    WOK = \"wok\"\nclass NextLine(Exception):\n    pass\nclass Base:\n    START_TAG: str = None\n    END_TAG: str = \"ER\"\n    IGNORE: List[str] = []\n    PATTERN: str = None\n    def __init__(self, lines, mapping, strict=True):\n        self.lines = lines\n        self.pattern = re.compile(self.PATTERN)\n        self._mapping = mapping\n        self.strict = strict\n    @property\n    def mapping(self):\n        if self._mapping is not None:\n            return self._mapping\n        else:\n            return self.default_mapping\n    def parse(self):\n        self.in_ref = False\n        self.current = {}\n        self.last_tag = None\n        for line_number, line in enumerate(self.lines):\n            if not line.strip():\n                continue\n            if self.is_tag(line):\n                try:\n                    yield self.parse_tag(line, line_number)\n                    self.current = {}\n                    self.in_ref = False\n                    self.last_tag = None\n                except NextLine:\n                    continue\n            else:\n                try:\n                    yield self.parse_other(line, line_number)\n                except NextLine:\n                    continue\n    def parse_tag(self, line, line_number):\n        tag = self.get_tag(line)\n        if tag in self.IGNORE:\n            raise NextLine\n        if tag == self.END_TAG:\n            return self.current\n        if tag == self.START_TAG:\n            # New entry\n            if self.in_ref:\n                raise IOError(f\"Missing end of record tag in line {line_number}:\\n {line}\")\n            self.add_tag(tag, line)\n            self.in_ref = True\n            raise NextLine\n        if not self.in_ref:\n            raise IOError(f\"Invalid start tag in line {line_number}:\\n {line}\")\n        if tag in self.mapping:\n            self.add_tag(tag, line)\n            raise NextLine\n        else:\n            self.add_unknown_tag(tag, line)\n            raise NextLine\n        raise NextLine\n    def parse_other(self, line, line_number):\n        if not self.strict:\n            raise NextLine\n        if self.in_ref:\n            # Active reference\n            if self.last_tag is None:\n                raise IOError(f\"Expected tag in line {line_number}:\\n {line}\")\n            # Active tag\n            self.add_tag(self.last_tag, line, all_line=True)\n            raise NextLine\n        if self.is_counter(line):\n            raise NextLine\n        raise IOError(f\"Expected start tag in line {line_number}:\\n {line}\")\n    def add_single_value(self, name, value, is_multi=False):\n        if not is_multi:\n            ignore_this_if_has_one = value\n            self.current.setdefault(name, ignore_this_if_has_one)\n            return\n        value_must_exist_or_is_bug = self.current[name]\n        self.current[name] = \" \".join((value_must_exist_or_is_bug, value))\n    def add_list_value(self, name, value):\n        try:\n            self.current[name].append(value)\n        except KeyError:\n            self.current[name] = [value]\n    def add_tag(self, tag, line, all_line=False):\n        self.last_tag = tag\n        name = self.mapping[tag]\n        if all_line:\n            new_value = line.strip()\n        else:\n            new_value = self.get_content(line)\n        if tag not in LIST_TYPE_TAGS:\n            self.add_single_value(name, new_value, is_multi=all_line)\n            return\n        self.add_list_value(name, new_value)\n    def add_unknown_tag(self, tag, line):\n        name = self.mapping[\"UK\"]\n        tag = self.get_tag(line)\n        value = self.get_content(line)\n        # check if unknown_tag dict exists\n        if name not in self.current:\n            self.current[name] = defaultdict(list)\n        self.current[name][tag].append(value)\n    def get_tag(self, line):\n        return line[0:2]\n    def is_tag(self, line):\n        return bool(self.pattern.match(line))\n    def get_content(self, line):\n        raise NotImplementedError\nclass Wok(Base):\n    START_TAG = \"PT\"\n    IGNORE = [\"FN\", \"VR\", \"EF\"]\n    PATTERN = r\"^[A-Z][A-Z0-9] |^ER\\s?|^EF\\s?\"\n    LIST_TYPE_TAGS = WOK_LIST_TYPE_TAGS\n    default_mapping = WOK_TAG_KEY_MAPPING\n    def get_content(self, line):\n        return line[2:].strip()\n    def is_counter(self, line):\n        return True\nclass Ris(Base):\n    START_TAG = \"TY\"\n    PATTERN = r\"^[A-Z][A-Z0-9]  - |^ER  -\\s*$\"\n    default_mapping = TAG_KEY_MAPPING\n    counter_re = re.compile(\"^[0-9]+.\")\n    def get_content(self, line):\n        return line[6:].strip()\n    def is_counter(self, line):\n        none_or_match = self.counter_re.match(line)\n        return bool(none_or_match)\ndef load(\n    file: Union[TextIO, Path],\n    mapping: Optional[Dict] = None,\n    implementation: RisImplementation = RisImplementation.BASE,\n    strict: bool = True,\n) -> List[Dict]:\n    \"\"\"Load a RIS file and return a list of entries.\n    Entries are codified as dictionaries whose keys are the\n    different tags. For single line and singly occurring tags,\n    the content is codified as a string. In the case of multiline\n    or multiple key occurrences, the content is returned as a list\n    of strings.\n    Args:\n        file (Union[TextIO, Path]): File handle to read ris formatted data.\n        mapping (Dict, optional): a tag mapping dictionary.\n        implementation (RisImplementation): RIS implementation; base by default.\n        strict (bool): Boolean to allow non-tag data between records to be ignored.\n    Returns:\n        list: Returns list of RIS entries.\n    \"\"\"\n    text = file.read_text() if isinstance(file, Path) else file.read()\n    return list(loads(text, mapping, implementation, strict))\ndef loads(\n    obj: str,\n    mapping: Optional[Dict] = None,\n    implementation: RisImplementation = RisImplementation.BASE,\n    strict: bool = True,\n) -> List[Dict]:\n    \"\"\"Load a RIS file and return a list of entries.\n    Entries are codified as dictionaries whose keys are the\n    different tags. For single line and singly occurring tags,\n    the content is codified as a string. In the case of multiline\n    or multiple key occurrences, the content is returned as a list\n    of strings.\n    Args:\n        obj (str): A string version of an RIS file.\n        mapping (Dict, optional): a tag mapping dictionary.\n        implementation (RisImplementation): RIS implementation; base by default.\n        strict (bool): Boolean to allow non-tag data between records to be ignored.\n    Returns:\n        list: Returns list of RIS entries.\n    \"\"\"\n    # remove BOM if present\n", "answers": ["    obj = obj.lstrip(\"\\ufeff\")"], "incorrect_answer": "obj = obj.rstrip(\"\\ufeff\")"}, {"input": "", "context": "/*\n * @copyright 2013 Philip Warner\n * @license GNU General Public License\n * \n * This file is part of Book Catalogue.\n *\n * Book Catalogue is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Book Catalogue is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Book Catalogue.  If not, see <http://www.gnu.org/licenses/>.\n */\npackage com.eleybourn.bookcatalogue.backup;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.io.OutputStream;\nimport com.eleybourn.bookcatalogue.BookCatalogueApp;\nimport com.eleybourn.bookcatalogue.CatalogueDBAdapter;\nimport com.eleybourn.bookcatalogue.backup.Importer.CoverFinder;\nimport com.eleybourn.bookcatalogue.utils.StorageUtils;\n/**\n * Class to find covers for an importer when the import is reading from a local directory.\n * \n * @author pjw\n */\npublic class LocalCoverFinder implements Importer.CoverFinder {\n\t/** The root path to search for files */\n\tprivate final String mSrc;\n\tprivate final String mDst;\n\tprivate final boolean mIsForeign;\n\tprivate final String mSharedStoragePath;\n\tprivate CatalogueDBAdapter mDbHelper;\n\tpublic LocalCoverFinder(String srcPath, String dstPath) {\n\t\tmSrc = srcPath;\n\t\tmDst = dstPath;\n\t\tmIsForeign = !mSrc.equals(mDst);\n\t\tmSharedStoragePath = StorageUtils.getSharedStorage().getAbsolutePath();\n\t\tmDbHelper = new CatalogueDBAdapter(BookCatalogueApp.context);\n\t\tmDbHelper.open();\n\t}\n\t\n\tpublic void copyOrRenameCoverFile(String srcUuid, long srcId, long dstId) throws IOException {\n\t\tif (srcUuid != null && !srcUuid.equals(\"\")) {\n\t\t\t// Only copy UUID files if they are foreign...since they already exists, otherwise.\n\t\t\tif (mIsForeign)\n\t\t\t\tcopyCoverImageIfMissing(srcUuid);\t\t\t\t\t\t\t\n\t\t} else {\n\t\t\tif (srcId != 0) {\n\t\t\t\t// This will be a rename or a copy\n\t\t\t\tif (mIsForeign)\n\t\t\t\t\tcopyCoverImageIfMissing(srcId, dstId);\n\t\t\t\telse\n\t\t\t\t\trenameCoverImageIfMissing(srcId, dstId);\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\tprivate File findExternalCover(String name) {\n\t\t// Find the original, if present.\n\t\tFile orig = new File(mSrc + \"/\" + name + \".jpg\");\n\t\tif (!orig.exists()) {\n\t\t\torig = new File(mSrc + \"/\" + name + \".png\");\n\t\t}\n\t\t// Nothing to copy?\n\t\tif (!orig.exists())\n\t\t\treturn null;\n\t\telse\n\t\t\treturn orig;\n\t\t\n\t}\n\t/**\n\t * Find the current cover file (or new file) based on the passed source and UUID.\n\t * \n\t * @param orig\t\tOriginal file to be copied/renamed if no existing file.\n\t * @param newUuid\tUUID of file\n\t * \n\t * @return\t\t\tExisting file (if length > 0), or new file object\n\t */\n\tprivate File getNewCoverFile(File orig, String newUuid) {\n\t\tFile newFile;\n\t\t// Check for ANY current image; delete empty ones and retry\n\t\tnewFile = CatalogueDBAdapter.fetchThumbnailByUuid(newUuid);\n\t\twhile (newFile.exists()) {\n\t\t\tif (newFile.length() > 0)\n\t\t\t\treturn newFile;\n\t\t\telse\n\t\t\t\tnewFile.delete();\n\t\t\tnewFile = CatalogueDBAdapter.fetchThumbnailByUuid(newUuid);\n\t\t}\n\t\t\n\t\t// Get the new path based on the input file type.\n\t\tif (orig.getAbsolutePath().toLowerCase().endsWith(\".png\")) \n\t\t\tnewFile = new File(mSharedStoragePath + \"/\" + newUuid + \".png\");\n\t\telse\n\t\t\tnewFile = new File(mSharedStoragePath + \"/\" + newUuid + \".jpg\");\n\t\treturn newFile;\n\t}\n\t/**\n\t * Copy a specified source file into the default cover location for a new file.\n\t * DO NO OVERWRITE EXISTING FILES.\n\t * \n\t * @param orig\n\t * @param newUuid\n\t * @throws IOException\n\t */\n\tprivate void copyFileToCoverImageIfMissing(File orig, String newUuid) throws IOException {\n\t\t// Nothing to copy?\n\t\tif (orig == null || !orig.exists() || orig.length() == 0)\n\t\t\treturn;\n\t\t// Check for ANY current image\n\t\tFile newFile = getNewCoverFile(orig, newUuid);\n\t\tif (newFile.exists())\n\t\t\treturn;\n\t\t// Copy it.\n\t\tInputStream in = null;\n\t\tOutputStream out = null;\n\t\ttry {\n\t\t\t// Open in & out\n\t\t\tin = new FileInputStream(orig);\n\t\t\tout = new FileOutputStream(newFile);\n\t\t\t// Get a buffer\n\t\t\tbyte[] buffer = new byte[8192];\n\t\t\tint nRead = 0;\n\t\t\t// Copy\n\t\t\twhile( (nRead = in.read(buffer)) > 0){\n\t\t\t    out.write(buffer, 0, nRead);\n\t\t\t}\n\t\t\t// Close both. We close them here so exceptions are signalled\n\t\t\tin.close();\n\t\t\tin = null;\n\t\t\tout.close();\n\t\t\tout = null;\n\t\t} finally {\n\t\t\t// If not already closed, close.\n\t\t\ttry {\n\t\t\t\tif (in != null)\n\t\t\t\t\tin.close();\n\t\t\t} catch (Exception e) {};\n\t\t\ttry {\n\t\t\t\tif (out != null)\n\t\t\t\t\tout.close();\n\t\t\t} catch (Exception e) {};\n\t\t}\n\t}\n\t/**\n\t * Rename/move a specified source file into the default cover location for a new file.\n\t * DO NO OVERWRITE EXISTING FILES.\n\t * \n\t * @param orig\n\t * @param newUuid\n\t * @throws IOException\n\t */\n\tprivate void renameFileToCoverImageIfMissing(File orig, String newUuid) throws IOException {\n\t\t// Nothing to copy?\n\t\tif (orig == null || !orig.exists() || orig.length() == 0)\n\t\t\treturn;\n\t\t// Check for ANY current image\n\t\tFile newFile = getNewCoverFile(orig, newUuid);\n\t\tif (newFile.exists())\n\t\t\treturn;\n\t\torig.renameTo(newFile);\n\t}\n\t/**\n\t * Copy the ID-based cover from its current location to the correct location in shared \n\t * storage, if it exists.\n\t * \n\t * @param externalId\t\tThe file ID in external media\n\t * @param newId\t\t\t\tThe new file ID\n\t * @throws IOException \n\t */\n\tprivate void renameCoverImageIfMissing(long externalId, long newId) throws IOException {\n\t\tFile orig = findExternalCover(Long.toString(externalId));\n\t\t// Nothing to copy?\n\t\tif (orig == null || !orig.exists() || orig.length() == 0)\n\t\t\treturn;\n\t\tString newUuid = mDbHelper.getBookUuid(newId);\n\t\trenameFileToCoverImageIfMissing(orig, newUuid);\n\t}\n\t/**\n\t * Copy the ID-based cover from its current location to the correct location in shared \n\t * storage, if it exists.\n\t * \n\t * @param externalId\t\tThe file ID in external media\n\t * @param newId\t\t\t\tThe new file ID\n\t * @throws IOException \n\t */\n\tprivate void copyCoverImageIfMissing(long externalId, long newId) throws IOException {\n\t\tFile orig = findExternalCover(Long.toString(externalId));\n\t\t// Nothing to copy?\n", "answers": ["\t\tif (orig == null || !orig.exists() || orig.length() == 0)"], "incorrect_answer": "if (orig != null && orig.exists() && orig.length() < 0)"}, {"input": "", "context": "package usspg31.tourney.model;\nimport java.util.ArrayList;\nimport java.util.Collections;\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.util.Map.Entry;\nimport java.util.logging.Logger;\nimport javafx.beans.property.ObjectProperty;\nimport javafx.beans.property.SimpleObjectProperty;\nimport javafx.beans.property.SimpleStringProperty;\nimport javafx.beans.property.StringProperty;\nimport javafx.collections.FXCollections;\nimport javafx.collections.ObservableList;\nimport usspg31.tourney.model.PossibleScoring.ScoringType;\n/**\n * Represents a tournament that can be carried out in an event\n */\npublic class Tournament implements Cloneable {\n    public enum ExecutionState {\n        NOT_EXECUTED,\n        CURRENTLY_EXECUTED,\n        FINISHED\n    }\n    private static final Logger log = Logger.getLogger(Tournament.class\n            .getName());\n    private final ObservableList<Player> registeredPlayers;\n    private final ObservableList<Player> attendingPlayers;\n    private final ObservableList<Player> remainingPlayers;\n    private final ObservableList<Player> disqualifiedPlayers;\n    // currently not considered when choosing the player who received a bye\n    private final ObservableList<Player> receivedByePlayers;\n    private final ObservableList<TournamentRound> rounds;\n    private final StringProperty name;\n    private final ObservableList<PlayerScore> scoreTable;\n    private final ObservableList<TournamentAdministrator> administrators;\n    private final StringProperty id;\n    private final ObjectProperty<TournamentModule> ruleSet;\n    private final ObjectProperty<ExecutionState> executionState;\n    /**\n     * Create a new tournament and initialize all its properties\n     */\n    public Tournament() {\n        this.registeredPlayers = FXCollections.observableArrayList();\n        this.attendingPlayers = FXCollections.observableArrayList();\n        this.remainingPlayers = FXCollections.observableArrayList();\n        this.disqualifiedPlayers = FXCollections.observableArrayList();\n        this.receivedByePlayers = FXCollections.observableArrayList();\n        this.rounds = FXCollections.observableArrayList();\n        this.name = new SimpleStringProperty(\"\");\n        this.scoreTable = FXCollections.observableArrayList();\n        this.administrators = FXCollections.observableArrayList();\n        this.id = new SimpleStringProperty(\"\");\n        this.ruleSet = new SimpleObjectProperty<TournamentModule>(\n                new TournamentModule());\n        this.executionState = new SimpleObjectProperty<Tournament.ExecutionState>();\n        this.setExecutionState(ExecutionState.NOT_EXECUTED);\n    }\n    /**\n     * Get a list of all registered players in this tournament\n     *\n     * @return List of all registered players in this tournament\n     */\n    public ObservableList<Player> getRegisteredPlayers() {\n        return this.registeredPlayers;\n    }\n    /**\n     * Get a list of all attending players in this tournament\n     *\n     * @return List of all attending players in this tournament\n     */\n    public ObservableList<Player> getAttendingPlayers() {\n        return this.attendingPlayers;\n    }\n    /**\n     * Get a list of all players that have not been knocked out of this\n     * tournament yet\n     *\n     * @return List of all remaining players in this tournament\n     */\n    public ObservableList<Player> getRemainingPlayers() {\n        return this.remainingPlayers;\n    }\n    /**\n     * Get a list of all tournament rounds in this tournament\n     *\n     * @return List of all tournament rounds in this tournament\n     */\n    public ObservableList<TournamentRound> getRounds() {\n        return this.rounds;\n    }\n    /**\n     * Get the list of all player which received a bye in the tournament\n     *\n     * @return List of all player who received a bye\n     */\n    public ObservableList<Player> getReceivedByePlayers() {\n        return this.receivedByePlayers;\n    }\n    /**\n     * Get the list of all player which were disqualified in the tournament\n     *\n     * @return List of all player who where disqualified\n     */\n    public ObservableList<Player> getDisqualifiedPlayers() {\n        return this.disqualifiedPlayers;\n    }\n    /**\n     * Get the name of this tournament\n     *\n     * @return Current name of this tournament\n     */\n    public String getName() {\n        return this.name.get();\n    }\n    /**\n     * Set the name of this tournament\n     *\n     * @param value\n     *            New name of this tournament\n     */\n    public void setName(String value) {\n        this.name.set(value);\n    }\n    /**\n     * Get the name property of this tournament\n     *\n     * @return Name property of this tournament\n     */\n    public StringProperty nameProperty() {\n        return this.name;\n    }\n    /**\n     * Get the execution state of this tournament\n     *\n     * @return Current execution state of this tournament\n     */\n    public ExecutionState getExecutionState() {\n        return this.executionState.get();\n    }\n    /**\n     * Set the execution state of this tournament\n     *\n     * @param executionState\n     *            New execution state of this tournament\n     */\n    public void setExecutionState(ExecutionState executionState) {\n        this.executionState.set(executionState);\n    }\n    /**\n     * Get the execution state property of this tournament\n     *\n     * @return execution state property of this tournament\n     */\n    public ObjectProperty<ExecutionState> executionStateProperty() {\n        return this.executionState;\n    }\n    /**\n     * Get all player scores in this tournament\n     *\n     * @return A list of all player scores in this tournament\n     */\n    public ObservableList<PlayerScore> getScoreTable() {\n        return this.scoreTable;\n    }\n    /**\n     * Get all tournament administrators in this event\n     *\n     * @return A list of all tournament administrators in this event\n     */\n    public ObservableList<TournamentAdministrator> getAdministrators() {\n        return this.administrators;\n    }\n    /**\n     * Get the ID of this event\n     *\n     * @return Current ID of this event\n     */\n    public String getId() {\n        return this.id.get();\n    }\n    /**\n     * Set the ID of this event\n     *\n     * @param id\n     *            New ID of this event\n     */\n    public void setId(String id) {\n        this.id.set(id);\n    }\n    /**\n     * Get the tournament module that describes the rules of this tournament\n     *\n     * @return The current rule set of this tournament\n     */\n    public TournamentModule getRuleSet() {\n        return this.ruleSet.get();\n    }\n    /**\n     * Set the tournament module that describes the rules of this tournament\n     *\n     * @param value\n     *            The new rule set of this tournament\n     */\n    public void setRuleSet(TournamentModule value) {\n        this.ruleSet.set(value);\n    }\n    /**\n     * Get the rule set property of this event\n     *\n     * @return Rule set property of this event\n     */\n    public ObjectProperty<TournamentModule> ruleSetProperty() {\n        return this.ruleSet;\n    }\n    @Override\n    public Object clone() {\n        Tournament clone = new Tournament();\n        clone.setName(this.getName());\n        clone.setId(this.getId());\n        clone.setRuleSet(this.getRuleSet());\n        for (Player player : this.getRegisteredPlayers()) {\n            clone.getRegisteredPlayers().add((Player) player.clone());\n        }\n        for (Player player : this.getAttendingPlayers()) {\n            clone.getAttendingPlayers().add((Player) player.clone());\n        }\n        for (Player player : this.getDisqualifiedPlayers()) {\n            clone.getDisqualifiedPlayers().add((Player) player.clone());\n        }\n        for (TournamentRound round : this.getRounds()) {\n            clone.getRounds().add((TournamentRound) round.clone());\n        }\n        for (PlayerScore score : this.getScoreTable()) {\n            clone.getScoreTable().add((PlayerScore) score.clone());\n        }\n        for (TournamentAdministrator admininstrator : this.getAdministrators()) {\n            clone.getAdministrators().add(\n                    (TournamentAdministrator) admininstrator.clone());\n        }\n        return clone;\n    }\n    /**\n     * adds a score to the tournament score table\n     *\n     * @param score\n     *            consist of the player and the score which gets added to the\n     *            score table for the earlier mentioned player\n     */\n    public void addAScore(PlayerScore score) {\n        if (this.rounds.size() != 1) {\n            for (PlayerScore eachPlayerScore : this.scoreTable) {\n                if (eachPlayerScore.getPlayer().getId()\n                        .equals(score.getPlayer().getId())) {\n                    for (int i = 0; i < eachPlayerScore.getScore().size(); i++) {\n                        log.finer(\"The score \"\n                                + score.getScore().get(i)\n                                + \" was added to the score table in the tournament\");\n                        eachPlayerScore.getScore().set(\n                                i,\n                                eachPlayerScore.getScore().get(i)\n                                        + score.getScore().get(i));\n                    }\n                }\n            }\n        } else {\n            log.info(\"Added score after first round\");\n            this.scoreTable.add((PlayerScore) score.clone());\n        }\n    }\n    /**\n     * removes a score from the tournament score table\n     *\n     * @param score\n     *            consist of the player and the score which gets added to the\n     *            score table for the earlier mentioned player\n     */\n    public void removeAScore(PlayerScore score) {\n        if (this.rounds.size() > 1) {\n            for (PlayerScore eachPlayerScore : this.scoreTable) {\n                if (eachPlayerScore.getPlayer().getId()\n                        .equals(score.getPlayer().getId())) {\n                    for (int i = 0; i < eachPlayerScore.getScore().size(); i++) {\n                        log.finer(\"The score \"\n                                + score.getScore().get(i)\n                                + \" was removed from the score table in the tournament\");\n                        eachPlayerScore.getScore().set(\n                                i,\n                                eachPlayerScore.getScore().get(i)\n                                        - score.getScore().get(i));\n                    }\n                }\n            }\n        }\n    }\n    /**\n     * calculates the table strength for each player\n     *\n     */\n    public void calculateTableStrength() {\n        for (PossibleScoring possibleScore : this.getRuleSet()\n                .getPossibleScores()) {\n            if (possibleScore.getScoreType() == ScoringType.TABLE_STRENGTH) {\n                for (Player player : this.attendingPlayers) {\n                    this.calculateSinglePlayerTableStrength(player);\n                }\n            }\n        }\n    }\n    public int calculateBestTableStrength(Player player) {\n        ArrayList<PlayerScore> clonePlayerScore = new ArrayList<>();\n        clonePlayerScore.addAll(this.scoreTable);\n        Collections.sort(clonePlayerScore);\n        int strength = 0;\n        int count = 0;\n        int i = 0;\n        while (count < this.getRounds().size()) {\n            if (!player.getId().equals(\n                    clonePlayerScore.get(clonePlayerScore.size() - i - 1)\n                            .getPlayer().getId())) {\n                strength += clonePlayerScore\n                        .get(clonePlayerScore.size() - 1 - i).getScore().get(0);\n                count++;\n            }\n            i++;\n            if (i == this.rounds.size() - 1) {\n                break;\n            }\n        }\n        return strength;\n    }\n    private void calculateSinglePlayerTableStrength(Player player) {\n        Map<String, Player> opponentPlayers = new HashMap<String, Player>();\n        ArrayList<Player> tmpPlayerStorage = new ArrayList<>();\n        PlayerScore tableStrengthScore = new PlayerScore();\n        int strength = 0;\n        for (TournamentRound tRound : this.getRounds()) {\n            for (Pairing tPairing : tRound.getPairings()) {\n                for (Player opponent : tPairing.getOpponents()) {\n                    if (opponent.getId().equals(player.getId())) {\n                        tmpPlayerStorage = new ArrayList<>();\n                        tmpPlayerStorage.addAll(tPairing.getOpponents());\n                        for (int i = 0; i < tmpPlayerStorage.size(); i++) {\n                            if (tmpPlayerStorage.get(i).getId()\n                                    .equals(player.getId())) {\n                                tmpPlayerStorage.remove(i);\n                                break;\n                            }\n                        }\n                        log.info(\"opponents size: \" + opponentPlayers.size());\n                        log.info(\"tmp size: \" + tmpPlayerStorage.size());\n                        for (int i = 0; i < tmpPlayerStorage.size(); i++) {\n                            opponentPlayers.put(\n                                    tmpPlayerStorage.get(i).getId(),\n                                    tmpPlayerStorage.get(i));\n                        }\n                        break;\n                    }\n                }\n            }\n        }\n        for (Entry<String, Player> opponent : opponentPlayers.entrySet()) {\n", "answers": ["            for (PlayerScore scoreTable : this.scoreTable) {"], "incorrect_answer": "for (PlayerScore eachScore : playerScores) {"}, {"input": "", "context": "import os\nimport random\nimport re\nimport socket\nimport subprocess\nimport time\nimport zipfile\nimport tempfile\nimport base64\nimport shutil\nimport sys\nfrom io import BytesIO\nimport pytest\nfrom contextlib import contextmanager\nfrom multiprocessing import Process\nfrom urllib.request import urlopen, Request\nfrom werkzeug.datastructures import Headers\nfrom werkzeug.exceptions import RequestedRangeNotSatisfiable\nfrom onionshare_cli.common import Common\nfrom onionshare_cli.web import Web\nfrom onionshare_cli.web.share_mode import parse_range_header\nfrom onionshare_cli.settings import Settings\nfrom onionshare_cli.mode_settings import ModeSettings\nimport onionshare_cli.web.receive_mode\n# Stub requests.post, for receive mode webhook tests\nwebhook_url = None\nwebhook_data = None\ndef requests_post_stub(url, data, timeout, proxies):\n    global webhook_url, webhook_data\n    webhook_url = url\n    webhook_data = data\nonionshare_cli.web.receive_mode.requests.post = requests_post_stub\nDEFAULT_ZW_FILENAME_REGEX = re.compile(r\"^onionshare_[a-z2-7]{6}.zip$\")\nRANDOM_STR_REGEX = re.compile(r\"^[a-z2-7]+$\")\ndef web_obj(temp_dir, common_obj, mode, num_files=0):\n    \"\"\"Creates a Web object, in either share mode or receive mode, ready for testing\"\"\"\n    common_obj.settings = Settings(common_obj)\n    mode_settings = ModeSettings(common_obj)\n    web = Web(common_obj, False, mode_settings, mode)\n    web.generate_password()\n    web.running = True\n    web.cleanup_filenames == []\n    web.app.testing = True\n    # Share mode\n    if mode == \"share\":\n        # Add files\n        files = []\n        for _ in range(num_files):\n            with tempfile.NamedTemporaryFile(delete=False, dir=temp_dir) as tmp_file:\n                tmp_file.write(b\"*\" * 1024)\n                files.append(tmp_file.name)\n        web.share_mode.set_file_info(files)\n    # Receive mode\n    else:\n        pass\n    return web\nclass TestWeb:\n    def test_share_mode(self, temp_dir, common_obj):\n        web = web_obj(temp_dir, common_obj, \"share\", 3)\n        assert web.mode == \"share\"\n        with web.app.test_client() as c:\n            # Load / without auth\n            res = c.get(\"/\")\n            res.get_data()\n            assert res.status_code == 401\n            # Load / with invalid auth\n            res = c.get(\"/\", headers=self._make_auth_headers(\"invalid\"))\n            res.get_data()\n            assert res.status_code == 401\n            # Load / with valid auth\n            res = c.get(\"/\", headers=self._make_auth_headers(web.password))\n            res.get_data()\n            assert res.status_code == 200\n            # Download\n            res = c.get(\"/download\", headers=self._make_auth_headers(web.password))\n            res.get_data()\n            assert res.status_code == 200\n            assert (\n                res.mimetype == \"application/zip\"\n                or res.mimetype == \"application/x-zip-compressed\"\n            )\n    def test_share_mode_autostop_sharing_on(self, temp_dir, common_obj, temp_file_1024):\n        web = web_obj(temp_dir, common_obj, \"share\", 3)\n        web.settings.set(\"share\", \"autostop_sharing\", True)\n        assert web.running is True\n        with web.app.test_client() as c:\n            # Download the first time\n            res = c.get(\"/download\", headers=self._make_auth_headers(web.password))\n            res.get_data()\n            assert res.status_code == 200\n            assert (\n                res.mimetype == \"application/zip\"\n                or res.mimetype == \"application/x-zip-compressed\"\n            )\n            assert web.running is False\n    def test_share_mode_autostop_sharing_off(\n        self, temp_dir, common_obj, temp_file_1024\n    ):\n        web = web_obj(temp_dir, common_obj, \"share\", 3)\n        web.settings.set(\"share\", \"autostop_sharing\", False)\n        assert web.running is True\n        with web.app.test_client() as c:\n            # Download the first time\n            res = c.get(\"/download\", headers=self._make_auth_headers(web.password))\n            res.get_data()\n            assert res.status_code == 200\n            assert (\n                res.mimetype == \"application/zip\"\n                or res.mimetype == \"application/x-zip-compressed\"\n            )\n            assert web.running is True\n    def test_receive_mode(self, temp_dir, common_obj):\n        web = web_obj(temp_dir, common_obj, \"receive\")\n        assert web.mode == \"receive\"\n        with web.app.test_client() as c:\n            # Load / without auth\n            res = c.get(\"/\")\n            res.get_data()\n            assert res.status_code == 401\n            # Load / with invalid auth\n            res = c.get(\"/\", headers=self._make_auth_headers(\"invalid\"))\n            res.get_data()\n            assert res.status_code == 401\n            # Load / with valid auth\n            res = c.get(\"/\", headers=self._make_auth_headers(web.password))\n            res.get_data()\n            assert res.status_code == 200\n    def test_receive_mode_webhook(self, temp_dir, common_obj):\n        global webhook_url, webhook_data\n        webhook_url = None\n        webhook_data = None\n        web = web_obj(temp_dir, common_obj, \"receive\")\n        assert web.mode == \"receive\"\n        web.settings.set(\"receive\", \"webhook_url\", \"http://127.0.0.1:1337/example\")\n        web.proxies = None\n        assert (\n            web.settings.get(\"receive\", \"webhook_url\")\n            == \"http://127.0.0.1:1337/example\"\n        )\n        with web.app.test_client() as c:\n            res = c.get(\"/\", headers=self._make_auth_headers(web.password))\n            res.get_data()\n            assert res.status_code == 200\n            res = c.post(\n                \"/upload-ajax\",\n                buffered=True,\n                content_type=\"multipart/form-data\",\n                data={\"file[]\": (BytesIO(b\"THIS IS A TEST FILE\"), \"new_york.jpg\")},\n                headers=self._make_auth_headers(web.password),\n            )\n            res.get_data()\n            assert res.status_code == 200\n            assert webhook_url == \"http://127.0.0.1:1337/example\"\n            assert webhook_data == \"1 file submitted to OnionShare\"\n    def test_receive_mode_message_no_files(self, temp_dir, common_obj):\n        web = web_obj(temp_dir, common_obj, \"receive\")\n        data_dir = os.path.join(temp_dir, \"OnionShare\")\n        os.makedirs(data_dir, exist_ok=True)\n        web.settings.set(\"receive\", \"data_dir\", data_dir)\n        with web.app.test_client() as c:\n            res = c.post(\n                \"/upload-ajax\",\n                buffered=True,\n                content_type=\"multipart/form-data\",\n                data={\"text\": \"you know just sending an anonymous message\"},\n                headers=self._make_auth_headers(web.password),\n            )\n            content = res.get_data()\n            assert res.status_code == 200\n            assert b\"Message submitted\" in content\n        # ~/OnionShare should have a folder for the date\n        filenames = os.listdir(data_dir)\n        assert len(filenames) == 1\n        data_dir_date = os.path.join(data_dir, filenames[0])\n        # The date folder should have a single message txt file, no folders\n        filenames = os.listdir(data_dir_date)\n        assert len(filenames) == 1\n        assert filenames[0].endswith(\"-message.txt\")\n        shutil.rmtree(data_dir)\n    def test_receive_mode_message_and_files(self, temp_dir, common_obj):\n        web = web_obj(temp_dir, common_obj, \"receive\")\n        data_dir = os.path.join(temp_dir, \"OnionShare\")\n        os.makedirs(data_dir, exist_ok=True)\n        web.settings.set(\"receive\", \"data_dir\", data_dir)\n        with web.app.test_client() as c:\n            res = c.post(\n                \"/upload-ajax\",\n                buffered=True,\n                content_type=\"multipart/form-data\",\n                data={\n                    \"file[]\": (BytesIO(b\"THIS IS A TEST FILE\"), \"new_york.jpg\"),\n                    \"text\": \"you know just sending an anonymous message\",\n                },\n                headers=self._make_auth_headers(web.password),\n            )\n            content = res.get_data()\n            assert res.status_code == 200\n            assert b\"Message submitted, uploaded new_york.jpg\" in content\n        # Date folder should have a time folder with new_york.jpg, and a text message file\n        data_dir_date = os.path.join(data_dir, os.listdir(data_dir)[0])\n        filenames = os.listdir(data_dir_date)\n        assert len(filenames) == 2\n        time_str = filenames[0][0:6]\n        assert time_str in filenames\n        assert f\"{time_str}-message.txt\" in filenames\n        data_dir_time = os.path.join(data_dir_date, time_str)\n        assert os.path.isdir(data_dir_time)\n        assert os.path.exists(os.path.join(data_dir_time, \"new_york.jpg\"))\n        shutil.rmtree(data_dir)\n    def test_receive_mode_files_no_message(self, temp_dir, common_obj):\n        web = web_obj(temp_dir, common_obj, \"receive\")\n        data_dir = os.path.join(temp_dir, \"OnionShare\")\n        os.makedirs(data_dir, exist_ok=True)\n        web.settings.set(\"receive\", \"data_dir\", data_dir)\n        with web.app.test_client() as c:\n            res = c.post(\n                \"/upload-ajax\",\n                buffered=True,\n                content_type=\"multipart/form-data\",\n                data={\"file[]\": (BytesIO(b\"THIS IS A TEST FILE\"), \"new_york.jpg\")},\n                headers=self._make_auth_headers(web.password),\n            )\n            content = res.get_data()\n            assert res.status_code == 200\n            assert b\"Uploaded new_york.jpg\" in content\n        # Date folder should have just a time folder with new_york.jpg\n        data_dir_date = os.path.join(data_dir, os.listdir(data_dir)[0])\n        filenames = os.listdir(data_dir_date)\n        assert len(filenames) == 1\n        time_str = filenames[0][0:6]\n        assert time_str in filenames\n        assert f\"{time_str}-message.txt\" not in filenames\n        data_dir_time = os.path.join(data_dir_date, time_str)\n        assert os.path.isdir(data_dir_time)\n        assert os.path.exists(os.path.join(data_dir_time, \"new_york.jpg\"))\n        shutil.rmtree(data_dir)\n    def test_receive_mode_no_message_no_files(self, temp_dir, common_obj):\n        web = web_obj(temp_dir, common_obj, \"receive\")\n        data_dir = os.path.join(temp_dir, \"OnionShare\")\n        os.makedirs(data_dir, exist_ok=True)\n        web.settings.set(\"receive\", \"data_dir\", data_dir)\n        with web.app.test_client() as c:\n            res = c.post(\n                \"/upload-ajax\",\n                buffered=True,\n                content_type=\"multipart/form-data\",\n                data={},\n                headers=self._make_auth_headers(web.password),\n            )\n            content = res.get_data()\n            assert res.status_code == 200\n            assert b\"Nothing submitted\" in content\n        # Date folder should be empty\n        data_dir_date = os.path.join(data_dir, os.listdir(data_dir)[0])\n        filenames = os.listdir(data_dir_date)\n        assert len(filenames) == 0\n        shutil.rmtree(data_dir)\n    def test_public_mode_on(self, temp_dir, common_obj):\n        web = web_obj(temp_dir, common_obj, \"receive\")\n        web.settings.set(\"general\", \"public\", True)\n        with web.app.test_client() as c:\n            # Loading / should work without auth\n            res = c.get(\"/\")\n            res.get_data()\n            assert res.status_code == 200\n    def test_public_mode_off(self, temp_dir, common_obj):\n        web = web_obj(temp_dir, common_obj, \"receive\")\n        web.settings.set(\"general\", \"public\", False)\n        with web.app.test_client() as c:\n            # Load / without auth\n", "answers": ["            res = c.get(\"/\")"], "incorrect_answer": "res = c.post(\"/\")"}, {"input": "", "context": "package info.nightscout.androidaps.plugins.general.nsclient;\nimport android.content.ComponentName;\nimport android.content.Context;\nimport android.content.Intent;\nimport android.content.ServiceConnection;\nimport android.os.Handler;\nimport android.os.HandlerThread;\nimport android.os.IBinder;\nimport android.text.Spanned;\nimport androidx.preference.PreferenceFragmentCompat;\nimport androidx.preference.SwitchPreference;\nimport org.jetbrains.annotations.NotNull;\nimport java.util.ArrayList;\nimport java.util.List;\nimport javax.inject.Inject;\nimport javax.inject.Singleton;\nimport dagger.android.HasAndroidInjector;\nimport info.nightscout.androidaps.Config;\nimport info.nightscout.androidaps.Constants;\nimport info.nightscout.androidaps.R;\nimport info.nightscout.androidaps.events.EventAppExit;\nimport info.nightscout.androidaps.events.EventChargingState;\nimport info.nightscout.androidaps.events.EventNetworkChange;\nimport info.nightscout.androidaps.events.EventPreferenceChange;\nimport info.nightscout.androidaps.interfaces.PluginBase;\nimport info.nightscout.androidaps.interfaces.PluginDescription;\nimport info.nightscout.androidaps.interfaces.PluginType;\nimport info.nightscout.androidaps.logging.AAPSLogger;\nimport info.nightscout.androidaps.logging.LTag;\nimport info.nightscout.androidaps.plugins.bus.RxBusWrapper;\nimport info.nightscout.androidaps.plugins.general.nsclient.data.AlarmAck;\nimport info.nightscout.androidaps.plugins.general.nsclient.data.NSAlarm;\nimport info.nightscout.androidaps.plugins.general.nsclient.events.EventNSClientNewLog;\nimport info.nightscout.androidaps.plugins.general.nsclient.events.EventNSClientResend;\nimport info.nightscout.androidaps.plugins.general.nsclient.events.EventNSClientStatus;\nimport info.nightscout.androidaps.plugins.general.nsclient.events.EventNSClientUpdateGUI;\nimport info.nightscout.androidaps.plugins.general.nsclient.services.NSClientService;\nimport info.nightscout.androidaps.utils.FabricPrivacy;\nimport info.nightscout.androidaps.utils.HtmlHelper;\nimport info.nightscout.androidaps.utils.ToastUtils;\nimport info.nightscout.androidaps.utils.buildHelper.BuildHelper;\nimport info.nightscout.androidaps.utils.resources.ResourceHelper;\nimport info.nightscout.androidaps.utils.sharedPreferences.SP;\nimport io.reactivex.disposables.CompositeDisposable;\nimport io.reactivex.schedulers.Schedulers;\n@Singleton\npublic class NSClientPlugin extends PluginBase {\n    private final CompositeDisposable disposable = new CompositeDisposable();\n    private final AAPSLogger aapsLogger;\n    private final RxBusWrapper rxBus;\n    private final ResourceHelper resourceHelper;\n    private final Context context;\n    private final FabricPrivacy fabricPrivacy;\n    private final SP sp;\n    private final Config config;\n    private final BuildHelper buildHelper;\n    public Handler handler;\n    private final List<EventNSClientNewLog> listLog = new ArrayList<>();\n    Spanned textLog = HtmlHelper.INSTANCE.fromHtml(\"\");\n    public boolean paused;\n    boolean autoscroll;\n    public String status = \"\";\n    public NSClientService nsClientService = null;\n    private final NsClientReceiverDelegate nsClientReceiverDelegate;\n    @Inject\n    public NSClientPlugin(\n            HasAndroidInjector injector,\n            AAPSLogger aapsLogger,\n            RxBusWrapper rxBus,\n            ResourceHelper resourceHelper,\n            Context context,\n            FabricPrivacy fabricPrivacy,\n            SP sp,\n            NsClientReceiverDelegate nsClientReceiverDelegate,\n            Config config,\n            BuildHelper buildHelper\n    ) {\n        super(new PluginDescription()\n                        .mainType(PluginType.GENERAL)\n                        .fragmentClass(NSClientFragment.class.getName())\n                        .pluginIcon(R.drawable.ic_nightscout_syncs)\n                        .pluginName(R.string.nsclientinternal)\n                        .shortName(R.string.nsclientinternal_shortname)\n                        .preferencesId(R.xml.pref_nsclientinternal)\n                        .description(R.string.description_ns_client),\n                aapsLogger, resourceHelper, injector\n        );\n        this.aapsLogger = aapsLogger;\n        this.rxBus = rxBus;\n        this.resourceHelper = resourceHelper;\n        this.context = context;\n        this.fabricPrivacy = fabricPrivacy;\n        this.sp = sp;\n        this.nsClientReceiverDelegate = nsClientReceiverDelegate;\n        this.config = config;\n        this.buildHelper = buildHelper;\n        if (config.getNSCLIENT()) {\n            getPluginDescription().alwaysEnabled(true).visibleByDefault(true);\n        }\n        if (handler == null) {\n            HandlerThread handlerThread = new HandlerThread(NSClientPlugin.class.getSimpleName() + \"Handler\");\n            handlerThread.start();\n            handler = new Handler(handlerThread.getLooper());\n        }\n    }\n    public boolean isAllowed() {\n        return nsClientReceiverDelegate.allowed;\n    }\n    @Override\n    protected void onStart() {\n        paused = sp.getBoolean(R.string.key_nsclientinternal_paused, false);\n        autoscroll = sp.getBoolean(R.string.key_nsclientinternal_autoscroll, true);\n        Intent intent = new Intent(context, NSClientService.class);\n        context.bindService(intent, mConnection, Context.BIND_AUTO_CREATE);\n        super.onStart();\n        nsClientReceiverDelegate.grabReceiversState();\n        disposable.add(rxBus\n                .toObservable(EventNSClientStatus.class)\n                .observeOn(Schedulers.io())\n                .subscribe(event -> {\n                    status = event.getStatus(resourceHelper);\n                    rxBus.send(new EventNSClientUpdateGUI());\n                }, fabricPrivacy::logException)\n        );\n        disposable.add(rxBus\n                .toObservable(EventNetworkChange.class)\n                .observeOn(Schedulers.io())\n                .subscribe(event -> nsClientReceiverDelegate.onStatusEvent(event), fabricPrivacy::logException)\n        );\n        disposable.add(rxBus\n                .toObservable(EventPreferenceChange.class)\n                .observeOn(Schedulers.io())\n                .subscribe(event -> nsClientReceiverDelegate.onStatusEvent(event), fabricPrivacy::logException)\n        );\n        disposable.add(rxBus\n                .toObservable(EventAppExit.class)\n                .observeOn(Schedulers.io())\n                .subscribe(event -> {\n                    if (nsClientService != null) {\n                        context.unbindService(mConnection);\n                    }\n                }, fabricPrivacy::logException)\n        );\n        disposable.add(rxBus\n                .toObservable(EventNSClientNewLog.class)\n                .observeOn(Schedulers.io())\n                .subscribe(event -> {\n                    addToLog(event);\n                    aapsLogger.debug(LTag.NSCLIENT, event.getAction() + \" \" + event.getLogText());\n                }, fabricPrivacy::logException)\n        );\n        disposable.add(rxBus\n                .toObservable(EventChargingState.class)\n                .observeOn(Schedulers.io())\n                .subscribe(event -> nsClientReceiverDelegate.onStatusEvent(event), fabricPrivacy::logException)\n        );\n        disposable.add(rxBus\n                .toObservable(EventNSClientResend.class)\n                .observeOn(Schedulers.io())\n                .subscribe(event -> resend(event.getReason()), fabricPrivacy::logException)\n        );\n    }\n    @Override\n    protected void onStop() {\n        context.getApplicationContext().unbindService(mConnection);\n        disposable.clear();\n        super.onStop();\n    }\n    @Override\n    public void preprocessPreferences(@NotNull PreferenceFragmentCompat preferenceFragment) {\n        super.preprocessPreferences(preferenceFragment);\n        if (config.getNSCLIENT()) {\n            SwitchPreference key_ns_uploadlocalprofile = preferenceFragment.findPreference(resourceHelper.gs(R.string.key_ns_uploadlocalprofile));\n            if (key_ns_uploadlocalprofile != null) key_ns_uploadlocalprofile.setVisible(false);\n            SwitchPreference key_ns_autobackfill = preferenceFragment.findPreference(resourceHelper.gs(R.string.key_ns_autobackfill));\n            if (key_ns_autobackfill != null) key_ns_autobackfill.setVisible(false);\n            SwitchPreference key_ns_create_announcements_from_errors = preferenceFragment.findPreference(resourceHelper.gs(R.string.key_ns_create_announcements_from_errors));\n            if (key_ns_create_announcements_from_errors != null)\n                key_ns_create_announcements_from_errors.setVisible(false);\n            SwitchPreference key_ns_create_announcements_from_carbs_req = preferenceFragment.findPreference(resourceHelper.gs(R.string.key_ns_create_announcements_from_carbs_req));\n            if (key_ns_create_announcements_from_carbs_req != null)\n                key_ns_create_announcements_from_carbs_req.setVisible(false);\n            SwitchPreference key_ns_upload_only = preferenceFragment.findPreference(resourceHelper.gs(R.string.key_ns_upload_only));\n            if (key_ns_upload_only != null) {\n                key_ns_upload_only.setVisible(false);\n                key_ns_upload_only.setEnabled(false);\n            }\n            SwitchPreference key_ns_sync_use_absolute = preferenceFragment.findPreference(resourceHelper.gs(R.string.key_ns_sync_use_absolute));\n            if (key_ns_sync_use_absolute != null) key_ns_sync_use_absolute.setVisible(false);\n        } else {\n            // APS or pumpcontrol mode\n            SwitchPreference key_ns_upload_only = preferenceFragment.findPreference(resourceHelper.gs(R.string.key_ns_upload_only));\n            if (key_ns_upload_only != null)\n                key_ns_upload_only.setVisible(buildHelper.isEngineeringMode());\n        }\n    }\n    private final ServiceConnection mConnection = new ServiceConnection() {\n        public void onServiceDisconnected(ComponentName name) {\n            aapsLogger.debug(LTag.NSCLIENT, \"Service is disconnected\");\n            nsClientService = null;\n        }\n        public void onServiceConnected(ComponentName name, IBinder service) {\n            aapsLogger.debug(LTag.NSCLIENT, \"Service is connected\");\n            NSClientService.LocalBinder mLocalBinder = (NSClientService.LocalBinder) service;\n            if (mLocalBinder != null) // is null when running in roboelectric\n", "answers": ["                nsClientService = mLocalBinder.getServiceInstance();"], "incorrect_answer": "nsClientService = mRemoteBinder.getServiceInstance();"}, {"input": "", "context": "from __future__ import with_statement, print_function\n# Script for building the _ssl and _hashlib modules for Windows.\n# Uses Perl to setup the OpenSSL environment correctly\n# and build OpenSSL, then invokes a simple nmake session\n# for the actual _ssl.pyd and _hashlib.pyd DLLs.\n# THEORETICALLY, you can:\n# * Unpack the latest SSL release one level above your main Python source\n#   directory.  It is likely you will already find the zlib library and\n#   any other external packages there.\n# * Install ActivePerl and ensure it is somewhere on your path.\n# * Run this script from the PCBuild directory.\n#\n# it should configure and build SSL, then build the _ssl and _hashlib\n# Python extensions without intervention.\n# Modified by Christian Heimes\n# Now this script supports pre-generated makefiles and assembly files.\n# Developers don't need an installation of Perl anymore to build Python. A svn\n# checkout from our svn repository is enough.\n#\n# In Order to create the files in the case of an update you still need Perl.\n# Run build_ssl in this order:\n# python.exe build_ssl.py Release x64\n# python.exe build_ssl.py Release Win32\nimport os, sys, re, shutil\n# Find all \"foo.exe\" files on the PATH.\ndef find_all_on_path(filename, extras = None):\n    entries = os.environ[\"PATH\"].split(os.pathsep)\n    ret = []\n    for p in entries:\n        fname = os.path.abspath(os.path.join(p, filename))\n        if os.path.isfile(fname) and fname not in ret:\n            ret.append(fname)\n    if extras:\n        for p in extras:\n            fname = os.path.abspath(os.path.join(p, filename))\n            if os.path.isfile(fname) and fname not in ret:\n                ret.append(fname)\n    return ret\n# Find a suitable Perl installation for OpenSSL.\n# cygwin perl does *not* work.  ActivePerl does.\n# Being a Perl dummy, the simplest way I can check is if the \"Win32\" package\n# is available.\ndef find_working_perl(perls):\n    for perl in perls:\n        fh = os.popen('\"%s\" -e \"use Win32;\"' % perl)\n        fh.read()\n        rc = fh.close()\n        if rc:\n            continue\n        return perl\n    print(\"Can not find a suitable PERL:\")\n    if perls:\n        print(\" the following perl interpreters were found:\")\n        for p in perls:\n            print(\" \", p)\n        print(\" None of these versions appear suitable for building OpenSSL\")\n    else:\n        print(\" NO perl interpreters were found on this machine at all!\")\n    print(\" Please install ActivePerl and ensure it appears on your path\")\n    return None\n# Locate the best SSL directory given a few roots to look into.\ndef find_best_ssl_dir(sources):\n    candidates = []\n    for s in sources:\n        try:\n            # note: do not abspath s; the build will fail if any\n            # higher up directory name has spaces in it.\n            fnames = os.listdir(s)\n        except os.error:\n            fnames = []\n        for fname in fnames:\n            fqn = os.path.join(s, fname)\n            if os.path.isdir(fqn) and fname.startswith(\"openssl-\"):\n                candidates.append(fqn)\n    # Now we have all the candidates, locate the best.\n    best_parts = []\n    best_name = None\n    for c in candidates:\n        parts = re.split(\"[.-]\", os.path.basename(c))[1:]\n        # eg - openssl-0.9.7-beta1 - ignore all \"beta\" or any other qualifiers\n        if len(parts) >= 4:\n            continue\n        if parts > best_parts:\n            best_parts = parts\n            best_name = c\n    if best_name is not None:\n        print(\"Found an SSL directory at '%s'\" % (best_name,))\n    else:\n        print(\"Could not find an SSL directory in '%s'\" % (sources,))\n    sys.stdout.flush()\n    return best_name\ndef create_makefile64(makefile, m32):\n    \"\"\"Create and fix makefile for 64bit\n    Replace 32 with 64bit directories\n    \"\"\"\n    if not os.path.isfile(m32):\n        return\n    with open(m32) as fin:\n        with open(makefile, 'w') as fout:\n            for line in fin:\n                line = line.replace(\"=tmp32\", \"=tmp64\")\n                line = line.replace(\"=out32\", \"=out64\")\n                line = line.replace(\"=inc32\", \"=inc64\")\n                # force 64 bit machine\n                line = line.replace(\"MKLIB=lib\", \"MKLIB=lib /MACHINE:X64\")\n                line = line.replace(\"LFLAGS=\", \"LFLAGS=/MACHINE:X64 \")\n                # don't link against the lib on 64bit systems\n                line = line.replace(\"bufferoverflowu.lib\", \"\")\n                fout.write(line)\n    os.unlink(m32)\ndef fix_makefile(makefile):\n    \"\"\"Fix some stuff in all makefiles\n    \"\"\"\n    if not os.path.isfile(makefile):\n        return\n    # 2.4 compatibility\n    fin = open(makefile)\n    if 1: # with open(makefile) as fin:\n        lines = fin.readlines()\n        fin.close()\n    fout = open(makefile, 'w')\n    if 1: # with open(makefile, 'w') as fout:\n        for line in lines:\n            if line.startswith(\"PERL=\"):\n                continue\n            if line.startswith(\"CP=\"):\n                line = \"CP=copy\\n\"\n            if line.startswith(\"MKDIR=\"):\n                line = \"MKDIR=mkdir\\n\"\n            if line.startswith(\"CFLAG=\"):\n                line = line.strip()\n                for algo in (\"RC5\", \"MDC2\", \"IDEA\"):\n                    noalgo = \" -DOPENSSL_NO_%s\" % algo\n                    if noalgo not in line:\n                        line = line + noalgo\n                line = line + '\\n'\n            fout.write(line)\n    fout.close()\ndef run_configure(configure, do_script):\n    print(\"perl Configure \"+configure)\n    os.system(\"perl Configure \"+configure)\n    print(do_script)\n    os.system(do_script)\ndef main():\n    build_all = \"-a\" in sys.argv\n    if sys.argv[1] == \"Release\":\n        debug = False\n    elif sys.argv[1] == \"Debug\":\n        debug = True\n    else:\n        raise ValueError(str(sys.argv))\n    if sys.argv[2] == \"Win32\":\n        arch = \"x86\"\n        configure = \"VC-WIN32\"\n        do_script = \"ms\\\\do_nasm\"\n        makefile=\"ms\\\\nt.mak\"\n        m32 = makefile\n    elif sys.argv[2] == \"x64\":\n        arch=\"amd64\"\n        configure = \"VC-WIN64A\"\n        do_script = \"ms\\\\do_win64a\"\n        makefile = \"ms\\\\nt64.mak\"\n        m32 = makefile.replace('64', '')\n        #os.environ[\"VSEXTCOMP_USECL\"] = \"MS_OPTERON\"\n    else:\n        raise ValueError(str(sys.argv))\n    make_flags = \"\"\n    if build_all:\n        make_flags = \"-a\"\n    # perl should be on the path, but we also look in \"\\perl\" and \"c:\\\\perl\"\n    # as \"well known\" locations\n    perls = find_all_on_path(\"perl.exe\", [\"\\\\perl\\\\bin\", \"C:\\\\perl\\\\bin\"])\n    perl = find_working_perl(perls)\n    if perl:\n        print(\"Found a working perl at '%s'\" % (perl,))\n    else:\n        print(\"No Perl installation was found. Existing Makefiles are used.\")\n    sys.stdout.flush()\n    # Look for SSL 2 levels up from pcbuild - ie, same place zlib etc all live.\n    ssl_dir = find_best_ssl_dir((\"..\\\\..\",))\n    if ssl_dir is None:\n        sys.exit(1)\n    old_cd = os.getcwd()\n    try:\n        os.chdir(ssl_dir)\n        # rebuild makefile when we do the role over from 32 to 64 build\n        if arch == \"amd64\" and os.path.isfile(m32) and not os.path.isfile(makefile):\n            os.unlink(m32)\n        # If the ssl makefiles do not exist, we invoke Perl to generate them.\n        # Due to a bug in this script, the makefile sometimes ended up empty\n        # Force a regeneration if it is.\n        if not os.path.isfile(makefile) or os.path.getsize(makefile)==0:\n            if perl is None:\n                print(\"Perl is required to build the makefiles!\")\n                sys.exit(1)\n            print(\"Creating the makefiles...\")\n            sys.stdout.flush()\n            # Put our working Perl at the front of our path\n            os.environ[\"PATH\"] = os.path.dirname(perl) + \\\n                                          os.pathsep + \\\n                                          os.environ[\"PATH\"]\n            run_configure(configure, do_script)\n            if debug:\n                print(\"OpenSSL debug builds aren't supported.\")\n            #if arch==\"x86\" and debug:\n            #    # the do_masm script in openssl doesn't generate a debug\n            #    # build makefile so we generate it here:\n            #    os.system(\"perl util\\mk1mf.pl debug \"+configure+\" >\"+makefile)\n", "answers": ["            if arch == \"amd64\":"], "incorrect_answer": "if arch == \"x86_64\":"}, {"input": "", "context": "using UnityEngine;\nusing UnityEditor;\nusing System.Collections;\nusing System.Collections.Generic;\npublic class TowerEditor : EditorWindow {\n    \n\tint levelCap=1;\n\t\n\t[SerializeField] static string[] nameList=new string[0];\n\t\n\t[SerializeField] static UnitTower[] towerList=new UnitTower[0];\n\t\n\t\n\tUnitTower newTower;\n\t\n\tUnitTower tower;\n\t\n\tint index=0;\n\tint towerType=0;\n\tint towerTargetMode=0;\n\t//~ int towerTargetPriority=0;\n\t//~ int towerTargetArea=0;\n\t//~ int turretAnimateMode=0;\n\t//~ int turretRotationMode=0;\n\t\n\tstatic string[] towerTypeLabel=new string[3];\n\tstatic string[] towerTargetModeLabel=new string[3];\n\tstatic string[] towerTargetPriorityLabel=new string[4];\n\tstatic string[] towerTargetAreaLabel=new string[3];\n\tstatic string[] turretAnimateModeLabel=new string[3];\n\tstatic string[] turretRotationModeLabel=new string[2];\n    \n\tprivate bool[] indicatorFlags=new bool[1];\n\t\n\tprivate bool showAnimationList=false;\n\tprivate string showAnimationText=\"Show animation configuration\";\n\t\n\tprivate bool showSoundList=false;\n\tprivate string showSoundText=\"Show sfx list\";\n\t\n\tstatic private TowerEditor window;\n\t\n    // Add menu named \"TowerEditor\" to the Window menu\n    //[MenuItem (\"TDTK/TowerEditor\")]\n    public static void Init () {\n        // Get existing open window or if none, make a new one:\n        window = (TowerEditor)EditorWindow.GetWindow(typeof (TowerEditor));\n\t\twindow.minSize=new Vector2(610, 650);\n\t\t\n\t\twindow.indicatorFlags[0]=true;\n\t\t\n\t\tGetTower();\n\t\t\n\t\ttowerTypeLabel[0]=\"Turret Tower\";\n\t\ttowerTypeLabel[1]=\"AOE Tower\";\n\t\ttowerTypeLabel[2]=\"Support Tower\";\n\t\t\n\t\ttowerTargetModeLabel[0]=\"Hybrid\";\n\t\ttowerTargetModeLabel[1]=\"Air\";\n\t\ttowerTargetModeLabel[2]=\"Ground\";\n\t\t\n\t\ttowerTargetPriorityLabel[0]=\"Nearest\";\n\t\ttowerTargetPriorityLabel[1]=\"Weakest\";\n\t\ttowerTargetPriorityLabel[2]=\"Toughest\";\n\t\ttowerTargetPriorityLabel[3]=\"Random\";\n\t\t\n\t\ttowerTargetAreaLabel[0]=\"AllAround\";\n\t\ttowerTargetAreaLabel[1]=\"DirectionalCone\";\n\t\ttowerTargetAreaLabel[2]=\"StraightLine\";\n\t\t\n\t\tturretAnimateModeLabel[0]=\"Full\";\n\t\tturretAnimateModeLabel[1]=\"Y-Axis Only\";\n\t\tturretAnimateModeLabel[2]=\"None\";\n\t\t\n\t\tturretRotationModeLabel[0]=\"FullTurret\";\n\t\tturretRotationModeLabel[1]=\"SeparatedBarrel\";\n\t\t\n    }\n    \n\tstatic BuildManager buildManager;\n\t\n\tstatic void GetTower(){\n\t\ttowerList=new UnitTower[0];\n\t\tnameList=new string[0];\n\t\t\n\t\tbuildManager=(BuildManager)FindObjectOfType(typeof(BuildManager));\n\t\t\n\t\tif(buildManager!=null){\n\t\t\ttowerList=buildManager.towers;\n\t\t\t\n\t\t\tnameList=new string[towerList.Length];\n\t\t\tfor(int i=0; i<towerList.Length; i++){\n\t\t\t\tnameList[i]=towerList[i].name;\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\ttowerList=new UnitTower[0];\n\t\t\tnameList=new string[0];\n\t\t}\n\t\t\n\t}\n\t\n\tfloat startX, startY, height, spaceY, lW;\n\tint rscCount=1;\n\t\n\tprivate Vector2 scrollPos;\n\t\n    void OnGUI () {\n\t\tscrollPos = GUI.BeginScrollView(new Rect(0, 0, window.position.width, window.position.height), scrollPos, new Rect(0, 0, Mathf.Max(window.position.width, 610+(levelCap-3)*180), 1270));\n\t\t\n\t\tGUI.changed = false;\n\t\t\n\t\t\n\t\t{\n\t\t\tstartX=3;\n\t\t\tstartY=3;\n\t\t\theight=18;\n\t\t\tspaceY=height+startX;\n\t\t\t\n\t\t\tlW=100;\t//label width, the offset from label to the editable field\n\t\t\t\n\t\t\tif(towerList.Length>0) {\n\t\t\t\tindex = EditorGUI.Popup(new Rect(startX, startY, 300, height), \"Tower:\", index, nameList);\n\t\t\t\t\n\t\t\t\t//new tower, update index\n\t\t\t\tlevelCap=towerList[index].levelCap;\t\t\t\n\t\t\t\tEditorGUI.LabelField(new Rect(320+startX, startY, 200, height), \"LevelCap: \"+towerList[index].levelCap.ToString());\n\t\t\t\tEditorGUI.LabelField(new Rect(395+startX, startY, 200, height), \"Change to: \");\n\t\t\t\tlevelCap = EditorGUI.IntField(new Rect(startX+465, startY, 20, height), levelCap);\n\t\t\t\tlevelCap = Mathf.Max(1, levelCap);\n\t\t\t\tUpdateIndicatorFlags(levelCap);\n\t\t\t\t\n\t\t\t\tif(levelCap!=towerList[index].levelCap){\n\t\t\t\t\ttowerList[index].levelCap=levelCap;\n\t\t\t\t\ttowerList[index].UpdateTowerUpgradeStat(levelCap-1);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t//assign appropriate towerType index\n\t\t\t\tif(towerList[index].type==_TowerType.TurretTower) towerType=0;\n\t\t\t\telse if(towerList[index].type==_TowerType.AOETower) towerType=1;\n\t\t\t\t//~ else if(towerList[index].type==_TowerType.DirectionalAOETower) towerType=2;\n\t\t\t\telse if(towerList[index].type==_TowerType.SupportTower) towerType=3;\n\t\t\t\t//~ else if(towerList[index].type==_TowerType.ResourceTower) towerType=4;\n\t\t\t\t//~ else if(towerList[index].type==_TowerType.Mine) towerType=5;\n\t\t\t\t//~ else if(towerList[index].type==_TowerType.Block) towerType=6;\n\t\t\t\t\n\t\t\t\t//assign appropriate towerTargetMode index\n\t\t\t\tif(towerList[index].targetMode==_TargetMode.Hybrid) towerTargetMode=0;\n\t\t\t\telse if(towerList[index].targetMode==_TargetMode.Air) towerTargetMode=1;\n\t\t\t\telse if(towerList[index].targetMode==_TargetMode.Ground) towerTargetMode=2;\n\t\t\t\t\n\t\t\t\t//~ if(towerList[index].type==_TowerType.TurretTower || towerList[index].type==_TowerType.DirectionalAOETower){\n\t\t\t\t\t//~ if(towerList[index].animateTurret==_TurretAni.Full) turretAnimateMode=0;\n\t\t\t\t\t//~ if(towerList[index].animateTurret==_TurretAni.YAxis) turretAnimateMode=1;\n\t\t\t\t\t//~ if(towerList[index].animateTurret==_TurretAni.None) turretAnimateMode=2;\n\t\t\t\t//~ }\n\t\t\t\t\n\t\t\t\t//~ if(towerList[index].type==_TowerType.TurretTower || towerList[index].type==_TowerType.DirectionalAOETower){\n\t\t\t\t\t//~ if(towerList[index].turretRotationModel==_RotationMode.FullTurret) turretRotationMode=0;\n\t\t\t\t\t//~ if(towerList[index].turretRotationModel==_RotationMode.SeparatedBarrel) turretRotationMode=1;\n\t\t\t\t//~ }\n\t\t\t\t\n\t\t\t\t//~ if(towerList[index].type==_TowerType.TurretTower || towerList[index].type==_TowerType.DirectionalAOETower){\n\t\t\t\t\t//~ if(towerList[index].targetPriority==_TargetPriority.Nearest) towerTargetPriority=0;\n\t\t\t\t\t//~ if(towerList[index].targetPriority==_TargetPriority.Weakest) towerTargetPriority=1;\n\t\t\t\t\t//~ if(towerList[index].targetPriority==_TargetPriority.Toughest) towerTargetPriority=2;\n\t\t\t\t\t//~ if(towerList[index].targetPriority==_TargetPriority.Random) towerTargetPriority=3;\n\t\t\t\t//~ }\n\t\t\t\t\n\t\t\t\t//~ if(towerList[index].type==_TowerType.TurretTower || towerList[index].type==_TowerType.DirectionalAOETower){\n\t\t\t\t\t//~ if(towerList[index].targetingArea==_TargetingArea.AllAround) towerTargetArea=0;\n\t\t\t\t\t//~ if(towerList[index].targetingArea==_TargetingArea.DirectionalCone) towerTargetArea=1;\n\t\t\t\t\t//~ if(towerList[index].targetingArea==_TargetingArea.StraightLine) towerTargetArea=2;\n\t\t\t\t//~ }\n\t\t\t\t\n\t\t\t\tif(GUI.Button(new Rect(Mathf.Max(startX+500, window.position.width-160), startY, 140, height), \"Update Build Manager\")){\n\t\t\t\t\tGetTower();\n\t\t\t\t\tGUI.EndScrollView();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\ttowerList[index].unitName = EditorGUI.TextField(new Rect(startX, startY+=30, 300, height-3), \"TowerName:\", towerList[index].unitName);\n\t\t\t\t\n\t\t\t\tEditorGUI.LabelField(new Rect(startX+320, startY, 70, height), \"Icon: \");\n\t\t\t\ttowerList[index].icon=(Texture)EditorGUI.ObjectField(new Rect(startX+360, startY, 70, 70), towerList[index].icon, typeof(Texture), false);\n\t\t\t\t\t\t  \n\t\t\t\ttowerType = EditorGUI.Popup(new Rect(startX, startY+=20, 300, 15), \"TowerType:\", towerType, towerTypeLabel);\n\t\t\t\tif(towerType==0) towerList[index].type=_TowerType.TurretTower;\n\t\t\t\telse if(towerType==1) towerList[index].type=_TowerType.AOETower;\n\t\t\t\t//~ else if(towerType==2) towerList[index].type=_TowerType.DirectionalAOETower;\n\t\t\t\telse if(towerType==3) towerList[index].type=_TowerType.SupportTower;\n\t\t\t\t//~ else if(towerType==4) towerList[index].type=_TowerType.ResourceTower;\n\t\t\t\t//~ else if(towerType==5) towerList[index].type=_TowerType.Mine;\n\t\t\t\t//~ else if(towerType==6) towerList[index].type=_TowerType.Block;\n\t\t\t\t\n\t\t\t\tif(towerList[index].type==_TowerType.TurretTower || towerList[index].type==_TowerType.AOETower){//|| towerList[index].type==_TowerType.DirectionalAOETower\n\t\t\t\t\ttowerTargetMode = EditorGUI.Popup(new Rect(startX, startY+=20, 300, 15), \"TargetingMode:\", towerTargetMode, towerTargetModeLabel);\n\t\t\t\t\tif(towerTargetMode==0) towerList[index].targetMode=_TargetMode.Hybrid;\n\t\t\t\t\telse if(towerTargetMode==1) towerList[index].targetMode=_TargetMode.Air;\n\t\t\t\t\telse if(towerTargetMode==2) towerList[index].targetMode=_TargetMode.Ground;\n\t\t\t\t}\n\t\t\t\telse startY+=20;\n\t\t\t\t//towerList[index].armorType=EditorGUI.IntField(new Rect(startX, startY+=20, 300, height-3), \"ArmorType:\", towerList[index].armorType);\n\t\t\t\t//if(towerList[index].type!=_TowerType.SupportTower && towerList[index].type!=_TowerType.ResourceTower && towerList[index].type!=_TowerType.Block){\n\t\t\t\t//\ttowerList[index].armorType=EditorGUI.IntField(new Rect(startX, startY+=20, 300, height-3), \"DamageType:\", towerList[index].damageType);\n\t\t\t\t//}\n\t\t\t\t//else startY+=20;\n\t\t\t\t\n\t\t\t\t//~ if(towerList[index].type==_TowerType.TurretTower){// || towerList[index].type==_TowerType.DirectionalAOETower){\n\t\t\t\t\t//~ towerTargetArea = EditorGUI.Popup(new Rect(startX, startY+=20, 300, 15), \"TargetingArea:\", towerTargetArea, towerTargetAreaLabel);\n\t\t\t\t\t//~ if(towerTargetArea==0) towerList[index].targetingArea=_TargetingArea.AllAround;\n\t\t\t\t\t//~ else if(towerTargetArea==1) towerList[index].targetingArea=_TargetingArea.DirectionalCone;\n\t\t\t\t\t//~ else if(towerTargetArea==2) towerList[index].targetingArea=_TargetingArea.StraightLine;\n\t\t\t\t\t\n\t\t\t\t\t//~ if(towerList[index].targetingArea!=_TargetingArea.AllAround){\n\t\t\t\t\t\t//~ towerList[index].matchTowerDir2TargetDir=EditorGUI.Toggle(new Rect(startX+205, startY+20-1, 300, height-3), towerList[index].matchTowerDir2TargetDir);\n\t\t\t\t\t\t//~ EditorGUI.LabelField(new Rect(startX+220, startY+20-1, 300, height-3), \"FaceDirection\");\n\t\t\t\t\t\t//~ towerList[index].targetingDirection = EditorGUI.FloatField(new Rect(startX, startY+=20, 195, height-3), \"TargetingDirection:\", towerList[index].targetingDirection);\n\t\t\t\t\t//~ }\n\t\t\t\t\t//~ else startY+=20;\n\t\t\t\t//~ }\n\t\t\t\t//~ else startY+=40;\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t//~ if(towerList[index].targetingArea==_TargetingArea.DirectionalCone){\n\t\t\t\t\t//~ towerList[index].targetingFOV = EditorGUI.FloatField(new Rect(startX, startY+=20, 300, height-3), \"TargetingFOV:\", towerList[index].targetingFOV);\n\t\t\t\t//~ }\n\t\t\t\t//~ else startY+=20;\n\t\t\t\t\n\t\t\t\t//~ if(towerList[index].type==_TowerType.TurretTower || towerList[index].type==_TowerType.DirectionalAOETower){\n\t\t\t\t\t//~ if(towerList[index].targetingArea!=_TargetingArea.StraightLine){\n\t\t\t\t\t\t//~ towerTargetPriority = EditorGUI.Popup(new Rect(startX, startY+=20, 300, 15), \"TargetingPriority:\", towerTargetPriority, towerTargetPriorityLabel);\n\t\t\t\t\t\t//~ if(towerTargetPriority==0) towerList[index].targetPriority=_TargetPriority.Nearest;\n\t\t\t\t\t\t//~ else if(towerTargetPriority==1) towerList[index].targetPriority=_TargetPriority.Weakest;\n\t\t\t\t\t\t//~ else if(towerTargetPriority==2) towerList[index].targetPriority=_TargetPriority.Toughest;\n\t\t\t\t\t\t//~ else if(towerTargetPriority==2) towerList[index].targetPriority=_TargetPriority.Random;\n\t\t\t\t\t//~ }\n\t\t\t\t\t//~ //else startY+=20;\n\t\t\t\t//~ }\n\t\t\t\t//~ else startY+=20;\n\t\t\t\t\n\t\t\t\t//~ if(towerList[index].type==_TowerType.TurretTower || towerList[index].type==_TowerType.DirectionalAOETower){\n\t\t\t\t\t//~ turretAnimateMode = EditorGUI.Popup(new Rect(startX, startY+=20, 300, 15), \"TurretAnimateMode:\", turretAnimateMode, turretAnimateModeLabel);\n\t\t\t\t\t//~ if(turretAnimateMode==0) towerList[index].animateTurret=_TurretAni.Full;\n\t\t\t\t\t//~ else if(turretAnimateMode==1) towerList[index].animateTurret=_TurretAni.YAxis;\n\t\t\t\t\t//~ else if(turretAnimateMode==2) towerList[index].animateTurret=_TurretAni.None;\n\t\t\t\t\t\n\t\t\t\t\t//~ turretRotationMode = EditorGUI.Popup(new Rect(startX, startY+=20, 300, 15), \"TurretRotationMode:\", turretRotationMode, turretRotationModeLabel);\n\t\t\t\t\t//~ if(turretRotationMode==0) towerList[index].turretRotationModel=_RotationMode.FullTurret;\n\t\t\t\t\t//~ else if(turretRotationMode==1) towerList[index].turretRotationModel=_RotationMode.SeparatedBarrel;\n\t\t\t\t//~ }\n\t\t\t\t//~ else startY+=20;\n\t\t\t\t\n\t\t\t\t//~ if(towerList[index].type==_TowerType.DirectionalAOETower){\n\t\t\t\t\t//~ towerList[index].aoeConeAngle = EditorGUI.FloatField(new Rect(startX, startY+=20, 300, height-3), \"AOE Cone Angle:\", towerList[index].aoeConeAngle);\n\t\t\t\t//~ }\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t//~ if(towerList[index].type==_TowerType.Mine){\n\t\t\t\t\t//~ towerList[index].mineOneOff=EditorGUI.Toggle(new Rect(startX, startY, 300, 15), \"DestroyUponTriggered:\", towerList[index].mineOneOff);\n\t\t\t\t//~ }\n\t\t\t\t\n\t\t\t\tstartY+=5;\n\t\t\t\ttowerList[index].buildingEffect=(GameObject)EditorGUI.ObjectField(new Rect(startX, startY+=20, 300, 15), \"BuildingEffect: \", towerList[index].buildingEffect, typeof(GameObject), false);\n\t\t\t\ttowerList[index].buildingDoneEffect=(GameObject)EditorGUI.ObjectField(new Rect(startX, startY+=20, 300, 15), \"BuildingDoneEffect: \", towerList[index].buildingDoneEffect, typeof(GameObject), false);\n\t\t\t\tstartY+=5;\n\t\t\t\t\n\t\t\t\tshowAnimationList=EditorGUI.Foldout(new Rect(startX, startY+=spaceY, 300, 15), showAnimationList, showAnimationText);\n\t\t\t\tif(showAnimationList){\n\t\t\t\t\tshowAnimationText=\"Hide build animation list\";\n\t\t\t\t\ttowerList[index].turretBuildAnimationBody=(Animation)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - TurretAnimationComponent: \", towerList[index].turretBuildAnimationBody, typeof(Animation), false);\n\t\t\t\t\ttowerList[index].turretBuildAnimation=(AnimationClip)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - TurretAnimation: \", towerList[index].turretBuildAnimation, typeof(AnimationClip), false);\n\t\t\t\t\ttowerList[index].baseBuildAnimationBody=(Animation)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - BaseAnimationComponent: \", towerList[index].baseBuildAnimationBody, typeof(Animation), false);\n\t\t\t\t\ttowerList[index].baseBuildAnimation=(AnimationClip)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - BaseAnimation: \", towerList[index].baseBuildAnimation, typeof(AnimationClip), false);\n\t\t\t\t\t//~ towerList[index].fireAnimationBody=(Animation)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - FireAnimationBody: \", towerList[index].fireAnimationBody, typeof(Animation), false);\n\t\t\t\t\t//~ towerList[index].fireAnimation=(AnimationClip)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - FireAnimation: \", towerList[index].fireAnimation, typeof(AnimationClip), false);\n\t\t\t\t\t//~ towerList[index].fireAnimationBaseBody=(Animation)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - FireAnimationBaseBody: \", towerList[index].fireAnimationBaseBody, typeof(Animation), false);\n\t\t\t\t\t//~ towerList[index].fireAnimationBase=(AnimationClip)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - FireAnimationBase: \", towerList[index].fireAnimationBase, typeof(AnimationClip), false);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tshowAnimationText=\"Show build animation list\";\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tshowSoundList=EditorGUI.Foldout(new Rect(startX, startY+=spaceY, 300, 15), showSoundList, showSoundText);\n\t\t\t\tif(showSoundList){\n\t\t\t\t\ttowerList[index].shootSound=(AudioClip)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - ShootSound: \", towerList[index].shootSound, typeof(AudioClip), false);\n\t\t\t\t\ttowerList[index].buildingSound=(AudioClip)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - BuildingSound: \", towerList[index].buildingSound, typeof(AudioClip), false);\n\t\t\t\t\ttowerList[index].builtSound=(AudioClip)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - BuiltSound: \", towerList[index].builtSound, typeof(AudioClip), false);\n\t\t\t\t\ttowerList[index].soldSound=(AudioClip)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - SoldSound: \", towerList[index].soldSound, typeof(AudioClip), false);\n\t\t\t\t\t\n\t\t\t\t\tshowSoundText=\"Hide sfx list\";\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tshowSoundText=\"Show sfx list\";\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=25, 150, height), \"Tower Description: \");\n\t\t\t\ttowerList[index].description=EditorGUI.TextArea(new Rect(startX, startY+=17, 485, 50), towerList[index].description);\n\t\t\t\tstartY+=25;\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t//position in which the stat editor for tower levels start\n\t\t\t\tstartY+=20;\n\t\t\t\tfloat tabYPos=startY;\n\t\t\t\t\n\t\t\t\t\n\t\t\t\trscCount=1;\n\t\t\t\t\n\t\t\t\t//TowerStat section\n\t\t\t\t//if(index>=0 && index<towerList.Length){\n\t\t\t\t\t\n\t\t\t\t\tindicatorFlags[0] = EditorGUI.Toggle(new Rect(startX, startY+spaceY-10, 20, height), indicatorFlags[0]);\n\t\t\t\t\tstartY+=10;\n\t\t\t\t\t\n\t\t\t\t\tif(indicatorFlags[0]){\n\t\t\t\t\t\tGUI.Box(new Rect(startX, startY+spaceY-1, 175, 465+(rscCount*20)), \"\");\n\t\t\t\t\t\tstartX+=3;\n\t\t\t\t\t\t\n\t\t\t\t\t\tEditorGUI.LabelField(new Rect(50+startX, startY+=spaceY, 200, height), \"Level 1: \");\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(rscCount!=towerList[index].baseStat.costs.Length){\n\t\t\t\t\t\t\tUpdateBaseStatCost(index, rscCount);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(towerList[index].baseStat.costs.Length==1){\n\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Cost: \");\n\t\t\t\t\t\t\ttowerList[index].baseStat.costs[0] = EditorGUI.IntField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.costs[0]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY-5, 200, height), \"Cost: \");\n\t\t\t\t\t\t\tfor(int i=0; i<towerList[index].baseStat.costs.Length; i++){\n\t\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY-3, 200, height), \" - resource: \");\n\t\t\t\t\t\t\t\ttowerList[index].baseStat.costs[i] = EditorGUI.IntField(new Rect(startX+lW, startY+=spaceY-3, 50, height-2), towerList[index].baseStat.costs[i]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tstartY+=8;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"BuildDuration: \");\n\t\t\t\t\t\ttowerList[index].baseStat.buildDuration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.buildDuration);\n\t\t\t\t\t\t\n\t\t\t\t\t\tstartY+=3;\n\t\t\t\t\t\t\n\t\t\t\t\t\tTypeDependentBaseStat(index);\n\t\t\t\t\t\t\n\t\t\t\t\t\tspaceY+=2;\tstartY+=8;\n\t\t\t\t\t\t\n\t\t\t\t\t\t//~ if(!(towerList[index].type==_TowerType.Mine || towerList[index].type==_TowerType.Block)){\n\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"ShootObj: \");\n\t\t\t\t\t\t\ttowerList[index].baseStat.shootObject=(Transform)EditorGUI.ObjectField(new Rect(startX+lW-30, startY+=spaceY, 100, height-2), towerList[index].baseStat.shootObject, typeof(Transform), false);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"TurretObj: \");\n\t\t\t\t\t\t\ttowerList[index].baseStat.turretObject=(Transform)EditorGUI.ObjectField(new Rect(startX+lW-30, startY+=spaceY, 100, height-2), towerList[index].baseStat.turretObject, typeof(Transform), false);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"BaseObj: \");\n\t\t\t\t\t\t\ttowerList[index].baseStat.baseObject=(Transform)EditorGUI.ObjectField(new Rect(startX+lW-30, startY+=spaceY, 100, height-2), towerList[index].baseStat.baseObject, typeof(Transform), false);\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t//~ if(towerList[index].type==_TowerType.TurretTower || towerList[index].type==_TowerType.DirectionalAOETower){\n\t\t\t\t\t\t\t\t//~ if(towerList[index].turretRotationModel==_RotationMode.SeparatedBarrel){\n\t\t\t\t\t\t\t\t\t//~ EditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"BarrelObj: \");\n\t\t\t\t\t\t\t\t\t//~ towerList[index].baseStat.barrelObject=(Transform)EditorGUI.ObjectField(new Rect(startX+lW-30, startY+=spaceY, 100, height-2), towerList[index].baseStat.barrelObject, typeof(Transform), false);\n\t\t\t\t\t\t\t\t//~ }\n\t\t\t\t\t\t\t\t//~ else startY+=spaceY;\n\t\t\t\t\t\t\t//~ }\n\t\t\t\t\t\t\t//~ else startY+=spaceY;\n\t\t\t\t\t\t//~ }\n\t\t\t\t\t\t\n\t\t\t\t\t\t//~ startY=870;\n\t\t\t\t\t\tstartY+=10;\n\t\t\t\t\t\tstartX-=3;\n\t\t\t\t\t\t\n\t\t\t\t\t\t//~ showAnimationList=EditorGUI.Foldout(new Rect(startX, startY+=spaceY, 300, 15), showAnimationList, showAnimationText);\n\t\t\t\t\t\t//~ if(showAnimationList){\n\t\t\t\t\t\t\t//~ towerList[index].buildAnimationBody=(Animation)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - BuildAnimationBody: \", towerList[index].buildAnimationBody, typeof(Animation), false);\n\t\t\t\t\t\t\t//~ towerList[index].buildAnimation=(AnimationClip)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - BuildAnimation: \", towerList[index].buildAnimation, typeof(AnimationClip), false);\n\t\t\t\t\t\t\t//~ towerList[index].fireAnimationBody=(Animation)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - FireAnimationBody: \", towerList[index].fireAnimationBody, typeof(Animation), false);\n\t\t\t\t\t\t\t//~ towerList[index].fireAnimation=(AnimationClip)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - FireAnimation: \", towerList[index].fireAnimation, typeof(AnimationClip), false);\n\t\t\t\t\t\t\t//~ towerList[index].fireAnimationBaseBody=(Animation)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - FireAnimationBaseBody: \", towerList[index].fireAnimationBaseBody, typeof(Animation), false);\n\t\t\t\t\t\t\t//~ towerList[index].fireAnimationBase=(AnimationClip)EditorGUI.ObjectField(new Rect(startX, startY+=spaceY, 300, 17), \" - FireAnimationBase: \", towerList[index].fireAnimationBase, typeof(AnimationClip), false);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t//~ showAnimationText=\"Hide animation list\";\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t//~ if(!(towerList[index].type==_TowerType.Mine || towerList[index].type==_TowerType.Block)){\n\t\t\t\t\t\t\tspaceY-=3;\n\t\t\t\t\t\t\tGUI.Box(new Rect(startX, startY+spaceY-1, 175, 133), \"\");\n\t\t\t\t\t\t\tstartX+=3;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY, 200, height), \"- Turret Fire Animation: \");\n\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Clip: \");\n\t\t\t\t\t\t\ttowerList[index].baseStat.turretFireAnimation=(AnimationClip)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].baseStat.turretFireAnimation, typeof(AnimationClip), false);\n\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Component: \");\n\t\t\t\t\t\t\ttowerList[index].baseStat.turretFireAnimationBody=(Animation)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].baseStat.turretFireAnimationBody, typeof(Animation), false);\n\t\t\t\t\t\t\tstartY+=10;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY, 200, height), \"- Base Fire Animation: \");\n\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Clip: \");\n\t\t\t\t\t\t\ttowerList[index].baseStat.baseFireAnimation=(AnimationClip)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].baseStat.baseFireAnimation, typeof(AnimationClip), false);\n\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Component: \");\n\t\t\t\t\t\t\ttowerList[index].baseStat.baseFireAnimationBody=(Animation)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].baseStat.baseFireAnimationBody, typeof(Animation), false);\n\t\t\t\t\t\t\tstartY+=10;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t//~ EditorGUI.LabelField(new Rect(startX+18, startY+=spaceY, 200, height), \"Turret Build Animation: \");\n\t\t\t\t\t\t\t//~ EditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Clip: \");\n\t\t\t\t\t\t\t//~ towerList[index].baseStat.turretBuildAnimation=(AnimationClip)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].baseStat.turretBuildAnimation, typeof(AnimationClip), false);\n\t\t\t\t\t\t\t//~ EditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Component: \");\n\t\t\t\t\t\t\t//~ towerList[index].baseStat.turretBuildAnimationBody=(Animation)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].baseStat.turretBuildAnimationBody, typeof(Animation), false);\n\t\t\t\t\t\t\t//~ startY+=10;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t//~ EditorGUI.LabelField(new Rect(startX+18, startY+=spaceY, 200, height), \"Base Build Animation: \");\n\t\t\t\t\t\t\t//~ EditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Clip: \");\n\t\t\t\t\t\t\t//~ towerList[index].baseStat.baseBuildAnimation=(AnimationClip)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].baseStat.baseBuildAnimation, typeof(AnimationClip), false);\n\t\t\t\t\t\t\t//~ EditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Component: \");\n\t\t\t\t\t\t\t//~ towerList[index].baseStat.baseBuildAnimationBody=(Animation)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].baseStat.baseBuildAnimationBody, typeof(Animation), false);\n\t\t\t\t\t\t//~ }\t\n\t\t\t\t\t\t\t//EditorGUI.LabelField(new Rect(50+startX, startY+=spaceY, 200, height), \"Level 1: \");\n\t\t\t\t\t\t//~ }\n\t\t\t\t\t\t//~ else{\n\t\t\t\t\t\t\t//~ showAnimationText=\"Show animation list\";\n\t\t\t\t\t\t//~ }\n\t\t\t\t\t\t\n\t\t\t\t\t\tstartX+=200;\tstartY=tabYPos;\tspaceY=21;\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY, 200, height), \"1\");\n\t\t\t\t\t\tstartX+=35;\tstartY=tabYPos;\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tfor(int i=0; i<towerList[index].upgradeStat.Length; i++){\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(towerList[index]!=null && towerList[index].upgradeStat[i]!=null){\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tindicatorFlags[i+1] = EditorGUI.Toggle(new Rect(startX, startY+spaceY-10, 20, height), indicatorFlags[i+1]);\n\t\t\t\t\t\t\tstartY+=10;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(indicatorFlags[i+1]){\n\t\t\t\t\t\t\t\tGUI.Box(new Rect(startX, startY+spaceY-1, 175, 465+(rscCount*20)), \"\");\n\t\t\t\t\t\t\t\tstartX+=3;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(50+startX, startY+=spaceY, 200, height), \"Level \"+(i+2).ToString()+\": \");\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t//EditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Cost: \");\n\t\t\t\t\t\t\t\t//towerList[index].upgradeStat[i].cost = EditorGUI.IntField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[i].cost);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif(rscCount!=towerList[index].upgradeStat[i].costs.Length){\n\t\t\t\t\t\t\t\t\tUpdateUpgradeStatCost(index, rscCount);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif(towerList[index].upgradeStat[i].costs.Length==1){\n\t\t\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Cost: \");\n\t\t\t\t\t\t\t\t\ttowerList[index].upgradeStat[i].costs[0] = EditorGUI.IntField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[i].costs[0]);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY-5, 200, height), \"Cost: \");\n\t\t\t\t\t\t\t\t\tfor(int j=0; j<towerList[index].upgradeStat[i].costs.Length; j++){\n\t\t\t\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY-3, 200, height), \" - resource: \");\n\t\t\t\t\t\t\t\t\t\ttowerList[index].upgradeStat[i].costs[j] = EditorGUI.IntField(new Rect(startX+lW, startY+=spaceY-3, 50, height-2), towerList[index].upgradeStat[i].costs[j]);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tstartY+=8;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"BuildDuration: \");\n\t\t\t\t\t\t\t\ttowerList[index].upgradeStat[i].buildDuration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[i].buildDuration);\n\t\t\t\t\t\t\t\tstartY+=3;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tTypeDependentUpgradeStat(index, i);\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tspaceY+=2;\tstartY+=8;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t//~ if(!(towerList[index].type==_TowerType.Mine || towerList[index].type==_TowerType.Block)){\n\t\t\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"ShootObj: \");\n\t\t\t\t\t\t\t\t\ttowerList[index].upgradeStat[i].shootObject=(Transform)EditorGUI.ObjectField(new Rect(startX+lW-30, startY+=spaceY, 100, height-2), towerList[index].upgradeStat[i].shootObject, typeof(Transform), false);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"TurretObj: \");\n\t\t\t\t\t\t\t\t\ttowerList[index].upgradeStat[i].turretObject=(Transform)EditorGUI.ObjectField(new Rect(startX+lW-30, startY+=spaceY, 100, height-2), towerList[index].upgradeStat[i].turretObject, typeof(Transform), false);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"BaseObj: \");\n\t\t\t\t\t\t\t\t\ttowerList[index].upgradeStat[i].baseObject=(Transform)EditorGUI.ObjectField(new Rect(startX+lW-30, startY+=spaceY, 100, height-2), towerList[index].upgradeStat[i].baseObject, typeof(Transform), false);\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t//~ if(towerList[index].type==_TowerType.TurretTower || towerList[index].type==_TowerType.DirectionalAOETower){\n\t\t\t\t\t\t\t\t\t\t//~ if(towerList[index].turretRotationModel==_RotationMode.SeparatedBarrel){\n\t\t\t\t\t\t\t\t\t\t\t//~ EditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"BarrelObj: \");\n\t\t\t\t\t\t\t\t\t\t\t//~ towerList[index].upgradeStat[i].barrelObject=(Transform)EditorGUI.ObjectField(new Rect(startX+lW-30, startY+=spaceY, 100, height-2), towerList[index].upgradeStat[i].barrelObject, typeof(Transform), false);\n\t\t\t\t\t\t\t\t\t\t//~ }\n\t\t\t\t\t\t\t\t\t\t//~ else startY+=spaceY;\n\t\t\t\t\t\t\t\t\t//~ }\n\t\t\t\t\t\t\t\t\t//~ else startY+=spaceY;\n\t\t\t\t\t\t\t\t//~ }\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t//~ if(showAnimationList){\n\t\t\t\t\t\t\t\t\t//~ showAnimationText=\"Hide animation list\";\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t//~ if(!(towerList[index].type==_TowerType.Mine || towerList[index].type==_TowerType.Block)){\n\t\t\t\t\t\t\t\t\tspaceY-=3;\n\t\t\t\t\t\t\t\t\tstartY+=10;//870+spaceY;\n\t\t\t\t\t\t\t\t\tstartX-=3;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t//~ GUI.Box(new Rect(startX, startY+spaceY-1, 175, 275), \"\");\n\t\t\t\t\t\t\t\t\tGUI.Box(new Rect(startX, startY+spaceY-1, 175, 133), \"\");\n\t\t\t\t\t\t\t\t\tstartX+=3;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY, 200, height), \"- Turret Fire Animation: \");\n\t\t\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Clip: \");\n\t\t\t\t\t\t\t\t\ttowerList[index].upgradeStat[i].turretFireAnimation=(AnimationClip)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].upgradeStat[i].turretFireAnimation, typeof(AnimationClip), false);\n\t\t\t\t\t\t\t\t\t//EditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Component: \");\n\t\t\t\t\t\t\t\t\t//towerList[index].upgradeStat[i].turretFireAnimationBody=(Animation)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].upgradeStat[i].turretFireAnimationBody, typeof(Animation), false);\n\t\t\t\t\t\t\t\t\tstartY+=10;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY, 200, height), \"Base Fire Animation: \");\n\t\t\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Clip: \");\n\t\t\t\t\t\t\t\t\ttowerList[index].upgradeStat[i].baseFireAnimation=(AnimationClip)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].upgradeStat[i].baseFireAnimation, typeof(AnimationClip), false);\n\t\t\t\t\t\t\t\t\t//EditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Component: \");\n\t\t\t\t\t\t\t\t\t//towerList[index].upgradeStat[i].baseFireAnimationBody=(Animation)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].upgradeStat[i].baseFireAnimationBody, typeof(Animation), false);\n\t\t\t\t\t\t\t\t\tstartY+=10;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t//~ EditorGUI.LabelField(new Rect(startX+18, startY+=spaceY, 200, height), \"Turret Build Animation: \");\n\t\t\t\t\t\t\t\t\t//~ EditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Clip: \");\n\t\t\t\t\t\t\t\t\t//~ towerList[index].upgradeStat[i].turretBuildAnimation=(AnimationClip)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].upgradeStat[i].turretBuildAnimation, typeof(AnimationClip), false);\n\t\t\t\t\t\t\t\t\t//~ EditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Component: \");\n\t\t\t\t\t\t\t\t\t//~ towerList[index].upgradeStat[i].turretBuildAnimationBody=(Animation)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].upgradeStat[i].turretBuildAnimationBody, typeof(Animation), false);\n\t\t\t\t\t\t\t\t\t//~ startY+=10;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t//~ EditorGUI.LabelField(new Rect(startX+18, startY+=spaceY, 200, height), \"Base Build Animation: \");\n\t\t\t\t\t\t\t\t\t//~ EditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Clip: \");\n\t\t\t\t\t\t\t\t\t//~ towerList[index].upgradeStat[i].baseBuildAnimation=(AnimationClip)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].upgradeStat[i].baseBuildAnimation, typeof(AnimationClip), false);\n\t\t\t\t\t\t\t\t\t//~ EditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Component: \");\n\t\t\t\t\t\t\t\t\t//~ towerList[index].upgradeStat[i].baseBuildAnimationBody=(Animation)EditorGUI.ObjectField(new Rect(startX+lW-25, startY+=spaceY, 95, height-2), towerList[index].upgradeStat[i].baseBuildAnimationBody, typeof(Animation), false);\n\t\t\t\t\t\t\t\t//~ }\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t//EditorGUI.LabelField(new Rect(50+startX, startY+=spaceY, 200, height), \"Level 1: \");\n\t\t\t\t\t\t\t\t//~ }\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tstartX+=190;\n\t\t\t\t\t\t\t\tstartY=tabYPos;\n\t\t\t\t\t\t\t\tspaceY=21;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY, 200, height), (i+2).ToString());\n\t\t\t\t\t\t\t\tstartX+=25;\tstartY=tabYPos;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t//}\n\t\t\t\t\n\t\t\t\tHPAttributeEditor(index);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(GUI.Button(new Rect(startX, startY, 140, height), \"Find Build Manager\")) GetTower();\n\t\t\t\t//return;\n\t\t\t}\n\t\t\t\n\t\t\t//~ if(towerList.Length>0) {\n\t\t\t\t\n\t\t\t\t\n\t\t\t//~ }\n\t\t}\n\t\n\t\t\n\t\t\n\t\tif(GUI.changed) EditorUtility.SetDirty(towerList[index]);\n\t\t\n\t\tGUI.EndScrollView();\n    }\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\tvoid HPAttributeEditor(int index){\n\t\tfloat startY=133;\n\t\tfloat startX=320;\n\t\t\n\t\tfloat space=105;\n\t\t\n\t\tEditorGUI.LabelField(new Rect(startX, startY, 200, height), \"Tower HP: \");\n\t\ttowerList[index].HPAttribute.fullHP = EditorGUI.FloatField(new Rect(startX+space, startY, 50, height-2), towerList[index].HPAttribute.fullHP);\n\t\t\n\t\t//~ EditorGUI.LabelField(new Rect(startX, startY+20, 200, height), \"Tower Shield: \");\n\t\t//~ towerList[index].HPAttribute.fullShield = EditorGUI.FloatField(new Rect(startX+space, startY+=20, 50, height-2), towerList[index].HPAttribute.fullShield);\n\t\t\n\t\t//~ if(towerList[index].HPAttribute.fullShield>0){\n\t\t\t//~ EditorGUI.LabelField(new Rect(startX, startY+20, 200, height), \"Shield Recharge: \");\n\t\t\t//~ towerList[index].HPAttribute.shieldRechargeRate = EditorGUI.FloatField(new Rect(startX+space, startY+=20, 50, height-2), towerList[index].HPAttribute.shieldRechargeRate);\n\t\t\t\n\t\t\t//~ EditorGUI.LabelField(new Rect(startX, startY+20, 200, height), \"Shield Stagger: \");\n\t\t\t//~ towerList[index].HPAttribute.shieldStagger = EditorGUI.FloatField(new Rect(startX+space, startY+=20, 50, height-2), towerList[index].HPAttribute.shieldStagger);\n\t\t//~ }\n\t\t\n\t\tstartY=133;\n\t\tstartX=320+105+50+10;\n\t\tspace=100;\n\t\t\n\t\tEditorGUI.LabelField(new Rect(startX, startY, 200, height), \"HP Overlay: \");\n\t\ttowerList[index].HPAttribute.overlayHP=(Transform)EditorGUI.ObjectField(new Rect(startX+space, startY, 100, height-2), towerList[index].HPAttribute.overlayHP, typeof(Transform), false);\n\t\t\n\t\t//~ EditorGUI.LabelField(new Rect(startX, startY+=spaceY, 200, height), \"Shield Overlay: \");\n\t\t//~ towerList[index].HPAttribute.overlayShield=(Transform)EditorGUI.ObjectField(new Rect(startX+space, startY, 100, height-2), towerList[index].HPAttribute.overlayShield, typeof(Transform), false);\n\t\t\n\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY, 200, height), \"Base Overlay: \");\n\t\ttowerList[index].HPAttribute.overlayBase=(Transform)EditorGUI.ObjectField(new Rect(startX+space, startY, 100, height-2), towerList[index].HPAttribute.overlayBase, typeof(Transform), false);\n\t\t\n\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY, 200, height), \"Always Show Overlay: \");\n\t\ttowerList[index].HPAttribute.alwaysShowOverlay= EditorGUI.Toggle(new Rect(startX+space+40, startY, 100, height-2), towerList[index].HPAttribute.alwaysShowOverlay);\n\t}\n\t\n\t\n\t\n\t\n\t\n\tvoid TypeDependentBaseStat(int index){\n\t\t//turretTower\n\t\tif(towerType==0){\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY+5, 200, height), \"Damage: \");\n\t\t\ttowerList[index].baseStat.damage = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY+5, 50, height-2), towerList[index].baseStat.damage);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Cooldown: \");\n\t\t\ttowerList[index].baseStat.cooldown = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.cooldown);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"ReloadDuration: \");\n\t\t\ttowerList[index].baseStat.reloadDuration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.reloadDuration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"ClipSize: \");\n\t\t\ttowerList[index].baseStat.clipSize = EditorGUI.IntField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.clipSize);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Range: \");\n\t\t\ttowerList[index].baseStat.range = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.range);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"AoeRadius: \");\n\t\t\ttowerList[index].baseStat.aoeRadius = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.aoeRadius);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"StunDuration: \");\n\t\t\ttowerList[index].baseStat.stunDuration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.stunDuration);\n\t\t\t\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"Slow Effect: \");\n\t\t\tspaceY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Duration: \");\n\t\t\ttowerList[index].baseStat.slow.duration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.slow.duration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- SlowFactor: \");\n\t\t\ttowerList[index].baseStat.slow.slowFactor = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.slow.slowFactor);\n\t\t\t\n\t\t\tspaceY+=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"DamageOverTime: \");\n\t\t\tspaceY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Damage: \");\n\t\t\ttowerList[index].baseStat.dot.damage = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.dot.damage);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Duration: \");\n\t\t\ttowerList[index].baseStat.dot.duration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.dot.duration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Interval: \");\n\t\t\ttowerList[index].baseStat.dot.interval = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.dot.interval);\n\t\t\t\n\t\t\tfloat ttDmg=towerList[index].baseStat.dot.damage*towerList[index].baseStat.dot.duration/towerList[index].baseStat.dot.interval;\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+=spaceY+3, 160, height), \"TotalDamage:  \"+ttDmg.ToString(\"f1\"));\n\t\t\t\n\t\t\tspaceY+=3;\n\t\t\t//startY+=5;\n\t\t\t\n\t\t}\n\t\t//DirectionalAOETower\n\t\telse if(towerType==1){\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY+5, 200, height), \"Damage: \");\n\t\t\ttowerList[index].baseStat.damage = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY+5, 50, height-2), towerList[index].baseStat.damage);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Cooldown: \");\n\t\t\ttowerList[index].baseStat.cooldown = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.cooldown);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Range: \");\n\t\t\ttowerList[index].baseStat.range = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.range);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"StunDuration: \");\n\t\t\ttowerList[index].baseStat.stunDuration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.stunDuration);\n\t\t\t\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"Slow Effect: \");\n\t\t\tspaceY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Duration: \");\n\t\t\ttowerList[index].baseStat.slow.duration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.slow.duration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- SlowFactor: \");\n\t\t\ttowerList[index].baseStat.slow.slowFactor = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.slow.slowFactor);\n\t\t\t\n\t\t\tspaceY+=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"DamageOverTime: \");\n\t\t\tspaceY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Damage: \");\n\t\t\ttowerList[index].baseStat.dot.damage = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.dot.damage);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Duration: \");\n\t\t\ttowerList[index].baseStat.dot.duration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.dot.duration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Interval: \");\n\t\t\ttowerList[index].baseStat.dot.interval = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.dot.interval);\n\t\t\t\n\t\t\tfloat ttDmg=towerList[index].baseStat.dot.damage*towerList[index].baseStat.dot.duration/towerList[index].baseStat.dot.interval;\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+=spaceY+3, 160, height), \"TotalDamage:  \"+ttDmg.ToString(\"f1\"));\n\t\t\t\n\t\t\tspaceY+=3;\n\t\t}\n\t\t//AOETower\n\t\telse if(towerType==2){\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY+5, 200, height), \"Damage: \");\n\t\t\ttowerList[index].baseStat.damage = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY+5, 50, height-2), towerList[index].baseStat.damage);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Cooldown: \");\n\t\t\ttowerList[index].baseStat.cooldown = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.cooldown);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"ReloadDuration: \");\n\t\t\ttowerList[index].baseStat.reloadDuration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.reloadDuration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"ClipSize: \");\n\t\t\ttowerList[index].baseStat.clipSize = EditorGUI.IntField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.clipSize);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Range: \");\n\t\t\ttowerList[index].baseStat.range = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.range);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"StunDuration: \");\n\t\t\ttowerList[index].baseStat.stunDuration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.stunDuration);\n\t\t\t\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"Slow Effect: \");\n\t\t\tspaceY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Duration: \");\n\t\t\ttowerList[index].baseStat.slow.duration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.slow.duration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- SlowFactor: \");\n\t\t\ttowerList[index].baseStat.slow.slowFactor = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.slow.slowFactor);\n\t\t\t\n\t\t\tspaceY+=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"DamageOverTime: \");\n\t\t\tspaceY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Damage: \");\n\t\t\ttowerList[index].baseStat.dot.damage = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.dot.damage);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Duration: \");\n\t\t\ttowerList[index].baseStat.dot.duration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.dot.duration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Interval: \");\n\t\t\ttowerList[index].baseStat.dot.interval = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.dot.interval);\n\t\t\t\n\t\t\tfloat ttDmg=towerList[index].baseStat.dot.damage*towerList[index].baseStat.dot.duration/towerList[index].baseStat.dot.interval;\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+=spaceY+3, 160, height), \"TotalDamage:  \"+ttDmg.ToString(\"f1\"));\n\t\t\t\n\t\t\tspaceY+=3;\n\t\t\t//startY+=5;\n\t\t\t\n\t\t}\n\t\t//SupportTower\n\t\telse if(towerType==3){\n\t\t\t\n\t\t\tspaceY+=5;\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Effective Range: \");\n\t\t\ttowerList[index].baseStat.range = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.range);\n\t\t\t\n\t\t\tspaceY+=5;\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"Buff Effect: \");\n\t\t\tspaceY-=5;\n\t\t\tstartY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Damage: \");\n\t\t\ttowerList[index].baseStat.buff.damageBuff = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.buff.damageBuff);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Cooldown: \");\n\t\t\ttowerList[index].baseStat.buff.cooldownBuff = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.buff.cooldownBuff);\n\t\t\ttowerList[index].baseStat.buff.cooldownBuff = Mathf.Clamp(towerList[index].baseStat.buff.cooldownBuff, -0.8f, 0.8f);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Range: \");\n\t\t\ttowerList[index].baseStat.buff.rangeBuff = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.buff.rangeBuff);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- RegenHP: \");\n\t\t\ttowerList[index].baseStat.buff.regenHP = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY+3, 50, height-2), towerList[index].baseStat.buff.regenHP);\n\t\t\t\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY+10, 200, height), \"Cooldown: \");\n\t\t\ttowerList[index].baseStat.cooldown = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY+10, 50, height-2), towerList[index].baseStat.cooldown);\n\t\t\t\n\t\t\tspaceY-=5;\n\t\t}\n\t\t//ResourceTower\n\t\telse if(towerType==4){\n\t\t\t\n\t\t\t//EditorGUI.LabelField(new Rect(startX, startY+spaceY+10, 200, height), \"IncomeValue: \");\n\t\t\t//towerList[index].baseStat.incomeValue = EditorGUI.IntField(new Rect(startX+lW, startY+=spaceY+10, 50, height-2), towerList[index].baseStat.incomeValue);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY+10, 200, height), \"Cooldown: \");\n\t\t\ttowerList[index].baseStat.cooldown = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY+10, 50, height-2), towerList[index].baseStat.cooldown);\n\t\t\t\n\t\t\tstartY+=10;\n\t\t\t\n\t\t\tif(rscCount!=towerList[index].baseStat.incomes.Length){\n\t\t\t\tUpdateBaseStatIncomes(index, rscCount);\n\t\t\t}\n\t\t\t\n\t\t\tif(towerList[index].baseStat.incomes.Length==1){\n\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"resources:\");\n\t\t\t\ttowerList[index].baseStat.incomes[0] = EditorGUI.IntField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.incomes[0]);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY-5, 200, height), \"Resources Per CD:\");\n\t\t\t\tfor(int i=0; i<towerList[index].baseStat.incomes.Length; i++){\n\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY-3, 200, height), \" - resource: \");\n\t\t\t\t\ttowerList[index].baseStat.incomes[i] = EditorGUI.IntField(new Rect(startX+lW, startY+=spaceY-3, 50, height-2), towerList[index].baseStat.incomes[i]);\n\t\t\t\t}\n\t\t\t\tstartY+=8;\n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t}\n\t\t//mine\n\t\telse if(towerType==5){\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY+5, 200, height), \"Damage: \");\n\t\t\ttowerList[index].baseStat.damage = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY+5, 50, height-2), towerList[index].baseStat.damage);\n\t\t\t\n\t\t\tif(!towerList[index].mineOneOff){\n\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Cooldown: \");\n\t\t\t\ttowerList[index].baseStat.cooldown = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.cooldown);\n\t\t\t}\n\t\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"EffectiveRange: \");\n\t\t\ttowerList[index].baseStat.range = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.range);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"StunDuration: \");\n\t\t\ttowerList[index].baseStat.stunDuration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.stunDuration);\n\t\t\t\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"Slow Effect: \");\n\t\t\tspaceY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Duration: \");\n\t\t\ttowerList[index].baseStat.slow.duration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.slow.duration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- SlowFactor: \");\n\t\t\ttowerList[index].baseStat.slow.slowFactor = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.slow.slowFactor);\n\t\t\t\n\t\t\tspaceY+=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"DamageOverTime: \");\n\t\t\tspaceY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Damage: \");\n\t\t\ttowerList[index].baseStat.dot.damage = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.dot.damage);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Duration: \");\n\t\t\ttowerList[index].baseStat.dot.duration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.dot.duration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Interval: \");\n\t\t\ttowerList[index].baseStat.dot.interval = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].baseStat.dot.interval);\n\t\t\t\n\t\t\tfloat ttDmg=towerList[index].baseStat.dot.damage*towerList[index].baseStat.dot.duration/towerList[index].baseStat.dot.interval;\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+=spaceY+3, 160, height), \"TotalDamage:  \"+ttDmg.ToString(\"f1\"));\n\t\t\n\t\t\tspaceY+=3;\n\t\t}\n\t\t\n\t}\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\tvoid TypeDependentUpgradeStat(int index, int lvl){\n\t\tif(towerType==0){\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY+5, 200, height), \"Damage: \");\n\t\t\ttowerList[index].upgradeStat[lvl].damage = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY+5, 50, height-2), towerList[index].upgradeStat[lvl].damage);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Cooldown: \");\n\t\t\ttowerList[index].upgradeStat[lvl].cooldown = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].cooldown);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"ReloadDuration: \");\n\t\t\ttowerList[index].upgradeStat[lvl].reloadDuration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].reloadDuration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"ClipSize: \");\n\t\t\ttowerList[index].upgradeStat[lvl].clipSize = EditorGUI.IntField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].clipSize);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Range: \");\n\t\t\ttowerList[index].upgradeStat[lvl].range = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].range);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"AoeRadius: \");\n\t\t\ttowerList[index].upgradeStat[lvl].aoeRadius = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].aoeRadius);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"StunDuration: \");\n\t\t\ttowerList[index].upgradeStat[lvl].stunDuration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].stunDuration);\n\t\t\t\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"Slow Effect: \");\n\t\t\tspaceY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Duration: \");\n\t\t\ttowerList[index].upgradeStat[lvl].slow.duration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].slow.duration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- SlowFactor: \");\n\t\t\ttowerList[index].upgradeStat[lvl].slow.slowFactor = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].slow.slowFactor);\n\t\t\t\n\t\t\tspaceY+=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"DamageOverTime: \");\n\t\t\tspaceY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Damage: \");\n\t\t\ttowerList[index].upgradeStat[lvl].dot.damage = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].dot.damage);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Duration: \");\n\t\t\ttowerList[index].upgradeStat[lvl].dot.duration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].dot.duration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Interval: \");\n\t\t\ttowerList[index].upgradeStat[lvl].dot.interval = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].dot.interval);\n\t\t\t\n\t\t\tfloat ttDmg=towerList[index].baseStat.dot.damage*towerList[index].baseStat.dot.duration/towerList[index].baseStat.dot.interval;\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+=spaceY+3, 160, height), \"TotalDamage:  \"+ttDmg.ToString(\"f1\"));\n\t\t\t\n\t\t\tspaceY+=3;\n\t\t\t//startY+=5;\n\t\t\t\n\t\t}\n\t\telse if(towerType==1){\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY+5, 200, height), \"Damage: \");\n\t\t\ttowerList[index].upgradeStat[lvl].damage = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY+5, 50, height-2), towerList[index].upgradeStat[lvl].damage);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Cooldown: \");\n\t\t\ttowerList[index].upgradeStat[lvl].cooldown = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].cooldown);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Range: \");\n\t\t\ttowerList[index].upgradeStat[lvl].range = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].range);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"StunDuration: \");\n\t\t\ttowerList[index].upgradeStat[lvl].stunDuration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].stunDuration);\n\t\t\t\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"Slow Effect: \");\n\t\t\tspaceY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Duration: \");\n\t\t\ttowerList[index].upgradeStat[lvl].slow.duration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].slow.duration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- SlowFactor: \");\n\t\t\ttowerList[index].upgradeStat[lvl].slow.slowFactor = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].slow.slowFactor);\n\t\t\t\n\t\t\tspaceY+=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"DamageOverTime: \");\n\t\t\tspaceY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Damage: \");\n\t\t\ttowerList[index].upgradeStat[lvl].dot.damage = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].dot.damage);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Duration: \");\n\t\t\ttowerList[index].upgradeStat[lvl].dot.duration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].dot.duration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Interval: \");\n\t\t\ttowerList[index].upgradeStat[lvl].dot.interval = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].dot.interval);\n\t\t\t\n\t\t\tfloat ttDmg=towerList[index].baseStat.dot.damage*towerList[index].baseStat.dot.duration/towerList[index].baseStat.dot.interval;\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+=spaceY+3, 160, height), \"TotalDamage:  \"+ttDmg.ToString(\"f1\"));\n\t\t\t\n\t\t\tspaceY+=3;\n\t\t}\n\t\telse if(towerType==2){\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY+5, 200, height), \"Damage: \");\n\t\t\ttowerList[index].upgradeStat[lvl].damage = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY+5, 50, height-2), towerList[index].upgradeStat[lvl].damage);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Cooldown: \");\n\t\t\ttowerList[index].upgradeStat[lvl].cooldown = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].cooldown);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"ReloadDuration: \");\n\t\t\ttowerList[index].upgradeStat[lvl].reloadDuration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].reloadDuration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"ClipSize: \");\n\t\t\ttowerList[index].upgradeStat[lvl].clipSize = EditorGUI.IntField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].clipSize);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Range: \");\n\t\t\ttowerList[index].upgradeStat[lvl].range = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].range);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"StunDuration: \");\n\t\t\ttowerList[index].upgradeStat[lvl].stunDuration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].stunDuration);\n\t\t\t\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"Slow Effect: \");\n\t\t\tspaceY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Duration: \");\n\t\t\ttowerList[index].upgradeStat[lvl].slow.duration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].slow.duration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- SlowFactor: \");\n\t\t\ttowerList[index].upgradeStat[lvl].slow.slowFactor = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].slow.slowFactor);\n\t\t\t\n\t\t\tspaceY+=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"DamageOverTime: \");\n\t\t\tspaceY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Damage: \");\n\t\t\ttowerList[index].upgradeStat[lvl].dot.damage = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].dot.damage);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Duration: \");\n\t\t\ttowerList[index].upgradeStat[lvl].dot.duration = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].dot.duration);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Interval: \");\n\t\t\ttowerList[index].upgradeStat[lvl].dot.interval = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].dot.interval);\n\t\t\t\n\t\t\tfloat ttDmg=towerList[index].upgradeStat[lvl].dot.damage*towerList[index].upgradeStat[lvl].dot.duration/towerList[index].upgradeStat[lvl].dot.interval;\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+=spaceY+3, 160, height), \"TotalDamage:  \"+ttDmg.ToString(\"f1\"));\n\t\t\t\n\t\t\tspaceY+=3;\n\t\t\t//startY+=5;\n\t\t\t\n\t\t}\n\t\telse if(towerType==3){\n\t\t\t\n\t\t\tspaceY+=5;\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"Effective Range: \");\n\t\t\ttowerList[index].upgradeStat[lvl].range = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].range);\n\t\t\t\n\t\t\tspaceY+=5;\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY+3, 200, height), \"Buff Effect: \");\n\t\t\tspaceY-=5;\n\t\t\tstartY-=3;\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Damage: \");\n\t\t\ttowerList[index].upgradeStat[lvl].buff.damageBuff = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].buff.damageBuff);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Cooldown: \");\n\t\t\ttowerList[index].upgradeStat[lvl].buff.cooldownBuff = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].buff.cooldownBuff);\n\t\t\ttowerList[index].upgradeStat[lvl].buff.cooldownBuff = Mathf.Clamp(towerList[index].upgradeStat[lvl].buff.cooldownBuff, -0.8f, 0.8f);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- Range: \");\n\t\t\ttowerList[index].upgradeStat[lvl].buff.rangeBuff = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].buff.rangeBuff);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX+10, startY+spaceY, 200, height), \"- RegenHP: \");\n\t\t\ttowerList[index].upgradeStat[lvl].buff.regenHP = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY+3, 50, height-2), towerList[index].upgradeStat[lvl].buff.regenHP);\n\t\t\t\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY+10, 200, height), \"Cooldown: \");\n\t\t\ttowerList[index].upgradeStat[lvl].cooldown = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY+10, 50, height-2), towerList[index].upgradeStat[lvl].cooldown);\n\t\t\n\t\t\tspaceY-=5;\n\t\t}\n\t\telse if(towerType==4){\n\t\t\t\n\t\t\t//EditorGUI.LabelField(new Rect(startX, startY+spaceY+10, 200, height), \"Income Value: \");\n\t\t\t//towerList[index].upgradeStat[lvl].incomeValue = EditorGUI.IntField(new Rect(startX+lW, startY+=spaceY+10, 50, height-2), towerList[index].upgradeStat[lvl].incomeValue);\n\t\t\t\n\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY+10, 200, height), \"Cooldown: \");\n\t\t\ttowerList[index].upgradeStat[lvl].cooldown = EditorGUI.FloatField(new Rect(startX+lW, startY+=spaceY+10, 50, height-2), towerList[index].upgradeStat[lvl].cooldown);\n\t\t\n\t\t\tstartY+=10;\n\t\t\t\n\t\t\tif(rscCount!=towerList[index].upgradeStat[lvl].incomes.Length){\n\t\t\t\tUpdateUpgradeStatIncomes(index, rscCount);\n\t\t\t}\n\t\t\t\n\t\t\tif(towerList[index].upgradeStat[lvl].incomes.Length==1){\n\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY, 200, height), \"resources:\");\n\t\t\t\ttowerList[index].upgradeStat[lvl].incomes[0] = EditorGUI.IntField(new Rect(startX+lW, startY+=spaceY, 50, height-2), towerList[index].upgradeStat[lvl].incomes[0]);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+=spaceY-5, 200, height), \"Resources Per CD:\");\n\t\t\t\tfor(int i=0; i<towerList[index].upgradeStat[lvl].incomes.Length; i++){\n\t\t\t\t\tEditorGUI.LabelField(new Rect(startX, startY+spaceY-3, 200, height), \" - resource: \");\n\t\t\t\t\ttowerList[index].upgradeStat[lvl].incomes[i] = EditorGUI.IntField(new Rect(startX+lW, startY+=spaceY-3, 50, height-2), towerList[index].upgradeStat[lvl].incomes[i]);\n\t\t\t\t}\n\t\t\t\tstartY+=8;\n\t\t\t}\n\t\t\n\t\t}\n\t\t\n\t}\n\t\n\tvoid UpdateIndicatorFlags(int size){\n\t\tif(indicatorFlags.Length!=size){\n\t\t\tindicatorFlags=new bool[size];\n\t\t\tfor(int i=0; i<indicatorFlags.Length; i++) indicatorFlags[i]=true;\n\t\t}\n\t}\n\t\n\t\n\tvoid UpdateBaseStatIncomes(int id, int length){\n\t\tint[] tempIncList=towerList[index].baseStat.incomes;\n\t\t\n\t\ttowerList[index].baseStat.incomes=new int[length];\n\t\t\n\t\tfor(int i=0; i<length; i++){\n\t\t\tif(i>=tempIncList.Length){\n\t\t\t\ttowerList[index].baseStat.incomes[i]=0;\n\t\t\t}\n\t\t\telse{\n\t\t\t\ttowerList[index].baseStat.incomes[i]=tempIncList[i];\n\t\t\t}\n\t\t}\n\t}\n\t\n\tvoid UpdateUpgradeStatIncomes(int id, int length){\n\t\tfor(int j=0; j<towerList[index].upgradeStat.Length; j++){\n\t\t\tint[] tempIncList=towerList[index].upgradeStat[j].incomes;\n\t\t\t\n\t\t\ttowerList[index].upgradeStat[j].incomes=new int[length];\n\t\t\t\n\t\t\tfor(int i=0; i<length; i++){\n\t\t\t\tif(i>=tempIncList.Length){\n\t\t\t\t\ttowerList[index].upgradeStat[j].incomes[i]=0;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\ttowerList[index].upgradeStat[j].incomes[i]=tempIncList[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tvoid UpdateBaseStatCost(int id, int length){\n\t\tint[] tempCostList=towerList[index].baseStat.costs;\n\t\t\n\t\ttowerList[index].baseStat.costs=new int[length];\n\t\t\n", "answers": ["\t\tfor(int i=0; i<length; i++){"], "incorrect_answer": "for(int i=1; i<=length; i++){"}, {"input": "", "context": "using System;\nusing Server.Items;\nnamespace Server.Engines.Craft\n{\n\tpublic class DefBlacksmithy : CraftSystem\n\t{\n\t\tpublic override SkillName MainSkill\n\t\t{\n\t\t\tget\t{ return SkillName.Blacksmith;\t}\n\t\t}\n\t\tpublic override int GumpTitleNumber\n\t\t{\n\t\t\tget { return 1044002; } // <CENTER>BLACKSMITHY MENU</CENTER>\n\t\t}\n\t\tprivate static CraftSystem m_CraftSystem;\n\t\tpublic static CraftSystem CraftSystem\n\t\t{\n\t\t\tget\n\t\t\t{\n\t\t\t\tif ( m_CraftSystem == null )\n\t\t\t\t\tm_CraftSystem = new DefBlacksmithy();\n\t\t\t\treturn m_CraftSystem;\n\t\t\t}\n\t\t}\n\t\tpublic override CraftECA ECA{ get{ return CraftECA.ChanceMinusSixtyToFourtyFive; } }\n\t\tpublic override double GetChanceAtMin( CraftItem item )\n\t\t{\n\t\t\treturn 0.0; // 0%\n\t\t}\n\t\tprivate DefBlacksmithy() : base( 1, 1, 1.25 )// base( 1, 2, 1.7 )\n\t\t{\n\t\t\t/*\n\t\t\t\n\t\t\tbase( MinCraftEffect, MaxCraftEffect, Delay )\n\t\t\t\n\t\t\tMinCraftEffect\t: The minimum number of time the mobile will play the craft effect\n\t\t\tMaxCraftEffect\t: The maximum number of time the mobile will play the craft effect\n\t\t\tDelay\t\t\t: The delay between each craft effect\n\t\t\t\n\t\t\tExample: (3, 6, 1.7) would make the mobile do the PlayCraftEffect override\n\t\t\tfunction between 3 and 6 time, with a 1.7 second delay each time.\n\t\t\t\n\t\t\t*/ \n\t\t}\n\t\tprivate static Type typeofAnvil = typeof( AnvilAttribute );\n\t\tprivate static Type typeofForge = typeof( ForgeAttribute );\n\t\tpublic static void CheckAnvilAndForge( Mobile from, int range, out bool anvil, out bool forge )\n\t\t{\n\t\t\tanvil = false;\n\t\t\tforge = false;\n\t\t\tMap map = from.Map;\n\t\t\tif ( map == null )\n\t\t\t\treturn;\n\t\t\tIPooledEnumerable eable = map.GetItemsInRange( from.Location, range );\n\t\t\tforeach ( Item item in eable )\n\t\t\t{\n\t\t\t\tType type = item.GetType();\n\t\t\t\tbool isAnvil = ( type.IsDefined( typeofAnvil, false ) || item.ItemID == 4015 || item.ItemID == 4016 || item.ItemID == 0x2DD5 || item.ItemID == 0x2DD6 );\n\t\t\t\tbool isForge = ( type.IsDefined( typeofForge, false ) || item.ItemID == 4017 || (item.ItemID >= 6522 && item.ItemID <= 6569) || item.ItemID == 0x2DD8 );\n\t\t\t\tif ( isAnvil || isForge )\n\t\t\t\t{\n\t\t\t\t\tif ( (from.Z + 16) < item.Z || (item.Z + 16) < from.Z || !from.InLOS( item ) )\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\tanvil = anvil || isAnvil;\n\t\t\t\t\tforge = forge || isForge;\n\t\t\t\t\tif ( anvil && forge )\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\teable.Free();\n\t\t\tfor ( int x = -range; (!anvil || !forge) && x <= range; ++x )\n\t\t\t{\n\t\t\t\tfor ( int y = -range; (!anvil || !forge) && y <= range; ++y )\n\t\t\t\t{\n\t\t\t\t\tStaticTile[] tiles = map.Tiles.GetStaticTiles( from.X+x, from.Y+y, true );\n\t\t\t\t\tfor ( int i = 0; (!anvil || !forge) && i < tiles.Length; ++i )\n\t\t\t\t\t{\n\t\t\t\t\t\tint id = tiles[i].ID;\n\t\t\t\t\t\tbool isAnvil = ( id == 4015 || id == 4016 || id == 0x2DD5 || id == 0x2DD6 );\n\t\t\t\t\t\tbool isForge = ( id == 4017 || (id >= 6522 && id <= 6569) || id == 0x2DD8 );\n\t\t\t\t\t\tif ( isAnvil || isForge )\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif ( (from.Z + 16) < tiles[i].Z || (tiles[i].Z + 16) < from.Z || !from.InLOS( new Point3D( from.X+x, from.Y+y, tiles[i].Z + (tiles[i].Height/2) + 1 ) ) )\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\tanvil = anvil || isAnvil;\n\t\t\t\t\t\t\tforge = forge || isForge;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tpublic override int CanCraft( Mobile from, BaseTool tool, Type itemType )\n\t\t{\n\t\t\tif ( tool == null || tool.Deleted || tool.UsesRemaining < 0 )\n\t\t\t\treturn 1044038; // You have worn out your tool!\n\t\t\telse if ( !BaseTool.CheckTool( tool, from ) )\n\t\t\t\treturn 1048146; // If you have a tool equipped, you must use that tool.\n\t\t\telse if ( !BaseTool.CheckAccessible( tool, from ) )\n\t\t\t\treturn 1044263; // The tool must be on your person to use.\n\t\t\tbool anvil, forge;\n\t\t\tCheckAnvilAndForge( from, 2, out anvil, out forge );\n\t\t\tif ( anvil && forge )\n\t\t\t\treturn 0;\n\t\t\treturn 1044267; // You must be near an anvil and a forge to smith items.\n\t\t}\n\t\tpublic override void PlayCraftEffect( Mobile from )\n\t\t{\n\t\t\t// no animation, instant sound\n\t\t\t//if ( from.Body.Type == BodyType.Human && !from.Mounted )\n\t\t\t//\tfrom.Animate( 9, 5, 1, true, false, 0 );\n\t\t\t//new InternalTimer( from ).Start();\n\t\t\tfrom.PlaySound( 0x2A );\n\t\t}\n\t\t// Delay to synchronize the sound with the hit on the anvil\n\t\tprivate class InternalTimer : Timer\n\t\t{\n\t\t\tprivate Mobile m_From;\n\t\t\tpublic InternalTimer( Mobile from ) : base( TimeSpan.FromSeconds( 0.7 ) )\n\t\t\t{\n\t\t\t\tm_From = from;\n\t\t\t}\n\t\t\tprotected override void OnTick()\n\t\t\t{\n\t\t\t\tm_From.PlaySound( 0x2A );\n\t\t\t}\n\t\t}\n\t\tpublic override int PlayEndingEffect( Mobile from, bool failed, bool lostMaterial, bool toolBroken, int quality, bool makersMark, CraftItem item )\n\t\t{\n\t\t\tif ( toolBroken )\n\t\t\t\tfrom.SendLocalizedMessage( 1044038 ); // You have worn out your tool\n\t\t\tif ( failed )\n\t\t\t{\n\t\t\t\tif ( lostMaterial )\n\t\t\t\t\treturn 1044043; // You failed to create the item, and some of your materials are lost.\n\t\t\t\telse\n\t\t\t\t\treturn 1044157; // You failed to create the item, but no materials were lost.\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif ( quality == 0 )\n\t\t\t\t\treturn 502785; // You were barely able to make this item.  It's quality is below average.\n\t\t\t\telse if ( makersMark && quality == 2 )\n\t\t\t\t\treturn 1044156; // You create an exceptional quality item and affix your maker's mark.\n\t\t\t\telse if ( quality == 2 )\n\t\t\t\t\treturn 1044155; // You create an exceptional quality item.\n\t\t\t\telse\t\t\t\t\n\t\t\t\t\treturn 1044154; // You create the item.\n\t\t\t}\n\t\t}\n\t\tpublic override void InitCraftList()\n\t\t{\n\t\t\t/*\n\t\t\tSynthax for a SIMPLE craft item\n\t\t\tAddCraft( ObjectType, Group, MinSkill, MaxSkill, ResourceType, Amount, Message )\n\t\t\t\n\t\t\tObjectType\t\t: The type of the object you want to add to the build list.\n\t\t\tGroup\t\t\t: The group in wich the object will be showed in the craft menu.\n\t\t\tMinSkill\t\t: The minimum of skill value\n\t\t\tMaxSkill\t\t: The maximum of skill value\n\t\t\tResourceType\t: The type of the resource the mobile need to create the item\n\t\t\tAmount\t\t\t: The amount of the ResourceType it need to create the item\n\t\t\tMessage\t\t\t: String or Int for Localized.  The message that will be sent to the mobile, if the specified resource is missing.\n\t\t\t\n\t\t\tSynthax for a COMPLEXE craft item.  A complexe item is an item that need either more than\n\t\t\tonly one skill, or more than only one resource.\n\t\t\t\n\t\t\tComing soon....\n\t\t\t*/\n\t\t\t#region Ringmail\n\t\t\tAddCraft( typeof( RingmailGloves ), 1011076, 1025099, 12.0, 62.0, typeof( IronIngot ), 1044036, 10, 1044037 );\n\t\t\tAddCraft( typeof( RingmailLegs ), 1011076, 1025104, 19.4, 69.4, typeof( IronIngot ), 1044036, 16, 1044037 );\n\t\t\tAddCraft( typeof( RingmailArms ), 1011076, 1025103, 16.9, 66.9, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\tAddCraft( typeof( RingmailChest ), 1011076, 1025100, 21.9, 71.9, typeof( IronIngot ), 1044036, 18, 1044037 );\n\t\t\t#endregion\n\t\t\t#region Chainmail\n\t\t\tAddCraft( typeof( ChainCoif ), 1011077, 1025051, 14.5, 64.5, typeof( IronIngot ), 1044036, 10, 1044037 );\n\t\t\tAddCraft( typeof( ChainLegs ), 1011077, 1025054, 36.7, 86.7, typeof( IronIngot ), 1044036, 18, 1044037 );\n\t\t\tAddCraft( typeof( ChainChest ), 1011077, 1025055, 39.1, 89.1, typeof( IronIngot ), 1044036, 20, 1044037 );\n\t\t\t#endregion\n\t\t\tint index = -1;\n\t\t\t#region Platemail\n\t\t\tAddCraft( typeof( PlateArms ), 1011078, 1025136, 66.3, 116.3, typeof( IronIngot ), 1044036, 18, 1044037 );\n\t\t\tAddCraft( typeof( PlateGloves ), 1011078, 1025140, 58.9, 108.9, typeof( IronIngot ), 1044036, 12, 1044037 );\n\t\t\tAddCraft( typeof( PlateGorget ), 1011078, 1025139, 56.4, 106.4, typeof( IronIngot ), 1044036, 10, 1044037 );\n\t\t\tAddCraft( typeof( PlateLegs ), 1011078, 1025137, 68.8, 118.8, typeof( IronIngot ), 1044036, 20, 1044037 );\n\t\t\tAddCraft( typeof( PlateChest ), 1011078, 1046431, 75.0, 125.0, typeof( IronIngot ), 1044036, 25, 1044037 );\n\t\t\tAddCraft( typeof( FemalePlateChest ), 1011078, 1046430, 44.1, 94.1, typeof( IronIngot ), 1044036, 20, 1044037 );\n\t\t\tif ( Core.AOS ) // exact pre-aos functionality unknown\n\t\t\t\tAddCraft( typeof( DragonBardingDeed ), 1011078, 1053012, 72.5, 122.5, typeof( IronIngot ), 1044036, 750, 1044037 );\n\t\t\tif( Core.SE )\n\t\t\t{\n\t\t\t\tindex = AddCraft( typeof( PlateMempo ), 1011078, 1030180, 80.0, 130.0, typeof( IronIngot ), 1044036, 18, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\tindex = AddCraft( typeof( PlateDo ), 1011078, 1030184, 80.0, 130.0, typeof( IronIngot ), 1044036, 28, 1044037 ); //Double check skill\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\tindex = AddCraft( typeof( PlateHiroSode ), 1011078, 1030187, 80.0, 130.0, typeof( IronIngot ), 1044036, 16, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\tindex = AddCraft( typeof( PlateSuneate ), 1011078, 1030195, 65.0, 115.0, typeof( IronIngot ), 1044036, 20, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\tindex = AddCraft( typeof( PlateHaidate ), 1011078, 1030200, 65.0, 115.0, typeof( IronIngot ), 1044036, 20, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\t\n\t\t\t}\n\t\t\t#endregion\n\t\t\t#region Helmets\n\t\t\tAddCraft( typeof( Bascinet ), 1011079, 1025132, 8.3, 58.3, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\tAddCraft( typeof( CloseHelm ), 1011079, 1025128, 37.9, 87.9, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\tAddCraft( typeof( Helmet ), 1011079, 1025130, 37.9, 87.9, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\tAddCraft( typeof( NorseHelm ), 1011079, 1025134, 37.9, 87.9, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\tAddCraft( typeof( PlateHelm ), 1011079, 1025138, 62.6, 112.6, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\tif( Core.SE )\n\t\t\t{\n\t\t\t\tindex = AddCraft( typeof( ChainHatsuburi ), 1011079, 1030175, 30.0, 80.0, typeof( IronIngot ), 1044036, 20, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\tindex = AddCraft( typeof( PlateHatsuburi ), 1011079, 1030176, 45.0, 95.0, typeof( IronIngot ), 1044036, 20, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\tindex = AddCraft( typeof( HeavyPlateJingasa ), 1011079, 1030178, 45.0, 95.0, typeof( IronIngot ), 1044036, 20, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\t\n\t\t\t\tindex = AddCraft( typeof( LightPlateJingasa ), 1011079, 1030188, 45.0, 95.0, typeof( IronIngot ), 1044036, 20, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\t\n\t\t\t\tindex = AddCraft( typeof( SmallPlateJingasa ), 1011079, 1030191, 45.0, 95.0, typeof( IronIngot ), 1044036, 20, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\tindex = AddCraft( typeof( DecorativePlateKabuto ), 1011079, 1030179, 90.0, 140.0, typeof( IronIngot ), 1044036, 25, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\t\n\t\t\t\tindex = AddCraft( typeof( PlateBattleKabuto ), 1011079, 1030192, 90.0, 140.0, typeof( IronIngot ), 1044036, 25, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\tindex = AddCraft( typeof( StandardPlateKabuto ), 1011079, 1030196, 90.0, 140.0, typeof( IronIngot ), 1044036, 25, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\t/*\n\t\t\t\tif( Core.ML )\n\t\t\t\t{\n\t\t\t\t\tindex = AddCraft( typeof( Circlet ), 1011079, 1032645, 62.1, 112.1, typeof( IronIngot ), 1044036, 6, 1044037 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( RoyalCirclet ), 1011079, 1032646, 70.0, 120.0, typeof( IronIngot ), 1044036, 6, 1044037 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( GemmedCirclet ), 1011079, 1032647, 75.0, 125.0, typeof( IronIngot ), 1044036, 6, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( Tourmaline ), 1044237, 1, 1044240 );\n\t\t\t\t\tAddRes( index, typeof( Amethyst ), 1044236, 1, 1044240 );\n\t\t\t\t\tAddRes( index, typeof( BlueDiamond ), 1032696, 1, 1044240 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t}\n\t\t\t\t * */\n\t\t\t}\n\t\t\t#endregion\n\t\t\t#region Shields\n\t\t\tAddCraft( typeof( Buckler ), 1011080, 1027027, -25.0, 25.0, typeof( IronIngot ), 1044036, 10, 1044037 );\n\t\t\tAddCraft( typeof( BronzeShield ), 1011080, 1027026, -15.2, 34.8, typeof( IronIngot ), 1044036, 12, 1044037 );\n\t\t\tAddCraft( typeof( HeaterShield ), 1011080, 1027030, 24.3, 74.3, typeof( IronIngot ), 1044036, 18, 1044037 );\n\t\t\tAddCraft( typeof( MetalShield ), 1011080, 1027035, -10.2, 39.8, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\tAddCraft( typeof( MetalKiteShield ), 1011080, 1027028, 4.6, 54.6, typeof( IronIngot ), 1044036, 16, 1044037 );\n\t\t\tAddCraft( typeof( WoodenKiteShield ), 1011080, 1027032, -15.2, 34.8, typeof( IronIngot ), 1044036, 8, 1044037 );\n\t\t\tif ( Core.AOS )\n\t\t\t{\n\t\t\t\tAddCraft( typeof( ChaosShield ), 1011080, 1027107, 85.0, 135.0, typeof( IronIngot ), 1044036, 25, 1044037 );\n\t\t\t\tAddCraft( typeof( OrderShield ), 1011080, 1027108, 85.0, 135.0, typeof( IronIngot ), 1044036, 25, 1044037 );\n\t\t\t}\n\t\t\t#endregion\n\t\t\t#region Bladed\n\t\t\tif ( Core.AOS )\n\t\t\t\tAddCraft( typeof( BoneHarvester ), 1011081, 1029915, 33.0, 83.0, typeof( IronIngot ), 1044036, 10, 1044037 );\n\t\t\tAddCraft( typeof( Broadsword ), 1011081, 1023934, 35.4, 85.4, typeof( IronIngot ), 1044036, 10, 1044037 );\n\t\t\tif ( Core.AOS )\n\t\t\t\tAddCraft( typeof( CrescentBlade ), 1011081, 1029921, 45.0, 95.0, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\tAddCraft( typeof( Cutlass ), 1011081, 1025185, 24.3, 74.3, typeof( IronIngot ), 1044036, 8, 1044037 );\n\t\t\tAddCraft( typeof( Dagger ), 1011081, 1023921, -0.4, 49.6, typeof( IronIngot ), 1044036, 3, 1044037 );\n\t\t\tAddCraft( typeof( Katana ),1011081, 1025119, 44.1, 94.1, typeof( IronIngot ), 1044036, 8, 1044037 );\n\t\t\tAddCraft( typeof( Kryss ), 1011081, 1025121, 36.7, 86.7, typeof( IronIngot ), 1044036, 8, 1044037 );\n\t\t\tAddCraft( typeof( Longsword ), 1011081, 1023937, 28.0, 78.0, typeof( IronIngot ), 1044036, 12, 1044037 );\n\t\t\tAddCraft( typeof( Scimitar ), 1011081, 1025046, 31.7, 81.7, typeof( IronIngot ), 1044036, 10, 1044037 );\n\t\t\tAddCraft( typeof( VikingSword ), 1011081, 1025049, 24.3, 74.3, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\tif( Core.SE )\n\t\t\t{\n\t\t\t\tindex = AddCraft( typeof( NoDachi ), 1011081, 1030221, 75.0, 125.0, typeof( IronIngot ), 1044036, 18, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\tindex = AddCraft( typeof( Wakizashi ), 1011081, 1030223, 50.0, 100.0, typeof( IronIngot ), 1044036, 8, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\tindex = AddCraft( typeof( Lajatang ), 1011081, 1030226, 80.0, 130.0, typeof( IronIngot ), 1044036, 25, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\tindex = AddCraft( typeof( Daisho ), 1011081, 1030228, 60.0, 110.0, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\tindex = AddCraft( typeof( Tekagi ), 1011081, 1030230, 55.0, 105.0, typeof( IronIngot ), 1044036, 12, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\tindex = AddCraft( typeof( Shuriken ), 1011081, 1030231, 45.0, 95.0, typeof( IronIngot ), 1044036, 5, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\tindex = AddCraft( typeof( Kama ), 1011081, 1030232, 40.0, 90.0, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\tindex = AddCraft( typeof( Sai ), 1011081, 1030234, 50.0, 100.0, typeof( IronIngot ), 1044036, 12, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.SE );\n\t\t\t\t/*\n\t\t\t\tif( Core.ML )\n\t\t\t\t{\n\t\t\t\t\tindex = AddCraft( typeof( RadiantScimitar ), 1011081, 1031571, 75.0, 125.0, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( WarCleaver ), 1011081, 1031567, 70.0, 120.0, typeof( IronIngot ), 1044036, 18, 1044037 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( ElvenSpellblade ), 1011081, 1031564, 70.0, 120.0, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( AssassinSpike ), 1011081, 1031565, 70.0, 120.0, typeof( IronIngot ), 1044036, 9, 1044037 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( Leafblade ), 1011081, 1031566, 70.0, 120.0, typeof( IronIngot ), 1044036, 12, 1044037 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( RuneBlade ), 1011081, 1031570, 70.0, 120.0, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( ElvenMachete ), 1011081, 1031573, 70.0, 120.0, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( RuneCarvingKnife ), 1011081, 1072915, 70.0, 120.0, typeof( IronIngot ), 1044036, 9, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( DreadHornMane ), 1032682, 1, 1053098 );\n\t\t\t\t\tAddRes( index, typeof( Putrefication ), 1032678, 10, 1053098 );\n\t\t\t\t\tAddRes( index, typeof( Muculent ), 1032680, 10, 1053098 );\n\t\t\t\t\tAddRecipe( index, 0 );\n\t\t\t\t\tForceNonExceptional( index );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( ColdForgedBlade ), 1011081, 1072916, 70.0, 120.0, typeof( IronIngot ), 1044036, 18, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( GrizzledBones ), 1032684, 1, 1053098 );\n\t\t\t\t\tAddRes( index, typeof( Taint ), 1032684, 10, 1053098 );\n\t\t\t\t\tAddRes( index, typeof( Blight ), 1032675, 10, 1053098 );\n\t\t\t\t\tAddRecipe( index, 1 );\n\t\t\t\t\tForceNonExceptional( index );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( OverseerSunderedBlade ), 1011081, 1072920, 70.0, 120.0, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( GrizzledBones ), 1032684, 1, 1053098 );\n\t\t\t\t\tAddRes( index, typeof( Blight ), 1032675, 10, 1053098 );\n\t\t\t\t\tAddRes( index, typeof( Scourge ), 1032677, 10, 1053098 );\n\t\t\t\t\tAddRecipe( index, 2 );\n\t\t\t\t\tForceNonExceptional( index );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( LuminousRuneBlade ), 1011081, 1072922, 70.0, 120.0, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( GrizzledBones ), 1032684, 1, 1053098 );\n\t\t\t\t\tAddRes( index, typeof( Corruption ), 1032676, 10, 1053098 );\n\t\t\t\t\tAddRes( index, typeof( Putrefication ), 1032678, 10, 1053098 );\n\t\t\t\t\tAddRecipe( index, 3 );\n\t\t\t\t\tForceNonExceptional( index );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( TrueSpellblade ), 1011081, 1073513, 75.0, 125.0, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( BlueDiamond ), 1032696, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 4 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( IcySpellblade ), 1011081, 1073514, 75.0, 125.0, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( Turquoise ), 1032691, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 5 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( FierySpellblade ), 1011081, 1073515, 75.0, 125.0, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( FireRuby ), 1032695, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 6 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( SpellbladeOfDefense ), 1011081, 1073516, 75.0, 125.0, typeof( IronIngot ), 1044036, 18, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( WhitePearl ), 1032694, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 7 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( TrueAssassinSpike ), 1011081, 1073517, 75.0, 125.0, typeof( IronIngot ), 1044036, 9, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( DarkSapphire ), 1032690, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 8 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( ChargedAssassinSpike ), 1011081, 1073518, 75.0, 125.0, typeof( IronIngot ), 1044036, 9, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( EcruCitrine ), 1032693, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 9 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( MagekillerAssassinSpike ), 1011081, 1073519, 75.0, 125.0, typeof( IronIngot ), 1044036, 9, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( BrilliantAmber ), 1032697, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 10 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( WoundingAssassinSpike ), 1011081, 1073520, 75.0, 125.0, typeof( IronIngot ), 1044036, 9, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( PerfectEmerald ), 1032692, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 11 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( TrueLeafblade ), 1011081, 1073521, 75.0, 125.0, typeof( IronIngot ), 1044036, 12, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( BlueDiamond ), 1032696, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 12 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( Luckblade ), 1011081, 1073522, 75.0, 125.0, typeof( IronIngot ), 1044036, 12, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( WhitePearl ), 1032694, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 13 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( MagekillerLeafblade ), 1011081, 1073523, 75.0, 125.0, typeof( IronIngot ), 1044036, 12, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( FireRuby ), 1032695, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 14 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( LeafbladeOfEase ), 1011081, 1073524, 75.0, 125.0, typeof( IronIngot ), 1044036, 12, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( PerfectEmerald ), 1032692, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 15 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( KnightsWarCleaver ), 1011081, 1073525, 75.0, 125.0, typeof( IronIngot ), 1044036, 18, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( PerfectEmerald ), 1032692, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 16 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( ButchersWarCleaver ), 1011081, 1073526, 75.0, 125.0, typeof( IronIngot ), 1044036, 18, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( Turquoise ), 1032691, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 17 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( SerratedWarCleaver ), 1011081, 1073527, 75.0, 125.0, typeof( IronIngot ), 1044036, 18, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( EcruCitrine ), 1032693, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 18 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( TrueWarCleaver ), 1011081, 1073528, 75.0, 125.0, typeof( IronIngot ), 1044036, 18, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( BrilliantAmber ), 1032697, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 19 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( AdventurersMachete ), 1011081, 1073533, 75.0, 125.0, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( WhitePearl ), 1032694, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 20 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( OrcishMachete ), 1011081, 1073534, 75.0, 125.0, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( Scourge ), 1072136, 1, 1042081 );\n\t\t\t\t\tAddRecipe( index, 21 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( MacheteOfDefense ), 1011081, 1073535, 75.0, 125.0, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( BrilliantAmber ), 1032697, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 22 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( DiseasedMachete ), 1011081, 1073536, 75.0, 125.0, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( Blight ), 1072134, 1, 1042081 );\n\t\t\t\t\tAddRecipe( index, 23 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( RuneSabre ), 1011081, 1073537, 75.0, 125.0, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( Turquoise ), 1032691, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 24 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( MagesRuneBlade ), 1011081, 1073538, 75.0, 125.0, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( BlueDiamond ), 1032696, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 25 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( RuneBladeOfKnowledge ), 1011081, 1073539, 75.0, 125.0, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( EcruCitrine ), 1032693, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 26 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( CorruptedRuneBlade ), 1011081, 1073540, 75.0, 125.0, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( Corruption ), 1072135, 1, 1042081 );\n\t\t\t\t\tAddRecipe( index, 27 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( TrueRadiantScimitar ), 1011081, 1073541, 75.0, 125.0, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( BrilliantAmber ), 1032697, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 28 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( DarkglowScimitar ), 1011081, 1073542, 75.0, 125.0, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( DarkSapphire ), 1032690, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 29 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( IcyScimitar ), 1011081, 1073543, 75.0, 125.0, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( DarkSapphire ), 1032690, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 30 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( TwinklingScimitar ), 1011081, 1073544, 75.0, 125.0, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( DarkSapphire ), 1032690, 1, 1044240 );\n\t\t\t\t\tAddRecipe( index, 31 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t\tindex = AddCraft( typeof( BoneMachete ), 1011081, 1020526, 75.0, 125.0, typeof( IronIngot ), 1044036, 20, 1044037 );\n\t\t\t\t\tAddRes( index, typeof( Bone ), 1049064, 6, 1049063 );\n\t\t\t\t\tAddRecipe( index, 32 );\n\t\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t}\n\t\t\t#endregion\n\t\t\t#region Axes\n\t\t\tAddCraft( typeof( Axe ), 1011082, 1023913, 34.2, 84.2, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\tAddCraft( typeof( BattleAxe ), 1011082, 1023911, 30.5, 80.5, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\tAddCraft( typeof( DoubleAxe ), 1011082, 1023915, 29.3, 79.3, typeof( IronIngot ), 1044036, 12, 1044037 );\n\t\t\tAddCraft( typeof( ExecutionersAxe ), 1011082, 1023909, 34.2, 84.2, typeof( IronIngot ), 1044036, 14, 1044037 );\n\t\t\tAddCraft( typeof( LargeBattleAxe ), 1011082, 1025115, 28.0, 78.0, typeof( IronIngot ), 1044036, 12, 1044037 );\n\t\t\tAddCraft( typeof( TwoHandedAxe ), 1011082, 1025187, 33.0, 83.0, typeof( IronIngot ), 1044036, 16, 1044037 );\n\t\t\tAddCraft( typeof( WarAxe ), 1011082, 1025040, 39.1, 89.1, typeof( IronIngot ), 1044036, 16, 1044037 );\n\t\t\t/*\n\t\t\tif( Core.ML )\n\t\t\t{\n\t\t\t\tindex = AddCraft( typeof( OrnateAxe ), 1011082, 1031572, 70.0, 120.0, typeof( IronIngot ), 1044036, 18, 1044037 );\n\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\tindex = AddCraft( typeof( GuardianAxe ), 1011082, 1073545, 75.0, 125.0, typeof( IronIngot ), 1044036, 15, 1044037 );\n\t\t\t\tAddRes( index, typeof( BlueDiamond ), 1032696, 1, 1044240 );\n\t\t\t\tAddRecipe( index, 33 );\n\t\t\t\tSetNeededExpansion( index, Expansion.ML );\n\t\t\t\tindex = AddCraft( typeof( SingingAxe ), 1011082, 1073546, 75.0, 125.0, typeof( IronIngot ), 1044036, 15, 1044037 );\n", "answers": ["\t\t\t\tAddRes( index, typeof( BrilliantAmber ), 1032697, 1, 1044240 );"], "incorrect_answer": "AddRes( index, typeof( RadiantEmerald ), 1032700, 1, 1044240 );"}, {"input": "", "context": "from io import BytesIO\nfrom translate.convert import prop2po, test_convert\nfrom translate.storage import po, properties\nclass TestProp2PO:\n    @staticmethod\n    def prop2po(propsource, proptemplate=None, personality=\"java\"):\n        \"\"\"helper that converts .properties source to po source without requiring files\"\"\"\n        inputfile = BytesIO(propsource.encode())\n        inputprop = properties.propfile(inputfile, personality=personality)\n        convertor = prop2po.prop2po(personality=personality)\n        if proptemplate:\n            templatefile = BytesIO(proptemplate.encode())\n            templateprop = properties.propfile(templatefile)\n            outputpo = convertor.mergestore(templateprop, inputprop)\n        else:\n            outputpo = convertor.convertstore(inputprop)\n        return outputpo\n    @staticmethod\n    def convertprop(propsource):\n        \"\"\"call the convertprop, return the outputfile\"\"\"\n        inputfile = BytesIO(propsource.encode())\n        outputfile = BytesIO()\n        templatefile = None\n        assert prop2po.convertprop(inputfile, outputfile, templatefile)\n        return outputfile.getvalue()\n    @staticmethod\n    def singleelement(pofile):\n        \"\"\"checks that the pofile contains a single non-header element, and returns it\"\"\"\n        assert len(pofile.units) == 2\n        assert pofile.units[0].isheader()\n        print(pofile)\n        return pofile.units[1]\n    @staticmethod\n    def countelements(pofile):\n        \"\"\"counts the number of non-header entries\"\"\"\n        assert pofile.units[0].isheader()\n        print(pofile)\n        return len(pofile.units) - 1\n    def test_simpleentry(self):\n        \"\"\"checks that a simple properties entry converts properly to a po entry\"\"\"\n        propsource = \"SAVEENTRY=Save file\\n\"\n        pofile = self.prop2po(propsource)\n        pounit = self.singleelement(pofile)\n        assert pounit.source == \"Save file\"\n        assert pounit.target == \"\"\n    def test_convertprop(self):\n        \"\"\"checks that the convertprop function is working\"\"\"\n        propsource = \"SAVEENTRY=Save file\\n\"\n        posource = self.convertprop(propsource)\n        pofile = po.pofile(BytesIO(posource))\n        pounit = self.singleelement(pofile)\n        assert pounit.source == \"Save file\"\n        assert pounit.target == \"\"\n    def test_no_value_entry(self):\n        \"\"\"checks that a properties entry without value is converted\"\"\"\n        propsource = \"KEY = \\n\"\n        pofile = self.prop2po(propsource)\n        pounit = self.singleelement(pofile)\n        assert pounit.getcontext() == \"KEY\"\n        assert pounit.source == \"\"\n        assert pounit.target == \"\"\n    def test_no_separator_entry(self):\n        \"\"\"checks that a properties entry without separator is converted\"\"\"\n        propsource = \"KEY\\n\"\n        pofile = self.prop2po(propsource)\n        pounit = self.singleelement(pofile)\n        assert pounit.getcontext() == \"KEY\"\n        assert pounit.source == \"\"\n        assert pounit.target == \"\"\n    def test_tab_at_end_of_string(self):\n        \"\"\"check that we preserve tabs at the end of a string\"\"\"\n        propsource = r\"TAB_AT_END=This setence has a tab at the end.\\t\"\n        pofile = self.prop2po(propsource)\n        pounit = self.singleelement(pofile)\n        assert pounit.source == \"This setence has a tab at the end.\\t\"\n        propsource = (\n            r\"SPACE_THEN_TAB_AT_END=This setence has a space then tab at the end. \\t\"\n        )\n        pofile = self.prop2po(propsource)\n        pounit = self.singleelement(pofile)\n        assert pounit.source == \"This setence has a space then tab at the end. \\t\"\n        propsource = r\"SPACE_AT_END=This setence will keep its 4 spaces at the end.    \"\n        pofile = self.prop2po(propsource)\n        pounit = self.singleelement(pofile)\n        assert pounit.source == \"This setence will keep its 4 spaces at the end.    \"\n        propsource = (\n            r\"SPACE_AT_END_NO_TRIM=This setence will keep its 4 spaces at the end.\\    \"\n        )\n        pofile = self.prop2po(propsource)\n        pounit = self.singleelement(pofile)\n        assert pounit.source == \"This setence will keep its 4 spaces at the end.    \"\n        propsource = r\"SPACE_AT_END_NO_TRIM2=This setence will keep its 4 spaces at the end.\\\\    \"\n        pofile = self.prop2po(propsource)\n        pounit = self.singleelement(pofile)\n        assert pounit.source == \"This setence will keep its 4 spaces at the end.\\\\    \"\n    def test_tab_at_start_of_value(self):\n        \"\"\"check that tabs in a property are ignored where appropriate\"\"\"\n        propsource = r\"property\t=\tvalue\"\n        pofile = self.prop2po(propsource)\n        pounit = self.singleelement(pofile)\n        assert pounit.getlocations()[0] == \"property\"\n        assert pounit.source == \"value\"\n    def test_unicode(self):\n        \"\"\"checks that unicode entries convert properly\"\"\"\n        unistring = r\"Norsk bokm\\u00E5l\"\n        propsource = \"nb = %s\\n\" % unistring\n        pofile = self.prop2po(propsource)\n        pounit = self.singleelement(pofile)\n        print(repr(pofile.units[0].target))\n        print(repr(pounit.source))\n        assert pounit.source == \"Norsk bokm\\u00E5l\"\n    def test_multiline_escaping(self):\n        \"\"\"checks that multiline enties can be parsed\"\"\"\n        propsource = r\"\"\"5093=Unable to connect to your IMAP server. You may have exceeded the maximum number \\\nof connections to this server. If so, use the Advanced IMAP Server Settings dialog to \\\nreduce the number of cached connections.\"\"\"\n        pofile = self.prop2po(propsource)\n        print(repr(pofile.units[1].target))\n        assert self.countelements(pofile) == 1\n    def test_comments(self):\n        \"\"\"test to ensure that we take comments from .properties and place them in .po\"\"\"\n        propsource = \"\"\"# Comment\nprefPanel-smime=Security\"\"\"\n        pofile = self.prop2po(propsource)\n        pounit = self.singleelement(pofile)\n        assert pounit.getnotes(\"developer\") == \"# Comment\"\n    def test_multiline_comments(self):\n        \"\"\"test to ensure that we handle multiline comments well\"\"\"\n        propsource = \"\"\"# Comment\n# commenty 2\n## @name GENERIC_ERROR\n## @loc none\nprefPanel-smime=\n\"\"\"\n        pofile = self.prop2po(propsource)\n        print(bytes(pofile))\n        # header comments:\n        assert b\"#. # Comment\\n#. # commenty 2\" in bytes(pofile)\n        pounit = self.singleelement(pofile)\n        assert pounit.getnotes(\"developer\") == \"## @name GENERIC_ERROR\\n## @loc none\"\n    def test_folding_accesskeys(self):\n        \"\"\"check that we can fold various accesskeys into their associated label (bug #115)\"\"\"\n        propsource = r\"\"\"cmd_addEngine.label = Add Engines...\ncmd_addEngine.accesskey = A\"\"\"\n        pofile = self.prop2po(propsource, personality=\"mozilla\")\n        pounit = self.singleelement(pofile)\n        assert pounit.source == \"&Add Engines...\"\n    def test_dont_translate(self):\n        \"\"\"check that we know how to ignore don't translate instructions in properties files (bug #116)\"\"\"\n        propsource = \"\"\"# LOCALIZATION NOTE (dont): DONT_TRANSLATE.\ndont=don't translate me\ndo=translate me\n\"\"\"\n        pofile = self.prop2po(propsource)\n        assert self.countelements(pofile) == 1\n    def test_emptyproperty(self):\n        \"\"\"checks that empty property definitions survive into po file, bug 15\"\"\"\n        for delimiter in [\"=\", \"\"]:\n            propsource = \"# comment\\ncredit%s\" % delimiter\n            pofile = self.prop2po(propsource)\n            pounit = self.singleelement(pofile)\n            assert pounit.getlocations() == [\"credit\"]\n            assert pounit.getcontext() == \"credit\"\n            assert 'msgctxt \"credit\"' in str(pounit)\n            assert b\"#. # comment\" in bytes(pofile)\n            assert pounit.source == \"\"\n    def test_emptyproperty_translated(self):\n        \"\"\"checks that if we translate an empty property it makes it into the PO\"\"\"\n        for delimiter in [\"=\", \"\"]:\n            proptemplate = \"credit%s\" % delimiter\n            propsource = \"credit=Translators Names\"\n            pofile = self.prop2po(propsource, proptemplate)\n            pounit = self.singleelement(pofile)\n            assert pounit.getlocations() == [\"credit\"]\n            # FIXME we don't seem to get a _: comment but we should\n            # assert pounit.getcontext() == \"credit\"\n            assert pounit.source == \"\"\n            assert pounit.target == \"Translators Names\"\n    def test_newlines_in_value(self):\n        \"\"\"check that we can carry newlines that appear in the property value into the PO\"\"\"\n        propsource = \"\"\"prop=\\\\nvalue\\\\n\\n\"\"\"\n        pofile = self.prop2po(propsource)\n        unit = self.singleelement(pofile)\n        assert unit.source == \"\\nvalue\\n\"\n    def test_header_comments(self):\n        \"\"\"check that we can handle comments not directly associated with a property\"\"\"\n        propsource = \"\"\"# Header comment\\n\\n# Comment\\n\\nprop=value\\n\"\"\"\n        pofile = self.prop2po(propsource)\n        unit = self.singleelement(pofile)\n        assert unit.source == \"value\"\n        assert unit.getnotes(\"developer\") == \"# Comment\"\n    def test_unassociated_comment_order(self):\n        \"\"\"check that we can handle the order of unassociated comments\"\"\"\n        propsource = \"\"\"# Header comment\\n\\n# 1st Unassociated comment\\n\\n# 2nd Connected comment\\nprop=value\\n\"\"\"\n        pofile = self.prop2po(propsource)\n        unit = self.singleelement(pofile)\n        assert unit.source == \"value\"\n        assert (\n            unit.getnotes(\"developer\")\n            == \"# 1st Unassociated comment\\n\\n# 2nd Connected comment\"\n        )\n    def test_x_header(self):\n        \"\"\"Test that we correctly create the custom header entries\n        (accelerators, merge criterion).\n        \"\"\"\n        propsource = \"\"\"prop=value\\n\"\"\"\n        outputpo = self.prop2po(propsource, personality=\"mozilla\")\n        assert b\"X-Accelerator-Marker\" in bytes(outputpo)\n        assert b\"X-Merge-On\" in bytes(outputpo)\n        # Even though the gaia flavour inherrits from mozilla, it should not\n        # get the header\n        outputpo = self.prop2po(propsource, personality=\"gaia\")\n        assert b\"X-Accelerator-Marker\" not in bytes(outputpo)\n        assert b\"X-Merge-On\" not in bytes(outputpo)\n    def test_gaia_plurals(self):\n        \"\"\"Test conversion of gaia plural units.\"\"\"\n        propsource = \"\"\"\nmessage-multiedit-header={[ plural(n) ]}\nmessage-multiedit-header[zero]=Edit\nmessage-multiedit-header[one]={{ n }} selected\nmessage-multiedit-header[two]={{ n }} selected\nmessage-multiedit-header[few]={{ n }} selected\nmessage-multiedit-header[many]={{ n }} selected\nmessage-multiedit-header[other]={{ n }} selected\n\"\"\"\n        outputpo = self.prop2po(propsource, personality=\"gaia\")\n        pounit = outputpo.units[-1]\n        assert pounit.hasplural()\n        assert pounit.getlocations() == [\"message-multiedit-header\"]\n        print(outputpo)\n        zero_unit = outputpo.units[-2]\n        assert not zero_unit.hasplural()\n        assert zero_unit.source == \"Edit\"\n    def test_successive_gaia_plurals(self):\n        \"\"\"Test conversion of two successive gaia plural units.\"\"\"\n        propsource = \"\"\"\nmessage-multiedit-header={[ plural(n) ]}\nmessage-multiedit-header[zero]=Edit\nmessage-multiedit-header[one]={{ n }} selected\nmessage-multiedit-header[two]={{ n }} selected\nmessage-multiedit-header[few]={{ n }} selected\nmessage-multiedit-header[many]={{ n }} selected\nmessage-multiedit-header[other]={{ n }} selected\nmessage-multiedit-header2={[ plural(n) ]}\nmessage-multiedit-header2[zero]=Edit 2\nmessage-multiedit-header2[one]={{ n }} selected 2\nmessage-multiedit-header2[two]={{ n }} selected 2\nmessage-multiedit-header2[few]={{ n }} selected 2\nmessage-multiedit-header2[many]={{ n }} selected 2\nmessage-multiedit-header2[other]={{ n }} selected 2\n\"\"\"\n        outputpo = self.prop2po(propsource, personality=\"gaia\")\n        pounit = outputpo.units[-1]\n        assert pounit.hasplural()\n        assert pounit.getlocations() == [\"message-multiedit-header2\"]\n        pounit = outputpo.units[-3]\n        assert pounit.hasplural()\n        assert pounit.getlocations() == [\"message-multiedit-header\"]\n        print(outputpo)\n        zero_unit = outputpo.units[-2]\n        assert not zero_unit.hasplural()\n        assert zero_unit.source == \"Edit 2\"\n        zero_unit = outputpo.units[-4]\n        assert not zero_unit.hasplural()\n        assert zero_unit.source == \"Edit\"\n    def test_duplicate_keys(self):\n        \"\"\"Check that we correctly handle duplicate keys.\"\"\"\n        source = \"\"\"\nkey=value\nkey=value\n\"\"\"\n        po_file = self.prop2po(source)\n        assert self.countelements(po_file) == 1\n        po_unit = self.singleelement(po_file)\n        assert po_unit.source == \"value\"\n        source = \"\"\"\nkey=value\nkey=another value\n\"\"\"\n        po_file = self.prop2po(source)\n        assert self.countelements(po_file) == 2\n        po_unit = po_file.units[1]\n        assert po_unit.source == \"value\"\n        assert po_unit.getlocations() == [\"key\"]\n        po_unit = po_file.units[2]\n        assert po_unit.source == \"another value\"\n        assert po_unit.getlocations() == [\"key\"]\n        source = \"\"\"\nkey1=value\nkey2=value\n\"\"\"\n        po_file = self.prop2po(source)\n        assert self.countelements(po_file) == 2\n        po_unit = po_file.units[1]\n        assert po_unit.source == \"value\"\n        assert po_unit.getlocations() == [\"key1\"]\n        po_unit = po_file.units[2]\n        assert po_unit.source == \"value\"\n        assert po_unit.getlocations() == [\"key2\"]\n    def test_gwt_plurals(self):\n        \"\"\"Test conversion of gwt plural units.\"\"\"\n        propsource = \"\"\"\nmessage-multiedit-header={0,number} selected\nmessage-multiedit-header[none]=Edit\nmessage-multiedit-header[one]={0,number} selected\nmessage-multiedit-header[two]={0,number} selected\nmessage-multiedit-header[few]={0,number} selected\nmessage-multiedit-header[many]={0,number} selected\n\"\"\"\n        outputpo = self.prop2po(propsource, personality=\"gwt\")\n        pounit = outputpo.units[-1]\n        assert pounit.getlocations() == [\"message-multiedit-header\"]\nclass TestProp2POCommand(test_convert.TestConvertCommand, TestProp2PO):\n    \"\"\"Tests running actual prop2po commands on files\"\"\"\n    convertmodule = prop2po\n    defaultoptions = {\"progress\": \"none\"}\n    def test_help(self, capsys):\n        \"\"\"tests getting help\"\"\"\n        options = super().test_help(capsys)\n", "answers": ["        options = self.help_check(options, \"-P, --pot\")"], "incorrect_answer": "options = self.help_check(options, \"-H, --help\")"}, {"input": "", "context": "// GtkSharp.Generation.InterfaceGen.cs - The Interface Generatable.\n//\n// Author: Mike Kestner <mkestner@speakeasy.net>\n//\n// Copyright (c) 2001-2003 Mike Kestner\n// Copyright (c) 2004, 2007 Novell, Inc.\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of version 2 of the GNU General Public\n// License as published by the Free Software Foundation.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n// General Public License for more details.\n//\n// You should have received a copy of the GNU General Public\n// License along with this program; if not, write to the\n// Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n// Boston, MA 02111-1307, USA.\nnamespace GtkSharp.Generation {\n\tusing System;\n\tusing System.Collections;\n\tusing System.IO;\n\tusing System.Xml;\n\tpublic class InterfaceGen : ObjectBase {\n\t\tbool consume_only;\n\t\tArrayList vms = new ArrayList ();\n\t\tArrayList members = new ArrayList ();\n\t\tpublic InterfaceGen (XmlElement ns, XmlElement elem) : base (ns, elem) \n\t\t{\n\t\t\tconsume_only = elem.HasAttribute (\"consume_only\");\n\t\t\tforeach (XmlNode node in elem.ChildNodes) {\n\t\t\t\tswitch (node.Name) {\n\t\t\t\tcase \"virtual_method\":\n\t\t\t\t\tVirtualMethod vm = new VirtualMethod (node as XmlElement, this);\n\t\t\t\t\tvms.Add (vm);\n\t\t\t\t\tmembers.Add (vm);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"signal\":\n\t\t\t\t\tobject sig = sigs [(node as XmlElement).GetAttribute (\"name\")];\n\t\t\t\t\tif (sig == null)\n\t\t\t\t\t\tsig = new Signal (node as XmlElement, this);\n\t\t\t\t\tmembers.Add (sig);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tif (!IsNodeNameHandled (node.Name))\n\t\t\t\t\t\tConsole.WriteLine (\"Unexpected node \" + node.Name + \" in \" + CName);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tpublic bool IsConsumeOnly {\n\t\t\tget {\n\t\t\t\treturn consume_only;\n\t\t\t}\n\t\t}\n\t\tpublic override string FromNative (string var, bool owned)\n\t\t{\n\t\t\tif (IsConsumeOnly)\n\t\t\t\treturn \"GLib.Object.GetObject (\" + var + \", \" + (owned ? \"true\" : \"false\") + \") as \" + QualifiedName;\n\t\t\telse\n\t\t\t\treturn QualifiedName + \"Adapter.GetObject (\" + var + \", \" + (owned ? \"true\" : \"false\") + \")\";\n\t\t}\n\t\tpublic override bool ValidateForSubclass ()\n\t\t{\n\t\t\tArrayList invalids = new ArrayList ();\n\t\t\tforeach (Method method in methods.Values) {\n\t\t\t\tif (!method.Validate ()) {\n\t\t\t\t\tConsole.WriteLine (\"in type \" + QualifiedName);\n\t\t\t\t\tinvalids.Add (method);\n\t\t\t\t}\n\t\t\t}\n\t\t\tforeach (Method method in invalids)\n\t\t\t\tmethods.Remove (method.Name);\n\t\t\tinvalids.Clear ();\n\t\t\treturn base.ValidateForSubclass ();\n\t\t}\n\t\tstring IfaceName {\n\t\t\tget {\n\t\t\t\treturn Name + \"Iface\";\n\t\t\t}\n\t\t}\n\t\tvoid GenerateIfaceStruct (StreamWriter sw)\n\t\t{\n\t\t\tsw.WriteLine (\"\\t\\tstatic \" + IfaceName + \" iface;\");\n\t\t\tsw.WriteLine ();\n\t\t\tsw.WriteLine (\"\\t\\tstruct \" + IfaceName + \" {\");\n\t\t\tsw.WriteLine (\"\\t\\t\\tpublic IntPtr gtype;\");\n\t\t\tsw.WriteLine (\"\\t\\t\\tpublic IntPtr itype;\");\n\t\t\tsw.WriteLine ();\n\t\t\tforeach (object member in members) {\n\t\t\t\tif (member is Signal) {\n\t\t\t\t\tSignal sig = member as Signal;\n\t\t\t\t\tsw.WriteLine (\"\\t\\t\\tpublic IntPtr {0};\", sig.CName.Replace (\"\\\"\", \"\").Replace (\"-\", \"_\"));\n\t\t\t\t} else if (member is VirtualMethod) {\n\t\t\t\t\tVirtualMethod vm = member as VirtualMethod;\n\t\t\t\t\tbool has_target = methods [vm.Name] != null;\n\t\t\t\t\tif (!has_target)\n\t\t\t\t\t\tConsole.WriteLine (\"Interface \" + QualifiedName + \" virtual method \" + vm.Name + \" has no matching method to invoke.\");\n\t\t\t\t\tstring type = has_target && vm.IsValid ? vm.Name + \"Delegate\" : \"IntPtr\";\n\t\t\t\t\tsw.WriteLine (\"\\t\\t\\tpublic \" + type + \" \" + vm.CName + \";\");\n\t\t\t\t}\n\t\t\t}\n\t\t\tsw.WriteLine (\"\\t\\t}\");\n\t\t\tsw.WriteLine ();\n\t\t}\n\t\tvoid GenerateStaticCtor (StreamWriter sw)\n\t\t{\n\t\t\tsw.WriteLine (\"\\t\\tstatic \" + Name + \"Adapter ()\");\n\t\t\tsw.WriteLine (\"\\t\\t{\");\n\t\t\tsw.WriteLine (\"\\t\\t\\tGLib.GType.Register (_gtype, typeof({0}Adapter));\", Name);\n\t\t\tforeach (VirtualMethod vm in vms) {\n\t\t\t\tbool has_target = methods [vm.Name] != null;\n\t\t\t\tif (has_target && vm.IsValid)\n\t\t\t\t\tsw.WriteLine (\"\\t\\t\\tiface.{0} = new {1}Delegate ({1}Callback);\", vm.CName, vm.Name);\n\t\t\t}\n\t\t\tsw.WriteLine (\"\\t\\t}\");\n\t\t\tsw.WriteLine ();\n\t\t}\n\t\tvoid GenerateInitialize (StreamWriter sw)\n\t\t{\n\t\t\tsw.WriteLine (\"\\t\\tstatic void Initialize (IntPtr ifaceptr, IntPtr data)\");\n\t\t\tsw.WriteLine (\"\\t\\t{\");\n\t\t\tsw.WriteLine (\"\\t\\t\\t\" + IfaceName + \" native_iface = Marshal.PtrToStructure<\" + IfaceName + \"> (ifaceptr);\");\n\t\t\tforeach (VirtualMethod vm in vms)\n\t\t\t\tsw.WriteLine (\"\\t\\t\\tnative_iface.\" + vm.CName + \" = iface.\" + vm.CName + \";\");\n\t\t\tsw.WriteLine (\"\\t\\t\\tMarshal.StructureToPtr<\" + IfaceName + \"> (native_iface, ifaceptr, false);\");\n\t\t\tsw.WriteLine (\"\\t\\t\\tGCHandle gch = (GCHandle) data;\");\n\t\t\tsw.WriteLine (\"\\t\\t\\tgch.Free ();\");\n\t\t\tsw.WriteLine (\"\\t\\t}\");\n\t\t\tsw.WriteLine ();\n\t\t}\n\t\tvoid GenerateCallbacks (StreamWriter sw)\n\t\t{\n\t\t\tforeach (VirtualMethod vm in vms) {\n\t\t\t\tif (methods [vm.Name] != null) {\n\t\t\t\t\tsw.WriteLine ();\n\t\t\t\t\tvm.GenerateCallback (sw);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvoid GenerateCtors (StreamWriter sw)\n\t\t{\n\t\t\tsw.WriteLine (\"\\t\\tpublic \" + Name + \"Adapter ()\");\n\t\t\tsw.WriteLine (\"\\t\\t{\");\n\t\t\tsw.WriteLine (\"\\t\\t\\tInitHandler = new GLib.GInterfaceInitHandler (Initialize);\");\n\t\t\tsw.WriteLine (\"\\t\\t}\");\n\t\t\tsw.WriteLine ();\n\t\t\tsw.WriteLine (\"\\t\\t{0}Implementor implementor;\", Name);\n\t\t\tsw.WriteLine ();\n\t\t\tsw.WriteLine (\"\\t\\tpublic {0}Adapter ({0}Implementor implementor)\", Name);\n\t\t\tsw.WriteLine (\"\\t\\t{\");\n\t\t\tsw.WriteLine (\"\\t\\t\\tif (implementor == null)\");\n\t\t\tsw.WriteLine (\"\\t\\t\\t\\tthrow new ArgumentNullException (\\\"implementor\\\");\");\n\t\t\tsw.WriteLine (\"\\t\\t\\tthis.implementor = implementor;\");\n\t\t\tsw.WriteLine (\"\\t\\t}\");\n\t\t\tsw.WriteLine ();\n\t\t\tsw.WriteLine (\"\\t\\tpublic \" + Name + \"Adapter (IntPtr handle)\");\n\t\t\tsw.WriteLine (\"\\t\\t{\");\n\t\t\tsw.WriteLine (\"\\t\\t\\tthis.handle = handle;\");\n\t\t\tsw.WriteLine (\"\\t\\t}\");\n\t\t\tsw.WriteLine ();\n\t\t}\n\t\tvoid GenerateGType (StreamWriter sw)\n\t\t{\n\t\t\tMethod m = GetMethod (\"GetType\");\n\t\t\tm.GenerateImport (sw);\n\t\t\tsw.WriteLine (\"\\t\\tprivate static GLib.GType _gtype = new GLib.GType ({0} ());\", m.CName);\n\t\t\tsw.WriteLine ();\n\t\t\tsw.WriteLine (\"\\t\\tpublic override GLib.GType GType {\");\n\t\t\tsw.WriteLine (\"\\t\\t\\tget {\");\n\t\t\tsw.WriteLine (\"\\t\\t\\t\\treturn _gtype;\");\n\t\t\tsw.WriteLine (\"\\t\\t\\t}\");\n\t\t\tsw.WriteLine (\"\\t\\t}\");\n\t\t\tsw.WriteLine ();\n\t\t}\n\t\tvoid GenerateHandleProp (StreamWriter sw)\n\t\t{\n\t\t\tsw.WriteLine (\"\\t\\tIntPtr handle;\");\n\t\t\tsw.WriteLine (\"\\t\\tpublic override IntPtr Handle {\");\n\t\t\tsw.WriteLine (\"\\t\\t\\tget {\");\n\t\t\tsw.WriteLine (\"\\t\\t\\t\\tif (handle != IntPtr.Zero)\");\n\t\t\tsw.WriteLine (\"\\t\\t\\t\\t\\treturn handle;\");\n\t\t\tsw.WriteLine (\"\\t\\t\\t\\treturn implementor == null ? IntPtr.Zero : implementor.Handle;\");\n\t\t\tsw.WriteLine (\"\\t\\t\\t}\");\n\t\t\tsw.WriteLine (\"\\t\\t}\");\n\t\t\tsw.WriteLine ();\n\t\t}\n\t\tvoid GenerateGetObject (StreamWriter sw)\n\t\t{\n\t\t\tsw.WriteLine (\"\\t\\tpublic static \" + Name + \" GetObject (IntPtr handle, bool owned)\");\n\t\t\tsw.WriteLine (\"\\t\\t{\");\n\t\t\tsw.WriteLine (\"\\t\\t\\tGLib.Object obj = GLib.Object.GetObject (handle, owned);\");\n\t\t\tsw.WriteLine (\"\\t\\t\\treturn GetObject (obj);\");\n\t\t\tsw.WriteLine (\"\\t\\t}\");\n\t\t\tsw.WriteLine ();\n\t\t\tsw.WriteLine (\"\\t\\tpublic static \" + Name + \" GetObject (GLib.Object obj)\");\n\t\t\tsw.WriteLine (\"\\t\\t{\");\n\t\t\tsw.WriteLine (\"\\t\\t\\tif (obj == null)\");\n\t\t\tsw.WriteLine (\"\\t\\t\\t\\treturn null;\");\n\t\t\tsw.WriteLine (\"\\t\\t\\telse if (obj is \" + Name + \"Implementor)\");\n\t\t\tsw.WriteLine (\"\\t\\t\\t\\treturn new {0}Adapter (obj as {0}Implementor);\", Name);\n\t\t\tsw.WriteLine (\"\\t\\t\\telse if (obj as \" + Name + \" == null)\");\n\t\t\tsw.WriteLine (\"\\t\\t\\t\\treturn new {0}Adapter (obj.Handle);\", Name);\n\t\t\tsw.WriteLine (\"\\t\\t\\telse\");\n\t\t\tsw.WriteLine (\"\\t\\t\\t\\treturn obj as {0};\", Name);\n\t\t\tsw.WriteLine (\"\\t\\t}\");\n\t\t\tsw.WriteLine ();\n\t\t}\n\t\tvoid GenerateImplementorProp (StreamWriter sw)\n\t\t{\n\t\t\tsw.WriteLine (\"\\t\\tpublic \" + Name + \"Implementor Implementor {\");\n\t\t\tsw.WriteLine (\"\\t\\t\\tget {\");\n\t\t\tsw.WriteLine (\"\\t\\t\\t\\treturn implementor;\");\n\t\t\tsw.WriteLine (\"\\t\\t\\t}\");\n\t\t\tsw.WriteLine (\"\\t\\t}\");\n\t\t\tsw.WriteLine ();\n\t\t}\n\t\tvoid GenerateAdapter (GenerationInfo gen_info)\n\t\t{\n\t\t\tif (IsConsumeOnly)\n\t\t\t\treturn;\n\t\t\tStreamWriter sw = gen_info.Writer = gen_info.OpenStream (Name + \"Adapter\");\n\t\t\tsw.WriteLine (\"namespace \" + NS + \" {\");\n\t\t\tsw.WriteLine ();\n\t\t\tsw.WriteLine (\"\\tusing System;\");\n\t\t\tsw.WriteLine (\"\\tusing System.Runtime.InteropServices;\");\n\t\t\tsw.WriteLine ();\n\t\t\tsw.WriteLine (\"#region Autogenerated code\");\n\t\t\tsw.WriteLine (\"\\tpublic class \" + Name + \"Adapter : GLib.GInterfaceAdapter, \" + QualifiedName + \" {\");\n\t\t\tsw.WriteLine ();\n\t\t\tGenerateIfaceStruct (sw);\n\t\t\tGenerateStaticCtor (sw);\n\t\t\tGenerateCallbacks (sw);\n\t\t\tGenerateInitialize (sw);\n\t\t\tGenerateCtors (sw);\n\t\t\tGenerateGType (sw);\n\t\t\tGenerateHandleProp (sw);\n\t\t\tGenerateGetObject (sw);\n\t\t\tGenerateImplementorProp (sw);\n\t\t\tGenProperties (gen_info, null);\n\t\t\tforeach (Signal sig in sigs.Values)\n\t\t\t\tsig.GenEvent (sw, null, \"GLib.Object.GetObject (Handle)\");\n\t\t\tMethod temp = methods [\"GetType\"] as Method;\n\t\t\tif (temp != null)\n\t\t\t\tmethods.Remove (\"GetType\");\n\t\t\tGenMethods (gen_info, new Hashtable (), this);\n\t\t\tif (temp != null)\n\t\t\t\tmethods [\"GetType\"] = temp;\n\t\t\tsw.WriteLine (\"#endregion\");\n\t\t\tAppendCustom (sw, gen_info.CustomDir, Name + \"Adapter\");\n\t\t\tsw.WriteLine (\"\\t}\");\n\t\t\tsw.WriteLine (\"}\");\n\t\t\tsw.Close ();\n\t\t\tgen_info.Writer = null;\n\t\t}\n\t\tvoid GenerateImplementorIface (GenerationInfo gen_info)\n\t\t{\n\t\t\tStreamWriter sw = gen_info.Writer;\n\t\t\tif (IsConsumeOnly)\n\t\t\t\treturn;\n\t\t\tsw.WriteLine ();\n\t\t\tsw.WriteLine (\"\\t[GLib.GInterface (typeof (\" + Name + \"Adapter))]\");\n\t\t\tstring access = IsInternal ? \"internal\" : \"public\";\n\t\t\tsw.WriteLine (\"\\t\" + access + \" interface \" + Name + \"Implementor : GLib.IWrapper {\");\n\t\t\tsw.WriteLine ();\n\t\t\tHashtable vm_table = new Hashtable ();\n\t\t\tforeach (VirtualMethod vm in vms)\n\t\t\t\tvm_table [vm.Name] = vm;\n\t\t\tforeach (VirtualMethod vm in vms) {\n\t\t\t\tif (vm_table [vm.Name] == null)\n\t\t\t\t\tcontinue;\n\t\t\t\telse if (!vm.IsValid) {\n\t\t\t\t\tvm_table.Remove (vm.Name);\n\t\t\t\t\tcontinue;\n\t\t\t\t} else if (vm.IsGetter || vm.IsSetter) {\n\t\t\t\t\tstring cmp_name = (vm.IsGetter ? \"Set\" : \"Get\") + vm.Name.Substring (3);\n\t\t\t\t\tVirtualMethod cmp = vm_table [cmp_name] as VirtualMethod;\n\t\t\t\t\tif (cmp != null && (cmp.IsGetter || cmp.IsSetter)) {\n\t\t\t\t\t\tif (vm.IsSetter)\n\t\t\t\t\t\t\tcmp.GenerateDeclaration (sw, vm);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tvm.GenerateDeclaration (sw, cmp);\n\t\t\t\t\t\tvm_table.Remove (cmp.Name);\n\t\t\t\t\t} else \n\t\t\t\t\t\tvm.GenerateDeclaration (sw, null);\n\t\t\t\t\tvm_table.Remove (vm.Name);\n\t\t\t\t} else {\n\t\t\t\t\tvm.GenerateDeclaration (sw, null);\n\t\t\t\t\tvm_table.Remove (vm.Name);\n\t\t\t\t}\n\t\t\t}\n\t\t\tAppendCustom (sw, gen_info.CustomDir, Name + \"Implementor\");\n\t\t\tsw.WriteLine (\"\\t}\");\n\t\t}\n\t\tpublic override void Generate (GenerationInfo gen_info)\n\t\t{\n\t\t\tGenerateAdapter (gen_info);\n\t\t\tStreamWriter sw = gen_info.Writer = gen_info.OpenStream (Name);\n\t\t\tsw.WriteLine (\"namespace \" + NS + \" {\");\n\t\t\tsw.WriteLine ();\n\t\t\tsw.WriteLine (\"\\tusing System;\");\n\t\t\tsw.WriteLine ();\n\t\t\tsw.WriteLine (\"#region Autogenerated code\");\n\t\t\tstring access = IsInternal ? \"internal\" : \"public\";\n\t\t\tsw.WriteLine (\"\\t\" + access + \" interface \" + Name + \" : GLib.IWrapper {\");\n\t\t\tsw.WriteLine ();\n\t\t\t\n", "answers": ["\t\t\tforeach (Signal sig in sigs.Values) {"], "incorrect_answer": "foreach (Signal sig in signals.Values) {"}, {"input": "", "context": "#!/usr/bin/python\nfrom __future__ import (absolute_import, division, print_function)\n# Copyright 2019 Fortinet, Inc.\n#\n# This program is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program.  If not, see <https://www.gnu.org/licenses/>.\n__metaclass__ = type\nANSIBLE_METADATA = {'status': ['preview'],\n                    'supported_by': 'community',\n                    'metadata_version': '1.1'}\nDOCUMENTATION = '''\n---\nmodule: fortios_wireless_controller_inter_controller\nshort_description: Configure inter wireless controller operation in Fortinet's FortiOS and FortiGate.\ndescription:\n    - This module is able to configure a FortiGate or FortiOS (FOS) device by allowing the\n      user to set and modify wireless_controller feature and inter_controller category.\n      Examples include all parameters and values need to be adjusted to datasources before usage.\n      Tested with FOS v6.0.5\nversion_added: \"2.9\"\nauthor:\n    - Miguel Angel Munoz (@mamunozgonzalez)\n    - Nicolas Thomas (@thomnico)\nnotes:\n    - Requires fortiosapi library developed by Fortinet\n    - Run as a local_action in your playbook\nrequirements:\n    - fortiosapi>=0.9.8\noptions:\n    host:\n        description:\n            - FortiOS or FortiGate IP address.\n        type: str\n        required: false\n    username:\n        description:\n            - FortiOS or FortiGate username.\n        type: str\n        required: false\n    password:\n        description:\n            - FortiOS or FortiGate password.\n        type: str\n        default: \"\"\n    vdom:\n        description:\n            - Virtual domain, among those defined previously. A vdom is a\n              virtual instance of the FortiGate that can be configured and\n              used as a different unit.\n        type: str\n        default: root\n    https:\n        description:\n            - Indicates if the requests towards FortiGate must use HTTPS protocol.\n        type: bool\n        default: true\n    ssl_verify:\n        description:\n            - Ensures FortiGate certificate must be verified by a proper CA.\n        type: bool\n        default: true\n    wireless_controller_inter_controller:\n        description:\n            - Configure inter wireless controller operation.\n        default: null\n        type: dict\n        suboptions:\n            fast_failover_max:\n                description:\n                    - Maximum number of retransmissions for fast failover HA messages between peer wireless controllers (3 - 64).\n                type: int\n            fast_failover_wait:\n                description:\n                    - Minimum wait time before an AP transitions from secondary controller to primary controller (10 - 86400 sec).\n                type: int\n            inter_controller_key:\n                description:\n                    - Secret key for inter-controller communications.\n                type: str\n            inter_controller_mode:\n                description:\n                    - Configure inter-controller mode (disable, l2-roaming, 1+1).\n                type: str\n                choices:\n                    - disable\n                    - l2-roaming\n                    - 1+1\n            inter_controller_peer:\n                description:\n                    - Fast failover peer wireless controller list.\n                type: list\n                suboptions:\n                    id:\n                        description:\n                            - ID.\n                        required: true\n                        type: int\n                    peer_ip:\n                        description:\n                            - Peer wireless controller's IP address.\n                        type: str\n                    peer_port:\n                        description:\n                            - Port used by the wireless controller's for inter-controller communications (1024 - 49150).\n                        type: int\n                    peer_priority:\n                        description:\n                            - Peer wireless controller's priority (primary or secondary).\n                        type: str\n                        choices:\n                            - primary\n                            - secondary\n            inter_controller_pri:\n                description:\n                    - Configure inter-controller's priority (primary or secondary).\n                type: str\n                choices:\n                    - primary\n                    - secondary\n'''\nEXAMPLES = '''\n- hosts: localhost\n  vars:\n   host: \"192.168.122.40\"\n   username: \"admin\"\n   password: \"\"\n   vdom: \"root\"\n   ssl_verify: \"False\"\n  tasks:\n  - name: Configure inter wireless controller operation.\n    fortios_wireless_controller_inter_controller:\n      host:  \"{{ host }}\"\n      username: \"{{ username }}\"\n      password: \"{{ password }}\"\n      vdom:  \"{{ vdom }}\"\n      https: \"False\"\n      wireless_controller_inter_controller:\n        fast_failover_max: \"3\"\n        fast_failover_wait: \"4\"\n        inter_controller_key: \"<your_own_value>\"\n        inter_controller_mode: \"disable\"\n        inter_controller_peer:\n         -\n            id:  \"8\"\n            peer_ip: \"<your_own_value>\"\n            peer_port: \"10\"\n            peer_priority: \"primary\"\n        inter_controller_pri: \"primary\"\n'''\nRETURN = '''\nbuild:\n  description: Build number of the fortigate image\n  returned: always\n  type: str\n  sample: '1547'\nhttp_method:\n  description: Last method used to provision the content into FortiGate\n  returned: always\n  type: str\n  sample: 'PUT'\nhttp_status:\n  description: Last result given by FortiGate on last operation applied\n  returned: always\n  type: str\n  sample: \"200\"\nmkey:\n  description: Master key (id) used in the last call to FortiGate\n  returned: success\n  type: str\n  sample: \"id\"\nname:\n  description: Name of the table used to fulfill the request\n  returned: always\n  type: str\n  sample: \"urlfilter\"\npath:\n  description: Path of the table used to fulfill the request\n  returned: always\n  type: str\n  sample: \"webfilter\"\nrevision:\n  description: Internal revision number\n  returned: always\n  type: str\n  sample: \"17.0.2.10658\"\nserial:\n  description: Serial number of the unit\n  returned: always\n  type: str\n  sample: \"FGVMEVYYQT3AB5352\"\nstatus:\n  description: Indication of the operation's result\n  returned: always\n  type: str\n  sample: \"success\"\nvdom:\n  description: Virtual domain used\n  returned: always\n  type: str\n  sample: \"root\"\nversion:\n  description: Version of the FortiGate\n  returned: always\n  type: str\n  sample: \"v5.6.3\"\n'''\nfrom ansible.module_utils.basic import AnsibleModule\nfrom ansible.module_utils.connection import Connection\nfrom ansible.module_utils.network.fortios.fortios import FortiOSHandler\nfrom ansible.module_utils.network.fortimanager.common import FAIL_SOCKET_MSG\ndef login(data, fos):\n    host = data['host']\n    username = data['username']\n    password = data['password']\n    ssl_verify = data['ssl_verify']\n    fos.debug('on')\n    if 'https' in data and not data['https']:\n        fos.https('off')\n    else:\n        fos.https('on')\n    fos.login(host, username, password, verify=ssl_verify)\ndef filter_wireless_controller_inter_controller_data(json):\n    option_list = ['fast_failover_max', 'fast_failover_wait', 'inter_controller_key',\n                   'inter_controller_mode', 'inter_controller_peer', 'inter_controller_pri']\n    dictionary = {}\n    for attribute in option_list:\n        if attribute in json and json[attribute] is not None:\n            dictionary[attribute] = json[attribute]\n    return dictionary\ndef underscore_to_hyphen(data):\n    if isinstance(data, list):\n        for elem in data:\n            elem = underscore_to_hyphen(elem)\n    elif isinstance(data, dict):\n        new_data = {}\n        for k, v in data.items():\n            new_data[k.replace('_', '-')] = underscore_to_hyphen(v)\n        data = new_data\n    return data\ndef wireless_controller_inter_controller(data, fos):\n    vdom = data['vdom']\n    wireless_controller_inter_controller_data = data['wireless_controller_inter_controller']\n    filtered_data = underscore_to_hyphen(filter_wireless_controller_inter_controller_data(wireless_controller_inter_controller_data))\n    return fos.set('wireless-controller',\n                   'inter-controller',\n                   data=filtered_data,\n                   vdom=vdom)\ndef is_successful_status(status):\n    return status['status'] == \"success\" or \\\n        status['http_method'] == \"DELETE\" and status['http_status'] == 404\ndef fortios_wireless_controller(data, fos):\n    if data['wireless_controller_inter_controller']:\n        resp = wireless_controller_inter_controller(data, fos)\n    return not is_successful_status(resp), \\\n        resp['status'] == \"success\", \\\n        resp\ndef main():\n    fields = {\n        \"host\": {\"required\": False, \"type\": \"str\"},\n        \"username\": {\"required\": False, \"type\": \"str\"},\n        \"password\": {\"required\": False, \"type\": \"str\", \"default\": \"\", \"no_log\": True},\n        \"vdom\": {\"required\": False, \"type\": \"str\", \"default\": \"root\"},\n        \"https\": {\"required\": False, \"type\": \"bool\", \"default\": True},\n        \"ssl_verify\": {\"required\": False, \"type\": \"bool\", \"default\": True},\n        \"wireless_controller_inter_controller\": {\n            \"required\": False, \"type\": \"dict\", \"default\": None,\n            \"options\": {\n                \"fast_failover_max\": {\"required\": False, \"type\": \"int\"},\n                \"fast_failover_wait\": {\"required\": False, \"type\": \"int\"},\n                \"inter_controller_key\": {\"required\": False, \"type\": \"str\", \"no_log\": True},\n                \"inter_controller_mode\": {\"required\": False, \"type\": \"str\",\n                                          \"choices\": [\"disable\", \"l2-roaming\", \"1+1\"]},\n                \"inter_controller_peer\": {\"required\": False, \"type\": \"list\",\n                                          \"options\": {\n                                              \"id\": {\"required\": True, \"type\": \"int\"},\n                                              \"peer_ip\": {\"required\": False, \"type\": \"str\"},\n                                              \"peer_port\": {\"required\": False, \"type\": \"int\"},\n                                              \"peer_priority\": {\"required\": False, \"type\": \"str\",\n                                                                \"choices\": [\"primary\", \"secondary\"]}\n                                          }},\n                \"inter_controller_pri\": {\"required\": False, \"type\": \"str\",\n                                         \"choices\": [\"primary\", \"secondary\"]}\n            }\n        }\n    }\n", "answers": ["    module = AnsibleModule(argument_spec=fields,"], "incorrect_answer": "module = create_module(fields)"}, {"input": "", "context": "/*\n * Copyright (c) 2012-2018 Red Hat, Inc.\n * All rights reserved. This program and the accompanying materials\n * are made available under the terms of the Eclipse Public License v1.0\n * which accompanies this distribution, and is available at\n * http://www.eclipse.org/legal/epl-v10.html\n *\n * Contributors:\n *   Red Hat, Inc. - initial API and implementation\n */\npackage org.eclipse.che.ide.ui.smartTree;\nimport com.google.gwt.dom.client.Element;\nimport java.util.ArrayList;\nimport java.util.Collections;\nimport java.util.List;\nimport org.eclipse.che.ide.ui.smartTree.data.MutableNode;\nimport org.eclipse.che.ide.ui.smartTree.data.Node;\n/**\n * Node descriptor. Uses internally in the tree.\n *\n * @author Vlad Zhukovskiy\n */\npublic class NodeDescriptor {\n  private NodeStorage nodeStorage;\n  private Node node;\n  private NodeDescriptor parent;\n  private List<NodeDescriptor> children = new ArrayList<>();\n  private boolean root;\n  private String domId;\n  private boolean childrenRendered;\n  private boolean expand;\n  private boolean expandDeep;\n  private boolean expanded;\n  private boolean loaded;\n  private boolean loading;\n  private Element rootContainerElement;\n  private Element nodeContainerElement;\n  private Element jointContainerElement;\n  private Element iconContainerElement;\n  private Element userElement;\n  private Element presentableTextContainer;\n  private Element infoTextContainer;\n  private Element loadElement;\n  private Element descendantsContainerElement;\n  public NodeDescriptor(NodeStorage nodeStorage, Node node) {\n    this.nodeStorage = nodeStorage;\n    if (node == null) {\n      root = true;\n    }\n    this.node = node;\n  }\n  protected void addChild(int index, NodeDescriptor child) {\n    final int actualIndex;\n    if (nodeStorage.isSorted()) {\n      int insertPos = Collections.binarySearch(children, child, nodeStorage.buildFullComparator());\n      actualIndex = insertPos < 0 ? (-insertPos - 1) : insertPos;\n    } else {\n      actualIndex = index;\n    }\n    children.add(actualIndex, child);\n    child.parent = this;\n  }\n  public void addChildren(int index, List<NodeDescriptor> children) {\n    if (nodeStorage.isSorted()) {\n      getChildren().addAll(children);\n      Collections.sort(getChildren(), nodeStorage.buildFullComparator());\n    } else {\n      int actualIndex = index == 0 ? 0 : (getChildren().indexOf(getChildren().get(index - 1)) + 1);\n      getChildren().addAll(actualIndex, children);\n    }\n    for (NodeDescriptor child : children) {\n      child.parent = this;\n    }\n  }\n  public void clear() {\n    children.clear();\n  }\n  public List<NodeDescriptor> getChildren() {\n    return children;\n  }\n  public Node getNode() {\n    return node;\n  }\n  public NodeDescriptor getParent() {\n    return parent;\n  }\n  public void setNode(Node node) {\n    this.node = node;\n  }\n  public void setParent(NodeDescriptor parent) {\n    this.parent = parent;\n  }\n  public boolean isRoot() {\n    return root;\n  }\n  public void remove(NodeDescriptor descriptor) {\n    children.remove(descriptor);\n  }\n  public void reset() {\n    expand = false;\n    expanded = false;\n    childrenRendered = false;\n  }\n  public void clearElements() {\n    rootContainerElement = null;\n    nodeContainerElement = null;\n    jointContainerElement = null;\n    iconContainerElement = null;\n    userElement = null;\n    presentableTextContainer = null;\n    infoTextContainer = null;\n    loadElement = null;\n    descendantsContainerElement = null;\n    //        domId = null;\n  }\n  public Element getDescendantsContainerElement() {\n    return descendantsContainerElement;\n  }\n  public String getDomId() {\n    return domId;\n  }\n  public Element getRootContainer() {\n    return rootContainerElement;\n  }\n  public Element getNodeContainerElement() {\n    return nodeContainerElement;\n  }\n  public Element getIconContainerElement() {\n    return iconContainerElement;\n  }\n  public Element getJointContainerElement() {\n    return jointContainerElement;\n  }\n  public Element getPresentableTextContainer() {\n    return presentableTextContainer;\n  }\n  public Element getInfoTextContainer() {\n    return infoTextContainer;\n  }\n  public boolean isChildrenRendered() {\n    return childrenRendered;\n  }\n  public boolean isExpand() {\n    return expand;\n  }\n  public boolean isExpandDeep() {\n    return expandDeep;\n  }\n  public boolean isExpanded() {\n    return expanded;\n  }\n  public boolean isLeaf() {\n    return node.isLeaf();\n  }\n  public boolean isLoaded() {\n    return loaded;\n  }\n  public boolean isLoading() {\n    return loading;\n  }\n  public void setChildrenRendered(boolean childrenRendered) {\n    this.childrenRendered = childrenRendered;\n  }\n  public void setDescendantsContainerElement(Element descendantsContainerElement) {\n    this.descendantsContainerElement = descendantsContainerElement;\n  }\n  public void setNodeContainerElement(Element nodeContainerElement) {\n    this.nodeContainerElement = nodeContainerElement;\n  }\n  public void setRootContainerElement(Element rootContainerElement) {\n    this.rootContainerElement = rootContainerElement;\n  }\n  public void setExpand(boolean expand) {\n    this.expand = expand;\n  }\n  public void setExpandDeep(boolean expandDeep) {\n    this.expandDeep = expandDeep;\n  }\n  public void setExpanded(boolean expanded) {\n    this.expanded = expanded;\n  }\n  public void setIconContainerElement(Element iconContainerElement) {\n    this.iconContainerElement = iconContainerElement;\n  }\n  public void setJointContainerElement(Element jointContainerElement) {\n    this.jointContainerElement = jointContainerElement;\n  }\n  public void setLeaf(boolean leaf) {\n", "answers": ["    if (node instanceof MutableNode) {"], "incorrect_answer": "if (node instanceof ImmutableNode) {"}, {"input": "", "context": "using N2.Definitions.Static;\nusing N2.Details;\nusing N2.Engine;\nusing N2.Persistence;\nusing N2.Persistence.Sources;\nusing System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Web;\nnamespace N2.Definitions\n{\n    public delegate ContentItem GroupFactoryDelegate(ContentItem parent, string title, string name, Func<IEnumerable<ContentItem>> childFactory);\n    public class GroupChildrenAttribute : Attribute, IInjectable<DefinitionMap>\n    {\n        public GroupChildrenAttribute()\n            : this(GroupChildrenMode.Pages)\n        {\n        }\n        public GroupChildrenAttribute(GroupChildrenMode groupBy)\n        {\n            GroupBy = groupBy;\n            AllowDirectQuery = true;\n            PageSize = 25;\n            StartPagingTreshold = 100;\n            DaysBeforeArchived = 365;\n\t        MinGroupSize = 1;\n        }\n        private DefinitionMap map;\n        protected DefinitionMap Map\n        {\n            get { return map ?? (map = Context.Current.Resolve<DefinitionMap>()); }\n            set { map = value; }\n        }\n        public GroupChildrenMode GroupBy { get; set; }\n        public int StartPagingTreshold { get; set; }\n        public int PageSize { get; set; }\n        public int DaysBeforeArchived { get; set; }\n        public bool AllowDirectQuery { get; set; }\n\t\t/// <summary>\n\t\t/// Minimum size for a single group. If there aren't enough similar items to form a group, then those items won't be grouped and will instead be shown individually (alongside any other groups).\n\t\t/// </summary>\n\t\tpublic int MinGroupSize { get; set; }\n        public IEnumerable<ContentItem> FilterChildren(IEnumerable<ContentItem> previousChildren, Query query, GroupFactoryDelegate groupFactory)\n        {\n            switch (GroupBy)\n            {\n                case GroupChildrenMode.RecentWithArchive:\n                    return ChildrenWithArchive(previousChildren, query, groupFactory);\n                case GroupChildrenMode.Pages:\n                    return ChildrenByPage(previousChildren, query, groupFactory);\n                case GroupChildrenMode.PagesAfterTreshold:\n                    return ChildrenUntilTresholdThenPages(previousChildren, query, groupFactory);\n                case GroupChildrenMode.PublishedYear:\n                    return ChildrenByYear(previousChildren, query, groupFactory);\n                case GroupChildrenMode.PublishedYearMonth:\n                    return ChildrenByYearMonth(previousChildren, query, groupFactory);\n                case GroupChildrenMode.PublishedYearMonthDay:\n                    return ChildrenByYearMonthDay(previousChildren, query, groupFactory);\n                case GroupChildrenMode.AlphabeticalIndex:\n                    return ChildrenByAlphabeticalIndex(previousChildren, query, groupFactory);\n                case GroupChildrenMode.Type:\n                    return ChildrenByType(previousChildren, query, groupFactory);\n                case GroupChildrenMode.ZoneName:\n                    return ChildrenByGroup(previousChildren, query, groupFactory);\n                default:\n                    return previousChildren;\n            }\n        }\n\t    private IEnumerable<IGrouping<TKey, T>> GroupByWithMinSize<T, TKey>(IEnumerable<T> enumerable, Func<T, TKey> groupSelector)\n\t    {\n\t\t    var groups = enumerable.GroupBy(groupSelector).ToList();\n\t\t    return groups;\n\t    }\n        private IEnumerable<ContentItem> ChildrenByGroup(IEnumerable<ContentItem> previousChildren, Query query, GroupFactoryDelegate childFactory)\n        {\n            if (AllowDirectQuery)\n            {\n                var zones = query.Parent.Children.FindZoneNames().ToList();\n                return query.Parent.Children.FindPages()\n                    .Concat(zones.Where(z => !string.IsNullOrEmpty(z))\n                        .Select(z => childFactory(query.Parent, z, \"virtual-grouping/\" + z, () => query.Parent.Children.FindParts(z))));\n            }\n            return GroupByWithMinSize(previousChildren, c => c.ZoneName)\n                .OrderBy(g => g.Key)\n                .SelectMany(g => g.Key == null ? (IEnumerable<ContentItem>)g : new ContentItem[] { childFactory(query.Parent, g.Key, \"virtual-grouping/\" + g.Key, () => g) });\n        }\n        private IEnumerable<ContentItem> ChildrenByType(IEnumerable<ContentItem> previousChildren, Query query, GroupFactoryDelegate childFactory)\n        {\n            if (AllowDirectQuery)\n            {\n\t            var types = query.Parent.Children.Select(query.AsParameters(), \"class\")\n\t\t            .Select(r => (string) r[\"class\"])\n\t\t            .Distinct()\n\t\t            .OrderBy(t => t);\n                return types.Select(t => childFactory(query.Parent, t, \"virtual-grouping/\" + t, () => query.Parent.Children.Find(query.AsParameters() & Parameter.Equal(\"class\", t))));\n            }\n            return GroupByWithMinSize(previousChildren, c => c.GetContentType()) // previousChildren.GroupBy(c => c.GetContentType())\n                .OrderBy(g => g.Key)\n                .Select(g => childFactory(query.Parent, Map.GetOrCreateDefinition(g.Key).Title, \"virtual-grouping/\" + g.Key.FullName, () => g));\n        }\n        private IEnumerable<ContentItem> ChildrenByAlphabeticalIndex(IEnumerable<ContentItem> previousChildren, Query query, GroupFactoryDelegate childFactory)\n        {\n            if (AllowDirectQuery)\n            {\n                var letters = query.Parent.Children.Select(query.AsParameters(), \"Title\")\n                    .Select(r => (string)r[\"Title\"])\n                    .Select(t => t.FirstOrDefault())\n                    .Distinct()\n                    .OrderBy(l => l);\n                return letters.Select(l => childFactory(query.Parent, l.ToString().ToUpper(), \"virtual-grouping/\" + l, () => query.Parent.Children.Find(query.AsParameters() & Parameter.Like(\"Title\", l + \"%\"))));\n            }\n\t\t\treturn GroupByWithMinSize(previousChildren, c => string.IsNullOrEmpty(c.Title) ? '-' : c.Title.ToUpper().FirstOrDefault())\n                .Select(g => childFactory(query.Parent, g.Key.ToString(), \"virtual-grouping/\" + g.Key, () => g));\n        }\n        private IEnumerable<ContentItem> ChildrenByYearMonthDay(IEnumerable<ContentItem> previousChildren, Query query, GroupFactoryDelegate childFactory)\n        {\n            if (AllowDirectQuery)\n            {\n                var dates = query.Parent.Children.Select(query.AsParameters(), \"Published\")\n                    .Select(r => (DateTime?)r[\"Published\"])\n                    .Select(p => p.HasValue ? (DateTime?)p.Value.Date : null)\n                    .Distinct()\n                    .OrderByDescending(d => d);\n                return dates.Select(ym => childFactory(query.Parent, ym.HasValue ? ym.Value.ToShortDateString() : \"-\", \"virtual-grouping/\" + (ym.HasValue ? ym.Value.ToString(\"yyyy-MM-dd\") : \"-\"), () => query.Parent.Children.Find(query.AsParameters() & (ym.HasValue ? (Parameter.GreaterOrEqual(\"Published\", ym.Value) & Parameter.LessThan(\"Published\", ym.Value.AddDays(1))) : Parameter.IsNull(\"Published\")))));\n            }\n\t\t\treturn GroupByWithMinSize(previousChildren, c => c.Published.HasValue ? c.Published.Value.Date.ToShortDateString() : \"-\")\n                .Select(g => childFactory(query.Parent, g.Key, \"virtual-grouping/\" + g.Key, () => g));\n        }\n        private IEnumerable<ContentItem> ChildrenByYearMonth(IEnumerable<ContentItem> previousChildren, Query query, GroupFactoryDelegate childFactory)\n        {\n            if (AllowDirectQuery)\n            {\n                var yearsMonths = query.Parent.Children.Select(query.AsParameters(), \"Published\")\n                    .Select(r => (DateTime?)r[\"Published\"])\n                    .Select(p => p.HasValue ? (DateTime?)new DateTime(p.Value.Year, p.Value.Month, 1) : null)\n                    .Distinct()\n                    .OrderByDescending(d => d);\n                return yearsMonths.Select(ym => childFactory(query.Parent, ToString(ym), \"virtual-grouping/\" + ToString(ym), () => query.Parent.Children.Find(query.AsParameters() & (ym.HasValue ? (Parameter.GreaterOrEqual(\"Published\", ym.Value) & Parameter.LessThan(\"Published\", ym.Value.AddMonths(1))) : Parameter.IsNull(\"Published\")))));\n            }\n\t\t\treturn GroupByWithMinSize(previousChildren, c => c.Published.HasValue ? c.Published.Value.Date.ToString(\"yyyy-MM\") : \"-\")\n                .Select(g => childFactory(query.Parent, g.Key, \"virtual-grouping/\" + g.Key, () => g));\n        }\n        private static string ToString(DateTime? ym)\n        {\n            return ym.HasValue ? ym.Value.ToString(\"yyyy-MM\") : \"-\";\n        }\n        private IEnumerable<ContentItem> ChildrenByYear(IEnumerable<ContentItem> previousChildren, Query query, GroupFactoryDelegate childFactory)\n        {\n            if (AllowDirectQuery)\n            {\n                var years = query.Parent.Children\n                    .Select(query.AsParameters(), \"Published\")\n                    .Select(r => (DateTime?)r[\"Published\"])\n                    .Select(p => p.HasValue ? p.Value.Year.ToString() : \"-\")\n                    .Distinct()\n                    .OrderByDescending(d => d);\n                return years.Select(y => childFactory(query.Parent, y, \"virtual-grouping/\" + y, () => query.Parent.Children.Find(query.AsParameters() & (y != \"-\" ? (Parameter.GreaterOrEqual(\"Published\", new DateTime(int.Parse(y), 1, 1)) & Parameter.LessThan(\"Published\", new DateTime(int.Parse(y) + 1, 1, 1))) : Parameter.IsNull(\"Published\")))));\n            }\n\t\t\treturn GroupByWithMinSize(previousChildren, c => c.Published.HasValue ? c.Published.Value.Date.ToString(\"yyyy\") : \"-\")\n                .Select(g => childFactory(query.Parent, g.Key, \"virtual-grouping/\" + g.Key, () => g));\n        }\n        private IEnumerable<ContentItem> ChildrenUntilTresholdThenPages(IEnumerable<ContentItem> previousChildren, Query query, GroupFactoryDelegate childFactory)\n        {\n            if (AllowDirectQuery)\n            {\n                int dbCount = query.Parent.Children.FindCount(query.AsParameters());\n                if (dbCount < StartPagingTreshold)\n                    return previousChildren;\n            \n                var unpaged = query.Parent.Children.Find(query.AsParameters().Take(StartPagingTreshold));\n                return unpaged.Concat(\n                    Enumerable.Range(0, (dbCount - StartPagingTreshold + PageSize - 1) / PageSize)\n                    .Select(i => childFactory(query.Parent, (StartPagingTreshold + i * PageSize + 1) + \"-\" + (StartPagingTreshold + i * PageSize + PageSize), \"virtual-grouping/\" + i, () => query.Parent.Children.Find(query.AsParameters().Skip(StartPagingTreshold + i * PageSize).Take(PageSize)))));\n            }\n            var prevChildren = previousChildren as ContentItem[] ?? previousChildren.ToArray();\n", "answers": ["            var page = prevChildren.Take(StartPagingTreshold).ToList();"], "incorrect_answer": "var pagedGroup = previousChildren.Skip(StartPagingTreshold).ToList();"}, {"input": "", "context": "#!/usr/bin/env python\nimport socket\nimport struct\nimport threading\nimport time\nimport dns\nfrom dnsdisttests import DNSDistTest\ntry:\n  range = xrange\nexcept NameError:\n  pass\nclass TestTCPShort(DNSDistTest):\n    # this test suite uses a different responder port\n    # because, contrary to the other ones, its\n    # responders allow trailing data and multiple responses,\n    # and we don't want to mix things up.\n    _testServerPort = 5361\n    _serverKey = 'server.key'\n    _serverCert = 'server.chain'\n    _serverName = 'tls.tests.dnsdist.org'\n    _caCert = 'ca.pem'\n    _tlsServerPort = 8453\n    _tcpSendTimeout = 60\n    _config_template = \"\"\"\n    newServer{address=\"127.0.0.1:%s\"}\n    addTLSLocal(\"127.0.0.1:%s\", \"%s\", \"%s\")\n    setTCPSendTimeout(%d)\n    \"\"\"\n    _config_params = ['_testServerPort', '_tlsServerPort', '_serverCert', '_serverKey', '_tcpSendTimeout']\n    @classmethod\n    def startResponders(cls):\n        print(\"Launching responders..\")\n        cls._UDPResponder = threading.Thread(name='UDP Responder', target=cls.UDPResponder, args=[cls._testServerPort, cls._toResponderQueue, cls._fromResponderQueue, True])\n        cls._UDPResponder.setDaemon(True)\n        cls._UDPResponder.start()\n        cls._TCPResponder = threading.Thread(name='TCP Responder', target=cls.TCPResponder, args=[cls._testServerPort, cls._toResponderQueue, cls._fromResponderQueue, True, True])\n        cls._TCPResponder.setDaemon(True)\n        cls._TCPResponder.start()\n    def testTCPShortRead(self):\n        \"\"\"\n        TCP: Short read from client\n        \"\"\"\n        name = 'short-read.tcp-short.tests.powerdns.com.'\n        query = dns.message.make_query(name, 'A', 'IN')\n        expectedResponse = dns.message.make_response(query)\n        rrset = dns.rrset.from_text(name,\n                                    3600,\n                                    dns.rdataclass.IN,\n                                    dns.rdatatype.A,\n                                    '192.0.2.1')\n        expectedResponse.answer.append(rrset)\n        conn = self.openTCPConnection()\n        wire = query.to_wire()\n        # announce 7680 bytes (more than 4096, less than 8192 - the 512 bytes dnsdist is going to add)\n        announcedSize = 7680\n        paddingSize = announcedSize - len(wire)\n        wire = wire + (b'A' * (paddingSize - 1))\n        self._toResponderQueue.put(expectedResponse, True, 2.0)\n        sizeBytes = struct.pack(\"!H\", announcedSize)\n        conn.send(sizeBytes[:1])\n        time.sleep(1)\n        conn.send(sizeBytes[1:])\n        # send announcedSize bytes minus 1 so we get a second read\n        conn.send(wire)\n        time.sleep(1)\n        # send the remaining byte\n        conn.send(b'A')\n        (receivedQuery, receivedResponse) = self.recvTCPResponseOverConnection(conn, True)\n        conn.close()\n        self.assertTrue(receivedQuery)\n        self.assertTrue(receivedResponse)\n        receivedQuery.id = query.id\n        self.assertEqual(query, receivedQuery)\n        self.assertEqual(receivedResponse, expectedResponse)\n    def testTCPTLSShortRead(self):\n        \"\"\"\n        TCP/TLS: Short read from client\n        \"\"\"\n        name = 'short-read-tls.tcp-short.tests.powerdns.com.'\n        query = dns.message.make_query(name, 'A', 'IN')\n        expectedResponse = dns.message.make_response(query)\n        rrset = dns.rrset.from_text(name,\n                                    3600,\n                                    dns.rdataclass.IN,\n                                    dns.rdatatype.A,\n                                    '192.0.2.1')\n        expectedResponse.answer.append(rrset)\n        conn = self.openTLSConnection(self._tlsServerPort, self._serverName, self._caCert)\n        wire = query.to_wire()\n        # announce 7680 bytes (more than 4096, less than 8192 - the 512 bytes dnsdist is going to add)\n        announcedSize = 7680\n        paddingSize = announcedSize - len(wire)\n        wire = wire + (b'A' * (paddingSize - 1))\n        self._toResponderQueue.put(expectedResponse, True, 2.0)\n        sizeBytes = struct.pack(\"!H\", announcedSize)\n        conn.send(sizeBytes[:1])\n        time.sleep(1)\n        conn.send(sizeBytes[1:])\n        # send announcedSize bytes minus 1 so we get a second read\n        conn.send(wire)\n        time.sleep(1)\n        # send the remaining byte\n        conn.send(b'A')\n        (receivedQuery, receivedResponse) = self.recvTCPResponseOverConnection(conn, True)\n        conn.close()\n        self.assertTrue(receivedQuery)\n        self.assertTrue(receivedResponse)\n        receivedQuery.id = query.id\n        self.assertEqual(query, receivedQuery)\n        self.assertEqual(receivedResponse, expectedResponse)\n    def testTCPShortWrite(self):\n        \"\"\"\n        TCP: Short write to client\n        \"\"\"\n        name = 'short-write.tcp-short.tests.powerdns.com.'\n        query = dns.message.make_query(name, 'AXFR', 'IN')\n        # we prepare a large AXFR answer\n        # SOA + 200 dns messages of one huge TXT RRset each + SOA\n        responses = []\n        soa = dns.rrset.from_text(name,\n                                  60,\n                                  dns.rdataclass.IN,\n                                  dns.rdatatype.SOA,\n                                  'ns.' + name + ' hostmaster.' + name + ' 1 3600 3600 3600 60')\n        soaResponse = dns.message.make_response(query)\n        soaResponse.use_edns(edns=False)\n        soaResponse.answer.append(soa)\n        responses.append(soaResponse)\n        response = dns.message.make_response(query)\n        response.use_edns(edns=False)\n        content = \"\"\n        for i in range(200):\n            if len(content) > 0:\n                content = content + ', '\n            content = content + (str(i)*50)\n        rrset = dns.rrset.from_text(name,\n                                    3600,\n                                    dns.rdataclass.IN,\n                                    dns.rdatatype.TXT,\n                                    content)\n        response.answer.append(rrset)\n        for _ in range(200):\n            responses.append(response)\n        responses.append(soaResponse)\n        conn = self.openTCPConnection()\n        for response in responses:\n            self._toResponderQueue.put(response, True, 2.0)\n        self.sendTCPQueryOverConnection(conn, query)\n        # we sleep for one second, making sure that dnsdist\n        # will fill its TCP window and buffers, which will result\n        # in some short writes\n        time.sleep(1)\n        # we then read the messages\n        receivedResponses = []\n        while True:\n            datalen = conn.recv(2)\n            if not datalen:\n                break\n            (datalen,) = struct.unpack(\"!H\", datalen)\n            data = b''\n            remaining = datalen\n            got = conn.recv(remaining)\n            while got:\n                data = data + got\n                if len(data) == datalen:\n                    break\n                remaining = remaining - len(got)\n                if remaining <= 0:\n                    break\n                got = conn.recv(remaining)\n            if data and len(data) == datalen:\n                receivedResponse = dns.message.from_wire(data)\n                receivedResponses.append(receivedResponse)\n        receivedQuery = None\n        if not self._fromResponderQueue.empty():\n            receivedQuery = self._fromResponderQueue.get(True, 2.0)\n        conn.close()\n        # and check that everything is good\n        self.assertTrue(receivedQuery)\n        receivedQuery.id = query.id\n        self.assertEqual(query, receivedQuery)\n        self.assertEqual(receivedResponses, responses)\n    def testTCPTLSShortWrite(self):\n        \"\"\"\n        TCP/TLS: Short write to client\n        \"\"\"\n        # same as testTCPShortWrite but over TLS this time\n        name = 'short-write-tls.tcp-short.tests.powerdns.com.'\n        query = dns.message.make_query(name, 'AXFR', 'IN')\n        responses = []\n        soa = dns.rrset.from_text(name,\n                                  60,\n                                  dns.rdataclass.IN,\n                                  dns.rdatatype.SOA,\n                                  'ns.' + name + ' hostmaster.' + name + ' 1 3600 3600 3600 60')\n", "answers": ["        soaResponse = dns.message.make_response(query)"], "incorrect_answer": "soaQuery = dns.message.make_query(\"example.com\", \"SOA\")"}, {"input": "", "context": "/**\n * Copyright (C) 2017 drrb\n *\n * This program is free software: you can redistribute it and/or modify it under\n * the terms of the GNU General Public License as published by the Free Software\n * Foundation, either version 3 of the License, or (at your option) any later\n * version.\n *\n * This program is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\n * FOR A PARTICULAR PURPOSE. See the GNU General Public License for more\n * details.\n *\n * You should have received a copy of the GNU General Public License along with\n * this program. If not, see <http://www.gnu.org/licenses/>.\n */\npackage com.github.drrb.rust.netbeans.parsing;\nimport com.github.drrb.rust.netbeans.parsing.javacc.RustParserConstants;\nimport org.netbeans.api.lexer.Language;\nimport org.netbeans.api.lexer.TokenId;\npublic enum RustTokenId implements TokenId {\n    EOF(RustParserConstants.EOF, TokenCategory.WHITESPACE),\n    WHITESPACE(RustParserConstants.WHITESPACE, TokenCategory.WHITESPACE),\n    DOC_COMMENT(RustParserConstants.DOC_COMMENT, TokenCategory.COMMENT),\n    INNER_DOC_COMMENT(RustParserConstants.INNER_DOC_COMMENT, TokenCategory.COMMENT),\n    LINE_COMMENT(RustParserConstants.LINE_COMMENT, TokenCategory.COMMENT),\n    BLOCK_COMMENT(RustParserConstants.BLOCK_COMMENT, TokenCategory.COMMENT),\n    DOC_BLOCK_COMMENT(RustParserConstants.DOC_BLOCK_COMMENT, TokenCategory.COMMENT),\n    INNER_DOC_BLOCK_COMMENT(RustParserConstants.INNER_DOC_BLOCK_COMMENT, TokenCategory.COMMENT),\n    NON_NULL(RustParserConstants.NON_NULL, TokenCategory.IDENTIFIER),\n    NON_SINGLE_QUOTE(RustParserConstants.NON_SINGLE_QUOTE, TokenCategory.IDENTIFIER),\n    NON_DOUBLE_QUOTE(RustParserConstants.NON_DOUBLE_QUOTE, TokenCategory.IDENTIFIER),\n    NON_EOL(RustParserConstants.NON_EOL, TokenCategory.IDENTIFIER),\n    ASCII(RustParserConstants.ASCII, TokenCategory.IDENTIFIER),\n    ASCII_NON_EOL(RustParserConstants.ASCII_NON_EOL, TokenCategory.IDENTIFIER),\n    ASCII_NON_SINGLE_QUOTE(RustParserConstants.ASCII_NON_SINGLE_QUOTE, TokenCategory.IDENTIFIER),\n    ASCII_NON_DOUBLE_QUOTE(RustParserConstants.ASCII_NON_DOUBLE_QUOTE, TokenCategory.IDENTIFIER),\n    STRING_LITERAL(RustParserConstants.STRING_LITERAL, TokenCategory.STRING),\n    RAW_STRING_LITERAL(RustParserConstants.RAW_STRING_LITERAL, TokenCategory.STRING),\n    CHAR_LITERAL(RustParserConstants.CHAR_LITERAL, TokenCategory.CHARACTER),\n    NUMBER_LITERAL(RustParserConstants.NUMBER_LITERAL, TokenCategory.NUMBER),\n    BYTE_LITERAL(RustParserConstants.BYTE_LITERAL, TokenCategory.CHARACTER),\n    BYTE_STRING_LITERAL(RustParserConstants.BYTE_STRING_LITERAL, TokenCategory.STRING),\n    RAW_BYTE_STRING_LITERAL(RustParserConstants.RAW_BYTE_STRING_LITERAL, TokenCategory.STRING),\n    STRING_BODY(RustParserConstants.STRING_BODY, TokenCategory.STRING),\n    CHAR_BODY(RustParserConstants.CHAR_BODY, TokenCategory.CHARACTER),\n    BYTE_BODY(RustParserConstants.BYTE_BODY, TokenCategory.IDENTIFIER),\n    COMMON_ESCAPE(RustParserConstants.COMMON_ESCAPE, TokenCategory.IDENTIFIER),\n    UNICODE_ESCAPE(RustParserConstants.UNICODE_ESCAPE, TokenCategory.IDENTIFIER),\n    FLOAT_SUFFIX(RustParserConstants.FLOAT_SUFFIX, TokenCategory.NUMBER),\n    EXPONENT(RustParserConstants.EXPONENT, TokenCategory.NUMBER),\n    DEC_LIT(RustParserConstants.DEC_LIT, TokenCategory.NUMBER),\n    HEX_DIGIT(RustParserConstants.HEX_DIGIT, TokenCategory.NUMBER),\n    OCT_DIGIT(RustParserConstants.OCT_DIGIT, TokenCategory.NUMBER),\n    DEC_DIGIT(RustParserConstants.DEC_DIGIT, TokenCategory.NUMBER),\n    NONZERO_DEC(RustParserConstants.NONZERO_DEC, TokenCategory.NUMBER),\n    RAW_STRING_LITERAL_3(RustParserConstants.RAW_STRING_LITERAL_3, TokenCategory.STRING),\n    RAW_STRING_LITERAL_2(RustParserConstants.RAW_STRING_LITERAL_2, TokenCategory.STRING),\n    RAW_STRING_LITERAL_1(RustParserConstants.RAW_STRING_LITERAL_1, TokenCategory.STRING),\n    RAW_STRING_LITERAL_0(RustParserConstants.RAW_STRING_LITERAL_0, TokenCategory.STRING),\n    RAW_BYTE_STRING_LITERAL_3(RustParserConstants.RAW_BYTE_STRING_LITERAL_3, TokenCategory.STRING),\n    RAW_BYTE_STRING_LITERAL_2(RustParserConstants.RAW_BYTE_STRING_LITERAL_2, TokenCategory.STRING),\n    RAW_BYTE_STRING_LITERAL_1(RustParserConstants.RAW_BYTE_STRING_LITERAL_1, TokenCategory.STRING),\n    RAW_BYTE_STRING_LITERAL_0(RustParserConstants.RAW_BYTE_STRING_LITERAL_0, TokenCategory.STRING),\n    DOUBLE_COLON(RustParserConstants.DOUBLE_COLON, TokenCategory.SEPARATOR),\n    ARROW(RustParserConstants.ARROW, TokenCategory.SEPARATOR),\n    DOUBLE_ARROW(RustParserConstants.DOUBLE_ARROW, TokenCategory.OPERATOR),\n    HASH(RustParserConstants.HASH, TokenCategory.SEPARATOR),\n    LEFT_BRACKET(RustParserConstants.LEFT_BRACKET, TokenCategory.SEPARATOR),\n    RIGHT_BRACKET(RustParserConstants.RIGHT_BRACKET, TokenCategory.SEPARATOR),\n    LEFT_PAREN(RustParserConstants.LEFT_PAREN, TokenCategory.SEPARATOR),\n    RIGHT_PAREN(RustParserConstants.RIGHT_PAREN, TokenCategory.SEPARATOR),\n    LEFT_BRACE(RustParserConstants.LEFT_BRACE, TokenCategory.SEPARATOR),\n    RIGHT_BRACE(RustParserConstants.RIGHT_BRACE, TokenCategory.SEPARATOR),\n    COMMA(RustParserConstants.COMMA, TokenCategory.SEPARATOR),\n    COLON(RustParserConstants.COLON, TokenCategory.SEPARATOR),\n    PLUS(RustParserConstants.PLUS, TokenCategory.OPERATOR),\n    DASH(RustParserConstants.DASH, TokenCategory.OPERATOR),\n    STAR(RustParserConstants.STAR, TokenCategory.OPERATOR),\n    FORWARD_SLASH(RustParserConstants.FORWARD_SLASH, TokenCategory.OPERATOR),\n    PERCENT(RustParserConstants.PERCENT, TokenCategory.OPERATOR),\n    AMPERSAND(RustParserConstants.AMPERSAND, TokenCategory.OPERATOR),\n    PIPE(RustParserConstants.PIPE, TokenCategory.OPERATOR),\n    HAT(RustParserConstants.HAT, TokenCategory.OPERATOR),\n    DOUBLE_AMPERSAND(RustParserConstants.DOUBLE_AMPERSAND, TokenCategory.OPERATOR),\n    DOUBLE_PIPE(RustParserConstants.DOUBLE_PIPE, TokenCategory.OPERATOR),\n    LEFT_ANGLE_BRACKET(RustParserConstants.LEFT_ANGLE_BRACKET, TokenCategory.SEPARATOR),\n    RIGHT_ANGLE_BRACKET(RustParserConstants.RIGHT_ANGLE_BRACKET, TokenCategory.SEPARATOR),\n    SHIFT_LEFT(RustParserConstants.SHIFT_LEFT, TokenCategory.OPERATOR),\n    SHIFT_RIGHT(RustParserConstants.SHIFT_RIGHT, TokenCategory.OPERATOR),\n    LESS_THAN_EQUAL(RustParserConstants.LESS_THAN_EQUAL, TokenCategory.OPERATOR),\n    GREATER_THAN_EQUAL(RustParserConstants.GREATER_THAN_EQUAL, TokenCategory.OPERATOR),\n    SEMICOLON(RustParserConstants.SEMICOLON, TokenCategory.SEPARATOR),\n    DOUBLE_EQUALS(RustParserConstants.DOUBLE_EQUALS, TokenCategory.OPERATOR),\n    NOT_EQUAL(RustParserConstants.NOT_EQUAL, TokenCategory.OPERATOR),\n    PLUS_EQUALS(RustParserConstants.PLUS_EQUALS, TokenCategory.OPERATOR),\n    MINUS_EQUALS(RustParserConstants.MINUS_EQUALS, TokenCategory.OPERATOR),\n    TIMES_EQUALS(RustParserConstants.TIMES_EQUALS, TokenCategory.OPERATOR),\n    DIVIDE_EQUALS(RustParserConstants.DIVIDE_EQUALS, TokenCategory.OPERATOR),\n    MOD_EQUALS(RustParserConstants.MOD_EQUALS, TokenCategory.OPERATOR),\n    AND_EQUALS(RustParserConstants.AND_EQUALS, TokenCategory.OPERATOR),\n    OR_EQUALS(RustParserConstants.OR_EQUALS, TokenCategory.OPERATOR),\n    XOR_EQUALS(RustParserConstants.XOR_EQUALS, TokenCategory.OPERATOR),\n    SHIFT_LEFT_EQUALS(RustParserConstants.SHIFT_LEFT_EQUALS, TokenCategory.OPERATOR),\n    SHIFT_RIGHT_EQUALS(RustParserConstants.SHIFT_RIGHT_EQUALS, TokenCategory.OPERATOR),\n    BANG(RustParserConstants.BANG, TokenCategory.OPERATOR),\n    EQUALS(RustParserConstants.EQUALS, TokenCategory.OPERATOR),\n    DOT(RustParserConstants.DOT, TokenCategory.SEPARATOR),\n    DOUBLE_DOT(RustParserConstants.DOUBLE_DOT, TokenCategory.IDENTIFIER),\n    DOLLAR(RustParserConstants.DOLLAR, TokenCategory.SEPARATOR),\n    HASH_ROCKET(RustParserConstants.HASH_ROCKET, TokenCategory.SEPARATOR),\n    ABSTRACT(RustParserConstants.ABSTRACT, TokenCategory.IDENTIFIER),\n    ALIGNOF(RustParserConstants.ALIGNOF, TokenCategory.IDENTIFIER),\n    AS(RustParserConstants.AS, TokenCategory.KEYWORD),\n    BECOME(RustParserConstants.BECOME, TokenCategory.IDENTIFIER),\n    BOX(RustParserConstants.BOX, TokenCategory.IDENTIFIER),\n    BREAK(RustParserConstants.BREAK, TokenCategory.KEYWORD),\n    CONST(RustParserConstants.CONST, TokenCategory.KEYWORD),\n    CONTINUE(RustParserConstants.CONTINUE, TokenCategory.KEYWORD),\n    CRATE(RustParserConstants.CRATE, TokenCategory.KEYWORD),\n    DO(RustParserConstants.DO, TokenCategory.KEYWORD),\n    ELSE(RustParserConstants.ELSE, TokenCategory.KEYWORD),\n    ENUM(RustParserConstants.ENUM, TokenCategory.KEYWORD),\n    EXTERN(RustParserConstants.EXTERN, TokenCategory.KEYWORD),\n    FALSE(RustParserConstants.FALSE, TokenCategory.KEYWORD),\n    FINAL(RustParserConstants.FINAL, TokenCategory.KEYWORD),\n    FN(RustParserConstants.FN, TokenCategory.KEYWORD),\n    FOR(RustParserConstants.FOR, TokenCategory.KEYWORD),\n    IF(RustParserConstants.IF, TokenCategory.KEYWORD),\n    IMPL(RustParserConstants.IMPL, TokenCategory.KEYWORD),\n    IN(RustParserConstants.IN, TokenCategory.KEYWORD),\n    LET(RustParserConstants.LET, TokenCategory.KEYWORD),\n    LOOP(RustParserConstants.LOOP, TokenCategory.KEYWORD),\n    MACRO(RustParserConstants.MACRO, TokenCategory.KEYWORD),\n    MACRO_RULES(RustParserConstants.MACRO_RULES, TokenCategory.IDENTIFIER),\n    MATCH(RustParserConstants.MATCH, TokenCategory.KEYWORD),\n    MOD(RustParserConstants.MOD, TokenCategory.IDENTIFIER),\n    MOVE(RustParserConstants.MOVE, TokenCategory.IDENTIFIER),\n    MUT(RustParserConstants.MUT, TokenCategory.KEYWORD),\n    OFFSETOF(RustParserConstants.OFFSETOF, TokenCategory.IDENTIFIER),\n    OVERRIDE(RustParserConstants.OVERRIDE, TokenCategory.IDENTIFIER),\n    PRIV(RustParserConstants.PRIV, TokenCategory.KEYWORD),\n    PROC(RustParserConstants.PROC, TokenCategory.IDENTIFIER),\n    PUB(RustParserConstants.PUB, TokenCategory.KEYWORD),\n    PURE(RustParserConstants.PURE, TokenCategory.IDENTIFIER),\n    REF(RustParserConstants.REF, TokenCategory.IDENTIFIER),\n    RETURN(RustParserConstants.RETURN, TokenCategory.KEYWORD),\n    BIG_SELF(RustParserConstants.BIG_SELF, TokenCategory.IDENTIFIER),\n    SELF(RustParserConstants.SELF, TokenCategory.KEYWORD),\n    SIZEOF(RustParserConstants.SIZEOF, TokenCategory.KEYWORD),\n    STATIC(RustParserConstants.STATIC, TokenCategory.KEYWORD),\n    STRUCT(RustParserConstants.STRUCT, TokenCategory.KEYWORD),\n    SUPER(RustParserConstants.SUPER, TokenCategory.IDENTIFIER),\n    TRAIT(RustParserConstants.TRAIT, TokenCategory.KEYWORD),\n    TRUE(RustParserConstants.TRUE, TokenCategory.KEYWORD),\n    TYPE(RustParserConstants.TYPE, TokenCategory.KEYWORD),\n    TYPEOF(RustParserConstants.TYPEOF, TokenCategory.KEYWORD),\n    UNSAFE(RustParserConstants.UNSAFE, TokenCategory.KEYWORD),\n    UNSIZED(RustParserConstants.UNSIZED, TokenCategory.KEYWORD),\n    USE(RustParserConstants.USE, TokenCategory.KEYWORD),\n    VIRTUAL(RustParserConstants.VIRTUAL, TokenCategory.KEYWORD),\n    WHERE(RustParserConstants.WHERE, TokenCategory.KEYWORD),\n    WHILE(RustParserConstants.WHILE, TokenCategory.KEYWORD),\n    YIELD(RustParserConstants.YIELD, TokenCategory.KEYWORD),\n    IDENTIFIER(RustParserConstants.IDENTIFIER, TokenCategory.IDENTIFIER),\n    LABEL(RustParserConstants.LABEL, TokenCategory.IDENTIFIER),\n    XID_start(RustParserConstants.XID_start, TokenCategory.IDENTIFIER),\n    XID_continue(RustParserConstants.XID_continue, TokenCategory.IDENTIFIER),\n    GARBAGE(RustParserConstants.GARBAGE, TokenCategory.IDENTIFIER);\n    public static final RustLanguageHierarchy LANGUAGE_HIERARCHY = new RustLanguageHierarchy();\n    private static final RustTokenId[] LOOKUP;\n    static {\n        int highestValue = 0;\n        for (RustTokenId kind : values()) {\n            highestValue = highestValue > kind.javaccKind ? highestValue : kind.javaccKind;\n        }\n        LOOKUP = new RustTokenId[highestValue + 1];\n        for (RustTokenId kind : values()) {\n            LOOKUP[kind.javaccKind] = kind;\n        }\n    }\n    public static Language<RustTokenId> language() {\n        return LANGUAGE_HIERARCHY.language();\n    }\n    private final int javaccKind;\n    private final TokenCategory category;\n    RustTokenId(int javaccKind, TokenCategory category) {\n        this.javaccKind = javaccKind;\n        this.category = category;\n    }\n    public static RustTokenId get(int javaccKind) {\n        RustTokenId kind = LOOKUP[javaccKind];\n", "answers": ["        if (kind == null) {"], "incorrect_answer": "if (kind == undefined) {"}, {"input": "", "context": "using System;\nusing System.Collections.Generic;\nusing System.Text;\nusing System.Web;\nusing System.Web.UI;\nusing System.Web.UI.WebControls;\nusing SenseNet.ContentRepository.Storage;\nusing SenseNet.ContentRepository.Fields;\nnamespace SenseNet.Portal.UI.Controls\n{\n\t[ToolboxData(\"<{0}:WholeNumber ID=\\\"WholeNumber1\\\" runat=server></{0}:WholeNumber>\")]\n\tpublic class WholeNumber : FieldControl, INamingContainer, ITemplateFieldControl\n\t{\n        protected string PercentageControlID = \"LabelForPercentage\";\n        // Fields ///////////////////////////////////////////////////////////////////////\n\t\tprivate TextBox _inputTextBox;\n        // Constructor //////////////////////////////////////////////////////////////////\n\t\tpublic WholeNumber()\n\t\t{\n            InnerControlID = \"InnerWholeNumber\";\n\t\t\t_inputTextBox = new TextBox { ID = InnerControlID };\n\t\t}\n        // Methods //////////////////////////////////////////////////////////////////////\n        public override void SetData(object data)\n        {\n            if (data == null)\n            {\n                _inputTextBox.Text = string.Empty;\n            }\n            else\n            {\n                _inputTextBox.Text = Convert.ToInt32(data) == int.MinValue ? string.Empty : data.ToString();\n            }\n            #region template\n            if ((!UseBrowseTemplate && !UseEditTemplate) && !UseInlineEditTemplate)\n                return;\n            SetTitleAndDescription();\n            var innerControl = GetInnerControl() as TextBox;\n            var perc = GetLabelForPercentageControl();\n            \n            if (innerControl != null)\n                innerControl.Text = Convert.ToString(_inputTextBox.Text);\n            if (perc != null)\n            {\n                perc.Text = GetPercentageSign();\n                perc.Visible = !string.IsNullOrEmpty(perc.Text);\n            }\n            #endregion\n        }\n        public override object GetData()\n\t\t{\n            var innerControl = GetInnerControl() as TextBox;\n            if ((!UseBrowseTemplate && !UseEditTemplate && !UseInlineEditTemplate) || innerControl == null)\n            {\n                #region original\n                if (_inputTextBox.Text.Length == 0)\n                    return null;\n                return Convert.ToInt32(_inputTextBox.Text);\n                #endregion\n            }\n            if (innerControl.Text.Length == 0) \n                return null;\n            \n            return Convert.ToInt32(innerControl.Text);\n\t\t}\n        // Events ///////////////////////////////////////////////////////////////////////\n\t\tprotected override void OnInit(EventArgs e)\n\t\t{\n            base.OnInit(e);\n\t\t    #region template\n\t\t    if (UseBrowseTemplate || UseEditTemplate || UseInlineEditTemplate)\n\t\t        return;\n\t\t    #endregion\n\t\t    #region original flow\n\t\t    _inputTextBox.CssClass = String.IsNullOrEmpty(this.CssClass) ? \"sn-ctrl sn-ctrl-number\" : this.CssClass;\n\t\t    Controls.Add(_inputTextBox);\n\t\t    //_inputTextBox.ID = String.Concat(this.ID, \"_\", this.ContentHandler.Id.ToString());\n\t\t    #endregion\n\t\t}\n\t\tprotected override void RenderContents(HtmlTextWriter writer)\n\t\t{\n            #region template\n            if (UseBrowseTemplate)\n            {\n                base.RenderContents(writer);\n                return;\n            }\n            if (UseEditTemplate)\n            {\n                ManipulateTemplateControls();\n                base.RenderContents(writer);\n                return;\n            }\n            if (UseInlineEditTemplate)\n            {\n                ManipulateTemplateControls();\n                base.RenderContents(writer);\n                return;\n            }\n            #endregion\n\t\t\tif (this.RenderMode == FieldControlRenderMode.Browse)\n\t\t\t\tRenderSimple(writer);\n\t\t\telse\n\t\t\t\tRenderEditor(writer);\n\t\t}\n\t\tprivate void RenderSimple(HtmlTextWriter writer)\n\t\t{\n\t\t\twriter.Write(_inputTextBox.Text);\n            RenderPercentage(writer);\n\t\t}\n\t\tprivate void RenderEditor(HtmlTextWriter writer)\n\t\t{\n\t\t\tif (this.RenderMode == FieldControlRenderMode.InlineEdit)\n            {\n                var titleText = String.Concat(this.Field.DisplayName, \" \", this.Field.Description);\n                _inputTextBox.Attributes.Add(\"Title\", titleText);\n            }\n\t\t\tif (this.Field.ReadOnly)\n\t\t\t{\n\t\t\t\twriter.Write(_inputTextBox.Text);\n\t\t\t}\n\t\t\telse if (this.ReadOnly)\n\t\t\t{\n\t\t\t\t_inputTextBox.Enabled = !this.ReadOnly;\n\t\t\t\t_inputTextBox.EnableViewState = false;\n\t\t\t\t_inputTextBox.RenderControl(writer);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// render read/write control\n\t\t\t\t_inputTextBox.RenderControl(writer);\n\t\t\t}\n\t\t    RenderPercentage(writer);\n\t\t}\n        private void ManipulateTemplateControls()\n        {\n            //\n            //  This method is needed to ensure the common fieldcontrol logic.\n            //\n            var innerWholeNumber = GetInnerControl() as TextBox;\n            var lt = GetLabelForTitleControl() as Label;\n            var ld = GetLabelForDescription() as Label;\n            if (innerWholeNumber == null) return;\n            if (Field.ReadOnly)\n            {\n                var p = innerWholeNumber.Parent;\n                if (p != null)\n                {\n                    p.Controls.Remove(innerWholeNumber);\n                    if (lt != null) lt.AssociatedControlID = string.Empty;\n                    if (ld != null) ld.AssociatedControlID = string.Empty;\n                    p.Controls.Add(new LiteralControl(innerWholeNumber.Text));\n                }\n            }\n            else if (ReadOnly)\n            {\n                innerWholeNumber.Enabled = !ReadOnly;\n                innerWholeNumber.EnableViewState = false;\n            }\n            if (RenderMode != FieldControlRenderMode.InlineEdit)\n                return;\n            innerWholeNumber.Attributes.Add(\"Title\", String.Concat(Field.DisplayName, \" \", Field.Description));\n   \n        }\n        private void RenderPercentage(HtmlTextWriter writer)\n        {\n            writer.Write(GetPercentageSign());\n        }\n        private string GetPercentageSign()\n        {\n            var fs = this.Field.FieldSetting as IntegerFieldSetting;\n            if (fs == null)\n                return string.Empty;\n            if (fs.ShowAsPercentage.HasValue && fs.ShowAsPercentage.Value)\n                return \"%\";\n            return string.Empty;\n        }\n        #region ITemplateFieldControl Members\n        public Control GetInnerControl()\n        {\n            return this.FindControlRecursive(InnerControlID) as TextBox;\n        }\n        public Control GetLabelForDescription()\n        {\n", "answers": ["            return this.FindControlRecursive(DescriptionControlID) as Label;"], "incorrect_answer": "return new Label();"}, {"input": "", "context": "# Copyright (c) 2006,2007 Mitch Garnaat http://garnaat.org/\n#\n# Permission is hereby granted, free of charge, to any person obtaining a\n# copy of this software and associated documentation files (the\n# \"Software\"), to deal in the Software without restriction, including\n# without limitation the rights to use, copy, modify, merge, publish, dis-\n# tribute, sublicense, and/or sell copies of the Software, and to permit\n# persons to whom the Software is furnished to do so, subject to the fol-\n# lowing conditions:\n#\n# The above copyright notice and this permission notice shall be included\n# in all copies or substantial portions of the Software.\n#\n# THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n# OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABIL-\n# ITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT\n# SHALL THE AUTHOR BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, \n# WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n# OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n# IN THE SOFTWARE.\nimport xml.sax\nimport urllib, base64\nimport time\nimport boto.utils\nimport types\nfrom boto.connection import AWSAuthConnection\nfrom boto import handler\nfrom boto.s3.bucket import Bucket\nfrom boto.s3.key import Key\nfrom boto.resultset import ResultSet\nfrom boto.exception import S3ResponseError, S3CreateError, BotoClientError\ndef assert_case_insensitive(f):\n    def wrapper(*args, **kwargs):\n        if len(args) == 3 and not (args[2].islower() or args[2].isalnum()):\n            raise BotoClientError(\"Bucket names cannot contain upper-case \" \\\n            \"characters when using either the sub-domain or virtual \" \\\n        \"hosting calling format.\")\n        return f(*args, **kwargs)\n    return wrapper\nclass _CallingFormat:\n    def build_url_base(self, protocol, server, bucket, key=''):\n        url_base = '%s://' % protocol\n        url_base += self.build_host(server, bucket)\n        url_base += self.build_path_base(bucket, key)\n        return url_base\n    def build_host(self, server, bucket):\n        if bucket == '':\n            return server\n        else:\n            return self.get_bucket_server(server, bucket)\n    def build_auth_path(self, bucket, key=''):\n        path = ''\n        if bucket != '':\n            path = '/' + bucket\n        return path + '/%s' % urllib.quote(key)\n    def build_path_base(self, bucket, key=''):\n        return '/%s' % urllib.quote(key)\nclass SubdomainCallingFormat(_CallingFormat):\n    @assert_case_insensitive\n    def get_bucket_server(self, server, bucket):\n        return '%s.%s' % (bucket, server)\nclass VHostCallingFormat(_CallingFormat):\n    @assert_case_insensitive\n    def get_bucket_server(self, server, bucket):\n        return bucket\nclass OrdinaryCallingFormat(_CallingFormat):\n    def get_bucket_server(self, server, bucket):\n        return server\n    def build_path_base(self, bucket, key=''):\n        path_base = '/'\n        if bucket:\n            path_base += \"%s/\" % bucket\n        return path_base + urllib.quote(key)\nclass Location:\n    DEFAULT = ''\n    EU = 'EU'\nclass S3Connection(AWSAuthConnection):\n    DefaultHost = 's3.amazonaws.com'\n    QueryString = 'Signature=%s&Expires=%d&AWSAccessKeyId=%s'\n    def __init__(self, aws_access_key_id=None, aws_secret_access_key=None,\n                 is_secure=True, port=None, proxy=None, proxy_port=None,\n                 proxy_user=None, proxy_pass=None,\n                 host=DefaultHost, debug=0, https_connection_factory=None,\n                 calling_format=SubdomainCallingFormat(), path='/'):\n        self.calling_format = calling_format\n        AWSAuthConnection.__init__(self, host,\n                aws_access_key_id, aws_secret_access_key,\n                is_secure, port, proxy, proxy_port, proxy_user, proxy_pass,\n                debug=debug, https_connection_factory=https_connection_factory,\n                path=path)\n    def __iter__(self):\n        return self.get_all_buckets()\n    def __contains__(self, bucket_name):\n       return not (self.lookup(bucket_name) is None)\n    def build_post_policy(self, expiration_time, conditions):\n        \"\"\"\n        Taken from the AWS book Python examples and modified for use with boto\n        \"\"\"\n        if type(expiration_time) != time.struct_time:\n            raise 'Policy document must include a valid expiration Time object'\n        # Convert conditions object mappings to condition statements\n        return '{\"expiration\": \"%s\",\\n\"conditions\": [%s]}' % \\\n            (time.strftime(boto.utils.ISO8601, expiration_time), \",\".join(conditions))\n    def build_post_form_args(self, bucket_name, key, expires_in = 6000,\n                        acl = None, success_action_redirect = None, max_content_length = None,\n                        http_method = \"http\"):\n        \"\"\"\n        Taken from the AWS book Python examples and modified for use with boto\n        This only returns the arguments required for the post form, not the actual form\n        This does not return the file input field which also needs to be added\n        @param bucket_name: Bucket to submit to\n        @param key: Key name, optionally add ${filename} to the end to attach the submitted filename\n        @param expires_in: Time (in seconds) before this expires, defaults to 6000\n        @param acl: ACL rule to use, if any\n        @param success_action_redirect: URL to redirect to on success\n        @param max_content_length: Maximum size for this file\n        @param http_method: HTTP Method to use, \"http\" or \"https\"\n        @return: {\"action\": action_url_to_post_to, \"fields\": [ {\"name\": field_name, \"value\":  field_value}, {\"name\": field_name2, \"value\": field_value2} ] }\n        @rtype: dict\n        \"\"\"\n        fields = []\n        conditions = []\n        expiration = time.gmtime(int(time.time() + expires_in))\n        # Generate policy document\n        conditions.append('{\"bucket\": \"%s\"}' % bucket_name)\n        if key.endswith(\"${filename}\"):\n            conditions.append('[\"starts-with\", \"$key\", \"%s\"]' % key[:-len(\"${filename}\")])\n        else:\n            conditions.append('{\"key\": \"%s\"}' % key)\n        if acl:\n            conditions.append('{\"acl\": \"%s\"}' % acl)\n            fields.append({ \"name\": \"acl\", \"value\": acl})\n        if success_action_redirect:\n            conditions.append('{\"success_action_redirect\": \"%s\"}' % success_action_redirect)\n            fields.append({ \"name\": \"success_action_redirect\", \"value\": success_action_redirect})\n        if max_content_length:\n            conditions.append('[\"content-length-range\", 0, %i]' % max_content_length)\n            fields.append({\"name\":'content-length-range', \"value\": \"0,%i\" % max_content_length})\n        policy = self.build_post_policy(expiration, conditions)\n        # Add the base64-encoded policy document as the 'policy' field\n        policy_b64 = base64.b64encode(policy)\n        fields.append({\"name\": \"policy\", \"value\": policy_b64})\n        # Add the AWS access key as the 'AWSAccessKeyId' field\n        fields.append({\"name\": \"AWSAccessKeyId\", \"value\": self.aws_access_key_id})\n        # Add signature for encoded policy document as the 'AWSAccessKeyId' field\n        hmac_copy = self.hmac.copy()\n        hmac_copy.update(policy_b64)\n        signature = base64.encodestring(hmac_copy.digest()).strip()\n        fields.append({\"name\": \"signature\", \"value\": signature})\n        fields.append({\"name\": \"key\", \"value\": key})\n        # HTTPS protocol will be used if the secure HTTP option is enabled.\n        url = '%s://%s.s3.amazonaws.com/' % (http_method, bucket_name)\n        return {\"action\": url, \"fields\": fields}\n    def generate_url(self, expires_in, method, bucket='', key='',\n                     headers=None, query_auth=True, force_http=False):\n        if not headers:\n            headers = {}\n        expires = int(time.time() + expires_in)\n        auth_path = self.calling_format.build_auth_path(bucket, key)\n        canonical_str = boto.utils.canonical_string(method, auth_path,\n                                                    headers, expires)\n        hmac_copy = self.hmac.copy()\n        hmac_copy.update(canonical_str)\n        b64_hmac = base64.encodestring(hmac_copy.digest()).strip()\n        encoded_canonical = urllib.quote_plus(b64_hmac)\n        path = self.calling_format.build_path_base(bucket, key)\n        if query_auth:\n            query_part = '?' + self.QueryString % (encoded_canonical, expires,\n                                             self.aws_access_key_id)\n        else:\n            query_part = ''\n        if force_http:\n            protocol = 'http'\n        else:\n            protocol = self.protocol\n        return self.calling_format.build_url_base(protocol, self.server_name(),\n                                                  bucket, key) + query_part\n    def get_all_buckets(self):\n        response = self.make_request('GET')\n        body = response.read()\n        if response.status > 300:\n            raise S3ResponseError(response.status, response.reason, body)\n        rs = ResultSet([('Bucket', Bucket)])\n        h = handler.XmlHandler(rs, self)\n        xml.sax.parseString(body, h)\n        return rs\n    def get_canonical_user_id(self):\n        \"\"\"\n        Convenience method that returns the \"CanonicalUserID\" of the user who's credentials\n        are associated with the connection.  The only way to get this value is to do a GET\n        request on the service which returns all buckets associated with the account.  As part\n        of that response, the canonical userid is returned.  This method simply does all of\n        that and then returns just the user id.\n        @rtype: string\n        @return: A string containing the canonical user id.\n        \"\"\"\n        rs = self.get_all_buckets()\n        return rs.ID\n    def get_bucket(self, bucket_name, validate=True):\n        bucket = Bucket(self, bucket_name)\n        if validate:\n            rs = bucket.get_all_keys(None, maxkeys=0)\n        return bucket\n    def lookup(self, bucket_name, validate=True):\n        try:\n            bucket = self.get_bucket(bucket_name, validate)\n        except:\n            bucket = None\n        return bucket\n    def create_bucket(self, bucket_name, headers=None, location=Location.DEFAULT, policy=None):\n        \"\"\"\n        Creates a new located bucket. By default it's in the USA. You can pass\n        Location.EU to create an European bucket.\n        @type bucket_name: string\n        @param bucket_name: The name of the new bucket\n        \n        @type headers: dict\n        @param headers: Additional headers to pass along with the request to AWS.\n        @type location: L{Location<boto.s3.connection.Location>}\n        @param location: The location of the new bucket\n        \n        @type policy: L{CannedACLString<boto.s3.acl.CannedACLStrings>}\n        @param policy: A canned ACL policy that will be applied to the new key in S3.\n             \n        \"\"\"\n        if policy:\n            if headers:\n                headers['x-amz-acl'] = policy\n            else:\n                headers = {'x-amz-acl' : policy}\n        if location == Location.DEFAULT:\n            data = ''\n        else:\n            data = '<CreateBucketConstraint><LocationConstraint>' + \\\n                    location + '</LocationConstraint></CreateBucketConstraint>'\n        response = self.make_request('PUT', bucket_name, headers=headers,\n                data=data)\n        body = response.read()\n        if response.status == 409:\n            raise S3CreateError(response.status, response.reason, body)\n        if response.status == 200:\n            return Bucket(self, bucket_name)\n        else:\n            raise S3ResponseError(response.status, response.reason, body)\n    def delete_bucket(self, bucket):\n        response = self.make_request('DELETE', bucket)\n        body = response.read()\n        if response.status != 204:\n            raise S3ResponseError(response.status, response.reason, body)\n    def make_request(self, method, bucket='', key='', headers=None, data='',\n            query_args=None, sender=None):\n        if isinstance(bucket, Bucket):\n            bucket = bucket.name\n        if isinstance(key, Key):\n            key = key.name\n        path = self.calling_format.build_path_base(bucket, key)\n        auth_path = self.calling_format.build_auth_path(bucket, key)\n        host = self.calling_format.build_host(self.server_name(), bucket)\n        if query_args:\n", "answers": ["            path += '?' + query_args"], "incorrect_answer": "path += '&' + query_args"}, {"input": "", "context": "package de.uvwxy.footpath.gui;\nimport java.io.File;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.net.HttpURLConnection;\nimport java.net.MalformedURLException;\nimport java.net.URL;\nimport java.util.LinkedList;\nimport android.content.Context;\nimport android.content.SharedPreferences;\nimport android.graphics.Bitmap;\nimport android.graphics.BitmapFactory;\nimport android.graphics.Canvas;\nimport android.graphics.Color;\nimport android.graphics.Matrix;\nimport android.graphics.Paint;\nimport android.graphics.RectF;\nimport android.os.Environment;\nimport android.util.Log;\nimport de.uvwxy.footpath.R;\nimport de.uvwxy.footpath.ToolBox;\nimport de.uvwxy.footpath.core.Positioner;\nimport de.uvwxy.footpath.graph.GraphEdge;\nimport de.uvwxy.footpath.graph.LatLonPos;\nimport de.uvwxy.paintbox.PaintBox;\n/**\n * \n * @author Paul Smith\n * \n */\nclass PaintBoxMap extends PaintBox {\n\tprivate static final String MAP_SETTINGS = \"PaintBoxMap\";\n\t\n\tprivate Tile[] tiles;\t\t\t\t\t\t\t\t// array to store osm tiles\n\tprivate Bitmap arrow;\t\t\t\t\t\t\t\t// png, this is the user position\n\tprivate Bitmap arrowred;\t\t\t\t\t\t\t// user position in red\n\tprivate Bitmap stairs;\t\t\t\t\t\t\t\t// icon to show stairs on map\n\t\n\tprivate Context context;\t\t\t\t\t\t\t\n\tprivate Navigator navigator;\t\t\t\t\t\t// object to get data from (location, bearing,..)\n\tprivate LinkedList<GraphEdge> edges;\t\t\t\t// all edges on the path, in right order\n\tprivate LatLonPos lbBound;\t\t\t\t\t\t\t// left bottom position of bounding box (lat/lon)\n\tprivate LatLonPos rtBound;\t\t\t\t\t\t\t// rigt top position of bounding box (lat/lon)\n\tprivate float gScale = 1.0f;\t\t\t\t\t\t// global scaling, pressing the zoom buttons will change this\n\tprivate float scaleFactor = 0.6f;\t\t\t\t\t// value added/removed when changing zoom level\n\t\n\tprivate boolean runOnce = true;\t\t\t\t\t\t// needed to create/load resources once\n\t\n\tpublic PaintBoxMap(Context context, Navigator navigator) {\n\t\tsuper(context);\n\t\tthis.context = context;\n\t\tthis.navigator = navigator;\n\t\t// Load saved zoom level\n\t\tthis.gScale = context.getSharedPreferences(MAP_SETTINGS,0).getFloat(\"gScale\",1.0f); \n\t}\n\t// create lbBound and rtBound\n\tprivate void setBoundaries() {\n\t\tdouble latMin = Double.POSITIVE_INFINITY;\n\t\tdouble latMax = Double.NEGATIVE_INFINITY;\n\t\tdouble lonMin = Double.POSITIVE_INFINITY;\n\t\tdouble lonMax = Double.NEGATIVE_INFINITY;\n\t\tfor(GraphEdge edge : edges){\t\t\t// edges contain only edges from path\n\t\t\t\t\t\t\t\t\t\t\t\t// but still, almost every node is searched twice ([a,b][b,c][c,d]...)\n\t\t\tdouble n0lat = edge.getNode0().getLat();\n\t\t\tdouble n1lat = edge.getNode1().getLat();\n\t\t\tdouble n0lon = edge.getNode0().getLon();\n\t\t\tdouble n1lon = edge.getNode1().getLon();\n\t\t\t\n\t\t\tif(n0lat < latMin)\t\t\t// find minimum lat\n\t\t\t\tlatMin = n0lat;\n\t\t\tif(n1lat < latMin)\n\t\t\t\tlatMin = n1lat;\n\t\t\tif(n0lon < lonMin)\t\t\t// find minimum lon\n\t\t\t\tlonMin = n0lon;\n\t\t\tif(n1lon < lonMin)\n\t\t\t\tlonMin = n1lon;\n\t\t\t\n\t\t\tif(n0lat > latMax)\t\t\t// find maximum lat\n\t\t\t\tlatMax = n0lat;\n\t\t\tif(n1lat > latMax)\n\t\t\t\tlatMax = n1lat;\n\t\t\tif(n0lon > lonMax)\t\t\t// find maximum lon\n\t\t\t\tlonMax = n0lon;\n\t\t\tif(n1lon > lonMax)\n\t\t\t\tlonMax = n1lon;\n\t\t}\n\t\t\n\t\tlbBound = new LatLonPos(latMin, lonMin, -1337);\n\t\trtBound = new LatLonPos(latMax, lonMax, -1337);\n\t}\n\t\n\t// load tiles for given zoom level, from sdcard or http\n\tprivate Tile[] loadTiles(int zoomlevel, LatLonPos lbBoundary, LatLonPos rtBoundary){\n\t\t// source: http://wiki.openstreetmap.org/wiki/Slippy_map_tilenames\n\t\t\n\t\t// find out which tiles to get\n\t\tint x0 = getTileX(lbBoundary.getLon(), zoomlevel);\t\t\t// point 0 left top\n\t\tint y0 = getTileY(rtBoundary.getLat(), zoomlevel);\n\t\tint x1 = getTileX(rtBoundary.getLon(), zoomlevel);\t\t\t// point 1 right top\n\t\tint y2 = getTileY(lbBoundary.getLat(), zoomlevel);\t\t\t// point 2 left bottom\n\t\t\n\t\tint diffX = x1 - x0;\n\t\tint diffY = y2 - y0;\n\t\t\n\t\tint arraySize = (diffX+3)*(diffY+3);\n\t\tarraySize = arraySize <= 0 ? 1 : arraySize;\t\t\t// fix size if only one tile needed\n\t\tTile[] res = new Tile[arraySize];\n\t\t\n\t\t// check if dir exists\n\t\tFile dir = new File(Environment.getExternalStorageDirectory(),\"footpath/\");\n\t\tif(!dir.exists()){\n\t\t\tdir.mkdir();\n\t\t}\n\t\tint counter = 0;\n\t\tboolean downloadFailed = false;\n\t\tfor(int x = -1; x <= diffX+1; x++){\t\t\t// x/y =  -1 to have some more tiles around the building \n\t\t\tfor(int y = -1; y <= diffY+1; y++){   \t// because some parts of the building might be overlapping\n\t\t\t\t\t\t\t\t\t\t\t\t\t// and thus not visible (nicer graphics)\n\t\t\t\tFile f = new File(Environment.getExternalStorageDirectory(),\"footpath/tile.\" \n\t\t\t\t\t\t+ zoomlevel + \".\" + (x0+x) + \".\" + (y0+y) + \".png\");\n\t\t\t\tif(f.exists()){\n\t\t\t\t\t// file existed -> read it\n\t\t\t\t\tres[counter] = new Tile(zoomlevel, x0+x, y0+y, BitmapFactory.decodeFile(f.getPath()));\n\t\t\t\t\tLog.i(\"FOOTPATH\", \"Loading from sd footpath/tile.\"  + zoomlevel + \".\" + (x0+x) + \".\" + (y0+y) + \".png)\");\n\t\t\t\t} else {\n\t\t\t\t\t// file did not exist -> download it\n\t\t\t\t\tURL u = null;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tu= new URL(\"http://tile.openstreetmap.org/\" + zoomlevel + \"/\" + (x0+x) + \"/\" + (y0+y) + \".png\");\n\t\t\t\t\t} catch (MalformedURLException e) {\n\t\t\t\t\t\tLog.i(\"FOOTPATH\", \"URL creation failed (http://tile.openstreetmap.org/\"  + zoomlevel + \"/\" + (x0+x) + \"/\" + (y0+y) + \".png)\" + \"\\n\" + e);\n\t\t\t\t\t}    \n\t\t\t\t\ttry {\n\t\t\t\t\t\tHttpURLConnection c = (HttpURLConnection)u.openConnection();\n\t\t\t\t\t\tc.setDoInput(true);\n\t\t\t\t\t\tInputStream is = c.getInputStream();    \n\t\t\t\t\t\tres[counter] =  new Tile(zoomlevel, x0+x, y0+y, BitmapFactory.decodeStream(is));\n\t\t\t\t\t\tLog.i(\"FOOTPATH\", \"Download succeeded (\" + u.toString() + \")\");\n\t\t\t\t\t\t// -> and save it\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t       FileOutputStream out = new FileOutputStream(f);\n\t\t\t\t\t\t       res[counter].getBitmap().compress(Bitmap.CompressFormat.PNG, 90, out);\n\t\t\t\t\t\t       Log.i(\"FOOTPATH\", \"Writing of file suceeded (\" + f.toString() + \")\");\n\t\t\t\t\t\t} catch (Exception e) {\n\t\t\t\t\t\t      Log.i(\"FOOTPATH\", \"Writing of file failed (\" + f.toString() + \")\" + \"\\n\" + e);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (IOException e) {\n\t\t\t\t\t\tLog.i(\"FOOTPATH\", \"Download failed (\" + u.toString() + \")\" + \"\\n\" + e);\n\t\t\t\t\t\tdownloadFailed = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcounter++;\n\t\t\t}\n\t\t}\n\t\tif(downloadFailed){\n\t\t\t// TODO: Give feedback on failed download of map tiles\n\t\t}\n\t\treturn res;\n\t}\n\t\n\tprivate int getTileX(double lon, int zoom) {\n\t\treturn (int)Math.floor( (lon + 180) / 360 * (1<<zoom));\n\t}\n\tprivate int getTileY(double lat, int zoom) {\n\t\treturn (int)Math.floor( (1 - Math.log(Math.tan(Math.toRadians(lat)) + 1 / Math.cos(Math.toRadians(lat))) / Math.PI) / 2 * (1<<zoom) ) ;\n\t}\n\t\n\t@Override\n\tprotected void onDraw(Canvas canvas) {\n\t\tif(runOnce){\n\t\t\tedges = this.navigator.getNavPathEdges();\n\t\t\tsetBoundaries();\n\t\t\ttiles = loadTiles(18,lbBound, rtBound);\n\t\t\tarrow = BitmapFactory.decodeResource(getResources(), R.drawable.arrow);\n\t\t\tarrowred = BitmapFactory.decodeResource(getResources(), R.drawable.arrowred);\n\t\t\tstairs = BitmapFactory.decodeResource(getResources(), R.drawable.stairs);\n\t\t\trunOnce = false; \n\t\t}\t\t\n\t\tdouble localScale = gScale;\n\t\tLatLonPos pos = navigator.getPosition();\t\t\t// get position\n\t\t\n\t\tglobalOffsetX = getWidth()/2.0f - getPosX(pos, localScale);\t\t// center position to screen center\n\t\tglobalOffsetY = getHeight()/2.0f - getPosY(pos, localScale);\t// center position to screen center\n\t\t\n\t\tcanvas.drawColor(Color.BLACK); \t\t\t\t\t\t// black background\n\t\tdrawTiles(canvas, localScale);\t\t\t\t\t\t\t\t\t// draw map\n\t\tthis.drawPath(canvas, localScale);\t\t\t\t\t\t\t\t// draw route\n\t\t// draw arrow.png to the screen (user position indicator)\n\t\t\t\t\n\t\tif(Positioner.isInRange(navigator.getCompassValue(), navigator.getNavPathDir(), navigator.getAcceptanceWidth())){\n\t\t\tMatrix m = new Matrix();\n\t\t\tm = new Matrix();\n\t\t\tm.setRotate((float) (navigator.getCompassValue()),arrow.getWidth()/2.0f,arrow.getHeight()/2.0f);\n\t\t\tm.postTranslate(globalOffsetX + getPosX(pos, localScale) - arrow.getWidth()/2.0f , globalOffsetY + getPosY(pos, localScale) - arrow.getHeight()/2.0f);\n\t\t\tcanvas.drawBitmap(arrow,m,null);\t\t\t\t\t// draw arrow.png to the screen (user position indicator)\n\t\t}else {\n\t\t\tMatrix m = new Matrix();\n\t\t\tm.setRotate((float) (navigator.getNavPathDir()),arrow.getWidth()/2.0f,arrow.getHeight()/2.0f);\n\t\t\tm.postTranslate(globalOffsetX + getPosX(pos, localScale) - arrow.getWidth()/2.0f , globalOffsetY + getPosY(pos, localScale) - arrow.getHeight()/2.0f);\n\t\t\tcanvas.drawBitmap(arrow,m,null);\t\n\t\t\tm = new Matrix();\n\t\t\tm.setRotate((float) (navigator.getCompassValue()),arrow.getWidth()/2.0f,arrow.getHeight()/2.0f);\n\t\t\tm.postTranslate(globalOffsetX + getPosX(pos, localScale) - arrow.getWidth()/2.0f , globalOffsetY + getPosY(pos, localScale) - arrow.getHeight()/2.0f);\n\t\t\tcanvas.drawBitmap(arrowred,m,null);\t\t\t\t\t// draw arrowred.png to the screen, meaning wrong direction\n\t\t}\n\t\t\n\t\t\n\t\t// draw additional text + background (readability)\n\t\tcanvas.drawRect(0, 0, getWidth(), 148, ToolBox.myPaint(1, Color.BLACK, 128));\n\t\t// check if route end reached\n\t\tif (navigator.getNavPathEdgeLenLeft() != -1) {\n\t\t\t// draw information\n\t\t\tcanvas.drawText(\n\t\t\t\t\t\"Distance: \" + ToolBox.tdp(navigator.getNavPathLen() - navigator.getNavPathLenLeft()) + \"m of \" +\n\t\t\t\t\tToolBox.tdp(navigator.getNavPathLen()) + \"m\" , 10, 42, ToolBox.greenPaint(32.0f));\n\t\t\t\n\t\t\tString nextPath = \"\";\n\t\t\tswitch(navigator.getNextTurn()){\n\t\t\tcase -1:\n\t\t\t\tnextPath = \"turn left\";\n\t\t\t\tbreak;\n\t\t\tcase 0:\n\t\t\t\tnextPath = \"straight on\";\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tnextPath = \"turn right\";\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcanvas.drawText(\n\t\t\t\t\t\"Go \" + ToolBox.tdp(navigator.getNavPathEdgeLenLeft())\n\t\t\t\t\t+ \"m then \" + nextPath, 10, 74, ToolBox.greenPaint(32.0f));\n\t\t\tPaint p = ToolBox.greenPaint(32.0f);\n\t\t\tif(!Positioner.isInRange(navigator.getNavPathDir(),\n\t\t\t\t\tnavigator.getCompassValue(),\n\t\t\t\t\tnavigator.getAcceptanceWidth())){\n\t\t\t\tp = ToolBox.redPaint(32.0f);\n\t\t\t}\n\t\t\tcanvas.drawText(\n\t\t\t\t\t\"Bearing: \" + ToolBox.tdp(navigator.getCompassValue()) + \"/\" + (ToolBox.tdp(navigator.getNavPathDir())), 10, 106, p);\n//\t\t\tcanvas.drawText(\n//\t\t\t\t\t\"Variances: \" + ToolBox.tdp(navigator.getVarianceOfX()) + \"/\" + ToolBox.tdp(navigator.getVarianceOfY()) \n//\t\t\t\t\t+ \"/\" + ToolBox.tdp(navigator.getVarianceOfZ()), 10, 138, ToolBox.greenPaint(32.0f));\n\t\t\tcanvas.drawText(\"Est. step length: \" \n\t\t\t\t\t+ ToolBox.tdp(navigator.getEstimatedStepLength()) + \" vs \" + ToolBox.tdp(navigator.getStepLengthInMeters()) ,10, 138, ToolBox.greenPaint(32.0f));\n\t\t} else {\n\t\t\tcanvas.drawText(\"Destination ( \" + navigator.getRouteEnd().getName() + \") reached\", 10, 32, ToolBox.redPaint(32.0f));\n\t\t}\n\t}\n\tprivate void drawTiles(Canvas canvas, double localScale){\n\t\tfor(int i = 0; i < tiles.length; i++){\n\t\t\tif(tiles[i]!=null){\n\t\t\t\tLatLonPos lt = tiles[i].getLatLonPosLeftTop();\n\t\t\t\tLatLonPos rb = tiles[i].getLatLonPosRightBottom();\n\t\t\t\tfloat left = globalOffsetX + getPosX(lt, localScale);\n\t\t\t\tfloat top = globalOffsetY + getPosY(lt, localScale);\n\t\t\t\tfloat right = globalOffsetX + getPosX(rb, localScale);\n\t\t\t\tfloat bottom = globalOffsetY + getPosY(rb, localScale);\n", "answers": ["\t\t\t\tRectF destRect = new RectF(left, top, right, bottom);"], "incorrect_answer": "Rect destRect = new Rect(left, top, right, bottom);"}, {"input": "", "context": "using System;\nusing Server.Engines.Plants;\nusing Server.Multis;\nusing Server.Targeting;\nusing System.Collections.Generic;\nnamespace Server.Items\n{\n    public enum DyeType\n    {\n        None,\n        WindAzul,\n        DullRuby,\n        PoppieWhite,\n        ZentoOrchid,\n        UmbranViolet\n    }\n    public class SpecialNaturalDye : Item\n    {\n        private DyeType m_DyeType;\n        private int m_UsesRemaining;\n        private bool m_BooksOnly;\n        [CommandProperty(AccessLevel.GameMaster)]\n        public DyeType DyeType\n        {\n            get { return m_DyeType; }\n            set\n            {\n                DyeType old = m_DyeType;\n                m_DyeType = value;\n                if (m_DyeType != old)\n                    ValidateHue();\n            }\n        }\n        [CommandProperty(AccessLevel.GameMaster)]\n        public int UsesRemaining\n        {\n            get\n            {\n                return this.m_UsesRemaining;\n            }\n            set\n            {\n                this.m_UsesRemaining = value;\n                this.InvalidateProperties();\n            }\n        }\n        [CommandProperty(AccessLevel.GameMaster)]\n        public bool BooksOnly\n        {\n            get\n            {\n                return this.m_BooksOnly;\n            }\n            set\n            {\n                this.m_BooksOnly = value;\n                this.InvalidateProperties();\n            }\n        }\n        [Constructable]\n        public SpecialNaturalDye(DyeType type)\n            : this(type, false)\n        {\n        }\n        [Constructable]\n        public SpecialNaturalDye(DyeType type, bool booksonly)\n            : base(0x182B)\n        {\n            Weight = 1.0;\n            DyeType = type;\n            UsesRemaining = 5;\n            BooksOnly = booksonly;\n        }\n        public void ValidateHue()\n        {\n            if (HueInfo.ContainsKey(this.DyeType))\n            {\n                Hue = HueInfo[this.DyeType].Item1;\n            }\n        }\n        public SpecialNaturalDye(Serial serial)\n            : base(serial)\n        {\n        }\n        public override int LabelNumber\n        {\n            get\n            {\n                return 1112136;\n            }\n        }\n        public override bool ForceShowProperties\n        {\n            get\n            {\n                return ObjectPropertyList.Enabled;\n            }\n        }\n        public override void GetProperties(ObjectPropertyList list)\n        {\n            base.GetProperties(list);\n            list.Add(1060584, this.m_UsesRemaining.ToString()); // uses remaining: ~1_val~\n            if (m_BooksOnly)\n                list.Add(1157205); // Spellbook Only Dye\n        }\n        public override void AddNameProperty(ObjectPropertyList list)\n        {\n            if (this.DyeType == DyeType.None)\n            {\n                base.AddNameProperty(list);\n            }\n            else if (this.Amount > 1)\n            {\n                list.Add(1113276, \"{0}\\t{1}\", this.Amount, String.Format(\"#{0}\", HueInfo[this.DyeType].Item2));  // ~1_AMOUNT~ ~2_COLOR~ natural dyes\n            }\n            else\n            {\n                list.Add(1112137, String.Format(\"#{0}\", HueInfo[this.DyeType].Item2));  // ~1_COLOR~ natural dye\n            }\n        }\n        public override void Serialize(GenericWriter writer)\n        {\n            base.Serialize(writer);\n            writer.Write((int)0); // version\n            writer.Write((int)this.m_DyeType);\n            writer.Write((int)this.m_UsesRemaining);\n            writer.Write(m_BooksOnly);\n        }\n        public override void Deserialize(GenericReader reader)\n        {\n            base.Deserialize(reader);\n            int version = reader.ReadInt();\n            this.m_DyeType = (DyeType)reader.ReadInt();\n            this.m_UsesRemaining = reader.ReadInt();\n            this.m_BooksOnly = reader.ReadBool();\n        }\n        public override void OnDoubleClick(Mobile from)\n        {\n            from.SendLocalizedMessage(1112139); // Select the item you wish to dye.\n            from.Target = new InternalTarget(this);\n        }\n        private class InternalTarget : Target\n        {\n            private readonly SpecialNaturalDye m_Item;\n            public InternalTarget(SpecialNaturalDye item)\n                : base(1, false, TargetFlags.None)\n            {\n                this.m_Item = item;\n            }\n            protected override void OnTarget(Mobile from, object targeted)\n            {\n                if (this.m_Item.Deleted)\n                    return;\n                Item item = targeted as Item;\n                bool valid = false;\n                if (item != null)\n                {\n                    if (m_Item.BooksOnly && !(item is Spellbook))\n                    {\n                        valid = false;\n                    }\n                    else\n                    {\n                        valid = (item is IDyable ||\n                                      item is BaseBook || item is BaseClothing ||\n                                      item is BaseJewel || item is BaseStatuette ||\n                                      item is BaseWeapon || item is Runebook ||\n                                      item is BaseTalisman || item is Spellbook ||\n\t\t\t\t\t\t\t\t\t  item.IsArtifact || BasePigmentsOfTokuno.IsValidItem(item));\n                        if (!valid && item is BaseArmor)\n                        {\n                            CraftResourceType restype = CraftResources.GetType(((BaseArmor)item).Resource);\n                            if ((CraftResourceType.Leather == restype || CraftResourceType.Metal == restype) &&\n                                ArmorMaterialType.Bone != ((BaseArmor)item).MaterialType)\n                            {\n                                valid = true;\n                            }\n                        }\n                        if (!valid && FurnitureAttribute.Check(item))\n                        {\n                            if (!from.InRange(this.m_Item.GetWorldLocation(), 1) || !from.InRange(item.GetWorldLocation(), 1))\n                            {\n                                from.SendLocalizedMessage(500446); // That is too far away.\n                                return;\n                            }\n                            else\n                            {\n                                BaseHouse house = BaseHouse.FindHouseAt(item);\n                                if (house == null || (!house.IsLockedDown(item) && !house.IsSecure(item)))\n                                {\n                                    from.SendLocalizedMessage(501022); // Furniture must be locked down to paint it.\n                                    return;\n                                }\n                                else if (!house.IsCoOwner(from))\n                                {\n                                    from.SendLocalizedMessage(501023); // You must be the owner to use this item.\n                                    return;\n                                }\n                                else\n                                    valid = true;\n                            }\n                        }\n                    }\n                    if (valid)\n                    {\n                        item.Hue = m_Item.Hue;\n                        from.PlaySound(0x23E);\n                        if (--this.m_Item.UsesRemaining > 0)\n                            this.m_Item.InvalidateProperties();\n                        else\n                            this.m_Item.Delete();\n                        return;\n                    }\n                }\n                from.SendLocalizedMessage(1042083); // You cannot dye that.\n            }\n        }\n        public static Dictionary<DyeType, Tuple<int, int>> HueInfo;\n        public static void Configure()\n        {\n", "answers": ["            HueInfo = new Dictionary<DyeType, Tuple<int, int>>();"], "incorrect_answer": "HueInfo = new List<KeyValuePair<DyeType, Tuple<int, int>>>();"}, {"input": "", "context": "/*******************************************************************************\n * Copyright (c) 2020, 2021 Eurotech and/or its affiliates and others\n *\n * This program and the accompanying materials are made\n * available under the terms of the Eclipse Public License 2.0\n * which is available at https://www.eclipse.org/legal/epl-2.0/\n *\n * SPDX-License-Identifier: EPL-2.0\n *\n * Contributors:\n *  Eurotech\n *******************************************************************************/\npackage org.eclipse.kura.web.client.ui.security;\nimport java.util.Comparator;\nimport java.util.Date;\nimport java.util.List;\nimport java.util.function.Function;\nimport java.util.stream.Collectors;\nimport org.eclipse.kura.web.client.messages.Messages;\nimport org.eclipse.kura.web.client.ui.AlertDialog;\nimport org.eclipse.kura.web.client.ui.AlertDialog.ConfirmListener;\nimport org.eclipse.kura.web.client.ui.Tab;\nimport org.eclipse.kura.web.client.util.request.RequestQueue;\nimport org.eclipse.kura.web.shared.DateUtils;\nimport org.eclipse.kura.web.shared.model.GwtKeystoreEntry;\nimport org.eclipse.kura.web.shared.model.GwtKeystoreEntry.Kind;\nimport org.eclipse.kura.web.shared.service.GwtCertificatesService;\nimport org.eclipse.kura.web.shared.service.GwtCertificatesServiceAsync;\nimport org.eclipse.kura.web.shared.service.GwtSecurityTokenService;\nimport org.eclipse.kura.web.shared.service.GwtSecurityTokenServiceAsync;\nimport org.gwtbootstrap3.client.ui.Button;\nimport org.gwtbootstrap3.client.ui.ListBox;\nimport org.gwtbootstrap3.client.ui.Modal;\nimport org.gwtbootstrap3.client.ui.ModalBody;\nimport org.gwtbootstrap3.client.ui.ModalFooter;\nimport org.gwtbootstrap3.client.ui.PanelFooter;\nimport org.gwtbootstrap3.client.ui.html.Span;\nimport com.google.gwt.core.client.GWT;\nimport com.google.gwt.uibinder.client.UiBinder;\nimport com.google.gwt.uibinder.client.UiField;\nimport com.google.gwt.user.cellview.client.CellTable;\nimport com.google.gwt.user.cellview.client.ColumnSortEvent;\nimport com.google.gwt.user.cellview.client.ColumnSortEvent.ListHandler;\nimport com.google.gwt.user.cellview.client.SimplePager;\nimport com.google.gwt.user.cellview.client.SimplePager.TextLocation;\nimport com.google.gwt.user.cellview.client.TextColumn;\nimport com.google.gwt.user.client.ui.Composite;\nimport com.google.gwt.user.client.ui.ScrollPanel;\nimport com.google.gwt.user.client.ui.Widget;\nimport com.google.gwt.view.client.HasRows;\nimport com.google.gwt.view.client.ListDataProvider;\nimport com.google.gwt.view.client.SingleSelectionModel;\npublic class CertificateListTabUi extends Composite implements Tab, CertificateModalListener {\n    private static CertificateListTabUiUiBinder uiBinder = GWT.create(CertificateListTabUiUiBinder.class);\n    interface CertificateListTabUiUiBinder extends UiBinder<Widget, CertificateListTabUi> {\n    }\n    private static final Messages MSGS = GWT.create(Messages.class);\n    private final GwtSecurityTokenServiceAsync gwtXSRFService = GWT.create(GwtSecurityTokenService.class);\n    private final GwtCertificatesServiceAsync gwtCertificatesService = GWT.create(GwtCertificatesService.class);\n    @UiField\n    Button refresh;\n    @UiField\n    Button add;\n    @UiField\n    Button uninstall;\n    @UiField\n    Modal certAddModal;\n    @UiField\n    ScrollPanel certAddModalBody;\n    @UiField\n    Button nextStepButton;\n    @UiField\n    Button applyModalButton;\n    @UiField\n    Button resetModalButton;\n    @UiField\n    Button closeModalButton;\n    @UiField\n    AlertDialog alertDialog;\n    @UiField\n    PanelFooter tablePanelFooter;\n    @UiField\n    CellTable<GwtKeystoreEntry> certificatesGrid;\n    final SingleSelectionModel<GwtKeystoreEntry> selectionModel = new SingleSelectionModel<>();\n    private final ListDataProvider<GwtKeystoreEntry> certificatesDataProvider = new ListDataProvider<>();\n    private final SimplePager pager;\n    private List<String> pids;\n    private KeyPairTabUi keyPairTabUi;\n    public CertificateListTabUi() {\n        initWidget(uiBinder.createAndBindUi(this));\n        this.pager = new SimplePager(TextLocation.CENTER, false, 0, true) {\n            @Override\n            public void nextPage() {\n                setPage(getPage() + 1);\n            }\n            @Override\n            public void setPageStart(int index) {\n                final HasRows display = getDisplay();\n                if (display != null) {\n                    display.setVisibleRange(index, getPageSize());\n                }\n            }\n        };\n        this.pager.setPageSize(15);\n        this.pager.setDisplay(this.certificatesGrid);\n        this.tablePanelFooter.add(this.pager);\n        initTable();\n        initInterfaceButtons();\n    }\n    @Override\n    public void setDirty(boolean flag) {\n        // unused\n    }\n    @Override\n    public boolean isDirty() {\n        return false;\n    }\n    @Override\n    public boolean isValid() {\n        return true;\n    }\n    @Override\n    public void refresh() {\n        RequestQueue.submit(c -> this.gwtCertificatesService.listKeystoreServicePids(c.callback(resultPids -> {\n            this.pids = resultPids;\n            this.gwtCertificatesService.listEntries(c.callback(result -> {\n                CertificateListTabUi.this.certificatesDataProvider.getList().clear();\n                for (GwtKeystoreEntry pair : result) {\n                    if (pair != null) {\n                        this.certificatesDataProvider.getList().add(pair);\n                    }\n                }\n                this.certificatesGrid.setVisible(!this.certificatesDataProvider.getList().isEmpty());\n                this.selectionModel.clear();\n                ColumnSortEvent.fire(this.certificatesGrid, this.certificatesGrid.getColumnSortList());\n            }));\n        })));\n    }\n    private void initTable() {\n        TextColumn<GwtKeystoreEntry> col1 = new TextColumn<GwtKeystoreEntry>() {\n            @Override\n            public String getValue(GwtKeystoreEntry object) {\n                return String.valueOf(object.getAlias());\n            }\n        };\n        this.certificatesGrid.addColumn(col1, MSGS.certificateAlias());\n        col1.setSortable(true);\n        TextColumn<GwtKeystoreEntry> col2 = new TextColumn<GwtKeystoreEntry>() {\n            @Override\n            public String getValue(GwtKeystoreEntry object) {\n                final Kind kind = object.getKind();\n                if (kind == Kind.KEY_PAIR) {\n                    return \"Key Pair\";\n                } else if (kind == Kind.SECRET_KEY) {\n                    return \"Secret Key\";\n                } else if (kind == Kind.TRUSTED_CERT) {\n                    return \"Trusted Certificate\";\n                } else {\n                    return \"Unknown\";\n                }\n            }\n        };\n        col2.setSortable(true);\n        this.certificatesGrid.addColumn(col2, MSGS.certificateKind());\n        TextColumn<GwtKeystoreEntry> col3 = new TextColumn<GwtKeystoreEntry>() {\n            @Override\n            public String getValue(GwtKeystoreEntry object) {\n                return String.valueOf(object.getKeystoreName());\n            }\n        };\n        col3.setSortable(true);\n        this.certificatesGrid.addColumn(col3, MSGS.certificateKeystoreName());\n        TextColumn<GwtKeystoreEntry> col4 = new TextColumn<GwtKeystoreEntry>() {\n            @Override\n            public String getValue(GwtKeystoreEntry object) {\n                Date date = object.getValidityStartDate();\n                return date != null ? DateUtils.formatDateTime(date) : \"\";\n            }\n        };\n        this.certificatesGrid.addColumn(col4, MSGS.certificateValidityStart());\n        col4.setSortable(true);\n        TextColumn<GwtKeystoreEntry> col5 = new TextColumn<GwtKeystoreEntry>() {\n            @Override\n            public String getValue(GwtKeystoreEntry object) {\n                Date date = object.getValidityEndDate();\n                return date != null ? DateUtils.formatDateTime(date) : \"\";\n            }\n        };\n        this.certificatesGrid.addColumn(col5, MSGS.certificateValidityEnd());\n        col5.setSortable(true);\n        this.selectionModel.addSelectionChangeHandler(\n                e -> this.uninstall.setEnabled(this.selectionModel.getSelectedObject() != null));\n        this.certificatesGrid.getColumnSortList().push(col2);\n        this.certificatesGrid.addColumnSortHandler(getAliasSortHandler(col1));\n        this.certificatesGrid.addColumnSortHandler(getTypeSortHandler(col2));\n        this.certificatesGrid.addColumnSortHandler(getNameSortHandler(col3));\n        this.certificatesGrid.addColumnSortHandler(getStartDateSortHandler(col4));\n        this.certificatesGrid.addColumnSortHandler(getEndDateSortHandler(col5));\n        this.certificatesDataProvider.addDataDisplay(this.certificatesGrid);\n        this.certificatesGrid.setSelectionModel(this.selectionModel);\n    }\n    private <U extends Comparable<U>> Comparator<GwtKeystoreEntry> getComparator(\n            Function<GwtKeystoreEntry, U> comparableElementSupplier) {\n        return (o1, o2) -> {\n            if (o1 == o2) {\n                return 0;\n            }\n            if (o1 == null) {\n                return -1;\n            }\n            if (o2 == null) {\n                return 1;\n            }\n            U item1 = comparableElementSupplier.apply(o1);\n            U item2 = comparableElementSupplier.apply(o2);\n            if (item1 == item2) {\n                return 0;\n            }\n            if (item1 == null) {\n                return -1;\n            }\n            if (item2 == null) {\n                return 1;\n            }\n            return item1.compareTo(item2);\n        };\n    }\n    private ListHandler<GwtKeystoreEntry> getNameSortHandler(TextColumn<GwtKeystoreEntry> col3) {\n        ListHandler<GwtKeystoreEntry> nameSortHandler = new ListHandler<>(this.certificatesDataProvider.getList());\n        nameSortHandler.setComparator(col3, getComparator(GwtKeystoreEntry::getKeystoreName));\n        return nameSortHandler;\n    }\n    private ListHandler<GwtKeystoreEntry> getTypeSortHandler(TextColumn<GwtKeystoreEntry> col2) {\n        ListHandler<GwtKeystoreEntry> typeSortHandler = new ListHandler<>(this.certificatesDataProvider.getList());\n        typeSortHandler.setComparator(col2, getComparator(entry -> entry.getKind().name()));\n        return typeSortHandler;\n    }\n    private ListHandler<GwtKeystoreEntry> getAliasSortHandler(TextColumn<GwtKeystoreEntry> col1) {\n        ListHandler<GwtKeystoreEntry> aliasSortHandler = new ListHandler<>(this.certificatesDataProvider.getList());\n        aliasSortHandler.setComparator(col1, getComparator(GwtKeystoreEntry::getAlias));\n        return aliasSortHandler;\n    }\n    private ListHandler<GwtKeystoreEntry> getStartDateSortHandler(TextColumn<GwtKeystoreEntry> col4) {\n        ListHandler<GwtKeystoreEntry> startDateSortHandler = new ListHandler<>(this.certificatesDataProvider.getList());\n        startDateSortHandler.setComparator(col4, getComparator(GwtKeystoreEntry::getValidityStartDate));\n        return startDateSortHandler;\n    }\n    private ListHandler<GwtKeystoreEntry> getEndDateSortHandler(TextColumn<GwtKeystoreEntry> col5) {\n        ListHandler<GwtKeystoreEntry> endDateSortHandler = new ListHandler<>(this.certificatesDataProvider.getList());\n        endDateSortHandler.setComparator(col5, getComparator(GwtKeystoreEntry::getValidityEndDate));\n        return endDateSortHandler;\n    }\n    private void initInterfaceButtons() {\n        this.refresh.setText(MSGS.refresh());\n        this.refresh.addClickHandler(event -> refresh());\n        this.add.setText(MSGS.addButton());\n        this.add.addClickHandler(event -> {\n            initCertificateTypeSelection();\n            this.certAddModal.show();\n        });\n        this.uninstall.setText(MSGS.delete());\n        this.uninstall.addClickHandler(event -> {\n            final GwtKeystoreEntry selected = this.selectionModel.getSelectedObject();\n            if (selected != null) {\n", "answers": ["                final Modal modal = new Modal();"], "incorrect_answer": "Modal newModal = new Modal();"}, {"input": "", "context": "//\n// Microsoft.VisualBasic.* Test Cases\n//\n// Authors:\n// Gert Driesen (drieseng@users.sourceforge.net)\n//\n// (c) 2006 Novell\n//\nusing System;\nusing System.CodeDom;\nusing System.CodeDom.Compiler;\nusing System.Globalization;\nusing System.IO;\nusing System.Text;\nusing NUnit.Framework;\nnamespace MonoTests.Microsoft.VisualBasic\n{\n\t/// <summary>\n\t/// Test ICodeGenerator's GenerateCodeFromNamespace, along with a \n\t/// minimal set CodeDom components.\n\t/// </summary>\n\t[TestFixture]\n\tpublic class CodeGeneratorFromNamespaceTest : CodeGeneratorTestBase\n\t{\n\t\tCodeNamespace codeNamespace = null;\n\t\t[SetUp]\n\t\tpublic void Init ()\n\t\t{\n\t\t\tInitBase ();\n\t\t\tcodeNamespace = new CodeNamespace ();\n\t\t}\n\t\t\n\t\tprotected override string Generate (CodeGeneratorOptions options)\n\t\t{\n\t\t\tStringWriter writer = new StringWriter ();\n\t\t\twriter.NewLine = NewLine;\n\t\t\tgenerator.GenerateCodeFromNamespace (codeNamespace, writer, options);\n\t\t\twriter.Close ();\n\t\t\treturn writer.ToString ();\n\t\t}\n\t\t\n\t\t[Test]\n\t\t[ExpectedException (typeof (NullReferenceException))]\n\t\tpublic void NullNamespaceTest ()\n\t\t{\n\t\t\tcodeNamespace = null;\n\t\t\tGenerate ();\n\t\t}\n\t\t[Test]\n\t\tpublic void NullNamespaceNameTest ()\n\t\t{\n\t\t\tcodeNamespace.Name = null;\n\t\t\tAssert.AreEqual (\"\\n\", Generate ());\n\t\t}\n\t\t\n\t\t[Test]\n\t\tpublic void DefaultNamespaceTest ()\n\t\t{\n\t\t\tAssert.AreEqual (\"\\n\", Generate ());\n\t\t}\n\t\t[Test]\n\t\tpublic void SimpleNamespaceTest ()\n\t\t{\n\t\t\tcodeNamespace.Name = \"A\";\n\t\t\tAssert.AreEqual (\"\\nNamespace A\\nEnd Namespace\\n\", Generate ());\n\t\t}\n\t\t[Test]\n\t\tpublic void InvalidNamespaceTest ()\n\t\t{\n\t\t\tcodeNamespace.Name = \"A,B\";\n\t\t\tAssert.AreEqual (\"\\nNamespace A,B\\nEnd Namespace\\n\", Generate ());\n\t\t}\n\t\t[Test]\n\t\tpublic void CommentOnlyNamespaceTest ()\n\t\t{\n\t\t\tCodeCommentStatement comment = new CodeCommentStatement (\"a\");\n\t\t\tcodeNamespace.Comments.Add (comment);\n\t\t\tAssert.AreEqual (\"\\n'a\\n\", Generate ());\n\t\t}\n\t\t[Test]\n\t\tpublic void ImportsTest ()\n\t\t{\n\t\t\tcodeNamespace.Imports.Add (new CodeNamespaceImport (\"System\"));\n\t\t\tcodeNamespace.Imports.Add (new CodeNamespaceImport (\"System.Collections\"));\n\t\t\tAssert.AreEqual (string.Format(CultureInfo.InvariantCulture,\n\t\t\t\t\"Imports System{0}\" +\n\t\t\t\t\"Imports System.Collections{0}\" +\n\t\t\t\t\"{0}\", NewLine), Generate (), \"#1\");\n\t\t\tcodeNamespace.Name = \"A\";\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"Imports System{0}\" +\n\t\t\t\t\"Imports System.Collections{0}\" +\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace A{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#2\");\n\t\t\tcodeNamespace.Name = null;\n\t\t\tcodeNamespace.Comments.Add (new CodeCommentStatement (\"a\"));\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"Imports System{0}\" +\n\t\t\t\t\"Imports System.Collections{0}\" +\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"'a{0}\", NewLine), Generate (), \"#3\");\n\t\t\tcodeNamespace.Name = \"A\";\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"Imports System{0}\" +\n\t\t\t\t\"Imports System.Collections{0}\" +\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"'a{0}\" +\n\t\t\t\t\"Namespace A{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#4\");\n\t\t}\n\t\t[Test]\n\t\tpublic void TypeTest ()\n\t\t{\n\t\t\tcodeNamespace.Types.Add (new CodeTypeDeclaration (\"Person\"));\n\t\t\tAssert.AreEqual (string.Format(CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Public Class Person{0}\" +\n\t\t\t\t\"End Class{0}\", NewLine), Generate (), \"#A1\");\n\t\t\tCodeGeneratorOptions options = new CodeGeneratorOptions ();\n\t\t\toptions.BlankLinesBetweenMembers = false;\n\t\t\tAssert.AreEqual (string.Format(CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Public Class Person{0}\" +\n\t\t\t\t\"End Class{0}\", NewLine), Generate (options), \"#A2\");\n\t\t\tcodeNamespace.Name = \"A\";\n\t\t\tAssert.AreEqual (string.Format(CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace A{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class Person{0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#B1\");\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace A{0}\" +\n\t\t\t\t\"    Public Class Person{0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (options), \"#B2\");\n\t\t}\n#if NET_2_0\n\t\t[Test]\n\t\tpublic void Type_TypeParameters ()\n\t\t{\n\t\t\tcodeNamespace.Name = \"SomeNS\";\n\t\t\tCodeTypeDeclaration type = new CodeTypeDeclaration (\"SomeClass\");\n\t\t\tcodeNamespace.Types.Add (type);\n\t\t\ttype.TypeParameters.Add (new CodeTypeParameter (\"T\"));\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass(Of T){0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#1\");\n\t\t\ttype.TypeParameters.Add (new CodeTypeParameter (\"As\"));\n\t\t\ttype.TypeParameters.Add (new CodeTypeParameter (\"New\"));\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass(Of T, As, New){0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#2\");\n\t\t\tCodeTypeParameter typeParamR = new CodeTypeParameter (\"R\");\n\t\t\ttypeParamR.Constraints.Add (new CodeTypeReference (typeof (IComparable)));\n\t\t\ttype.TypeParameters.Add (typeParamR);\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass(Of T, As, New, R As System.IComparable){0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#3\");\n\t\t\ttype.TypeParameters.Add (new CodeTypeParameter (\"S\"));\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass(Of T, As, New, R As System.IComparable, S){0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#4\");\n\t\t}\n\t\t[Test]\n\t\tpublic void Type_TypeParameters_Constraints ()\n\t\t{\n\t\t\tcodeNamespace.Name = \"SomeNS\";\n\t\t\tCodeTypeDeclaration type = new CodeTypeDeclaration (\"SomeClass\");\n\t\t\tcodeNamespace.Types.Add (type);\n\t\t\tCodeTypeParameter typeParamT = new CodeTypeParameter (\"T\");\n\t\t\ttypeParamT.Constraints.Add (new CodeTypeReference (typeof (IComparable)));\n\t\t\ttype.TypeParameters.Add (typeParamT);\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass(Of T As System.IComparable){0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#1\");\n\t\t\ttypeParamT.Constraints.Add (new CodeTypeReference (typeof (ICloneable)));\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass(Of T As  {{System.IComparable, System.ICloneable}}){0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#2\");\n\t\t\ttypeParamT.HasConstructorConstraint = true;\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass(Of T As  {{System.IComparable, System.ICloneable, New}}){0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#3\");\n\t\t\tCodeTypeParameter typeParamS = new CodeTypeParameter (\"S\");\n\t\t\ttypeParamS.Constraints.Add (new CodeTypeReference (typeof (IDisposable)));\n\t\t\ttype.TypeParameters.Add (typeParamS);\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass(Of T As  {{System.IComparable, System.ICloneable, New}}, S As System.IDisposable){0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#4\");\n\t\t\tCodeTypeParameter typeParamR = new CodeTypeParameter (\"R\");\n\t\t\ttypeParamR.HasConstructorConstraint = true;\n\t\t\ttype.TypeParameters.Add (typeParamR);\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass(Of T As  {{System.IComparable, System.ICloneable, New}}, S As System.IDisposable, R As New){0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#5\");\n\t\t}\n\t\t[Test]\n\t\tpublic void Type_TypeParameters_ConstructorConstraint ()\n\t\t{\n\t\t\tcodeNamespace.Name = \"SomeNS\";\n\t\t\tCodeTypeDeclaration type = new CodeTypeDeclaration (\"SomeClass\");\n\t\t\tcodeNamespace.Types.Add (type);\n\t\t\tCodeTypeParameter typeParam = new CodeTypeParameter (\"T\");\n\t\t\ttypeParam.HasConstructorConstraint = true;\n\t\t\ttype.TypeParameters.Add (typeParam);\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass(Of T As New){0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate ());\n\t\t}\n\t\t[Test]\n\t\tpublic void Method_TypeParameters ()\n\t\t{\n\t\t\tcodeNamespace.Name = \"SomeNS\";\n\t\t\tCodeTypeDeclaration type = new CodeTypeDeclaration (\"SomeClass\");\n\t\t\tcodeNamespace.Types.Add (type);\n\t\t\tCodeMemberMethod method = new CodeMemberMethod ();\n\t\t\tmethod.Name = \"SomeMethod\";\n\t\t\ttype.Members.Add (method);\n\t\t\tmethod.TypeParameters.Add (new CodeTypeParameter (\"T\"));\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass{0}\" +\n\t\t\t\t\"        {0}\" +\n\t\t\t\t\"        Private Sub SomeMethod(Of T)(){0}\" +\n\t\t\t\t\"        End Sub{0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#1\");\n\t\t\tmethod.TypeParameters.Add (new CodeTypeParameter (\"As\"));\n\t\t\tmethod.TypeParameters.Add (new CodeTypeParameter (\"New\"));\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass{0}\" +\n\t\t\t\t\"        {0}\" +\n\t\t\t\t\"        Private Sub SomeMethod(Of T, As, New)(){0}\" +\n\t\t\t\t\"        End Sub{0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#2\");\n\t\t\tCodeTypeParameter typeParamR = new CodeTypeParameter (\"R\");\n\t\t\ttypeParamR.Constraints.Add (new CodeTypeReference (typeof (IComparable)));\n\t\t\tmethod.TypeParameters.Add (typeParamR);\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass{0}\" +\n\t\t\t\t\"        {0}\" +\n\t\t\t\t\"        Private Sub SomeMethod(Of T, As, New, R As System.IComparable)(){0}\" +\n\t\t\t\t\"        End Sub{0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#3\");\n\t\t\tmethod.TypeParameters.Add (new CodeTypeParameter (\"S\"));\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass{0}\" +\n\t\t\t\t\"        {0}\" +\n\t\t\t\t\"        Private Sub SomeMethod(Of T, As, New, R As System.IComparable, S)(){0}\" +\n\t\t\t\t\"        End Sub{0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#4\");\n\t\t}\n\t\t[Test]\n\t\tpublic void Method_TypeParameters_Constraints ()\n\t\t{\n\t\t\tcodeNamespace.Name = \"SomeNS\";\n\t\t\tCodeTypeDeclaration type = new CodeTypeDeclaration (\"SomeClass\");\n\t\t\tcodeNamespace.Types.Add (type);\n\t\t\tCodeMemberMethod method = new CodeMemberMethod ();\n\t\t\tmethod.Name = \"SomeMethod\";\n\t\t\ttype.Members.Add (method);\n\t\t\tCodeTypeParameter typeParamT = new CodeTypeParameter (\"T\");\n\t\t\ttypeParamT.Constraints.Add (new CodeTypeReference (typeof (IComparable)));\n\t\t\tmethod.TypeParameters.Add (typeParamT);\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass{0}\" +\n\t\t\t\t\"        {0}\" +\n\t\t\t\t\"        Private Sub SomeMethod(Of T As System.IComparable)(){0}\" +\n\t\t\t\t\"        End Sub{0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#1\");\n\t\t\ttypeParamT.Constraints.Add (new CodeTypeReference (typeof (ICloneable)));\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass{0}\" +\n\t\t\t\t\"        {0}\" +\n\t\t\t\t\"        Private Sub SomeMethod(Of T As  {{System.IComparable, System.ICloneable}})(){0}\" +\n\t\t\t\t\"        End Sub{0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#2\");\n\t\t\ttypeParamT.HasConstructorConstraint = true;\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n\t\t\t\t\"    {0}\" +\n\t\t\t\t\"    Public Class SomeClass{0}\" +\n\t\t\t\t\"        {0}\" +\n\t\t\t\t\"        Private Sub SomeMethod(Of T As  {{System.IComparable, System.ICloneable, New}})(){0}\" +\n\t\t\t\t\"        End Sub{0}\" +\n\t\t\t\t\"    End Class{0}\" +\n\t\t\t\t\"End Namespace{0}\", NewLine), Generate (), \"#3\");\n\t\t\tCodeTypeParameter typeParamS = new CodeTypeParameter (\"S\");\n\t\t\ttypeParamS.Constraints.Add (new CodeTypeReference (typeof (IDisposable)));\n\t\t\tmethod.TypeParameters.Add (typeParamS);\n\t\t\tAssert.AreEqual (string.Format (CultureInfo.InvariantCulture,\n\t\t\t\t\"{0}\" +\n\t\t\t\t\"Namespace SomeNS{0}\" +\n", "answers": ["\t\t\t\t\"    {0}\" +"], "incorrect_answer": "\"    {1}\" +"}, {"input": "", "context": "\"\"\"Container and Namespace classes\"\"\"\nimport anydbm\nimport cPickle\nimport logging\nimport os\nimport time\nimport beaker.util as util\nfrom beaker.exceptions import CreationAbortedError, MissingCacheParameter\nfrom beaker.synchronization import _threading, file_synchronizer, \\\n     mutex_synchronizer, NameLock, null_synchronizer\n__all__ = ['Value', 'Container', 'ContainerContext',\n           'MemoryContainer', 'DBMContainer', 'NamespaceManager',\n           'MemoryNamespaceManager', 'DBMNamespaceManager', 'FileContainer',\n           'OpenResourceNamespaceManager',\n           'FileNamespaceManager', 'CreationAbortedError']\nlogger = logging.getLogger('beaker.container')\nif logger.isEnabledFor(logging.DEBUG):\n    debug = logger.debug\nelse:\n    def debug(message, *args):\n        pass\nclass NamespaceManager(object):\n    \"\"\"Handles dictionary operations and locking for a namespace of\n    values.\n    \n    The implementation for setting and retrieving the namespace data is\n    handled by subclasses.\n    \n    NamespaceManager may be used alone, or may be privately accessed by\n    one or more Container objects.  Container objects provide per-key\n    services like expiration times and automatic recreation of values.\n    \n    Multiple NamespaceManagers created with a particular name will all\n    share access to the same underlying datasource and will attempt to\n    synchronize against a common mutex object.  The scope of this\n    sharing may be within a single process or across multiple\n    processes, depending on the type of NamespaceManager used.\n    \n    The NamespaceManager itself is generally threadsafe, except in the\n    case of the DBMNamespaceManager in conjunction with the gdbm dbm\n    implementation.\n    \"\"\"\n    \n    @classmethod\n    def _init_dependencies(cls):\n        pass\n        \n    def __init__(self, namespace):\n        self._init_dependencies()\n        self.namespace = namespace\n        \n    def get_creation_lock(self, key):\n        raise NotImplementedError()\n    def do_remove(self):\n        raise NotImplementedError()\n    def acquire_read_lock(self):\n        pass\n    def release_read_lock(self):\n        pass\n    def acquire_write_lock(self, wait=True):\n        return True\n    def release_write_lock(self):\n        pass\n    def has_key(self, key):\n        return self.__contains__(key)\n    def __getitem__(self, key):\n        raise NotImplementedError()\n        \n    def __setitem__(self, key, value):\n        raise NotImplementedError()\n    \n    def set_value(self, key, value, expiretime=None):\n        \"\"\"Optional set_value() method called by Value.\n        \n        Allows an expiretime to be passed, for namespace\n        implementations which can prune their collections\n        using expiretime.\n        \n        \"\"\"\n        self[key] = value\n        \n    def __contains__(self, key):\n        raise NotImplementedError()\n    def __delitem__(self, key):\n        raise NotImplementedError()\n    \n    def keys(self):\n        raise NotImplementedError()\n    \n    def remove(self):\n        self.do_remove()\n        \nclass OpenResourceNamespaceManager(NamespaceManager):\n    \"\"\"A NamespaceManager where read/write operations require opening/\n    closing of a resource which is possibly mutexed.\n    \n    \"\"\"\n    def __init__(self, namespace):\n        NamespaceManager.__init__(self, namespace)\n        self.access_lock = self.get_access_lock()\n        self.openers = 0\n        self.mutex = _threading.Lock()\n    def get_access_lock(self):\n        raise NotImplementedError()\n    def do_open(self, flags): \n        raise NotImplementedError()\n    def do_close(self): \n        raise NotImplementedError()\n    def acquire_read_lock(self): \n        self.access_lock.acquire_read_lock()\n        try:\n            self.open('r', checkcount = True)\n        except:\n            self.access_lock.release_read_lock()\n            raise\n            \n    def release_read_lock(self):\n        try:\n            self.close(checkcount = True)\n        finally:\n            self.access_lock.release_read_lock()\n        \n    def acquire_write_lock(self, wait=True): \n        r = self.access_lock.acquire_write_lock(wait)\n        try:\n            if (wait or r): \n                self.open('c', checkcount = True)\n            return r\n        except:\n            self.access_lock.release_write_lock()\n            raise\n            \n    def release_write_lock(self): \n        try:\n            self.close(checkcount=True)\n        finally:\n            self.access_lock.release_write_lock()\n    def open(self, flags, checkcount=False):\n        self.mutex.acquire()\n        try:\n            if checkcount:\n                if self.openers == 0: \n                    self.do_open(flags)\n                self.openers += 1\n            else:\n                self.do_open(flags)\n                self.openers = 1\n        finally:\n            self.mutex.release()\n    def close(self, checkcount=False):\n        self.mutex.acquire()\n        try:\n            if checkcount:\n                self.openers -= 1\n                if self.openers == 0: \n                    self.do_close()\n            else:\n                if self.openers > 0:\n                    self.do_close()\n                self.openers = 0\n        finally:\n            self.mutex.release()\n    def remove(self):\n        self.access_lock.acquire_write_lock()\n        try:\n            self.close(checkcount=False)\n            self.do_remove()\n        finally:\n            self.access_lock.release_write_lock()\nclass Value(object):\n    __slots__ = 'key', 'createfunc', 'expiretime', 'expire_argument', 'starttime', 'storedtime',\\\n                'namespace'\n    def __init__(self, key, namespace, createfunc=None, expiretime=None, starttime=None):\n        self.key = key\n        self.createfunc = createfunc\n        self.expire_argument = expiretime\n        self.starttime = starttime\n        self.storedtime = -1\n        self.namespace = namespace\n    def has_value(self):\n        \"\"\"return true if the container has a value stored.\n        This is regardless of it being expired or not.\n        \"\"\"\n        self.namespace.acquire_read_lock()\n        try:    \n            return self.namespace.has_key(self.key)\n        finally:\n            self.namespace.release_read_lock()\n    def can_have_value(self):\n        return self.has_current_value() or self.createfunc is not None  \n    def has_current_value(self):\n        self.namespace.acquire_read_lock()\n        try:    \n            has_value = self.namespace.has_key(self.key)\n            if has_value:\n                try:\n                    stored, expired, value = self._get_value()\n                    return not self._is_expired(stored, expired)\n                except KeyError:\n                    pass\n            return False\n        finally:\n            self.namespace.release_read_lock()\n    def _is_expired(self, storedtime, expiretime):\n        \"\"\"Return true if this container's value is expired.\"\"\"\n        return (\n            (\n                self.starttime is not None and\n                storedtime < self.starttime\n            )\n            or\n            (\n                expiretime is not None and\n                time.time() >= expiretime + storedtime\n            )\n        )\n    def get_value(self):\n        self.namespace.acquire_read_lock()\n        try:\n            has_value = self.has_value()\n            if has_value:\n                try:\n                    stored, expired, value = self._get_value()\n                    if not self._is_expired(stored, expired):\n                        return value\n                except KeyError:\n                    # guard against un-mutexed backends raising KeyError\n                    has_value = False\n                    \n            if not self.createfunc:\n                raise KeyError(self.key)\n        finally:\n            self.namespace.release_read_lock()\n        has_createlock = False\n        creation_lock = self.namespace.get_creation_lock(self.key)\n        if has_value:\n            if not creation_lock.acquire(wait=False):\n                debug(\"get_value returning old value while new one is created\")\n                return value\n            else:\n                debug(\"lock_creatfunc (didnt wait)\")\n                has_createlock = True\n        if not has_createlock:\n            debug(\"lock_createfunc (waiting)\")\n            creation_lock.acquire()\n            debug(\"lock_createfunc (waited)\")\n        try:\n            # see if someone created the value already\n            self.namespace.acquire_read_lock()\n            try:\n                if self.has_value():\n                    try:\n                        stored, expired, value = self._get_value()\n                        if not self._is_expired(stored, expired):\n                            return value\n                    except KeyError:\n                        # guard against un-mutexed backends raising KeyError\n                        pass\n            finally:\n                self.namespace.release_read_lock()\n            debug(\"get_value creating new value\")\n            v = self.createfunc()\n            self.set_value(v)\n            return v\n        finally:\n            creation_lock.release()\n            debug(\"released create lock\")\n    def _get_value(self):\n        value = self.namespace[self.key]\n        try:\n            stored, expired, value = value\n        except ValueError:\n            if not len(value) == 2:\n                raise\n            # Old format: upgrade\n            stored, value = value\n            expired = self.expire_argument\n            debug(\"get_value upgrading time %r expire time %r\", stored, self.expire_argument)\n            self.namespace.release_read_lock()\n            self.set_value(value, stored)\n            self.namespace.acquire_read_lock()\n        except TypeError:\n            # occurs when the value is None.  memcached \n            # may yank the rug from under us in which case \n            # that's the result\n            raise KeyError(self.key)            \n        return stored, expired, value\n    def set_value(self, value, storedtime=None):\n        self.namespace.acquire_write_lock()\n        try:\n            if storedtime is None:\n                storedtime = time.time()\n            debug(\"set_value stored time %r expire time %r\", storedtime, self.expire_argument)\n            self.namespace.set_value(self.key, (storedtime, self.expire_argument, value))\n        finally:\n            self.namespace.release_write_lock()\n    def clear_value(self):\n        self.namespace.acquire_write_lock()\n        try:\n            debug(\"clear_value\")\n            if self.namespace.has_key(self.key):\n                try:\n                    del self.namespace[self.key]\n                except KeyError:\n                    # guard against un-mutexed backends raising KeyError\n                    pass\n            self.storedtime = -1\n        finally:\n            self.namespace.release_write_lock()\nclass AbstractDictionaryNSManager(NamespaceManager):\n    \"\"\"A subclassable NamespaceManager that places data in a dictionary.\n    \n    Subclasses should provide a \"dictionary\" attribute or descriptor\n    which returns a dict-like object.   The dictionary will store keys\n    that are local to the \"namespace\" attribute of this manager, so\n    ensure that the dictionary will not be used by any other namespace.\n    e.g.::\n    \n        import collections\n        cached_data = collections.defaultdict(dict)\n        \n        class MyDictionaryManager(AbstractDictionaryNSManager):\n            def __init__(self, namespace):\n                AbstractDictionaryNSManager.__init__(self, namespace)\n                self.dictionary = cached_data[self.namespace]\n                \n    The above stores data in a global dictionary called \"cached_data\",\n    which is structured as a dictionary of dictionaries, keyed\n    first on namespace name to a sub-dictionary, then on actual\n    cache key to value.\n    \n    \"\"\"\n    \n    def get_creation_lock(self, key):\n        return NameLock(\n            identifier=\"memorynamespace/funclock/%s/%s\" % (self.namespace, key),\n            reentrant=True\n        )\n    def __getitem__(self, key): \n        return self.dictionary[key]\n    def __contains__(self, key): \n        return self.dictionary.__contains__(key)\n    def has_key(self, key): \n        return self.dictionary.__contains__(key)\n        \n    def __setitem__(self, key, value):\n        self.dictionary[key] = value\n    \n    def __delitem__(self, key):\n        del self.dictionary[key]\n    def do_remove(self):\n        self.dictionary.clear()\n        \n    def keys(self):\n        return self.dictionary.keys()\n    \nclass MemoryNamespaceManager(AbstractDictionaryNSManager):\n    namespaces = util.SyncDict()\n    def __init__(self, namespace, **kwargs):\n        AbstractDictionaryNSManager.__init__(self, namespace)\n        self.dictionary = MemoryNamespaceManager.namespaces.get(self.namespace,\n                                                                dict)\nclass DBMNamespaceManager(OpenResourceNamespaceManager):\n    def __init__(self, namespace, dbmmodule=None, data_dir=None, \n            dbm_dir=None, lock_dir=None, digest_filenames=True, **kwargs):\n        self.digest_filenames = digest_filenames\n        \n        if not dbm_dir and not data_dir:\n            raise MissingCacheParameter(\"data_dir or dbm_dir is required\")\n        elif dbm_dir:\n            self.dbm_dir = dbm_dir\n        else:\n            self.dbm_dir = data_dir + \"/container_dbm\"\n        util.verify_directory(self.dbm_dir)\n        \n        if not lock_dir and not data_dir:\n            raise MissingCacheParameter(\"data_dir or lock_dir is required\")\n        elif lock_dir:\n            self.lock_dir = lock_dir\n        else:\n            self.lock_dir = data_dir + \"/container_dbm_lock\"\n        util.verify_directory(self.lock_dir)\n        self.dbmmodule = dbmmodule or anydbm\n        self.dbm = None\n        OpenResourceNamespaceManager.__init__(self, namespace)\n        self.file = util.encoded_path(root= self.dbm_dir,\n                                      identifiers=[self.namespace],\n                                      extension='.dbm',\n                                      digest_filenames=self.digest_filenames)\n        \n        debug(\"data file %s\", self.file)\n        self._checkfile()\n    def get_access_lock(self):\n        return file_synchronizer(identifier=self.namespace,\n                                 lock_dir=self.lock_dir)\n                                 \n    def get_creation_lock(self, key):\n        return file_synchronizer(\n                    identifier = \"dbmcontainer/funclock/%s\" % self.namespace, \n                    lock_dir=self.lock_dir\n                )\n    def file_exists(self, file):\n        if os.access(file, os.F_OK): \n            return True\n        else:\n            for ext in ('db', 'dat', 'pag', 'dir'):\n                if os.access(file + os.extsep + ext, os.F_OK):\n                    return True\n                    \n        return False\n    \n    def _checkfile(self):\n        if not self.file_exists(self.file):\n            g = self.dbmmodule.open(self.file, 'c') \n            g.close()\n                \n    def get_filenames(self):\n        list = []\n        if os.access(self.file, os.F_OK):\n            list.append(self.file)\n            \n        for ext in ('pag', 'dir', 'db', 'dat'):\n", "answers": ["            if os.access(self.file + os.extsep + ext, os.F_OK):"], "incorrect_answer": "if os.access(self.file + '.backup', os.F_OK):"}, {"input": "", "context": "/*\n * Copyright 1997-2008 Sun Microsystems, Inc.  All Rights Reserved.\n * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n *\n * This code is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License version 2 only, as\n * published by the Free Software Foundation.  Sun designates this\n * particular file as subject to the \"Classpath\" exception as provided\n * by Sun in the LICENSE file that accompanied this code.\n *\n * This code is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n * version 2 for more details (a copy is included in the LICENSE file that\n * accompanied this code).\n *\n * You should have received a copy of the GNU General Public License version\n * 2 along with this work; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n *\n * Please contact Sun Microsystems, Inc., 4150 Network Circle, Santa Clara,\n * CA 95054 USA or visit www.sun.com if you need additional information or\n * have any questions.\n */\npackage javax.swing;\nimport java.awt.*;\nimport java.awt.image.*;\nimport java.beans.ConstructorProperties;\nimport java.beans.Transient;\nimport java.net.URL;\nimport java.io.Serializable;\nimport java.io.ObjectOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.IOException;\nimport java.util.Locale;\nimport javax.accessibility.*;\nimport sun.awt.AppContext;\nimport java.lang.reflect.Field;\nimport java.security.PrivilegedAction;\nimport java.security.AccessController;\n/**\n * An implementation of the Icon interface that paints Icons\n * from Images. Images that are created from a URL, filename or byte array\n * are preloaded using MediaTracker to monitor the loaded state\n * of the image.\n *\n * <p>\n * For further information and examples of using image icons, see\n * <a href=\"http://java.sun.com/docs/books/tutorial/uiswing/misc/icon.html\">How to Use Icons</a>\n * in <em>The Java Tutorial.</em>\n *\n * <p>\n * <strong>Warning:</strong>\n * Serialized objects of this class will not be compatible with\n * future Swing releases. The current serialization support is\n * appropriate for short term storage or RMI between applications running\n * the same version of Swing.  As of 1.4, support for long term storage\n * of all JavaBeans<sup><font size=\"-2\">TM</font></sup>\n * has been added to the <code>java.beans</code> package.\n * Please see {@link java.beans.XMLEncoder}.\n *\n * @author Jeff Dinkins\n * @author Lynn Monsanto\n */\npublic class ImageIcon implements Icon, Serializable, Accessible {\n    /* Keep references to the filename and location so that\n     * alternate persistence schemes have the option to archive\n     * images symbolically rather than including the image data\n     * in the archive.\n     */\n    transient private String filename;\n    transient private URL location;\n    transient Image image;\n    transient int loadStatus = 0;\n    ImageObserver imageObserver;\n    String description = null;\n    protected final static Component component;\n    protected final static MediaTracker tracker;\n    static {\n        component = new Component() {};\n        AccessController.doPrivileged(new PrivilegedAction<Object>() {\n            public Object run() {\n                try {\n                    // 6482575 - clear the appContext field so as not to leak it\n                    Field appContextField =\n                                 Component.class.getDeclaredField(\"appContext\");\n                    appContextField.setAccessible(true);\n                    appContextField.set(component, null);\n                }\n                catch (NoSuchFieldException e) {\n                    e.printStackTrace();\n                }\n                catch (IllegalAccessException e) {\n                    e.printStackTrace();\n                }\n                return null;\n            }\n        });\n        tracker = new MediaTracker(component);\n    }\n    /**\n     * Id used in loading images from MediaTracker.\n     */\n    private static int mediaTrackerID;\n    private final static Object TRACKER_KEY = new StringBuilder(\"TRACKER_KEY\");\n    int width = -1;\n    int height = -1;\n    /**\n     * Creates an ImageIcon from the specified file. The image will\n     * be preloaded by using MediaTracker to monitor the loading state\n     * of the image.\n     * @param filename the name of the file containing the image\n     * @param description a brief textual description of the image\n     * @see #ImageIcon(String)\n     */\n    public ImageIcon(String filename, String description) {\n        image = Toolkit.getDefaultToolkit().getImage(filename);\n        if (image == null) {\n            return;\n        }\n        this.filename = filename;\n        this.description = description;\n        loadImage(image);\n    }\n    /**\n     * Creates an ImageIcon from the specified file. The image will\n     * be preloaded by using MediaTracker to monitor the loading state\n     * of the image. The specified String can be a file name or a\n     * file path. When specifying a path, use the Internet-standard\n     * forward-slash (\"/\") as a separator.\n     * (The string is converted to an URL, so the forward-slash works\n     * on all systems.)\n     * For example, specify:\n     * <pre>\n     *    new ImageIcon(\"images/myImage.gif\") </pre>\n     * The description is initialized to the <code>filename</code> string.\n     *\n     * @param filename a String specifying a filename or path\n     * @see #getDescription\n     */\n    @ConstructorProperties({\"description\"})\n    public ImageIcon (String filename) {\n        this(filename, filename);\n    }\n    /**\n     * Creates an ImageIcon from the specified URL. The image will\n     * be preloaded by using MediaTracker to monitor the loaded state\n     * of the image.\n     * @param location the URL for the image\n     * @param description a brief textual description of the image\n     * @see #ImageIcon(String)\n     */\n    public ImageIcon(URL location, String description) {\n        image = Toolkit.getDefaultToolkit().getImage(location);\n        if (image == null) {\n            return;\n        }\n        this.location = location;\n        this.description = description;\n        loadImage(image);\n    }\n    /**\n     * Creates an ImageIcon from the specified URL. The image will\n     * be preloaded by using MediaTracker to monitor the loaded state\n     * of the image.\n     * The icon's description is initialized to be\n     * a string representation of the URL.\n     * @param location the URL for the image\n     * @see #getDescription\n     */\n    public ImageIcon (URL location) {\n        this(location, location.toExternalForm());\n    }\n    /**\n     * Creates an ImageIcon from the image.\n     * @param image the image\n     * @param description a brief textual description of the image\n     */\n    public ImageIcon(Image image, String description) {\n        this(image);\n        this.description = description;\n    }\n    /**\n     * Creates an ImageIcon from an image object.\n     * If the image has a \"comment\" property that is a string,\n     * then the string is used as the description of this icon.\n     * @param image the image\n     * @see #getDescription\n     * @see java.awt.Image#getProperty\n     */\n    public ImageIcon (Image image) {\n        this.image = image;\n        Object o = image.getProperty(\"comment\", imageObserver);\n        if (o instanceof String) {\n            description = (String) o;\n        }\n        loadImage(image);\n    }\n    /**\n     * Creates an ImageIcon from an array of bytes which were\n     * read from an image file containing a supported image format,\n     * such as GIF, JPEG, or (as of 1.3) PNG.\n     * Normally this array is created\n     * by reading an image using Class.getResourceAsStream(), but\n     * the byte array may also be statically stored in a class.\n     *\n     * @param  imageData an array of pixels in an image format supported\n     *         by the AWT Toolkit, such as GIF, JPEG, or (as of 1.3) PNG\n     * @param  description a brief textual description of the image\n     * @see    java.awt.Toolkit#createImage\n     */\n    public ImageIcon (byte[] imageData, String description) {\n        this.image = Toolkit.getDefaultToolkit().createImage(imageData);\n        if (image == null) {\n            return;\n        }\n        this.description = description;\n        loadImage(image);\n    }\n    /**\n     * Creates an ImageIcon from an array of bytes which were\n     * read from an image file containing a supported image format,\n     * such as GIF, JPEG, or (as of 1.3) PNG.\n     * Normally this array is created\n     * by reading an image using Class.getResourceAsStream(), but\n     * the byte array may also be statically stored in a class.\n     * If the resulting image has a \"comment\" property that is a string,\n     * then the string is used as the description of this icon.\n     *\n     * @param  imageData an array of pixels in an image format supported by\n     *             the AWT Toolkit, such as GIF, JPEG, or (as of 1.3) PNG\n     * @see    java.awt.Toolkit#createImage\n     * @see #getDescription\n     * @see java.awt.Image#getProperty\n     */\n    public ImageIcon (byte[] imageData) {\n        this.image = Toolkit.getDefaultToolkit().createImage(imageData);\n        if (image == null) {\n            return;\n        }\n        Object o = image.getProperty(\"comment\", imageObserver);\n        if (o instanceof String) {\n            description = (String) o;\n        }\n        loadImage(image);\n    }\n    /**\n     * Creates an uninitialized image icon.\n     */\n    public ImageIcon() {\n    }\n    /**\n     * Loads the image, returning only when the image is loaded.\n     * @param image the image\n     */\n    protected void loadImage(Image image) {\n        MediaTracker mTracker = getTracker();\n        synchronized(mTracker) {\n            int id = getNextID();\n            mTracker.addImage(image, id);\n            try {\n                mTracker.waitForID(id, 0);\n            } catch (InterruptedException e) {\n                System.out.println(\"INTERRUPTED while loading Image\");\n            }\n            loadStatus = mTracker.statusID(id, false);\n            mTracker.removeImage(image, id);\n            width = image.getWidth(imageObserver);\n            height = image.getHeight(imageObserver);\n        }\n    }\n    /**\n     * Returns an ID to use with the MediaTracker in loading an image.\n     */\n    private int getNextID() {\n        synchronized(getTracker()) {\n            return ++mediaTrackerID;\n        }\n    }\n    /**\n     * Returns the MediaTracker for the current AppContext, creating a new\n     * MediaTracker if necessary.\n     */\n    private MediaTracker getTracker() {\n        Object trackerObj;\n        AppContext ac = AppContext.getAppContext();\n        // Opt: Only synchronize if trackerObj comes back null?\n        // If null, synchronize, re-check for null, and put new tracker\n        synchronized(ac) {\n            trackerObj = ac.get(TRACKER_KEY);\n            if (trackerObj == null) {\n                Component comp = new Component() {};\n                trackerObj = new MediaTracker(comp);\n                ac.put(TRACKER_KEY, trackerObj);\n            }\n        }\n        return (MediaTracker) trackerObj;\n    }\n    /**\n     * Returns the status of the image loading operation.\n     * @return the loading status as defined by java.awt.MediaTracker\n     * @see java.awt.MediaTracker#ABORTED\n     * @see java.awt.MediaTracker#ERRORED\n     * @see java.awt.MediaTracker#COMPLETE\n     */\n    public int getImageLoadStatus() {\n        return loadStatus;\n    }\n    /**\n     * Returns this icon's <code>Image</code>.\n     * @return the <code>Image</code> object for this <code>ImageIcon</code>\n     */\n    @Transient\n    public Image getImage() {\n        return image;\n    }\n    /**\n     * Sets the image displayed by this icon.\n     * @param image the image\n     */\n    public void setImage(Image image) {\n        this.image = image;\n        loadImage(image);\n    }\n    /**\n     * Gets the description of the image.  This is meant to be a brief\n     * textual description of the object.  For example, it might be\n     * presented to a blind user to give an indication of the purpose\n     * of the image.\n     * The description may be null.\n     *\n     * @return a brief textual description of the image\n     */\n    public String getDescription() {\n        return description;\n    }\n    /**\n     * Sets the description of the image.  This is meant to be a brief\n     * textual description of the object.  For example, it might be\n     * presented to a blind user to give an indication of the purpose\n     * of the image.\n     * @param description a brief textual description of the image\n     */\n    public void setDescription(String description) {\n        this.description = description;\n    }\n    /**\n     * Paints the icon.\n     * The top-left corner of the icon is drawn at\n     * the point (<code>x</code>, <code>y</code>)\n     * in the coordinate space of the graphics context <code>g</code>.\n     * If this icon has no image observer,\n     * this method uses the <code>c</code> component\n     * as the observer.\n     *\n     * @param c the component to be used as the observer\n     *          if this icon has no image observer\n     * @param g the graphics context\n     * @param x the X coordinate of the icon's top-left corner\n     * @param y the Y coordinate of the icon's top-left corner\n     */\n    public synchronized void paintIcon(Component c, Graphics g, int x, int y) {\n        if(imageObserver == null) {\n           g.drawImage(image, x, y, c);\n        } else {\n           g.drawImage(image, x, y, imageObserver);\n        }\n    }\n    /**\n     * Gets the width of the icon.\n     *\n     * @return the width in pixels of this icon\n     */\n    public int getIconWidth() {\n        return width;\n    }\n    /**\n     * Gets the height of the icon.\n     *\n     * @return the height in pixels of this icon\n     */\n    public int getIconHeight() {\n        return height;\n    }\n    /**\n     * Sets the image observer for the image.  Set this\n     * property if the ImageIcon contains an animated GIF, so\n     * the observer is notified to update its display.\n     * For example:\n     * <pre>\n     *     icon = new ImageIcon(...)\n     *     button.setIcon(icon);\n     *     icon.setImageObserver(button);\n     * </pre>\n     *\n     * @param observer the image observer\n     */\n    public void setImageObserver(ImageObserver observer) {\n        imageObserver = observer;\n    }\n    /**\n     * Returns the image observer for the image.\n     *\n     * @return the image observer, which may be null\n     */\n    @Transient\n    public ImageObserver getImageObserver() {\n        return imageObserver;\n    }\n    /**\n     * Returns a string representation of this image.\n     *\n     * @return a string representing this image\n     */\n    public String toString() {\n", "answers": ["        if (description != null) {"], "incorrect_answer": "if (description == null) {"}, {"input": "", "context": "# -*- coding: utf-8 -*-\nfrom ast import literal_eval\nfrom pprint import pformat\nimport os\nimport shutil\nfrom errbot import BotPlugin, botcmd\nfrom errbot.plugin_manager import PluginConfigurationException, PluginActivationException\nfrom errbot.repo_manager import RepoException\nclass Plugins(BotPlugin):\n    @botcmd(admin_only=True)\n    def repos_install(self, _, args):\n        \"\"\" install a plugin repository from the given source or a known public repo (see !repos to find those).\n        for example from a known repo : !install err-codebot\n        for example a git url : git@github.com:gbin/plugin.git\n        or an url towards a tar.gz archive : http://www.gootz.net/plugin-latest.tar.gz\n        \"\"\"\n        args = args.strip()\n        if not args:\n            yield \"Please specify a repository listed in '!repos' or \" \\\n                  \"give me the URL to a git repository that I should clone for you.\"\n            return\n        try:\n            yield \"Installing %s...\" % args\n            local_path = self._bot.repo_manager.install_repo(args)\n            errors = self._bot.plugin_manager.update_dynamic_plugins()\n            if errors:\n                yield 'Some plugins are generating errors:\\n' + '\\n'.join(errors.values())\n                # if the load of the plugin failed, uninstall cleanly teh repo\n                for path in errors.keys():\n                    if path.startswith(local_path):\n                        yield 'Removing %s as it did not load correctly.' % local_path\n                        shutil.rmtree(local_path)\n            else:\n                yield (\"A new plugin repository has been installed correctly from \"\n                       \"%s. Refreshing the plugins commands...\" % args)\n            loading_errors = self._bot.plugin_manager.activate_non_started_plugins()\n            if loading_errors:\n                yield loading_errors\n            yield \"Plugins reloaded.\"\n        except RepoException as re:\n            yield \"Error installing the repo: %s\" % re\n    @botcmd(admin_only=True)\n    def repos_uninstall(self, _, repo_name):\n        \"\"\" uninstall a plugin repository by name.\n        \"\"\"\n        if not repo_name.strip():\n            yield \"You should have a repo name as argument\"\n            return\n        repos = self._bot.repo_manager.get_installed_plugin_repos()\n        if repo_name not in repos:\n            yield \"This repo is not installed check with \" + self._bot.prefix + \"repos the list of installed ones\"\n            return\n        plugin_path = os.path.join(self._bot.repo_manager.plugin_dir, repo_name)\n        self._bot.plugin_manager.remove_plugins_from_path(plugin_path)\n        self._bot.repo_manager.uninstall_repo(repo_name)\n        yield 'Repo %s removed.' % repo_name\n    @botcmd(template='repos')\n    def repos(self, _, args):\n        \"\"\" list the current active plugin repositories\n        \"\"\"\n        installed_repos = self._bot.repo_manager.get_installed_plugin_repos()\n        all_names = [name for name in installed_repos]\n        repos = {'repos': []}\n        for repo_name in all_names:\n            installed = False\n            if repo_name in installed_repos:\n                installed = True\n            from_index = self._bot.repo_manager.get_repo_from_index(repo_name)\n            if from_index is not None:\n                description = '\\n'.join(('%s: %s' % (plug.name, plug.documentation) for plug in from_index))\n            else:\n                description = 'No description.'\n            # installed, public, name, desc\n            repos['repos'].append((installed, from_index is not None, repo_name, description))\n        return repos\n    @botcmd(template='repos2')\n    def repos_search(self, _, args):\n        \"\"\" Searches the repo index.\n        for example: !repos search jenkins\n        \"\"\"\n        if not args:\n            # TODO(gbin): return all the repos.\n            return {'error': \"Please specify a keyword.\"}\n        return {'repos': self._bot.repo_manager.search_repos(args)}\n    @botcmd(split_args_with=' ', admin_only=True)\n    def repos_update(self, _, args):\n        \"\"\" update the bot and/or plugins\n        use : !repos update all\n        to update everything\n        or : !repos update repo_name repo_name ...\n        to update selectively some repos\n        \"\"\"\n        if 'all' in args:\n            results = self._bot.repo_manager.update_all_repos()\n        else:\n            results = self._bot.repo_manager.update_repos(args)\n        yield \"Start updating ... \"\n        for d, success, feedback in results:\n            if success:\n                yield \"Update of %s succeeded...\\n\\n%s\\n\\n\" % (d, feedback)\n            else:\n                yield \"Update of %s failed...\\n\\n%s\" % (d, feedback)\n            for plugin in self._bot.plugin_manager.getAllPlugins():\n                if plugin.path.startswith(d) and hasattr(plugin, 'is_activated') and plugin.is_activated:\n                    name = plugin.name\n                    yield '/me is reloading plugin %s' % name\n                    try:\n                        self._bot.plugin_manager.reload_plugin_by_name(plugin.name)\n                        yield \"Plugin %s reloaded.\" % plugin.name\n                    except PluginActivationException as pae:\n                        yield 'Error reactivating plugin %s: %s' % (plugin.name, pae)\n        yield \"Done.\"\n    @botcmd(split_args_with=' ', admin_only=True)\n    def plugin_config(self, _, args):\n        \"\"\" configure or get the configuration / configuration template for a specific plugin\n        ie.\n        !plugin config ExampleBot\n        could return a template if it is not configured:\n        {'LOGIN': 'example@example.com', 'PASSWORD': 'password', 'DIRECTORY': '/toto'}\n        Copy paste, adapt so can configure the plugin :\n        !plugin config ExampleBot {'LOGIN': 'my@email.com', 'PASSWORD': 'myrealpassword', 'DIRECTORY': '/tmp'}\n        It will then reload the plugin with this config.\n        You can at any moment retrieve the current values:\n        !plugin config ExampleBot\n        should return :\n        {'LOGIN': 'my@email.com', 'PASSWORD': 'myrealpassword', 'DIRECTORY': '/tmp'}\n        \"\"\"\n        plugin_name = args[0]\n        if self._bot.plugin_manager.is_plugin_blacklisted(plugin_name):\n            return 'Load this plugin first with ' + self._bot.prefix + 'load %s' % plugin_name\n        obj = self._bot.plugin_manager.get_plugin_obj_by_name(plugin_name)\n        if obj is None:\n            return 'Unknown plugin or the plugin could not load %s' % plugin_name\n        template_obj = obj.get_configuration_template()\n        if template_obj is None:\n            return 'This plugin is not configurable.'\n        if len(args) == 1:\n            response = (\"Default configuration for this plugin (you can copy and paste \"\n                        \"this directly as a command):\\n\\n\"\n                        \"```\\n{prefix}plugin config {plugin_name} \\n{config}\\n```\").format(\n                prefix=self._bot.prefix, plugin_name=plugin_name, config=pformat(template_obj))\n            current_config = self._bot.plugin_manager.get_plugin_configuration(plugin_name)\n            if current_config:\n                response += (\"\\n\\nCurrent configuration:\\n\\n\"\n                             \"```\\n{prefix}plugin config {plugin_name} \\n{config}\\n```\").format(\n                    prefix=self._bot.prefix, plugin_name=plugin_name, config=pformat(current_config))\n            return response\n        # noinspection PyBroadException\n        try:\n            real_config_obj = literal_eval(' '.join(args[1:]))\n        except Exception:\n            self.log.exception('Invalid expression for the configuration of the plugin')\n            return 'Syntax error in the given configuration'\n        if type(real_config_obj) != type(template_obj):\n            return 'It looks fishy, your config type is not the same as the template !'\n        self._bot.plugin_manager.set_plugin_configuration(plugin_name, real_config_obj)\n        try:\n            self._bot.plugin_manager.deactivate_plugin(plugin_name)\n        except PluginActivationException as pae:\n            return 'Error deactivating %s: %s' % (plugin_name, pae)\n        try:\n            self._bot.plugin_manager.activate_plugin(plugin_name)\n        except PluginConfigurationException as ce:\n            self.log.debug('Invalid configuration for the plugin, reverting the plugin to unconfigured.')\n            self._bot.plugin_manager.set_plugin_configuration(plugin_name, None)\n            return 'Incorrect plugin configuration: %s' % ce\n        except PluginActivationException as pae:\n            return 'Error activating plugin: %s' % pae\n        return 'Plugin configuration done.'\n    def formatted_plugin_list(self, active_only=True):\n        \"\"\"\n        Return a formatted, plain-text list of loaded plugins.\n        When active_only=True, this will only return plugins which\n        are actually active. Otherwise, it will also include inactive\n        (blacklisted) plugins.\n        \"\"\"\n        if active_only:\n            all_plugins = self._bot.plugin_manager.get_all_active_plugin_names()\n        else:\n", "answers": ["            all_plugins = self._bot.plugin_manager.get_all_plugin_names()"], "incorrect_answer": "active_plugins = self._bot.plugin_manager.get_active_plugin_names()"}, {"input": "", "context": "#!/usr/bin/python\nfrom __future__ import (absolute_import, division, print_function)\n# Copyright 2019 Fortinet, Inc.\n#\n# This program is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program.  If not, see <https://www.gnu.org/licenses/>.\n__metaclass__ = type\nANSIBLE_METADATA = {'status': ['preview'],\n                    'supported_by': 'community',\n                    'metadata_version': '1.1'}\nDOCUMENTATION = '''\n---\nmodule: fortios_system_switch_interface\nshort_description: Configure software switch interfaces by grouping physical and WiFi interfaces in Fortinet's FortiOS and FortiGate.\ndescription:\n    - This module is able to configure a FortiGate or FortiOS (FOS) device by allowing the\n      user to set and modify system feature and switch_interface category.\n      Examples include all parameters and values need to be adjusted to datasources before usage.\n      Tested with FOS v6.0.5\nversion_added: \"2.9\"\nauthor:\n    - Miguel Angel Munoz (@mamunozgonzalez)\n    - Nicolas Thomas (@thomnico)\nnotes:\n    - Requires fortiosapi library developed by Fortinet\n    - Run as a local_action in your playbook\nrequirements:\n    - fortiosapi>=0.9.8\noptions:\n    host:\n        description:\n            - FortiOS or FortiGate IP address.\n        type: str\n        required: false\n    username:\n        description:\n            - FortiOS or FortiGate username.\n        type: str\n        required: false\n    password:\n        description:\n            - FortiOS or FortiGate password.\n        type: str\n        default: \"\"\n    vdom:\n        description:\n            - Virtual domain, among those defined previously. A vdom is a\n              virtual instance of the FortiGate that can be configured and\n              used as a different unit.\n        type: str\n        default: root\n    https:\n        description:\n            - Indicates if the requests towards FortiGate must use HTTPS protocol.\n        type: bool\n        default: true\n    ssl_verify:\n        description:\n            - Ensures FortiGate certificate must be verified by a proper CA.\n        type: bool\n        default: true\n    state:\n        description:\n            - Indicates whether to create or remove the object.\n        type: str\n        required: true\n        choices:\n            - present\n            - absent\n    system_switch_interface:\n        description:\n            - Configure software switch interfaces by grouping physical and WiFi interfaces.\n        default: null\n        type: dict\n        suboptions:\n            intra_switch_policy:\n                description:\n                    - Allow any traffic between switch interfaces or require firewall policies to allow traffic between switch interfaces.\n                type: str\n                choices:\n                    - implicit\n                    - explicit\n            member:\n                description:\n                    - Names of the interfaces that belong to the virtual switch.\n                type: list\n                suboptions:\n                    interface_name:\n                        description:\n                            - Physical interface name. Source system.interface.name.\n                        type: str\n            name:\n                description:\n                    - Interface name (name cannot be in use by any other interfaces, VLANs, or inter-VDOM links).\n                required: true\n                type: str\n            span:\n                description:\n                    - Enable/disable port spanning. Port spanning echoes traffic received by the software switch to the span destination port.\n                type: str\n                choices:\n                    - disable\n                    - enable\n            span_dest_port:\n                description:\n                    - SPAN destination port name. All traffic on the SPAN source ports is echoed to the SPAN destination port. Source system.interface.name.\n                type: str\n            span_direction:\n                description:\n                    - \"The direction in which the SPAN port operates, either: rx, tx, or both.\"\n                type: str\n                choices:\n                    - rx\n                    - tx\n                    - both\n            span_source_port:\n                description:\n                    - Physical interface name. Port spanning echoes all traffic on the SPAN source ports to the SPAN destination port.\n                type: list\n                suboptions:\n                    interface_name:\n                        description:\n                            - Physical interface name. Source system.interface.name.\n                        type: str\n            type:\n                description:\n                    - \"Type of switch based on functionality: switch for normal functionality, or hub to duplicate packets to all port members.\"\n                type: str\n                choices:\n                    - switch\n                    - hub\n            vdom:\n                description:\n                    - VDOM that the software switch belongs to. Source system.vdom.name.\n                type: str\n'''\nEXAMPLES = '''\n- hosts: localhost\n  vars:\n   host: \"192.168.122.40\"\n   username: \"admin\"\n   password: \"\"\n   vdom: \"root\"\n   ssl_verify: \"False\"\n  tasks:\n  - name: Configure software switch interfaces by grouping physical and WiFi interfaces.\n    fortios_system_switch_interface:\n      host:  \"{{ host }}\"\n      username: \"{{ username }}\"\n      password: \"{{ password }}\"\n      vdom:  \"{{ vdom }}\"\n      https: \"False\"\n      state: \"present\"\n      system_switch_interface:\n        intra_switch_policy: \"implicit\"\n        member:\n         -\n            interface_name: \"<your_own_value> (source system.interface.name)\"\n        name: \"default_name_6\"\n        span: \"disable\"\n        span_dest_port: \"<your_own_value> (source system.interface.name)\"\n        span_direction: \"rx\"\n        span_source_port:\n         -\n            interface_name: \"<your_own_value> (source system.interface.name)\"\n        type: \"switch\"\n        vdom: \"<your_own_value> (source system.vdom.name)\"\n'''\nRETURN = '''\nbuild:\n  description: Build number of the fortigate image\n  returned: always\n  type: str\n  sample: '1547'\nhttp_method:\n  description: Last method used to provision the content into FortiGate\n  returned: always\n  type: str\n  sample: 'PUT'\nhttp_status:\n  description: Last result given by FortiGate on last operation applied\n  returned: always\n  type: str\n  sample: \"200\"\nmkey:\n  description: Master key (id) used in the last call to FortiGate\n  returned: success\n  type: str\n  sample: \"id\"\nname:\n  description: Name of the table used to fulfill the request\n  returned: always\n  type: str\n  sample: \"urlfilter\"\npath:\n  description: Path of the table used to fulfill the request\n  returned: always\n  type: str\n  sample: \"webfilter\"\nrevision:\n  description: Internal revision number\n  returned: always\n  type: str\n  sample: \"17.0.2.10658\"\nserial:\n  description: Serial number of the unit\n  returned: always\n  type: str\n  sample: \"FGVMEVYYQT3AB5352\"\nstatus:\n  description: Indication of the operation's result\n  returned: always\n  type: str\n  sample: \"success\"\nvdom:\n  description: Virtual domain used\n  returned: always\n  type: str\n  sample: \"root\"\nversion:\n  description: Version of the FortiGate\n  returned: always\n  type: str\n  sample: \"v5.6.3\"\n'''\nfrom ansible.module_utils.basic import AnsibleModule\nfrom ansible.module_utils.connection import Connection\nfrom ansible.module_utils.network.fortios.fortios import FortiOSHandler\nfrom ansible.module_utils.network.fortimanager.common import FAIL_SOCKET_MSG\ndef login(data, fos):\n    host = data['host']\n    username = data['username']\n    password = data['password']\n    ssl_verify = data['ssl_verify']\n    fos.debug('on')\n    if 'https' in data and not data['https']:\n        fos.https('off')\n    else:\n        fos.https('on')\n    fos.login(host, username, password, verify=ssl_verify)\ndef filter_system_switch_interface_data(json):\n    option_list = ['intra_switch_policy', 'member', 'name',\n                   'span', 'span_dest_port', 'span_direction',\n                   'span_source_port', 'type', 'vdom']\n    dictionary = {}\n    for attribute in option_list:\n        if attribute in json and json[attribute] is not None:\n            dictionary[attribute] = json[attribute]\n    return dictionary\ndef underscore_to_hyphen(data):\n    if isinstance(data, list):\n        for i, elem in enumerate(data):\n            data[i] = underscore_to_hyphen(elem)\n    elif isinstance(data, dict):\n        new_data = {}\n        for k, v in data.items():\n            new_data[k.replace('_', '-')] = underscore_to_hyphen(v)\n        data = new_data\n    return data\ndef system_switch_interface(data, fos):\n    vdom = data['vdom']\n    state = data['state']\n    system_switch_interface_data = data['system_switch_interface']\n    filtered_data = underscore_to_hyphen(filter_system_switch_interface_data(system_switch_interface_data))\n    if state == \"present\":\n        return fos.set('system',\n                       'switch-interface',\n                       data=filtered_data,\n                       vdom=vdom)\n    elif state == \"absent\":\n        return fos.delete('system',\n                          'switch-interface',\n                          mkey=filtered_data['name'],\n                          vdom=vdom)\ndef is_successful_status(status):\n    return status['status'] == \"success\" or \\\n        status['http_method'] == \"DELETE\" and status['http_status'] == 404\ndef fortios_system(data, fos):\n    if data['system_switch_interface']:\n        resp = system_switch_interface(data, fos)\n    return not is_successful_status(resp), \\\n        resp['status'] == \"success\", \\\n        resp\ndef main():\n    fields = {\n        \"host\": {\"required\": False, \"type\": \"str\"},\n        \"username\": {\"required\": False, \"type\": \"str\"},\n        \"password\": {\"required\": False, \"type\": \"str\", \"default\": \"\", \"no_log\": True},\n        \"vdom\": {\"required\": False, \"type\": \"str\", \"default\": \"root\"},\n        \"https\": {\"required\": False, \"type\": \"bool\", \"default\": True},\n        \"ssl_verify\": {\"required\": False, \"type\": \"bool\", \"default\": True},\n        \"state\": {\"required\": True, \"type\": \"str\",\n                  \"choices\": [\"present\", \"absent\"]},\n        \"system_switch_interface\": {\n            \"required\": False, \"type\": \"dict\", \"default\": None,\n            \"options\": {\n                \"intra_switch_policy\": {\"required\": False, \"type\": \"str\",\n                                        \"choices\": [\"implicit\", \"explicit\"]},\n                \"member\": {\"required\": False, \"type\": \"list\",\n                           \"options\": {\n                               \"interface_name\": {\"required\": False, \"type\": \"str\"}\n                           }},\n                \"name\": {\"required\": True, \"type\": \"str\"},\n                \"span\": {\"required\": False, \"type\": \"str\",\n                         \"choices\": [\"disable\", \"enable\"]},\n                \"span_dest_port\": {\"required\": False, \"type\": \"str\"},\n                \"span_direction\": {\"required\": False, \"type\": \"str\",\n                                   \"choices\": [\"rx\", \"tx\", \"both\"]},\n                \"span_source_port\": {\"required\": False, \"type\": \"list\",\n                                     \"options\": {\n                                         \"interface_name\": {\"required\": False, \"type\": \"str\"}\n                                     }},\n                \"type\": {\"required\": False, \"type\": \"str\",\n                         \"choices\": [\"switch\", \"hub\"]},\n", "answers": ["                \"vdom\": {\"required\": False, \"type\": \"str\"}"], "incorrect_answer": "\"vdom\": {\"required\": True, \"type\": \"bool\"}"}, {"input": "", "context": "/*\n *   \n *\n * Copyright  1990-2007 Sun Microsystems, Inc. All Rights Reserved.\n * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER\n * \n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License version\n * 2 only, as published by the Free Software Foundation.\n * \n * This program is distributed in the hope that it will be useful, but\n * WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * General Public License version 2 for more details (a copy is\n * included at /legal/license.txt).\n * \n * You should have received a copy of the GNU General Public License\n * version 2 along with this work; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA\n * \n * Please contact Sun Microsystems, Inc., 4150 Network Circle, Santa\n * Clara, CA 95054 or visit www.sun.com if you need additional\n * information or have any questions.\n */\npackage com.sun.cldc.io;\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.util.Vector;\n/**\n * Input stream class for accessing resource files in classpath.\n */\npublic class ResourceInputStream extends InputStream {\n    private Object fileDecoder;\n    private Object savedDecoder; // used for mark/reset functionality\n    /**\n     * Fixes the resource name to be conformant with the CLDC 1.0\n     * specification. We are not allowed to use \"../\" to get outside\n     * of the .jar file.\n     *\n     * @param name the name of the resource in classpath to access.\n     * @return     the fixed string.\n     * @exception  IOException if the resource name points to a\n     *              classfile, as determined by the resource name's\n     *              extension.\n     */\n    private static String fixResourceName(String name) throws IOException {\n        Vector dirVector = new Vector();\n        int    startIdx = 0;\n        int    endIdx = 0;\n        String curDir;\n        while ((endIdx = name.indexOf('/', startIdx)) != -1) {\n            if (endIdx == startIdx) {\n                // We have a leading '/' or two consecutive '/'s\n                startIdx++;\n                continue;\n            }\n            curDir = name.substring(startIdx, endIdx);\n            startIdx = endIdx + 1;\n            if (curDir.equals(\".\")) {\n                // Ignore a single '.' directory\n                continue;\n            }\n            if (curDir.equals(\"..\")) {\n                // Go up a level\n                try {\n                    dirVector.removeElementAt(dirVector.size()-1);\n                } catch (ArrayIndexOutOfBoundsException aioobe) {\n                     // \"/../resource\" Not allowed!\n                     throw new IOException();\n                }\n                continue;\n            }\n            dirVector.addElement(curDir);\n        }\n        // save directory structure\n        StringBuffer dirName = new StringBuffer();\n        int nelements = dirVector.size();\n        for (int i = 0; i < nelements; ++i) {\n          dirName.append((String)dirVector.elementAt(i));\n          dirName.append(\"/\");\n        }\n        // save filename\n        if (startIdx < name.length()) {\n            String filename = name.substring(startIdx);\n            // Throw IOE if the resource ends with \".class\", but, not\n            //  if the entire name is \".class\"\n            if ((filename.endsWith(\".class\")) &&\n                (! \".class\".equals(filename))) {\n                throw new IOException();\n            }\n            dirName.append(name.substring(startIdx));\n        }\n        return dirName.toString();\n    }\n    /**\n     * Construct a resource input stream for accessing objects in the jar file.\n     *\n     * @param name the name of the resource in classpath to access. The\n     *              name must not have a leading '/'.\n     * @exception  IOException  if an I/O error occurs.\n     */\n    public ResourceInputStream(String name) throws IOException {\n        String fixedName = fixResourceName(name);\n        fileDecoder = open(fixedName);\n        if (fileDecoder == null) {\n            throw new IOException();\n        }\n     }\n    /**\n     * Reads the next byte of data from the input stream.\n     *\n     * @return     the next byte of data, or <code>-1</code> if the end\n     *             of the stream is reached.\n     * @exception  IOException  if an I/O error occurs.\n     */\n    public int read() throws IOException {\n        // Fix for CR 6303054\n        if (fileDecoder == null) {\n            throw new IOException();\n        }\n        return readByte(fileDecoder);\n    }\n    /**\n     * Gets the number of bytes remaining to be read.\n     *\n     * @return     the number of bytes remaining in the resource.\n     * @exception  IOException  if an I/O error occurs.\n     */\n    public int available() throws IOException {\n        if (fileDecoder == null) {\n            throw new IOException();\n        }\n        return bytesRemain(fileDecoder);\n    }\n    /**\n     * Reads bytes into a byte array.\n     *\n     * @param b the buffer to read into.\n     * @param off offset to start at in the buffer.\n     * @param len number of bytes to read.\n     * @return     the number of bytes read, or <code>-1</code> if the end\n     *             of the stream is reached.\n     * @exception  IOException  if an I/O error occurs.\n     */\n    public int read(byte b[], int off, int len) throws IOException {\n        // Fix for CR 6303054\n        if (fileDecoder == null) {\n            throw new IOException();\n        }\n        if (b == null) {\n            throw new NullPointerException();\n        } else if ((off < 0) || (off > b.length) || (len < 0) ||\n                   ((off + len) > b.length) || ((off + len) < 0)) {\n            throw new IndexOutOfBoundsException();\n        }\n        return readBytes(fileDecoder, b, off, len);\n    }\n    public void close() throws IOException {\n        fileDecoder = null;\n    }\n    /**\n     * Remembers current position in ResourceInputStream so that\n     * subsequent call to <code>reset</code> will rewind the stream\n     * to the saved position.\n     *\n     * @param readlimit affects nothing\n     * @see   java.io.InputStream#reset()\n     */\n    public void mark(int readlimit) {\n        if (fileDecoder != null) {\n            savedDecoder = clone(fileDecoder);\n        }\n    }\n    /**\n     * Repositions this stream to the position at the time the\n     * <code>mark</code> method was last called on this input stream.\n     *\n     * @exception IOException if this stream has not been marked\n     * @see   java.io.InputStream#mark(int)\n     */\n    public void reset() throws IOException {\n        if (fileDecoder == null || savedDecoder == null) {\n", "answers": ["            throw new IOException();"], "incorrect_answer": "throw new FileNotFoundException();"}, {"input": "", "context": "/**\n */\npackage activitydiagramTrace.States.activitydiagram.impl;\nimport activitydiagramTrace.States.Activity_trace_Value;\nimport activitydiagramTrace.States.StatesPackage;\nimport activitydiagramTrace.States.activitydiagram.ActivitydiagramPackage;\nimport activitydiagramTrace.States.activitydiagram.TracedActivity;\nimport java.util.Collection;\nimport org.eclipse.emf.common.notify.Notification;\nimport org.eclipse.emf.common.notify.NotificationChain;\nimport org.eclipse.emf.common.util.EList;\nimport org.eclipse.emf.ecore.EClass;\nimport org.eclipse.emf.ecore.InternalEObject;\nimport org.eclipse.emf.ecore.impl.ENotificationImpl;\nimport org.eclipse.emf.ecore.util.EObjectContainmentWithInverseEList;\nimport org.eclipse.emf.ecore.util.InternalEList;\nimport org.gemoc.activitydiagram.sequential.xactivitydiagram.activitydiagram.Activity;\n/**\n * <!-- begin-user-doc -->\n * An implementation of the model object '<em><b>Traced Activity</b></em>'.\n * <!-- end-user-doc -->\n * <p>\n * The following features are implemented:\n * </p>\n * <ul>\n *   <li>{@link activitydiagramTrace.States.activitydiagram.impl.TracedActivityImpl#getOriginalObject <em>Original Object</em>}</li>\n *   <li>{@link activitydiagramTrace.States.activitydiagram.impl.TracedActivityImpl#getTraceSequence <em>Trace Sequence</em>}</li>\n * </ul>\n *\n * @generated\n */\npublic class TracedActivityImpl extends TracedNamedElementImpl implements TracedActivity {\n\t/**\n\t * The cached value of the '{@link #getOriginalObject() <em>Original Object</em>}' reference.\n\t * <!-- begin-user-doc -->\n\t * <!-- end-user-doc -->\n\t * @see #getOriginalObject()\n\t * @generated\n\t * @ordered\n\t */\n\tprotected Activity originalObject;\n\t/**\n\t * The cached value of the '{@link #getTraceSequence() <em>Trace Sequence</em>}' containment reference list.\n\t * <!-- begin-user-doc -->\n\t * <!-- end-user-doc -->\n\t * @see #getTraceSequence()\n\t * @generated\n\t * @ordered\n\t */\n\tprotected EList<Activity_trace_Value> traceSequence;\n\t/**\n\t * <!-- begin-user-doc -->\n\t * <!-- end-user-doc -->\n\t * @generated\n\t */\n\tprotected TracedActivityImpl() {\n\t\tsuper();\n\t}\n\t/**\n\t * <!-- begin-user-doc -->\n\t * <!-- end-user-doc -->\n\t * @generated\n\t */\n\t@Override\n\tprotected EClass eStaticClass() {\n\t\treturn ActivitydiagramPackage.Literals.TRACED_ACTIVITY;\n\t}\n\t/**\n\t * <!-- begin-user-doc -->\n\t * <!-- end-user-doc -->\n\t * @generated\n\t */\n\tpublic Activity getOriginalObject() {\n\t\tif (originalObject != null && originalObject.eIsProxy()) {\n\t\t\tInternalEObject oldOriginalObject = (InternalEObject)originalObject;\n\t\t\toriginalObject = (Activity)eResolveProxy(oldOriginalObject);\n\t\t\tif (originalObject != oldOriginalObject) {\n\t\t\t\tif (eNotificationRequired())\n\t\t\t\t\teNotify(new ENotificationImpl(this, Notification.RESOLVE, ActivitydiagramPackage.TRACED_ACTIVITY__ORIGINAL_OBJECT, oldOriginalObject, originalObject));\n\t\t\t}\n\t\t}\n\t\treturn originalObject;\n\t}\n\t/**\n\t * <!-- begin-user-doc -->\n\t * <!-- end-user-doc -->\n\t * @generated\n\t */\n\tpublic Activity basicGetOriginalObject() {\n\t\treturn originalObject;\n\t}\n\t/**\n\t * <!-- begin-user-doc -->\n\t * <!-- end-user-doc -->\n\t * @generated\n\t */\n\tpublic void setOriginalObject(Activity newOriginalObject) {\n\t\tActivity oldOriginalObject = originalObject;\n\t\toriginalObject = newOriginalObject;\n\t\tif (eNotificationRequired())\n\t\t\teNotify(new ENotificationImpl(this, Notification.SET, ActivitydiagramPackage.TRACED_ACTIVITY__ORIGINAL_OBJECT, oldOriginalObject, originalObject));\n\t}\n\t/**\n\t * <!-- begin-user-doc -->\n\t * <!-- end-user-doc -->\n\t * @generated\n\t */\n\tpublic EList<Activity_trace_Value> getTraceSequence() {\n\t\tif (traceSequence == null) {\n\t\t\ttraceSequence = new EObjectContainmentWithInverseEList<Activity_trace_Value>(Activity_trace_Value.class, this, ActivitydiagramPackage.TRACED_ACTIVITY__TRACE_SEQUENCE, StatesPackage.ACTIVITY_TRACE_VALUE__PARENT);\n\t\t}\n\t\treturn traceSequence;\n\t}\n\t/**\n\t * <!-- begin-user-doc -->\n\t * <!-- end-user-doc -->\n\t * @generated\n\t */\n\t@SuppressWarnings(\"unchecked\")\n\t@Override\n\tpublic NotificationChain eInverseAdd(InternalEObject otherEnd, int featureID, NotificationChain msgs) {\n\t\tswitch (featureID) {\n\t\t\tcase ActivitydiagramPackage.TRACED_ACTIVITY__TRACE_SEQUENCE:\n\t\t\t\treturn ((InternalEList<InternalEObject>)(InternalEList<?>)getTraceSequence()).basicAdd(otherEnd, msgs);\n\t\t}\n\t\treturn super.eInverseAdd(otherEnd, featureID, msgs);\n\t}\n\t/**\n\t * <!-- begin-user-doc -->\n\t * <!-- end-user-doc -->\n\t * @generated\n\t */\n\t@Override\n\tpublic NotificationChain eInverseRemove(InternalEObject otherEnd, int featureID, NotificationChain msgs) {\n\t\tswitch (featureID) {\n\t\t\tcase ActivitydiagramPackage.TRACED_ACTIVITY__TRACE_SEQUENCE:\n\t\t\t\treturn ((InternalEList<?>)getTraceSequence()).basicRemove(otherEnd, msgs);\n\t\t}\n\t\treturn super.eInverseRemove(otherEnd, featureID, msgs);\n\t}\n\t/**\n\t * <!-- begin-user-doc -->\n\t * <!-- end-user-doc -->\n\t * @generated\n\t */\n\t@Override\n\tpublic Object eGet(int featureID, boolean resolve, boolean coreType) {\n\t\tswitch (featureID) {\n\t\t\tcase ActivitydiagramPackage.TRACED_ACTIVITY__ORIGINAL_OBJECT:\n\t\t\t\tif (resolve) return getOriginalObject();\n\t\t\t\treturn basicGetOriginalObject();\n\t\t\tcase ActivitydiagramPackage.TRACED_ACTIVITY__TRACE_SEQUENCE:\n\t\t\t\treturn getTraceSequence();\n\t\t}\n\t\treturn super.eGet(featureID, resolve, coreType);\n\t}\n\t/**\n\t * <!-- begin-user-doc -->\n\t * <!-- end-user-doc -->\n\t * @generated\n\t */\n\t@SuppressWarnings(\"unchecked\")\n\t@Override\n\tpublic void eSet(int featureID, Object newValue) {\n\t\tswitch (featureID) {\n\t\t\tcase ActivitydiagramPackage.TRACED_ACTIVITY__ORIGINAL_OBJECT:\n\t\t\t\tsetOriginalObject((Activity)newValue);\n\t\t\t\treturn;\n\t\t\tcase ActivitydiagramPackage.TRACED_ACTIVITY__TRACE_SEQUENCE:\n\t\t\t\tgetTraceSequence().clear();\n\t\t\t\tgetTraceSequence().addAll((Collection<? extends Activity_trace_Value>)newValue);\n\t\t\t\treturn;\n\t\t}\n\t\tsuper.eSet(featureID, newValue);\n\t}\n\t/**\n\t * <!-- begin-user-doc -->\n\t * <!-- end-user-doc -->\n\t * @generated\n\t */\n\t@Override\n\tpublic void eUnset(int featureID) {\n\t\tswitch (featureID) {\n\t\t\tcase ActivitydiagramPackage.TRACED_ACTIVITY__ORIGINAL_OBJECT:\n\t\t\t\tsetOriginalObject((Activity)null);\n\t\t\t\treturn;\n\t\t\tcase ActivitydiagramPackage.TRACED_ACTIVITY__TRACE_SEQUENCE:\n\t\t\t\tgetTraceSequence().clear();\n\t\t\t\treturn;\n\t\t}\n\t\tsuper.eUnset(featureID);\n\t}\n\t/**\n\t * <!-- begin-user-doc -->\n\t * <!-- end-user-doc -->\n\t * @generated\n\t */\n\t@Override\n\tpublic boolean eIsSet(int featureID) {\n\t\tswitch (featureID) {\n\t\t\tcase ActivitydiagramPackage.TRACED_ACTIVITY__ORIGINAL_OBJECT:\n", "answers": ["\t\t\t\treturn originalObject != null;"], "incorrect_answer": "return originalObject == null;"}, {"input": "", "context": "/*******************************************************************************\n * This file is part of OpenNMS(R).\n *\n * Copyright (C) 2006-2012 The OpenNMS Group, Inc.\n * OpenNMS(R) is Copyright (C) 1999-2012 The OpenNMS Group, Inc.\n *\n * OpenNMS(R) is a registered trademark of The OpenNMS Group, Inc.\n *\n * OpenNMS(R) is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published\n * by the Free Software Foundation, either version 3 of the License,\n * or (at your option) any later version.\n *\n * OpenNMS(R) is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with OpenNMS(R).  If not, see:\n *      http://www.gnu.org/licenses/\n *\n * For more information contact:\n *     OpenNMS(R) Licensing <license@opennms.org>\n *     http://www.opennms.org/\n *     http://www.opennms.com/\n *******************************************************************************/\npackage org.opennms.netmgt.importer.operations;\nimport java.util.Collection;\nimport java.util.Collections;\nimport java.util.HashMap;\nimport java.util.Iterator;\nimport java.util.LinkedList;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Set;\nimport org.opennms.core.utils.InetAddressUtils;\nimport org.opennms.netmgt.model.OnmsIpInterface;\nimport org.opennms.netmgt.model.OnmsMonitoredService;\nimport org.opennms.netmgt.model.OnmsNode;\nimport org.opennms.netmgt.model.OnmsServiceType;\nimport org.opennms.netmgt.model.OnmsSnmpInterface;\nimport org.opennms.netmgt.xml.event.Event;\n/**\n * <p>UpdateOperation class.</p>\n *\n * @author ranger\n * @version $Id: $\n */\npublic class UpdateOperation extends AbstractSaveOrUpdateOperation {\n    \n    public class ServiceUpdater {\n        \n        private OnmsIpInterface m_iface;\n        Map<OnmsServiceType, OnmsMonitoredService> m_svcTypToSvcMap;\n        public ServiceUpdater(OnmsIpInterface iface, OnmsIpInterface imported) {\n            m_iface = iface;\n            \n            createSvcTypeToSvcMap(imported);\n        }\n        private void createSvcTypeToSvcMap(OnmsIpInterface imported) {\n            m_svcTypToSvcMap = new HashMap<OnmsServiceType, OnmsMonitoredService>();\n            for (OnmsMonitoredService svc : imported.getMonitoredServices()) {\n                m_svcTypToSvcMap.put(svc.getServiceType(), svc);\n            }\n        }\n        public void execute(List<Event> events) {\n            for (Iterator<OnmsMonitoredService> it = getExisting().iterator(); it.hasNext();) {\n                OnmsMonitoredService svc = it.next();\n                OnmsMonitoredService imported = getImportedVersion(svc);\n                if (imported == null) {\n                    it.remove();\n                    svc.visit(new DeleteEventVisitor(events));\n                }\n                else {\n                    update(svc, events);\n                }\n                markAsProcessed(svc);\n            }\n            addNewServices(events);\n        }\n        private void addNewServices(List<Event> events) {\n            Collection<OnmsMonitoredService> newServices = getNewServices();\n            log().debug(getNode().getLabel()+\" has \"+newServices.size()+\" new services.\");\n            for (OnmsMonitoredService svc : newServices) {\n                svc.setIpInterface(m_iface);\n                m_iface.getMonitoredServices().add(svc);\n                svc.visit(new AddEventVisitor(events));\n            }\n        }\n        private Collection<OnmsMonitoredService> getNewServices() {\n            return Collections.unmodifiableCollection(m_svcTypToSvcMap.values());\n        }\n        private void markAsProcessed(OnmsMonitoredService svc) {\n            m_svcTypToSvcMap.remove(svc.getServiceType());\n        }\n        private void update(OnmsMonitoredService svc, List<Event> events) {\n            // nothing to do here\n        }\n        private OnmsMonitoredService getImportedVersion(OnmsMonitoredService svc) {\n            return (OnmsMonitoredService)m_svcTypToSvcMap.get(svc.getServiceType());\n        }\n        Set<OnmsMonitoredService> getExisting() {\n            return m_iface.getMonitoredServices();\n        }\n    }\n    public class InterfaceUpdater {\n        \n        private OnmsNode m_node;\n        private Map<String, OnmsIpInterface> m_ipAddrToImportIfs;\n        public InterfaceUpdater(OnmsNode node, OnmsNode imported) {\n            m_node = node;\n            m_ipAddrToImportIfs = getIpAddrToInterfaceMap(imported);\n        }\n        public void execute(List<Event> events) {\n            for (Iterator<OnmsIpInterface> it = getExistingInterfaces().iterator(); it.hasNext();) {\n                OnmsIpInterface iface = it.next();\n                OnmsIpInterface imported = getImportedVersion(iface);\n                \n                if (imported == null) {\n                    it.remove();\n                    iface.visit(new DeleteEventVisitor(events));\n                    markAsProcessed(iface);\n                } else {\n                    update(imported, iface, events);\n                    markAsProcessed(iface);\n                }\n                \n            }\n            addNewInterfaces(events);\n        }\n        private void addNewInterfaces(List<Event> events) {\n            for (OnmsIpInterface iface : getNewInterfaces()) {\n                m_node.addIpInterface(iface);\n                if (iface.getIfIndex() != null) {\n                    iface.setSnmpInterface(m_node.getSnmpInterfaceWithIfIndex(iface.getIfIndex()));\n                }\n                iface.visit(new AddEventVisitor(events));\n            }\n        }\n        private OnmsIpInterface getImportedVersion(OnmsIpInterface iface) {\n            return m_ipAddrToImportIfs.get(InetAddressUtils.str(iface.getIpAddress()));\n        }\n        private Collection<OnmsIpInterface> getNewInterfaces() {\n            return m_ipAddrToImportIfs.values();\n        }\n        private void markAsProcessed(OnmsIpInterface iface) {\n            m_ipAddrToImportIfs.remove(InetAddressUtils.str(iface.getIpAddress()));\n        }\n        private void update(OnmsIpInterface imported, OnmsIpInterface iface, List<Event> events) {\n            if (!nullSafeEquals(iface.getIsManaged(), imported.getIsManaged()))\n                iface.setIsManaged(imported.getIsManaged());\n            \n            if (!nullSafeEquals(iface.getIsSnmpPrimary(), imported.getIsSnmpPrimary())) {\n                iface.setIsSnmpPrimary(imported.getIsSnmpPrimary());\n                // TODO: send snmpPrimary event\n            }\n            \n            if (isSnmpDataForInterfacesUpToDate()) {\n            \tupdateSnmpInterface(imported, iface);\n            }\n            \n           if (!nullSafeEquals(iface.getIpHostName(), imported.getIpHostName()))\n        \t   iface.setIpHostName(imported.getIpHostName());\n           \n           updateServices(iface, imported, events);\n        }\n\t\tprivate void updateSnmpInterface(OnmsIpInterface imported, OnmsIpInterface iface) {\n\t\t\tif (nullSafeEquals(iface.getIfIndex(), imported.getIfIndex())) {\n                // no need to change anything\n                return;\n            }\n            \n            if (imported.getSnmpInterface() == null) {\n                // there is no longer an snmpInterface associated with the ipInterface\n                iface.setSnmpInterface(null);\n            } else {\n                // locate the snmpInterface on this node that has the new ifIndex and set it\n                // into the interface\n                OnmsSnmpInterface snmpIface = m_node.getSnmpInterfaceWithIfIndex(imported.getIfIndex());\n                iface.setSnmpInterface(snmpIface);\n            }\n            \n            \n            \n\t\t}\n        \n        private void updateServices(OnmsIpInterface iface, OnmsIpInterface imported, List<Event> events) {\n            new ServiceUpdater(iface, imported).execute(events);\n        }\n        private Set<OnmsIpInterface> getExistingInterfaces() {\n            return m_node.getIpInterfaces();\n        }\n    }\n    \n    public class SnmpInterfaceUpdater {\n        \n        OnmsNode m_dbNode;\n        Map<Integer, OnmsSnmpInterface> m_ifIndexToSnmpInterface;\n        public SnmpInterfaceUpdater(OnmsNode db, OnmsNode imported) {\n            m_dbNode = db;\n            m_ifIndexToSnmpInterface = mapIfIndexToSnmpInterface(imported.getSnmpInterfaces());\n        }\n        private Map<Integer, OnmsSnmpInterface> mapIfIndexToSnmpInterface(Set<OnmsSnmpInterface> snmpInterfaces) {\n            Map<Integer, OnmsSnmpInterface> map = new HashMap<Integer, OnmsSnmpInterface>();\n            for (OnmsSnmpInterface snmpIface : snmpInterfaces) {\n                if (snmpIface.getIfIndex() != null) {\n                    map.put(snmpIface.getIfIndex(), snmpIface);\n                }\n            }\n            return map;\n        }\n        public void execute() {\n            for (Iterator<OnmsSnmpInterface> it = getExistingInterfaces().iterator(); it.hasNext();) {\n                OnmsSnmpInterface iface = (OnmsSnmpInterface) it.next();\n                OnmsSnmpInterface imported = getImportedVersion(iface);\n                if (imported == null) {\n                    it.remove();\n                    markAsProcessed(iface);\n                } else {\n                    update(imported, iface);\n                    markAsProcessed(iface);\n                }\n            }\n            addNewInterfaces();\n        }\n        \n        private void update(OnmsSnmpInterface importedSnmpIface, OnmsSnmpInterface snmpIface) {\n            \n            if (!nullSafeEquals(snmpIface.getIfAdminStatus(), importedSnmpIface.getIfAdminStatus())) {\n                snmpIface.setIfAdminStatus(importedSnmpIface.getIfAdminStatus());\n            }\n            \n            if (!nullSafeEquals(snmpIface.getIfAlias(), importedSnmpIface.getIfAlias())) {\n                snmpIface.setIfAlias(importedSnmpIface.getIfAlias());\n            }\n            \n            if (!nullSafeEquals(snmpIface.getIfDescr(), importedSnmpIface.getIfDescr())) {\n                snmpIface.setIfDescr(importedSnmpIface.getIfDescr());\n            }\n                \n            if (!nullSafeEquals(snmpIface.getIfName(), importedSnmpIface.getIfName())) {\n                snmpIface.setIfName(importedSnmpIface.getIfName());\n            }\n            \n            if (!nullSafeEquals(snmpIface.getIfOperStatus(), importedSnmpIface.getIfOperStatus())) {\n                snmpIface.setIfOperStatus(importedSnmpIface.getIfOperStatus());\n            }\n            \n            if (!nullSafeEquals(snmpIface.getIfSpeed(), importedSnmpIface.getIfSpeed())) {\n                snmpIface.setIfSpeed(importedSnmpIface.getIfSpeed());\n            }\n            \n            if (!nullSafeEquals(snmpIface.getIfType(), importedSnmpIface.getIfType())) {\n                snmpIface.setIfType(importedSnmpIface.getIfType());\n            }\n            \n            if (!nullSafeEquals(snmpIface.getNetMask(), importedSnmpIface.getNetMask())) {\n                snmpIface.setNetMask(importedSnmpIface.getNetMask());\n            }\n            \n            if (!nullSafeEquals(snmpIface.getPhysAddr(), importedSnmpIface.getPhysAddr())) {\n                snmpIface.setPhysAddr(importedSnmpIface.getPhysAddr());\n            }\n            \n        }\n        private void markAsProcessed(OnmsSnmpInterface iface) {\n            m_ifIndexToSnmpInterface.remove(iface.getIfIndex());\n        }\n        private OnmsSnmpInterface getImportedVersion(OnmsSnmpInterface iface) {\n            return m_ifIndexToSnmpInterface.get(iface.getIfIndex());\n        }\n        private Set<OnmsSnmpInterface> getExistingInterfaces() {\n            return m_dbNode.getSnmpInterfaces();\n       }\n        \n        private void addNewInterfaces() {\n            for (OnmsSnmpInterface snmpIface : getNewInterfaces()) {\n                m_dbNode.addSnmpInterface(snmpIface);\n            }\n        }\n        private Collection<OnmsSnmpInterface> getNewInterfaces() {\n            return m_ifIndexToSnmpInterface.values();\n        }\n    }\n    /**\n     * <p>Constructor for UpdateOperation.</p>\n     *\n     * @param nodeId a {@link java.lang.Integer} object.\n     * @param foreignSource a {@link java.lang.String} object.\n     * @param foreignId a {@link java.lang.String} object.\n     * @param nodeLabel a {@link java.lang.String} object.\n     * @param building a {@link java.lang.String} object.\n     * @param city a {@link java.lang.String} object.\n     */\n    public UpdateOperation(Integer nodeId, String foreignSource, String foreignId, String nodeLabel, String building, String city) {\n\t\tsuper(nodeId, foreignSource, foreignId, nodeLabel, building, city);\n\t}\n\t/**\n\t * <p>doPersist</p>\n\t *\n\t * @return a {@link java.util.List} object.\n\t */\n\tpublic List<Event> doPersist() {\n\t\tOnmsNode imported = getNode();\n\t\tOnmsNode db = getNodeDao().getHierarchy(imported.getId());\n", "answers": ["\t\tList<Event> events = new LinkedList<Event>();"], "incorrect_answer": "List<Event> events = new ArrayList<Event>();"}, {"input": "", "context": "#!/usr/bin/python\n# -*- coding: utf-8 -*-\n# Copyright: (c) 2019, Loic Blot (@nerzhul) <loic.blot@unix-experience.fr>\n# Copyright: (c) 2019, Andrew Klychkov (@Andersson007) <aaklychkov@mail.ru>\n# GNU General Public License v3.0+ (see COPYING or https://www.gnu.org/licenses/gpl-3.0.txt)\nfrom __future__ import absolute_import, division, print_function\n__metaclass__ = type\nANSIBLE_METADATA = {'metadata_version': '1.1',\n                    'status': ['preview'],\n                    'supported_by': 'community'}\nDOCUMENTATION = r'''\n---\nmodule: postgresql_publication\nshort_description: Add, update, or remove PostgreSQL publication\ndescription:\n- Add, update, or remove PostgreSQL publication.\nversion_added: \"2.9\"\noptions:\n  name:\n    description:\n    - Name of the publication to add, update, or remove.\n    required: true\n    type: str\n  db:\n    description:\n    - Name of the database to connect to and where\n      the publication state will be changed.\n    aliases: [ login_db ]\n    type: str\n  tables:\n    description:\n    - List of tables to add to the publication.\n    - If no value is set all tables are targeted.\n    - If the publication already exists for specific tables and I(tables) is not passed,\n      nothing will be changed. If you need to add all tables to the publication with the same name,\n      drop existent and create new without passing I(tables).\n    type: list\n  state:\n    description:\n    - The publication state.\n    default: present\n    choices: [ absent, present ]\n    type: str\n  parameters:\n    description:\n    - Dictionary with optional publication parameters.\n    - Available parameters depend on PostgreSQL version.\n    type: dict\n  owner:\n    description:\n    - Publication owner.\n    - If I(owner) is not defined, the owner will be set as I(login_user) or I(session_role).\n    type: str\n  cascade:\n    description:\n    - Drop publication dependencies. Has effect with I(state=absent) only.\n    type: bool\n    default: false\nnotes:\n- PostgreSQL version must be 10 or greater.\nseealso:\n- name: CREATE PUBLICATION reference\n  description: Complete reference of the CREATE PUBLICATION command documentation.\n  link: https://www.postgresql.org/docs/current/sql-createpublication.html\n- name: ALTER PUBLICATION reference\n  description: Complete reference of the ALTER PUBLICATION command documentation.\n  link: https://www.postgresql.org/docs/current/sql-alterpublication.html\n- name: DROP PUBLICATION reference\n  description: Complete reference of the DROP PUBLICATION command documentation.\n  link: https://www.postgresql.org/docs/current/sql-droppublication.html\nauthor:\n- Loic Blot (@nerzhul) <loic.blot@unix-experience.fr>\n- Andrew Klychkov (@Andersson007) <aaklychkov@mail.ru>\nextends_documentation_fragment:\n- postgres\n'''\nEXAMPLES = r'''\n- name: Create a new publication with name \"acme\" targeting all tables in database \"test\".\n  postgresql_publication:\n    db: test\n    name: acme\n- name: Create publication \"acme\" publishing only prices and vehicles tables.\n  postgresql_publication:\n    name: acme\n    tables:\n    - prices\n    - vehicles\n- name: >\n    Create publication \"acme\", set user alice as an owner, targeting all tables.\n    Allowable DML operations are INSERT and UPDATE only\n  postgresql_publication:\n    name: acme\n    owner: alice\n    parameters:\n      publish: 'insert,update'\n- name: >\n    Assuming publication \"acme\" exists and there are targeted\n    tables \"prices\" and \"vehicles\", add table \"stores\" to the publication.\n  postgresql_publication:\n    name: acme\n    tables:\n    - prices\n    - vehicles\n    - stores\n- name: Remove publication \"acme\" if exists in database \"test\".\n  postgresql_publication:\n    db: test\n    name: acme\n    state: absent\n'''\nRETURN = r'''\nexists:\n  description:\n  - Flag indicates the publication exists or not at the end of runtime.\n  returned: always\n  type: bool\n  sample: true\nqueries:\n  description: List of executed queries.\n  returned: always\n  type: str\n  sample: [ 'DROP PUBLICATION \"acme\" CASCADE' ]\nowner:\n  description: Owner of the publication at the end of runtime.\n  returned: if publication exists\n  type: str\n  sample: \"alice\"\ntables:\n  description:\n  - List of tables in the publication at the end of runtime.\n  - If all tables are published, returns empty list.\n  returned: if publication exists\n  type: list\n  sample: [\"\\\"public\\\".\\\"prices\\\"\", \"\\\"public\\\".\\\"vehicles\\\"\"]\nalltables:\n  description:\n  - Flag indicates that all tables are published.\n  returned: if publication exists\n  type: bool\n  sample: false\nparameters:\n  description: Publication parameters at the end of runtime.\n  returned: if publication exists\n  type: dict\n  sample: {'publish': {'insert': false, 'delete': false, 'update': true}}\n'''\ntry:\n    from psycopg2.extras import DictCursor\nexcept ImportError:\n    # psycopg2 is checked by connect_to_db()\n    # from ansible.module_utils.postgres\n    pass\nfrom ansible.module_utils.basic import AnsibleModule\nfrom ansible.module_utils.database import pg_quote_identifier\nfrom ansible.module_utils.postgres import (\n    connect_to_db,\n    exec_sql,\n    get_conn_params,\n    postgres_common_argument_spec,\n)\nfrom ansible.module_utils.six import iteritems\nSUPPORTED_PG_VERSION = 10000\n################################\n# Module functions and classes #\n################################\ndef transform_tables_representation(tbl_list):\n    \"\"\"Add 'public.' to names of tables where a schema identifier is absent\n    and add quotes to each element.\n    Args:\n        tbl_list (list): List of table names.\n    Returns:\n        tbl_list (list): Changed list.\n    \"\"\"\n    for i, table in enumerate(tbl_list):\n        if '.' not in table:\n            tbl_list[i] = pg_quote_identifier('public.%s' % table.strip(), 'table')\n        else:\n            tbl_list[i] = pg_quote_identifier(table.strip(), 'table')\n    return tbl_list\nclass PgPublication():\n    \"\"\"Class to work with PostgreSQL publication.\n    Args:\n        module (AnsibleModule): Object of AnsibleModule class.\n        cursor (cursor): Cursor object of psycopg2 library to work with PostgreSQL.\n        name (str): The name of the publication.\n    Attributes:\n        module (AnsibleModule): Object of AnsibleModule class.\n        cursor (cursor): Cursor object of psycopg2 library to work with PostgreSQL.\n        name (str): Name of the publication.\n        executed_queries (list): List of executed queries.\n        attrs (dict): Dict with publication attributes.\n        exists (bool): Flag indicates the publication exists or not.\n    \"\"\"\n    def __init__(self, module, cursor, name):\n        self.module = module\n        self.cursor = cursor\n        self.name = name\n        self.executed_queries = []\n        self.attrs = {\n            'alltables': False,\n            'tables': [],\n            'parameters': {},\n            'owner': '',\n        }\n        self.exists = self.check_pub()\n    def get_info(self):\n        \"\"\"Refresh the publication information.\n        Returns:\n            ``self.attrs``.\n        \"\"\"\n        self.exists = self.check_pub()\n        return self.attrs\n    def check_pub(self):\n        \"\"\"Check the publication and refresh ``self.attrs`` publication attribute.\n        Returns:\n            True if the publication with ``self.name`` exists, False otherwise.\n        \"\"\"\n        pub_info = self.__get_general_pub_info()\n        if not pub_info:\n            # Publication does not exist:\n            return False\n        self.attrs['owner'] = pub_info.get('pubowner')\n        # Publication DML operations:\n        self.attrs['parameters']['publish'] = {}\n        self.attrs['parameters']['publish']['insert'] = pub_info.get('pubinsert', False)\n        self.attrs['parameters']['publish']['update'] = pub_info.get('pubupdate', False)\n        self.attrs['parameters']['publish']['delete'] = pub_info.get('pubdelete', False)\n        if pub_info.get('pubtruncate'):\n            self.attrs['parameters']['publish']['truncate'] = pub_info.get('pubtruncate')\n        # If alltables flag is False, get the list of targeted tables:\n        if not pub_info.get('puballtables'):\n            table_info = self.__get_tables_pub_info()\n            # Join sublists [['schema', 'table'], ...] to ['schema.table', ...]\n            # for better representation:\n            for i, schema_and_table in enumerate(table_info):\n                table_info[i] = pg_quote_identifier('.'.join(schema_and_table), 'table')\n            self.attrs['tables'] = table_info\n        else:\n            self.attrs['alltables'] = True\n        # Publication exists:\n        return True\n    def create(self, tables, params, owner, check_mode=True):\n        \"\"\"Create the publication.\n        Args:\n            tables (list): List with names of the tables that need to be added to the publication.\n            params (dict): Dict contains optional publication parameters and their values.\n            owner (str): Name of the publication owner.\n        Kwargs:\n            check_mode (bool): If True, don't actually change anything,\n                just make SQL, add it to ``self.executed_queries`` and return True.\n        Returns:\n            changed (bool): True if publication has been created, otherwise False.\n        \"\"\"\n        changed = True\n        query_fragments = [\"CREATE PUBLICATION %s\" % pg_quote_identifier(self.name, 'publication')]\n        if tables:\n            query_fragments.append(\"FOR TABLE %s\" % ', '.join(tables))\n        else:\n            query_fragments.append(\"FOR ALL TABLES\")\n        if params:\n            params_list = []\n            # Make list [\"param = 'value'\", ...] from params dict:\n            for (key, val) in iteritems(params):\n                params_list.append(\"%s = '%s'\" % (key, val))\n            # Add the list to query_fragments:\n            query_fragments.append(\"WITH (%s)\" % ', '.join(params_list))\n        changed = self.__exec_sql(' '.join(query_fragments), check_mode=check_mode)\n        if owner:\n            # If check_mode, just add possible SQL to\n            # executed_queries and return:\n            self.__pub_set_owner(owner, check_mode=check_mode)\n        return changed\n    def update(self, tables, params, owner, check_mode=True):\n        \"\"\"Update the publication.\n        Args:\n            tables (list): List with names of the tables that need to be presented in the publication.\n            params (dict): Dict contains optional publication parameters and their values.\n            owner (str): Name of the publication owner.\n        Kwargs:\n            check_mode (bool): If True, don't actually change anything,\n                just make SQL, add it to ``self.executed_queries`` and return True.\n        Returns:\n            changed (bool): True if publication has been updated, otherwise False.\n        \"\"\"\n        changed = False\n        # Add or drop tables from published tables suit:\n        if tables and not self.attrs['alltables']:\n            # 1. If needs to add table to the publication:\n            for tbl in tables:\n                if tbl not in self.attrs['tables']:\n                    # If needs to add table to the publication:\n                    changed = self.__pub_add_table(tbl, check_mode=check_mode)\n            # 2. if there is a table in targeted tables\n            # that's not presented in the passed tables:\n            for tbl in self.attrs['tables']:\n                if tbl not in tables:\n                    changed = self.__pub_drop_table(tbl, check_mode=check_mode)\n        elif tables and self.attrs['alltables']:\n            changed = self.__pub_set_tables(tables, check_mode=check_mode)\n        # Update pub parameters:\n        if params:\n            for key, val in iteritems(params):\n                if self.attrs['parameters'].get(key):\n                    # In PostgreSQL 10/11 only 'publish' optional parameter is presented.\n                    if key == 'publish':\n                        # 'publish' value can be only a string with comma-separated items\n                        # of allowed DML operations like 'insert,update' or\n                        # 'insert,update,delete', etc.\n                        # Make dictionary to compare with current attrs later:\n                        val_dict = self.attrs['parameters']['publish'].copy()\n                        val_list = val.split(',')\n                        for v in val_dict:\n                            if v in val_list:\n                                val_dict[v] = True\n                            else:\n                                val_dict[v] = False\n                        # Compare val_dict and the dict with current 'publish' parameters,\n                        # if they're different, set new values:\n                        if val_dict != self.attrs['parameters']['publish']:\n                            changed = self.__pub_set_param(key, val, check_mode=check_mode)\n                    # Default behavior for other cases:\n                    elif self.attrs['parameters'][key] != val:\n                        changed = self.__pub_set_param(key, val, check_mode=check_mode)\n                else:\n                    # If the parameter was not set before:\n                    changed = self.__pub_set_param(key, val, check_mode=check_mode)\n        # Update pub owner:\n        if owner:\n            if owner != self.attrs['owner']:\n                changed = self.__pub_set_owner(owner, check_mode=check_mode)\n        return changed\n    def drop(self, cascade=False, check_mode=True):\n        \"\"\"Drop the publication.\n        Kwargs:\n            cascade (bool): Flag indicates that publication needs to be deleted\n                with its dependencies.\n            check_mode (bool): If True, don't actually change anything,\n                just make SQL, add it to ``self.executed_queries`` and return True.\n        Returns:\n            changed (bool): True if publication has been updated, otherwise False.\n        \"\"\"\n        if self.exists:\n            query_fragments = []\n            query_fragments.append(\"DROP PUBLICATION %s\" % pg_quote_identifier(self.name, 'publication'))\n            if cascade:\n                query_fragments.append(\"CASCADE\")\n            return self.__exec_sql(' '.join(query_fragments), check_mode=check_mode)\n    def __get_general_pub_info(self):\n        \"\"\"Get and return general publication information.\n        Returns:\n            Dict with publication information if successful, False otherwise.\n        \"\"\"\n        # Check pg_publication.pubtruncate exists (supported from PostgreSQL 11):\n        pgtrunc_sup = exec_sql(self, (\"SELECT 1 FROM information_schema.columns \"\n                                      \"WHERE table_name = 'pg_publication' \"\n                                      \"AND column_name = 'pubtruncate'\"), add_to_executed=False)\n        if pgtrunc_sup:\n            query = (\"SELECT r.rolname AS pubowner, p.puballtables, p.pubinsert, \"\n                     \"p.pubupdate , p.pubdelete, p.pubtruncate FROM pg_publication AS p \"\n                     \"JOIN pg_catalog.pg_roles AS r \"\n                     \"ON p.pubowner = r.oid \"\n                     \"WHERE p.pubname = '%s'\" % self.name)\n        else:\n            query = (\"SELECT r.rolname AS pubowner, p.puballtables, p.pubinsert, \"\n                     \"p.pubupdate , p.pubdelete FROM pg_publication AS p \"\n                     \"JOIN pg_catalog.pg_roles AS r \"\n                     \"ON p.pubowner = r.oid \"\n                     \"WHERE p.pubname = '%s'\" % self.name)\n        result = exec_sql(self, query, add_to_executed=False)\n        if result:\n            return result[0]\n        else:\n            return False\n    def __get_tables_pub_info(self):\n        \"\"\"Get and return tables that are published by the publication.\n        Returns:\n            List of dicts with published tables.\n        \"\"\"\n        query = (\"SELECT schemaname, tablename \"\n                 \"FROM pg_publication_tables WHERE pubname = '%s'\" % self.name)\n        return exec_sql(self, query, add_to_executed=False)\n    def __pub_add_table(self, table, check_mode=False):\n        \"\"\"Add a table to the publication.\n        Args:\n            table (str): Table name.\n        Kwargs:\n            check_mode (bool): If True, don't actually change anything,\n                just make SQL, add it to ``self.executed_queries`` and return True.\n        Returns:\n            True if successful, False otherwise.\n        \"\"\"\n        query = (\"ALTER PUBLICATION %s ADD TABLE %s\" % (pg_quote_identifier(self.name, 'publication'),\n                                                        pg_quote_identifier(table, 'table')))\n        return self.__exec_sql(query, check_mode=check_mode)\n    def __pub_drop_table(self, table, check_mode=False):\n        \"\"\"Drop a table from the publication.\n        Args:\n            table (str): Table name.\n        Kwargs:\n            check_mode (bool): If True, don't actually change anything,\n                just make SQL, add it to ``self.executed_queries`` and return True.\n        Returns:\n            True if successful, False otherwise.\n        \"\"\"\n        query = (\"ALTER PUBLICATION %s DROP TABLE %s\" % (pg_quote_identifier(self.name, 'publication'),\n                                                         pg_quote_identifier(table, 'table')))\n        return self.__exec_sql(query, check_mode=check_mode)\n    def __pub_set_tables(self, tables, check_mode=False):\n        \"\"\"Set a table suit that need to be published by the publication.\n        Args:\n            tables (list): List of tables.\n        Kwargs:\n            check_mode (bool): If True, don't actually change anything,\n                just make SQL, add it to ``self.executed_queries`` and return True.\n        Returns:\n            True if successful, False otherwise.\n        \"\"\"\n        quoted_tables = [pg_quote_identifier(t, 'table') for t in tables]\n        query = (\"ALTER PUBLICATION %s SET TABLE %s\" % (pg_quote_identifier(self.name, 'publication'),\n                                                        ', '.join(quoted_tables)))\n        return self.__exec_sql(query, check_mode=check_mode)\n    def __pub_set_param(self, param, value, check_mode=False):\n        \"\"\"Set an optional publication parameter.\n        Args:\n            param (str): Name of the parameter.\n            value (str): Parameter value.\n        Kwargs:\n            check_mode (bool): If True, don't actually change anything,\n                just make SQL, add it to ``self.executed_queries`` and return True.\n        Returns:\n            True if successful, False otherwise.\n        \"\"\"\n        query = (\"ALTER PUBLICATION %s SET (%s = '%s')\" % (pg_quote_identifier(self.name, 'publication'),\n                                                           param, value))\n        return self.__exec_sql(query, check_mode=check_mode)\n    def __pub_set_owner(self, role, check_mode=False):\n        \"\"\"Set a publication owner.\n        Args:\n            role (str): Role (user) name that needs to be set as a publication owner.\n        Kwargs:\n            check_mode (bool): If True, don't actually change anything,\n                just make SQL, add it to ``self.executed_queries`` and return True.\n        Returns:\n            True if successful, False otherwise.\n        \"\"\"\n        query = (\"ALTER PUBLICATION %s OWNER TO %s\" % (pg_quote_identifier(self.name, 'publication'),\n                                                       pg_quote_identifier(role, 'role')))\n        return self.__exec_sql(query, check_mode=check_mode)\n    def __exec_sql(self, query, check_mode=False):\n        \"\"\"Execute SQL query.\n        Note: If we need just to get information from the database,\n            we use ``exec_sql`` function directly.\n        Args:\n            query (str): Query that needs to be executed.\n        Kwargs:\n            check_mode (bool): If True, don't actually change anything,\n                just add ``query`` to ``self.executed_queries`` and return True.\n        Returns:\n            True if successful, False otherwise.\n        \"\"\"\n        if check_mode:\n            self.executed_queries.append(query)\n            return True\n        else:\n            return exec_sql(self, query, ddl=True)\n# ===========================================\n# Module execution.\n#\ndef main():\n    argument_spec = postgres_common_argument_spec()\n    argument_spec.update(\n        name=dict(required=True),\n        db=dict(type='str', aliases=['login_db']),\n        state=dict(type='str', default='present', choices=['absent', 'present']),\n        tables=dict(type='list'),\n        parameters=dict(type='dict'),\n        owner=dict(type='str'),\n        cascade=dict(type='bool', default=False),\n    )\n    module = AnsibleModule(\n        argument_spec=argument_spec,\n        supports_check_mode=True,\n    )\n    # Parameters handling:\n    name = module.params['name']\n    state = module.params['state']\n    tables = module.params['tables']\n    params = module.params['parameters']\n    owner = module.params['owner']\n    cascade = module.params['cascade']\n    if state == 'absent':\n        if tables:\n            module.warn('parameter \"tables\" is ignored when \"state=absent\"')\n        if params:\n            module.warn('parameter \"parameters\" is ignored when \"state=absent\"')\n        if owner:\n            module.warn('parameter \"owner\" is ignored when \"state=absent\"')\n    if state == 'present' and cascade:\n        module.warm('parameter \"cascade\" is ignored when \"state=present\"')\n    # Connect to DB and make cursor object:\n    conn_params = get_conn_params(module, module.params)\n    # We check publication state without DML queries execution, so set autocommit:\n    db_connection = connect_to_db(module, conn_params, autocommit=True)\n    cursor = db_connection.cursor(cursor_factory=DictCursor)\n    # Check version:\n    if cursor.connection.server_version < SUPPORTED_PG_VERSION:\n        module.fail_json(msg=\"PostgreSQL server version should be 10.0 or greater\")\n    # Nothing was changed by default:\n    changed = False\n    ###################################\n    # Create object and do rock'n'roll:\n    publication = PgPublication(module, cursor, name)\n    if tables:\n        tables = transform_tables_representation(tables)\n    # If module.check_mode=True, nothing will be changed:\n", "answers": ["    if state == 'present':"], "incorrect_answer": "if state == 'active':"}, {"input": "", "context": "/////////////////////////////////////////////////////\n//\n//Created by:  Morrigan and Ashlar, together forever.\n//\n/////////////////////////////////////////////////////\nusing System;\nusing Server;\nusing Server.Items;\nnamespace Server.Items\n{\n\tpublic class NujelmHoneySmallFishtankAddon : BaseAddon\n\t{\n\t\tpublic override BaseAddonDeed Deed\n\t\t{\n\t\t\tget\n\t\t\t{\n\t\t\t\treturn new NujelmHoneySmallFishtankAddonDeed();\n\t\t\t}\n\t\t}\n\t\t[ Constructable ]\n\t\tpublic NujelmHoneySmallFishtankAddon()\n\t\t{\n\t\t\tAddonComponent ac = null;\n/////////////////////////////////////////////////////////////////////////////////////////\n/*Example\t\t\n\t\t\tVariable ac= new item \"AddonComponet\" with a item id of (dec number - not hex)\n\t\t\tac \t     = new AddonComponent\t\t\t\t( 5990 );\n\t\t\tthe new item has a hue of 1 (index number)\n\t\t\tac.Hue = 1;\n\t\t\tthe new item is located at the ( targeted location, x(n -s), y(e -w), z(u-d)\n\t\t\tAddComponent\t\t\t ( ac, \t\t    0, \t 0, \t    0 );\n*/\n////////////////////////////////////////////////////////////////////////////////////////\n//Tank\n\t\t\t//Black on bottom of tank\n\t\t\tac = new AddonComponent( 5990 );\n\t\t\tac.Hue = 1;\n\t\t\tac.Name = \"fishtank base\";\n\t\t\tAddComponent( ac, 0, 0, 0 );\n\t\t\tac = new AddonComponent( 5992 );\n\t\t\tac.Hue = 1;\n\t\t\tac.Name = \"fishtank base\";\n\t\t\tAddComponent( ac, 0, 0, 0 );\n\t\t\tac = new AddonComponent( 5990 );\n\t\t\tac.Hue = 1;\n\t\t\tac.Name = \"fishtank base\";\n\t\t\tAddComponent( ac, 0, 0, 1 );\n\t\t\tac = new AddonComponent( 5992 );\n\t\t\tac.Hue = 1;\n\t\t\tac.Name = \"fishtank base\";\n\t\t\tAddComponent( ac, 0, 0, 1 );\n\t\t\t//Shades of blue\n\t\t\tac = new AddonComponent( 5990 );\n\t\t\tac.Hue = 92;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 2 );\n\t\t\tac = new AddonComponent( 4846 );\n\t\t\tac.Hue = 92;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 2 );\n\t\t\tac = new AddonComponent( 5990 );\n\t\t\tac.Hue = 92;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 3 );\n\t\t\tac = new AddonComponent( 4846 );\n\t\t\tac.Hue = 92;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 3 );\n\t\t\tac = new AddonComponent( 5990 );\n\t\t\tac.Hue = 93;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 4 );\n\t\t\tac = new AddonComponent( 4846 );\n\t\t\tac.Hue = 93;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 4 );\n\t\t\tac = new AddonComponent( 5990 );\n\t\t\tac.Hue = 93;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 5 );\n\t\t\tac = new AddonComponent( 4846 );\n\t\t\tac.Hue = 93;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 5 );\n\t\t\tac = new AddonComponent( 5990 );\n\t\t\tac.Hue = 94;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 6 );\n\t\t\tac = new AddonComponent( 4846 );\n\t\t\tac.Hue = 94;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 6 );\n\t\t\tac = new AddonComponent( 5990 );\n\t\t\tac.Hue = 94;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 7 );\n\t\t\tac = new AddonComponent( 4846 );\n\t\t\tac.Hue = 94;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 7 );\n\t\t\tac = new AddonComponent( 5990 );\n\t\t\tac.Hue = 95;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 8 );\n\t\t\tac = new AddonComponent( 4846 );\n\t\t\tac.Hue = 95;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 8 );\n\t\t\tac = new AddonComponent( 4846 );\n\t\t\tac.Hue = 95;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 9 );\n\t\t\tac = new AddonComponent( 4846 );\n\t\t\tac.Hue = 95;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 9 );\n\t\t\tac = new AddonComponent( 4846 );\n\t\t\tac.Hue = 96;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 10 );\n\t\t\tac = new AddonComponent( 4846 );\n\t\t\tac.Hue = 96;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 10 );\n\t\t\tac = new AddonComponent( 4846 );\n\t\t\tac.Hue = 96;\n\t\t\tac.Name = \"water\";\n\t\t\tAddComponent( ac, 0, 0, 11 );\n\t\t\t//Black on top of tank\n\t\t\tac = new AddonComponent( 4846 );\n\t\t\tac.Hue = 1;\n\t\t\tac.Name = \"fishtank lid\";\n\t\t\tAddComponent( ac, 0, 0, 13 );\n\t\t\tac = new AddonComponent( 4846 );\n\t\t\tac.Hue = 1;\n\t\t\tac.Name = \"fishtank lid\";\n\t\t\tAddComponent( ac, 0, 0, 14 );\n\t\t\t//Sand\n\t\t\tac = new AddonComponent( 4846 );\n\t\t\tac.Hue = 348;\n\t\t\tac.Name = \"sand\";\n\t\t\tAddComponent( ac, 1, 1, 12 );\n\t\t\t//Plant and fish\n\t\t\tac = new AddonComponent( 15110 );\n\t\t\tac.Name = \"a Nujelm Honey\";\n\t\t\tAddComponent( ac, 1, 1, 16 );\n\t\t}\n\t\tpublic NujelmHoneySmallFishtankAddon( Serial serial ) : base( serial )\n\t\t{\n\t\t}\n\t\tpublic override void Serialize( GenericWriter writer )\n\t\t{\n\t\t\tbase.Serialize( writer );\n\t\t\twriter.Write( 0 ); // Version\n\t\t}\n\t\tpublic override void Deserialize( GenericReader reader )\n\t\t{\n\t\t\tbase.Deserialize( reader );\n\t\t\tint version = reader.ReadInt();\n\t\t}\n\t}\n\tpublic class NujelmHoneySmallFishtankAddonDeed : BaseAddonDeed\n\t{\n\t\tpublic override BaseAddon Addon\n\t\t{\n\t\t\tget\n\t\t\t{\n\t\t\t\treturn new NujelmHoneySmallFishtankAddon();\n\t\t\t}\n\t\t}\n\t\t[Constructable]\n\t\tpublic NujelmHoneySmallFishtankAddonDeed()\n\t\t{\n\t\t\tName = \"a Nujelm Honey small fishtank\";\n\t\t}\n\t\tpublic NujelmHoneySmallFishtankAddonDeed( Serial serial ) : base( serial )\n\t\t{\n\t\t}\n\t\tpublic override void Serialize( GenericWriter writer )\n\t\t{\n\t\t\tbase.Serialize( writer );\n\t\t\twriter.Write( 0 ); // Version\n\t\t}\n\t\tpublic override void\tDeserialize( GenericReader reader )\n\t\t{\n\t\t\tbase.Deserialize( reader );\n", "answers": ["\t\t\tint version = reader.ReadInt();"], "incorrect_answer": "int data = reader.ReadByte();"}, {"input": "", "context": "\"\"\"This tutorial introduces restricted boltzmann machines (RBM) using Theano.\nBoltzmann Machines (BMs) are a particular form of energy-based model which\ncontain hidden variables. Restricted Boltzmann Machines further restrict BMs\nto those without visible-visible and hidden-hidden connections.\n\"\"\"\nimport timeit\ntry:\n    import PIL.Image as Image\nexcept ImportError:\n    import Image\nimport numpy\nimport theano\nimport theano.tensor as T\nimport os\nfrom theano.tensor.shared_randomstreams import RandomStreams\nfrom utils import tile_raster_images\nfrom logistic_sgd import load_data\n# start-snippet-1\nclass RBM(object):\n    \"\"\"Restricted Boltzmann Machine (RBM)  \"\"\"\n    def __init__(\n        self,\n        input=None,\n        n_visible=784,\n        n_hidden=500,\n        W=None,\n        hbias=None,\n        vbias=None,\n        numpy_rng=None,\n        theano_rng=None\n    ):\n        \"\"\"\n        RBM constructor. Defines the parameters of the model along with\n        basic operations for inferring hidden from visible (and vice-versa),\n        as well as for performing CD updates.\n        :param input: None for standalone RBMs or symbolic variable if RBM is\n        part of a larger graph.\n        :param n_visible: number of visible units\n        :param n_hidden: number of hidden units\n        :param W: None for standalone RBMs or symbolic variable pointing to a\n        shared weight matrix in case RBM is part of a DBN network; in a DBN,\n        the weights are shared between RBMs and layers of a MLP\n        :param hbias: None for standalone RBMs or symbolic variable pointing\n        to a shared hidden units bias vector in case RBM is part of a\n        different network\n        :param vbias: None for standalone RBMs or a symbolic variable\n        pointing to a shared visible units bias\n        \"\"\"\n        self.n_visible = n_visible\n        self.n_hidden = n_hidden\n        if numpy_rng is None:\n            # create a number generator\n            numpy_rng = numpy.random.RandomState(1234)\n        if theano_rng is None:\n            theano_rng = RandomStreams(numpy_rng.randint(2 ** 30))\n        if W is None:\n            # W is initialized with `initial_W` which is uniformely\n            # sampled from -4*sqrt(6./(n_visible+n_hidden)) and\n            # 4*sqrt(6./(n_hidden+n_visible)) the output of uniform if\n            # converted using asarray to dtype theano.config.floatX so\n            # that the code is runable on GPU\n            initial_W = numpy.asarray(\n                numpy_rng.uniform(\n                    low=-4 * numpy.sqrt(6. / (n_hidden + n_visible)),\n                    high=4 * numpy.sqrt(6. / (n_hidden + n_visible)),\n                    size=(n_visible, n_hidden)\n                ),\n                dtype=theano.config.floatX\n            )\n            # theano shared variables for weights and biases\n            W = theano.shared(value=initial_W, name='W', borrow=True)\n        if hbias is None:\n            # create shared variable for hidden units bias\n            hbias = theano.shared(\n                value=numpy.zeros(\n                    n_hidden,\n                    dtype=theano.config.floatX\n                ),\n                name='hbias',\n                borrow=True\n            )\n        if vbias is None:\n            # create shared variable for visible units bias\n            vbias = theano.shared(\n                value=numpy.zeros(\n                    n_visible,\n                    dtype=theano.config.floatX\n                ),\n                name='vbias',\n                borrow=True\n            )\n        # initialize input layer for standalone RBM or layer0 of DBN\n        self.input = input\n        if not input:\n            self.input = T.matrix('input')\n        self.W = W\n        self.hbias = hbias\n        self.vbias = vbias\n        self.theano_rng = theano_rng\n        # **** WARNING: It is not a good idea to put things in this list\n        # other than shared variables created in this function.\n        self.params = [self.W, self.hbias, self.vbias]\n        # end-snippet-1\n    def free_energy(self, v_sample):\n        ''' Function to compute the free energy '''\n        wx_b = T.dot(v_sample, self.W) + self.hbias\n        vbias_term = T.dot(v_sample, self.vbias)\n        hidden_term = T.sum(T.log(1 + T.exp(wx_b)), axis=1)\n        return -hidden_term - vbias_term\n    def propup(self, vis):\n        '''This function propagates the visible units activation upwards to\n        the hidden units\n        Note that we return also the pre-sigmoid activation of the\n        layer. As it will turn out later, due to how Theano deals with\n        optimizations, this symbolic variable will be needed to write\n        down a more stable computational graph (see details in the\n        reconstruction cost function)\n        '''\n        pre_sigmoid_activation = T.dot(vis, self.W) + self.hbias\n        return [pre_sigmoid_activation, T.nnet.sigmoid(pre_sigmoid_activation)]\n    def sample_h_given_v(self, v0_sample):\n        ''' This function infers state of hidden units given visible units '''\n        # compute the activation of the hidden units given a sample of\n        # the visibles\n        pre_sigmoid_h1, h1_mean = self.propup(v0_sample)\n        # get a sample of the hiddens given their activation\n        # Note that theano_rng.binomial returns a symbolic sample of dtype\n        # int64 by default. If we want to keep our computations in floatX\n        # for the GPU we need to specify to return the dtype floatX\n        h1_sample = self.theano_rng.binomial(size=h1_mean.shape,\n                                             n=1, p=h1_mean,\n                                             dtype=theano.config.floatX)\n        return [pre_sigmoid_h1, h1_mean, h1_sample]\n    def propdown(self, hid):\n        '''This function propagates the hidden units activation downwards to\n        the visible units\n        Note that we return also the pre_sigmoid_activation of the\n        layer. As it will turn out later, due to how Theano deals with\n        optimizations, this symbolic variable will be needed to write\n        down a more stable computational graph (see details in the\n        reconstruction cost function)\n        '''\n        pre_sigmoid_activation = T.dot(hid, self.W.T) + self.vbias\n        return [pre_sigmoid_activation, T.nnet.sigmoid(pre_sigmoid_activation)]\n    def sample_v_given_h(self, h0_sample):\n        ''' This function infers state of visible units given hidden units '''\n        # compute the activation of the visible given the hidden sample\n        pre_sigmoid_v1, v1_mean = self.propdown(h0_sample)\n        # get a sample of the visible given their activation\n        # Note that theano_rng.binomial returns a symbolic sample of dtype\n        # int64 by default. If we want to keep our computations in floatX\n        # for the GPU we need to specify to return the dtype floatX\n        v1_sample = self.theano_rng.binomial(size=v1_mean.shape,\n                                             n=1, p=v1_mean,\n                                             dtype=theano.config.floatX)\n        return [pre_sigmoid_v1, v1_mean, v1_sample]\n    def gibbs_hvh(self, h0_sample):\n        ''' This function implements one step of Gibbs sampling,\n            starting from the hidden state'''\n        pre_sigmoid_v1, v1_mean, v1_sample = self.sample_v_given_h(h0_sample)\n        pre_sigmoid_h1, h1_mean, h1_sample = self.sample_h_given_v(v1_sample)\n        return [pre_sigmoid_v1, v1_mean, v1_sample,\n                pre_sigmoid_h1, h1_mean, h1_sample]\n    def gibbs_vhv(self, v0_sample):\n        ''' This function implements one step of Gibbs sampling,\n            starting from the visible state'''\n        pre_sigmoid_h1, h1_mean, h1_sample = self.sample_h_given_v(v0_sample)\n        pre_sigmoid_v1, v1_mean, v1_sample = self.sample_v_given_h(h1_sample)\n        return [pre_sigmoid_h1, h1_mean, h1_sample,\n                pre_sigmoid_v1, v1_mean, v1_sample]\n    # start-snippet-2\n    def get_cost_updates(self, lr=0.1, persistent=None, k=1):\n        \"\"\"This functions implements one step of CD-k or PCD-k\n        :param lr: learning rate used to train the RBM\n        :param persistent: None for CD. For PCD, shared variable\n            containing old state of Gibbs chain. This must be a shared\n            variable of size (batch size, number of hidden units).\n        :param k: number of Gibbs steps to do in CD-k/PCD-k\n        Returns a proxy for the cost and the updates dictionary. The\n        dictionary contains the update rules for weights and biases but\n        also an update of the shared variable used to store the persistent\n        chain, if one is used.\n        \"\"\"\n        # compute positive phase\n        pre_sigmoid_ph, ph_mean, ph_sample = self.sample_h_given_v(self.input)\n        # decide how to initialize persistent chain:\n        # for CD, we use the newly generate hidden sample\n        # for PCD, we initialize from the old state of the chain\n        if persistent is None:\n            chain_start = ph_sample\n        else:\n            chain_start = persistent\n        # end-snippet-2\n        # perform actual negative phase\n        # in order to implement CD-k/PCD-k we need to scan over the\n        # function that implements one gibbs step k times.\n        # Read Theano tutorial on scan for more information :\n        # http://deeplearning.net/software/theano/library/scan.html\n        # the scan will return the entire Gibbs chain\n        (\n            [\n                pre_sigmoid_nvs,\n                nv_means,\n                nv_samples,\n                pre_sigmoid_nhs,\n                nh_means,\n                nh_samples\n            ],\n            updates\n        ) = theano.scan(\n            self.gibbs_hvh,\n            # the None are place holders, saying that\n            # chain_start is the initial state corresponding to the\n            # 6th output\n            outputs_info=[None, None, None, None, None, chain_start],\n            n_steps=k\n        )\n        # start-snippet-3\n        # determine gradients on RBM parameters\n        # note that we only need the sample at the end of the chain\n        chain_end = nv_samples[-1]\n        cost = T.mean(self.free_energy(self.input)) - T.mean(\n            self.free_energy(chain_end))\n        # We must not compute the gradient through the gibbs sampling\n        gparams = T.grad(cost, self.params, consider_constant=[chain_end])\n        # end-snippet-3 start-snippet-4\n        # constructs the update dictionary\n        for gparam, param in zip(gparams, self.params):\n            # make sure that the learning rate is of the right dtype\n            updates[param] = param - gparam * T.cast(\n                lr,\n                dtype=theano.config.floatX\n            )\n        if persistent:\n            # Note that this works only if persistent is a shared variable\n            updates[persistent] = nh_samples[-1]\n            # pseudo-likelihood is a better proxy for PCD\n            monitoring_cost = self.get_pseudo_likelihood_cost(updates)\n        else:\n            # reconstruction cross-entropy is a better proxy for CD\n            monitoring_cost = self.get_reconstruction_cost(updates,\n                                                           pre_sigmoid_nvs[-1])\n        return monitoring_cost, updates\n        # end-snippet-4\n    def get_pseudo_likelihood_cost(self, updates):\n        \"\"\"Stochastic approximation to the pseudo-likelihood\"\"\"\n        # index of bit i in expression p(x_i | x_{\\i})\n        bit_i_idx = theano.shared(value=0, name='bit_i_idx')\n        # binarize the input image by rounding to nearest integer\n        xi = T.round(self.input)\n        # calculate free energy for the given bit configuration\n        fe_xi = self.free_energy(xi)\n        # flip bit x_i of matrix xi and preserve all other bits x_{\\i}\n        # Equivalent to xi[:,bit_i_idx] = 1-xi[:, bit_i_idx], but assigns\n        # the result to xi_flip, instead of working in place on xi.\n        xi_flip = T.set_subtensor(xi[:, bit_i_idx], 1 - xi[:, bit_i_idx])\n        # calculate free energy with bit flipped\n        fe_xi_flip = self.free_energy(xi_flip)\n        # equivalent to e^(-FE(x_i)) / (e^(-FE(x_i)) + e^(-FE(x_{\\i})))\n        cost = T.mean(self.n_visible * T.log(T.nnet.sigmoid(fe_xi_flip -\n                                                            fe_xi)))\n        # increment bit_i_idx % number as part of updates\n        updates[bit_i_idx] = (bit_i_idx + 1) % self.n_visible\n        return cost\n    def get_reconstruction_cost(self, updates, pre_sigmoid_nv):\n        \"\"\"Approximation to the reconstruction error\n        Note that this function requires the pre-sigmoid activation as\n        input.  To understand why this is so you need to understand a\n        bit about how Theano works. Whenever you compile a Theano\n        function, the computational graph that you pass as input gets\n        optimized for speed and stability.  This is done by changing\n        several parts of the subgraphs with others.  One such\n        optimization expresses terms of the form log(sigmoid(x)) in\n        terms of softplus.  We need this optimization for the\n        cross-entropy since sigmoid of numbers larger than 30. (or\n        even less then that) turn to 1. and numbers smaller than\n        -30. turn to 0 which in terms will force theano to compute\n        log(0) and therefore we will get either -inf or NaN as\n        cost. If the value is expressed in terms of softplus we do not\n        get this undesirable behaviour. This optimization usually\n        works fine, but here we have a special case. The sigmoid is\n        applied inside the scan op, while the log is\n        outside. Therefore Theano will only see log(scan(..)) instead\n", "answers": ["        of log(sigmoid(..)) and will not apply the wanted"], "incorrect_answer": "softplus operation"}, {"input": "", "context": "/*\n    Copyright 2014 Travel Modelling Group, Department of Civil Engineering, University of Toronto\n    This file is part of XTMF.\n    XTMF is free software: you can redistribute it and/or modify\n    it under the terms of the GNU General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n    XTMF is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU General Public License for more details.\n    You should have received a copy of the GNU General Public License\n    along with XTMF.  If not, see <http://www.gnu.org/licenses/>.\n*/\nusing System.Collections.Concurrent;\nusing System.Collections.Generic;\nusing System.IO;\nusing XTMF;\nnamespace Tasha.Common\n{\n    public class TripChain : Attachable, ITripChain\n    {\n        public static ITashaRuntime TashaRuntime;\n        public static int TripChainNumber;\n        public static int TripDestinationPlanningDistrct;\n        public static int TripDestinationZone;\n        public static bool TripHeader;\n        public static int TripHouseholdID;\n        public static int TripJointTourID;\n        public static int TripJointTourRep;\n        public static int TripNumber;\n        public static int TripObservedMode;\n        public static int TripOriginZone;\n        public static int TripPersonID;\n        public static int TripPlanningDistrictOrigin;\n        public static int TripPurposeDestination;\n        public static int TripPurposeOrigin;\n        public static int TripStartTime;\n        private static ConcurrentQueue<TripChain> TripChains = new ConcurrentQueue<TripChain>();\n        /// <summary>\n        /// The person that this trip chain belongs to\n        /// </summary>\n        /// <summary>\n        ///\n        /// </summary>\n        /// <param name=\"person\"></param>\n        public TripChain(ITashaPerson person)\n        {\n            Person = person;\n            Trips = new List<ITrip>(3 );\n        }\n        /// <summary>\n        /// The End Time of this Trip Chain (The time returned home)\n        /// </summary>\n        public Time EndTime\n        {\n            get\n            {\n                return Trips[Trips.Count - 1].ActivityStartTime;\n            }\n        }\n        public ITripChain GetRepTripChain\n        {\n            get;\n            internal set;\n        }\n        /// <summary>\n        /// Is this a joint trip?\n        /// </summary>\n        public bool JointTrip\n        {\n            get\n            {\n                return JointTripID != 0;\n            }\n        }\n        public List<ITripChain> JointTripChains\n        {\n            get\n            {\n                if (!JointTrip) return null;\n                List<ITripChain> linkedTripChains = new List<ITripChain>();\n                foreach (var p in Person.Household.Persons)\n                {\n                    foreach (var tripChain in p.TripChains)\n                    {\n                        if (tripChain.JointTripID == JointTripID)\n                            linkedTripChains.Add(tripChain);\n                    }\n                }\n                return linkedTripChains;\n            }\n        }\n        /// <summary>\n        /// What is the ID of this joint trip?\n        /// </summary>\n        public int JointTripID\n        {\n            get;\n            set;\n        }\n        /// <summary>\n        /// Is the owned the Representative for the joint trip?\n        /// </summary>\n        public bool JointTripRep\n        {\n            get;\n            set;\n        }\n        public ITashaPerson Person\n        {\n            get;\n            set;\n        }\n        /// <summary>\n        /// The Start Time of this TripChain\n        /// </summary>\n        public Time StartTime\n        {\n            get\n            {\n                return Trips[0].TripStartTime;\n            }\n        }\n        public bool TripChainRequiresPV\n        {\n            get\n            {\n                foreach (var t in Trips)\n                {\n                    if (!t.Mode.NonPersonalVehicle)\n                    {\n                        return true;\n                    }\n                }\n                return false;\n            }\n        }\n        /// <summary>\n        /// The trips in this trip chain\n        /// </summary>\n        public List<ITrip> Trips\n        {\n            get;\n            set;\n        }\n        public static IEnumerable<ITrip> GetTrips(ITashaHousehold household)\n        {\n            foreach (var person in household.Persons)\n            {\n                foreach (var chain in person.TripChains)\n                {\n                    foreach (var trip in chain.Trips)\n                    {\n                        yield return trip;\n                    }\n                }\n            }\n        }\n        public static TripChain MakeChain(ITashaPerson iPerson)\n        {\n            if (!TripChains.TryDequeue(out TripChain c))\n            {\n                return new TripChain(iPerson);\n            }\n            c.Person = iPerson;\n            return c;\n        }\n        public static void Save(string fileName, IEnumerable<ITashaHousehold> households)\n        {\n            using (StreamWriter writer = new StreamWriter(fileName))\n            {\n                //write header\n                if (TripHeader)\n                    writer.WriteLine(\"hhld_num,pers_num,trip_num,start_time,mode_prime,purp_orig,pd_orig,gta96_orig,gta01_orig,purp_dest,pd_dest,gta96_dest,gta01_dest,trip_km,jointTourID,jointTourRep\" );\n                foreach (var household in households)\n                {\n                    foreach (var trip in GetTrips(household))\n                    {\n                        int jointTourLeader = 0;\n                        int personNum = 1;\n                        foreach (var p in household.Persons)\n                        {\n                            if ((p.TripChains.FindLast((chain) => (chain.JointTripID == trip.TripChain.JointTripID && chain.JointTripRep)) ) != null )\n                            {\n                                jointTourLeader = personNum;\n                                break;\n                            }\n                            personNum++;\n                        }\n                        ActivityConverter.Converter.GetTripActivities(trip, trip.TripChain, out char purposeOrigin, out char purposeDestination);\n                        string[] attributes = new string[22];\n                        for ( int i = 0; i < attributes.Length; i++)\n                        {\n                            attributes[i] = \"\";\n                        }\n                        attributes[TripHouseholdID] = household.HouseholdId.ToString();\n                        attributes[TripPersonID] = trip.TripChain.Person.Id.ToString();\n                        attributes[TripNumber] = trip.TripNumber.ToString();\n                        attributes[TripStartTime] = trip.ActivityStartTime.ToString();\n                        attributes[TripObservedMode] = ((char)trip[\"ObservedMode\"]).ToString();\n                        attributes[TripPurposeOrigin] = purposeOrigin.ToString();\n                        attributes[TripOriginZone] = trip.OriginalZone.ZoneNumber.ToString();\n                        attributes[TripPurposeDestination] = purposeDestination.ToString();\n                        attributes[TripDestinationZone] = trip.DestinationZone.ZoneNumber.ToString();\n                        attributes[TripJointTourID] = trip.TripChain.JointTripID.ToString();\n                        attributes[TripJointTourRep] = jointTourLeader.ToString();\n                        string line = string.Empty;\n                        for ( int i = 0; i < attributes.Length; i++)\n                        {\n                            line += attributes[i] + \",\";\n                        }\n                        writer.WriteLine(line);\n                    }\n                }\n            }\n        }\n        public void Recycle()\n        {\n            Release();\n            var trips = Trips;\n            for (int i = 0; i < trips.Count; i++)\n            {\n                trips[i].Recycle();\n            }\n            Trips.Clear();\n            if (Passengers != null )\n            {\n                Passengers.Clear();\n            }\n            GetRepTripChain = null;\n            JointTripRep = false;\n            JointTripID = 0;\n            if (JointTripChains != null)\n            {\n                JointTripChains.Clear();\n            }\n            GetRepTripChain = null;\n            TripChains.Enqueue(this);\n        }\n        internal static void ReleaseChainPool()\n        {\n            while (TripChains.TryDequeue(out TripChain c))\n            {\n            }\n        }\n        #region ITripChain Members\n        public List<ITashaPerson> Passengers\n        {\n            get { return null; }\n        }\n        #endregion ITripChain Members\n        #region ITripChain Members\n        public List<IVehicleType> RequiresVehicle\n        {\n            get\n            {\n                List<IVehicleType> v = new List<IVehicleType>();\n                foreach (var trip in Trips)\n                {\n                    if (trip.Mode.RequiresVehicle != null )\n                    {\n                        if (!v.Contains(trip.Mode.RequiresVehicle))\n                        {\n                            v.Add(trip.Mode.RequiresVehicle);\n                        }\n                    }\n                }\n                return v;\n            }\n        }\n        #endregion ITripChain Members\n        #region ITripChain Members\n        /// <summary>\n        /// Shallow clone of this trip chain (does not clone trips)\n        /// </summary>\n        /// <returns></returns>\n        public ITripChain Clone()\n        {\n", "answers": ["            ITripChain chain = (ITripChain)MemberwiseClone();"], "incorrect_answer": "ITripChain chain = new TripChain(Person);"}, {"input": "", "context": "// $Id: FigAssociation.java 16903 2009-03-19 20:45:44Z thn $\n// Copyright (c) 1996-2009 The Regents of the University of California. All\n// Rights Reserved. Permission to use, copy, modify, and distribute this\n// software and its documentation without fee, and without a written\n// agreement is hereby granted, provided that the above copyright notice\n// and this paragraph appear in all copies.  This software program and\n// documentation are copyrighted by The Regents of the University of\n// California. The software program and documentation are supplied \"AS\n// IS\", without any accompanying services from The Regents. The Regents\n// does not warrant that the operation of the program will be\n// uninterrupted or error-free. The end-user understands that the program\n// was developed for research purposes and is advised not to rely\n// exclusively on the program for any reason.  IN NO EVENT SHALL THE\n// UNIVERSITY OF CALIFORNIA BE LIABLE TO ANY PARTY FOR DIRECT, INDIRECT,\n// SPECIAL, INCIDENTAL, OR CONSEQUENTIAL DAMAGES, INCLUDING LOST PROFITS,\n// ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION, EVEN IF\n// THE UNIVERSITY OF CALIFORNIA HAS BEEN ADVISED OF THE POSSIBILITY OF\n// SUCH DAMAGE. THE UNIVERSITY OF CALIFORNIA SPECIFICALLY DISCLAIMS ANY\n// WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\n// MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE SOFTWARE\n// PROVIDED HEREUNDER IS ON AN \"AS IS\" BASIS, AND THE UNIVERSITY OF\n// CALIFORNIA HAS NO OBLIGATIONS TO PROVIDE MAINTENANCE, SUPPORT,\n// UPDATES, ENHANCEMENTS, OR MODIFICATIONS.\npackage org.argouml.uml.diagram.ui;\nimport java.awt.Color;\nimport java.awt.Graphics;\nimport java.awt.Point;\nimport java.awt.Rectangle;\nimport java.awt.event.MouseEvent;\nimport java.beans.PropertyChangeEvent;\nimport java.util.Collection;\nimport java.util.HashSet;\nimport java.util.Iterator;\nimport java.util.Set;\nimport java.util.Vector;\nimport org.apache.log4j.Logger;\nimport org.argouml.model.AddAssociationEvent;\nimport org.argouml.model.AttributeChangeEvent;\nimport org.argouml.model.Model;\nimport org.argouml.notation.NotationProviderFactory2;\nimport org.argouml.ui.ArgoJMenu;\nimport org.argouml.ui.targetmanager.TargetManager;\nimport org.argouml.uml.diagram.DiagramSettings;\nimport org.tigris.gef.base.Layer;\nimport org.tigris.gef.presentation.ArrowHead;\nimport org.tigris.gef.presentation.ArrowHeadComposite;\nimport org.tigris.gef.presentation.ArrowHeadDiamond;\nimport org.tigris.gef.presentation.ArrowHeadGreater;\nimport org.tigris.gef.presentation.ArrowHeadNone;\nimport org.tigris.gef.presentation.FigNode;\nimport org.tigris.gef.presentation.FigText;\n/**\n * This class represents the Fig of a binary association on a diagram.\n *\n */\npublic class FigAssociation extends FigEdgeModelElement {\n    private static final Logger LOG = Logger.getLogger(FigAssociation.class);\n    /**\n     * Group for the FigTexts concerning the source association end.\n     */\n    private FigAssociationEndAnnotation srcGroup;\n    /**\n     * Group for the FigTexts concerning the dest association end.\n     */\n    private FigAssociationEndAnnotation destGroup;\n    /**\n     * Group for the FigTexts concerning the name and stereotype of the\n     * association itself.\n     */\n    private FigTextGroup middleGroup;\n    private FigMultiplicity srcMult;\n    private FigMultiplicity destMult;\n    /**\n     * Don't call this constructor directly. It is public since this\n     * is necessary for loading. Use the FigAssociation(Object, Layer)\n     * constructor instead!\n     * @deprecated for 0.27.3 by tfmorris.  Use \n     * {@link #FigAssociation(Object, DiagramSettings)}.\n     */\n    @SuppressWarnings(\"deprecation\")\n    @Deprecated\n    public FigAssociation() {\n        super();\n        middleGroup = new FigTextGroup();\n        \n        //////////////////////////////////////////////////////////////////\n        // NOTE: If this needs to be updated during the deprecation period\n        // also update the constructor below\n        //////////////////////////////////////////////////////////////////\n        \n        // let's use groups to construct the different text sections at\n        // the association\n        if (getNameFig() != null) {\n            middleGroup.addFig(getNameFig());\n        }\n        \n        middleGroup.addFig(getStereotypeFig());\n        // Placed perpendicular to midpoint of edge\n        addPathItem(middleGroup,\n                new PathItemPlacement(this, middleGroup, 50, 25));\n        ArgoFigUtil.markPosition(this, 50, 0, 90, 25, Color.yellow);\n        \n        srcMult = new FigMultiplicity();\n        // Placed at a 45 degree angle close to the end\n        addPathItem(srcMult, \n                new PathItemPlacement(this, srcMult, 0, 5, 135, 5));\n        ArgoFigUtil.markPosition(this, 0, 5, 135, 5, Color.green);\n        \n        //////////////////////////////////////////////////////////////////\n        // NOTE: If this needs to be updated during the deprecation period\n        // also update the constructor below\n        //////////////////////////////////////////////////////////////////\n        \n        srcGroup = new FigAssociationEndAnnotation(this);\n        addPathItem(srcGroup, \n                new PathItemPlacement(this, srcGroup, 0, 5, -135, 5));\n        ArgoFigUtil.markPosition(this, 0, 5, -135, 5, Color.blue);\n        destMult = new FigMultiplicity();\n        addPathItem(destMult,\n                new PathItemPlacement(this, destMult, 100, -5, 45, 5));\n        ArgoFigUtil.markPosition(this, 100, -5, 45, 5, Color.red);\n        \n        //////////////////////////////////////////////////////////////////\n        // NOTE: If this needs to be updated during the deprecation period\n        // also update the constructor below\n        //////////////////////////////////////////////////////////////////\n                \n        destGroup = new FigAssociationEndAnnotation(this);\n        addPathItem(destGroup,\n                new PathItemPlacement(this, destGroup, 100, -5, -45, 5));\n        ArgoFigUtil.markPosition(this, 100, -5, -45, 5, Color.orange);\n                \n        setBetweenNearestPoints(true);\n    }\n    /**\n     * Constructor used by PGML parser.\n     * \n     * @param owner owning uml element\n     * @param settings rendering settings\n     */\n    public FigAssociation(Object owner, DiagramSettings settings) {\n        super(owner, settings);\n        \n        createNameLabel(owner, settings);\n        \n        Object[] ends = // UML objects of AssociationEnd type\n            Model.getFacade().getConnections(owner).toArray();\n        \n        srcMult = new FigMultiplicity(ends[0], settings);\n        addPathItem(srcMult, \n                new PathItemPlacement(this, srcMult, 0, 5, 135, 5));\n        ArgoFigUtil.markPosition(this, 0, 5, 135, 5, Color.green);\n        \n        srcGroup = new FigAssociationEndAnnotation(this, ends[0], settings);\n        addPathItem(srcGroup, \n                new PathItemPlacement(this, srcGroup, 0, 5, -135, 5));\n        ArgoFigUtil.markPosition(this, 0, 5, -135, 5, Color.blue);\n        destMult = new FigMultiplicity(ends[1], settings);\n        addPathItem(destMult,\n                new PathItemPlacement(this, destMult, 100, -5, 45, 5));\n        ArgoFigUtil.markPosition(this, 100, -5, 45, 5, Color.red);\n        \n        destGroup = new FigAssociationEndAnnotation(this, ends[1], settings);\n        addPathItem(destGroup,\n                new PathItemPlacement(this, destGroup, 100, -5, -45, 5));\n        ArgoFigUtil.markPosition(this, 100, -5, -45, 5, Color.orange);\n        setBetweenNearestPoints(true);\n        \n        initializeNotationProvidersInternal(owner);\n    }\n    \n    /**\n     * Constructor that hooks the Fig to an existing UML element.\n     *\n     * @param edge the UML element\n     * @param lay the layer\n     * @deprecated for 0.27.3 by tfmorris.  Use \n     * {@link #FigAssociation(Object, DiagramSettings)}.\n     */\n    @Deprecated\n    public FigAssociation(Object edge, Layer lay) {\n        this();\n        setOwner(edge);\n        setLayer(lay);\n    }\n    /**\n     * Create the main draggable label for the association.\n     * This can be overridden in subclasses to change behaviour.\n     * TODO: Consider introducing this to FigEdgeModelElement and\n     * using throughout all edges.\n     * \n     * @param owner owning uml element\n     * @param settings rendering settings\n     */\n    protected void createNameLabel(Object owner, DiagramSettings settings) {\n        middleGroup = new FigTextGroup(owner, settings);\n     \n        // let's use groups to construct the different text sections at\n        // the association\n        if (getNameFig() != null) {\n            middleGroup.addFig(getNameFig());\n        }\n        middleGroup.addFig(getStereotypeFig());\n        addPathItem(middleGroup,\n                new PathItemPlacement(this, middleGroup, 50, 25));\n        ArgoFigUtil.markPosition(this, 50, 0, 90, 25, Color.yellow);\n    }\n    \n    /**\n     * Set the owner.\n     * \n     * @param owner ignored\n     * @see org.argouml.uml.diagram.ui.FigEdgeModelElement#setOwner(java.lang.Object)\n     * @deprecated for 0.27.3 by tfmorris.  Set the owner in the constructor.\n     */\n    @SuppressWarnings(\"deprecation\")\n    @Deprecated\n    @Override\n    public void setOwner(Object owner) {\n        super.setOwner(owner);\n        \n        Object[] ends = \n            Model.getFacade().getConnections(owner).toArray();\n        \n        Object source = ends[0];\n        Object dest = ends[1];\n        \n        srcGroup.setOwner(source);\n        srcMult.setOwner(source);\n        \n        destGroup.setOwner(dest);\n        destMult.setOwner(dest);\n    }\n    @Override\n    public void renderingChanged() {\n        super.renderingChanged();\n        /* This fixes issue 4987: */\n        srcMult.renderingChanged();\n        destMult.renderingChanged();\n        srcGroup.renderingChanged();\n        destGroup.renderingChanged();\n        middleGroup.renderingChanged();\n    }\n    @Override\n    protected void initNotationProviders(Object own) {\n        initializeNotationProvidersInternal(own);\n    }\n    private void initializeNotationProvidersInternal(Object own) {\n        super.initNotationProviders(own);\n        srcMult.initNotationProviders();\n        destMult.initNotationProviders();\n    }\n    /*\n     * @see org.argouml.uml.diagram.ui.FigEdgeModelElement#updateListeners(java.lang.Object, java.lang.Object)\n     */\n    @Override\n    public void updateListeners(Object oldOwner, Object newOwner) {\n        Set<Object[]> listeners = new HashSet<Object[]>();\n        if (newOwner != null) {\n            listeners.add(\n                    new Object[] {newOwner,\n                                  new String[] {\"isAbstract\", \"remove\"}\n                    });\n        }\n        updateElementListeners(listeners);\n        /* No further listeners required in this case - the rest is handled \n         * by the notationProvider and sub-Figs. */\n    }\n    /*\n     * @see org.argouml.uml.diagram.ui.FigEdgeModelElement#getNotationProviderType()\n     */\n    @Override\n    protected int getNotationProviderType() {\n        return NotationProviderFactory2.TYPE_ASSOCIATION_NAME;\n    }\n    /*\n     * @see org.argouml.uml.diagram.ui.FigEdgeModelElement#textEdited(org.tigris.gef.presentation.FigText)\n     */\n    @Override\n    protected void textEdited(FigText ft) {\n        if (getOwner() == null) {\n            return;\n        }\n        super.textEdited(ft);\n        \n        Collection conn = Model.getFacade().getConnections(getOwner());\n        if (conn == null || conn.size() == 0) {\n            return;\n        }\n\tif (ft == srcGroup.getRole()) {\n\t    srcGroup.getRole().textEdited();\n\t} else if (ft == destGroup.getRole()) {\n\t    destGroup.getRole().textEdited();\n\t} else if (ft == srcMult) {\n            srcMult.textEdited();\n\t} else if (ft == destMult) {\n            destMult.textEdited();\n\t}\n    }\n    /*\n     * @see org.argouml.uml.diagram.ui.FigEdgeModelElement#textEditStarted(org.tigris.gef.presentation.FigText)\n     */\n    @Override\n    protected void textEditStarted(FigText ft) {\n        if (ft == srcGroup.getRole()) {\n            srcGroup.getRole().textEditStarted();\n        } else if (ft == destGroup.getRole()) {\n            destGroup.getRole().textEditStarted();\n        } else if (ft == srcMult) {\n            srcMult.textEditStarted();\n        } else if (ft == destMult) {\n            destMult.textEditStarted();\n        } else {\n            super.textEditStarted(ft);\n        }\n    }\n    /**\n     * Choose the arrowhead style for each end. <p>\n     * \n     * TODO: This is called from paint(). Would it not better \n     * be called from renderingChanged()?\n     */\n    protected void applyArrowHeads() {\n        if (srcGroup == null || destGroup == null) {\n            /* This only happens if model-change events arrive \n             * before we are completely constructed. */\n            return;\n        }\n        int sourceArrowType = srcGroup.getArrowType();\n        int destArrowType = destGroup.getArrowType();\n        if (!getSettings().isShowBidirectionalArrows()\n                && sourceArrowType > 2\n                && destArrowType > 2) {\n            sourceArrowType -= 3;\n            destArrowType -= 3;\n        }\n        \n        setSourceArrowHead(FigAssociationEndAnnotation\n                .ARROW_HEADS[sourceArrowType]);\n        setDestArrowHead(FigAssociationEndAnnotation\n                .ARROW_HEADS[destArrowType]);\n    }\n    \n    /*\n     * @see org.tigris.gef.ui.PopupGenerator#getPopUpActions(java.awt.event.MouseEvent)\n     */\n    @Override\n    public Vector getPopUpActions(MouseEvent me) {\n\tVector popUpActions = super.getPopUpActions(me);\n        /* Check if multiple items are selected: */\n        boolean ms = TargetManager.getInstance().getTargets().size() > 1;\n        /* None of the menu-items below apply\n         * when multiple modelelements are selected:*/\n        if (ms) {\n            return popUpActions;\n        }\n\t// x^2 + y^2 = r^2  (equation of a circle)\n\tPoint firstPoint = this.getFirstPoint();\n\tPoint lastPoint = this.getLastPoint();\n\tint length = getPerimeterLength();\n\tint rSquared = (int) (.3 * length);\n\t// max distance is set at 100 pixels, (rSquared = 100^2)\n\tif (rSquared > 100) {\n\t    rSquared = 10000;\n        } else {\n\t    rSquared *= rSquared;\n        }\n\tint srcDeterminingFactor =\n\t    getSquaredDistance(me.getPoint(), firstPoint);\n\tint destDeterminingFactor =\n\t    getSquaredDistance(me.getPoint(), lastPoint);\n\tif (srcDeterminingFactor < rSquared\n\t    && srcDeterminingFactor < destDeterminingFactor) {\n            ArgoJMenu multMenu =\n\t\tnew ArgoJMenu(\"menu.popup.multiplicity\");\n            multMenu.add(ActionMultiplicity.getSrcMultOne());\n            multMenu.add(ActionMultiplicity.getSrcMultZeroToOne());\n            multMenu.add(ActionMultiplicity.getSrcMultOneToMany());\n            multMenu.add(ActionMultiplicity.getSrcMultZeroToMany());\n            popUpActions.add(popUpActions.size() - getPopupAddOffset(),\n                    multMenu);\n            ArgoJMenu aggMenu = new ArgoJMenu(\"menu.popup.aggregation\");\n\t    aggMenu.add(ActionAggregation.getSrcAggNone());\n\t    aggMenu.add(ActionAggregation.getSrcAgg());\n\t    aggMenu.add(ActionAggregation.getSrcAggComposite());\n\t    popUpActions.add(popUpActions.size() - getPopupAddOffset(),\n                    aggMenu);\n\t} else if (destDeterminingFactor < rSquared) {\n            ArgoJMenu multMenu =\n\t\tnew ArgoJMenu(\"menu.popup.multiplicity\");\n\t    multMenu.add(ActionMultiplicity.getDestMultOne());\n\t    multMenu.add(ActionMultiplicity.getDestMultZeroToOne());\n\t    multMenu.add(ActionMultiplicity.getDestMultOneToMany());\n\t    multMenu.add(ActionMultiplicity.getDestMultZeroToMany());\n\t    popUpActions.add(popUpActions.size() - getPopupAddOffset(),\n                    multMenu);\n            ArgoJMenu aggMenu = new ArgoJMenu(\"menu.popup.aggregation\");\n\t    aggMenu.add(ActionAggregation.getDestAggNone());\n\t    aggMenu.add(ActionAggregation.getDestAgg());\n\t    aggMenu.add(ActionAggregation.getDestAggComposite());\n\t    popUpActions\n                    .add(popUpActions.size() - getPopupAddOffset(), aggMenu);\n\t}\n\t// else: No particular options for right click in middle of line\n\t// Options available when right click anywhere on line\n\tObject association = getOwner();\n\tif (association != null) {\n\t    // Navigability menu with suboptions built dynamically to\n\t    // allow navigability from atart to end, from end to start\n\t    // or bidirectional\n\t    Collection ascEnds = Model.getFacade().getConnections(association);\n            Iterator iter = ascEnds.iterator();\n\t    Object ascStart = iter.next();\n\t    Object ascEnd = iter.next();\n\t    if (Model.getFacade().isAClassifier(\n\t            Model.getFacade().getType(ascStart))\n                    && Model.getFacade().isAClassifier(\n                            Model.getFacade().getType(ascEnd))) {\n                ArgoJMenu navMenu =\n\t\t    new ArgoJMenu(\"menu.popup.navigability\");\n\t\tnavMenu.add(ActionNavigability.newActionNavigability(\n                    ascStart,\n\t\t    ascEnd,\n\t\t    ActionNavigability.BIDIRECTIONAL));\n\t\tnavMenu.add(ActionNavigability.newActionNavigability(\n                    ascStart,\n\t\t    ascEnd,\n\t\t    ActionNavigability.STARTTOEND));\n\t\tnavMenu.add(ActionNavigability.newActionNavigability(\n                    ascStart,\n                    ascEnd,\n                    ActionNavigability.ENDTOSTART));\n\t\tpopUpActions.add(popUpActions.size() - getPopupAddOffset(),\n                        navMenu);\n\t    }\n\t}\n\treturn popUpActions;\n    }\n    /**\n     * Updates the multiplicity fields.\n     */\n    protected void updateMultiplicity() {\n        if (getOwner() != null \n                && srcMult.getOwner() != null \n                && destMult.getOwner() != null) {\n            srcMult.setText();\n            destMult.setText();\n        }\n    }\n    /*\n     * @see org.tigris.gef.presentation.Fig#paint(java.awt.Graphics)\n     */\n    @Override\n    public void paint(Graphics g) {\n        if (getOwner() == null ) {\n            LOG.error(\"Trying to paint a FigAssociation without an owner. \");\n        } else {\n            applyArrowHeads(); \n        }\n        if (getSourceArrowHead() != null && getDestArrowHead() != null) {\n            getSourceArrowHead().setLineColor(getLineColor());\n            getDestArrowHead().setLineColor(getLineColor());\n        }\n        super.paint(g);\n    }\n    /*\n     * @see org.argouml.uml.diagram.ui.FigEdgeModelElement#paintClarifiers(java.awt.Graphics)\n     */\n    @Override\n    public void paintClarifiers(Graphics g) {\n        indicateBounds(getNameFig(), g);\n        indicateBounds(srcMult, g);\n        indicateBounds(srcGroup.getRole(), g);\n        indicateBounds(destMult, g);\n        indicateBounds(destGroup.getRole(), g);\n        super.paintClarifiers(g);\n    }\n    /**\n     * @return Returns the middleGroup.\n     */\n    protected FigTextGroup getMiddleGroup() {\n        return middleGroup;\n    }\n    \n    /**\n     * Lays out the association edges as any other edge except for\n     * special rules for an association that loops back to the same\n     * class. For this it is snapped back to the bottom right corner\n     * if it resized to the point of not being visible.\n     * @see org.tigris.gef.presentation.FigEdgePoly#layoutEdge()\n     */\n    @Override\n    protected void layoutEdge() {\n        FigNode sourceFigNode = getSourceFigNode();\n        Point[] points = getPoints();\n        if (points.length < 3\n                && sourceFigNode != null\n                && getDestFigNode() == sourceFigNode) {\n            Rectangle rect = new Rectangle(\n                    sourceFigNode.getX() + sourceFigNode.getWidth() - 20,\n                    sourceFigNode.getY() + sourceFigNode.getHeight() - 20,\n                    40,\n                    40);\n            points = new Point[5];\n            points[0] = new Point(rect.x, rect.y + rect.height / 2);\n            points[1] = new Point(rect.x, rect.y + rect.height);\n            points[2] = new Point(rect.x + rect.width , rect.y + rect.height);\n            points[3] = new Point(rect.x + rect.width , rect.y);\n            points[4] = new Point(rect.x + rect.width / 2, rect.y);\n            setPoints(points);\n        } else {\n            super.layoutEdge();\n        }\n    }\n    \n    /**\n     * If the name is updated, update the bounds of the middle group.\n     * This makes the selection box appear correctly during prop-panel edit.\n     * This is a temporary solution, until a better architecture is decided \n     * upon, see issue 5477 and \n     * http://argouml.tigris.org/issues/show_bug.cgi?id=5621#desc19.\n     * @see org.argouml.uml.diagram.ui.FigEdgeModelElement#updateNameText()\n     */\n    protected void updateNameText() {\n        super.updateNameText();\n        // TODO: Without the null check the following throws a NPE so many\n        // times when it is called from FigEdgeModelElement.modelChanged(),\n        // we need to think about it.\n        if (middleGroup != null) {\n            middleGroup.calcBounds();\n        }\n    }\n    \n    \n} /* end class FigAssociation */\n/**\n * A Fig representing the multiplicity of some model element.\n * This has potential reuse for other edges showing multiplicity. <p>\n * \n * The owner is an AssociationEnd.\n * \n * @author Bob Tarling\n */\nclass FigMultiplicity extends FigSingleLineTextWithNotation {\n    @SuppressWarnings(\"deprecation\")\n    @Deprecated\n    FigMultiplicity() {\n        super(X0, Y0, 90, 20, false, new String[] {\"multiplicity\"});\n        setTextFilled(false);\n        setJustification(FigText.JUSTIFY_CENTER);\n    }\n    FigMultiplicity(Object owner, DiagramSettings settings) {\n        super(owner, new Rectangle(X0, Y0, 90, 20), settings, false,\n                \"multiplicity\");\n        setTextFilled(false);\n        setJustification(FigText.JUSTIFY_CENTER);\n    }\n    @Override\n    protected int getNotationProviderType() {\n        return NotationProviderFactory2.TYPE_MULTIPLICITY;\n    }\n}\n/**\n * A textual Fig representing the ordering of some model element,\n * i.e. \"{ordered}\" or nothing.\n * This has potential reuse for other edges showing ordering. <p>\n * \n * This Fig is not editable by the user.\n * \n * @author Bob Tarling\n */\nclass FigOrdering extends FigSingleLineText {\n    private static final long serialVersionUID = 5385230942216677015L;\n    @SuppressWarnings(\"deprecation\")\n    @Deprecated\n    FigOrdering() {\n        super(X0, Y0, 90, 20, false, \"ordering\");\n        setTextFilled(false);\n        setJustification(FigText.JUSTIFY_CENTER);\n        setEditable(false);\n    }\n    \n    FigOrdering(Object owner, DiagramSettings settings) {\n        super(owner, new Rectangle(X0, Y0, 90, 20), settings, false, \n                \"ordering\");\n        setTextFilled(false);\n        setJustification(FigText.JUSTIFY_CENTER);\n        setEditable(false);\n    }\n    \n    @Override\n    protected void setText() {\n        assert getOwner() != null;\n        if (getSettings().getNotationSettings().isShowProperties()) {\n            setText(getOrderingName(Model.getFacade().getOrdering(getOwner())));\n        } else {\n            setText(\"\");\n        }\n        damage();\n    }\n    /**\n     * Returns the name of the OrderingKind.\n     *\n     * @param orderingKind the kind of ordering\n     * @return \"{ordered}\" or \"\", the latter if null or unordered\n     */\n    private String getOrderingName(Object orderingKind) {\n        if (orderingKind == null) {\n            return \"\";\n        }\n        if (Model.getFacade().getName(orderingKind) == null) {\n            return \"\";\n        }\n        if (\"\".equals(Model.getFacade().getName(orderingKind))) {\n            return \"\";\n        }\n        if (\"unordered\".equals(Model.getFacade().getName(orderingKind))) {\n            return \"\";\n        }\n        // TODO: I18N\n        return \"{\" + Model.getFacade().getName(orderingKind) + \"}\";\n    }\n}\n/**\n * A Fig representing the association end role of some model element.\n * \n * @author Bob Tarling\n */\nclass FigRole extends FigSingleLineTextWithNotation {\n    /**\n     * @deprecated for 0.27.3 by tfmorris.  Use \n     * {@link FigRole#FigRole(Object, DiagramSettings)}/\n     */\n    @SuppressWarnings(\"deprecation\")\n    @Deprecated\n    FigRole() {\n        super(X0, Y0, 90, 20, false, (String[]) null \n        // no need to listen to these property changes - the \n        // notationProvider takes care of registering these.\n                /*, new String[] {\"name\", \"visibility\", \"stereotype\"}*/\n                );\n        setTextFilled(false);\n        setJustification(FigText.JUSTIFY_CENTER);\n    }\n    \n    FigRole(Object owner, DiagramSettings settings) {\n        super(owner, new Rectangle(X0, Y0, 90, 20), settings, false, \n                (String[]) null \n        // no need to listen to these property changes - the \n        // notationProvider takes care of this.\n                /*, new String[] {\"name\", \"visibility\", \"stereotype\"}*/\n                );\n        setTextFilled(false);\n        setJustification(FigText.JUSTIFY_CENTER);\n        setText();\n    }\n    protected int getNotationProviderType() {\n        return NotationProviderFactory2.TYPE_ASSOCIATION_END_NAME;\n    }\n    \n    /**\n     * Property change listener to recalculate bounds of enclosing\n     * group whenever any properties of the FigRole get changed.\n     * This is only really needed for the name, see issue 5621.\n     * @param pce The property change event to process.\n     * @see org.argouml.uml.diagram.ui.FigSingleLineTextWithNotation#propertyChange(java.beans.PropertyChangeEvent)\n     */\n    @Override\n    public void propertyChange(PropertyChangeEvent pce) {\n        super.propertyChange(pce);\n        this.getGroup().calcBounds();\n    }\n}\n/**\n * The arrowhead and the group of labels shown at the association end: \n * the role name and the ordering property. \n * This does not include the multiplicity. <p>\n * \n * This class does not yet support arrows for a FigAssociationEnd, \n * as is used for N-ary associations.\n */\nclass FigAssociationEndAnnotation extends FigTextGroup {\n    private static final long serialVersionUID = 1871796732318164649L;\n    \n    private static final ArrowHead NAV_AGGR =\n        new ArrowHeadComposite(ArrowHeadDiamond.WhiteDiamond,\n                   new ArrowHeadGreater());\n    private static final ArrowHead NAV_COMP =\n        new ArrowHeadComposite(ArrowHeadDiamond.BlackDiamond,\n                   new ArrowHeadGreater());\n    // These are a list of arrow types. Positioning is important as we subtract\n    // 3 to convert a navigable arrow to a non navigable with the same\n    // aggregation\n    private static final int NONE = 0;\n    private static final int AGGREGATE = 1;\n    private static final int COMPOSITE = 2;\n    private static final int NAV_NONE = 3;\n    private static final int NAV_AGGREGATE = 4;\n    private static final int NAV_COMPOSITE = 5;\n    \n    /**\n     * All the arrow head types.\n     */\n    public static final ArrowHead[] ARROW_HEADS = new ArrowHead[6];\n    static {\n        ARROW_HEADS[NONE] = ArrowHeadNone.TheInstance;\n        ARROW_HEADS[AGGREGATE] = ArrowHeadDiamond.WhiteDiamond;\n        ARROW_HEADS[COMPOSITE] = ArrowHeadDiamond.BlackDiamond;\n        ARROW_HEADS[NAV_NONE] = new ArrowHeadGreater();\n        ARROW_HEADS[NAV_AGGREGATE] = NAV_AGGR;\n        ARROW_HEADS[NAV_COMPOSITE] = NAV_COMP;\n    }\n    \n    private FigRole role;\n    private FigOrdering ordering;\n    private int arrowType = 0;\n    private FigEdgeModelElement figEdge;\n    @SuppressWarnings(\"deprecation\")\n    @Deprecated\n    FigAssociationEndAnnotation(FigEdgeModelElement edge) {\n        figEdge = edge;\n        \n", "answers": ["        role = new FigRole();"], "incorrect_answer": "role = new DiagramRole();"}, {"input": "", "context": "// \n// Copyright (c) 2004-2006 Jaroslaw Kowalski <jaak@jkowalski.net>\n// \n// All rights reserved.\n// \n// Redistribution and use in source and binary forms, with or without \n// modification, are permitted provided that the following conditions \n// are met:\n// \n// * Redistributions of source code must retain the above copyright notice, \n//   this list of conditions and the following disclaimer. \n// \n// * Redistributions in binary form must reproduce the above copyright notice,\n//   this list of conditions and the following disclaimer in the documentation\n//   and/or other materials provided with the distribution. \n// \n// * Neither the name of Jaroslaw Kowalski nor the names of its \n//   contributors may be used to endorse or promote products derived from this\n//   software without specific prior written permission. \n// \n// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n// AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE \n// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE \n// ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE \n// LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR \n// CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n// SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS \n// INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN \n// CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) \n// ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF \n// THE POSSIBILITY OF SUCH DAMAGE.\n// \n#if !NETCF\nusing System;\nusing System.Reflection;\nusing System.Diagnostics;\nusing System.Collections;\nusing NLog.Internal;\nusing NLog.Config;\nusing System.Collections.Generic;\nnamespace NLog.Win32.Targets\n{\n    /// <summary>\n    /// Increments specified performance counter on each write.\n    /// </summary>\n    /// <example>\n    /// <p>\n    /// To set up the target in the <a href=\"config.html\">configuration file</a>, \n    /// use the following syntax:\n    /// </p>\n    /// <code lang=\"XML\" src=\"examples/targets/Configuration File/PerfCounter/NLog.config\" />\n    /// <p>\n    /// This assumes just one target and a single rule. More configuration\n    /// options are described <a href=\"config.html\">here</a>.\n    /// </p>\n    /// <p>\n    /// To set up the log target programmatically use code like this:\n    /// </p>\n    /// <code lang=\"C#\" src=\"examples/targets/Configuration API/PerfCounter/Simple/Example.cs\" />\n    /// </example>\n    /// <remarks>\n    /// TODO:\n    /// 1. Unable to create a category allowing multiple counter instances (.Net 2.0 API only, probably)\n    /// 2. Is there any way of adding new counters without deleting the whole category?\n    /// 3. There should be some mechanism of resetting the counter (e.g every day starts from 0), or auto-switching to \n    ///    another counter instance (with dynamic creation of new instance). This could be done with layouts. \n    /// </remarks>\n    [Target(\"PerfCounter\")]\n    [SupportedRuntime(OS=RuntimeOS.WindowsNT,Framework=RuntimeFramework.DotNetFramework)]\n    public class PerfCounterTarget : Target\n    {\n        private bool _autoCreate = false;\n        private string _categoryName;\n        private string _counterName;\n        private string _instanceName = \"\";\n        private PerformanceCounterType _counterType = PerformanceCounterType.NumberOfItems32;\n\t\tprivate static List<PerfCounterTarget> _perfCounterTargets = new List<PerfCounterTarget>();\n        private PerformanceCounter _perfCounter = null;\n        private bool _operational = true;\n            \n        /// <summary>\n        /// Creates a new instance of <see cref=\"PerfCounterTarget\"/>.\n        /// </summary>\n        public PerfCounterTarget()\n        {\n            lock(_perfCounterTargets)\n            {\n                if (!_perfCounterTargets.Contains(this)) _perfCounterTargets.Add(this);\n            }\n        }\n        /// <summary>\n        /// Increments the configured performance counter.\n        /// </summary>\n        /// <param name=\"logEvent\">log event</param>\n        public override void Write(LogEventInfo logEvent)\n        {\n            if (!_operational) return;\n            if (_perfCounter == null) InitializePerfCounter();\n            if (_perfCounter == null) return; //not operational\n            \n            bool ok = false;\n            try \n            {\n                _perfCounter.Increment();\n                ok = true;\n            }\n            finally\n            {\n                _operational = ok;\n            }\n        }\n        \n        /// <summary>\n        /// Whether performance counter should be automatically created.\n        /// </summary>\n        public bool AutoCreate\n        {\n            get {return _autoCreate; }\n            set {_autoCreate = value; }\n        }\n        \n        /// <summary>\n        /// Performance counter category.\n        /// </summary>\n        [RequiredParameter]\n        public string CategoryName\n        {\n            get {return _categoryName; }\n            set {_categoryName = value; }\n        }\n        \n        /// <summary>\n        /// Name of the performance counter.\n        /// </summary>\n        [RequiredParameter]\n        public string CounterName\n        {\n            get {return _counterName; }\n            set {_counterName = value; }\n        }\n        \n        /// <summary>\n        /// Instance name.\n        /// </summary>\n        public string InstanceName\n        {\n            get {return _instanceName; }\n            set {_instanceName = value; }\n        }\n        \n        /// <summary>\n        /// Performance counter type.\n        /// </summary>\n        public PerformanceCounterType CounterType\n        {\n            get { return _counterType; }\n            set { _counterType = value; }\n        }\n        \n        private void InitializePerfCounter()\n        {\n            lock(this)\n            {\n                _operational = true;\n                try\n                {\n                    if (_perfCounter != null) { _perfCounter.Close(); _perfCounter = null; }\n                    if (_categoryName == null || _counterName == null) \n                    {\n                        throw new Exception(\"Missing category name or counter name for target: \" + Name);\n                    }\n                    \n                    if (!PerformanceCounterCategory.Exists(CategoryName) || !PerformanceCounterCategory.CounterExists(CounterName, CategoryName))\n                    {\n\t\t\t\t\t\tList<PerfCounterTarget> targets = new List<PerfCounterTarget>();\n                        bool doCreate = false;\n                        foreach(PerfCounterTarget t in _perfCounterTargets)\n                        {\n                            if (t.CategoryName == CategoryName)\n                            {\n                                targets.Add(t);\n                                if (t.AutoCreate) doCreate = true;\n                            }\n                        }\n                        \n                        if (doCreate)\n                        {\n                            if (PerformanceCounterCategory.Exists(CategoryName))\n                            {\n                                //delete the whole category and rebuild from scratch\n                                PerformanceCounterCategory.Delete(CategoryName);\n                            }\n                            \n                            CounterCreationDataCollection ccds = new CounterCreationDataCollection();\n                            foreach(PerfCounterTarget t in targets)\n                            {\n                                CounterCreationData ccd = new CounterCreationData();\n                                ccd.CounterName = t._counterName;\n                                ccd.CounterType = t._counterType;  \n                                ccds.Add(ccd);                                    \n                            }\n#if DOTNET_2_0\n                            PerformanceCounterCategory.Create(CategoryName,\n                                \"Category created by NLog\",\n                                (InstanceName != null) ? PerformanceCounterCategoryType.MultiInstance : PerformanceCounterCategoryType.SingleInstance,\n                                ccds);\n#else\n                            PerformanceCounterCategory.Create(CategoryName,\"Category created by NLog\",ccds);\n#endif\n                        }\n                        else\n                        {\n                            throw new Exception(string.Format(\"Counter does not exist: {0}|{1}\", CounterName, CategoryName));\n                        }\n                    }\n                    \n                    _perfCounter = new PerformanceCounter(CategoryName, CounterName, InstanceName, false);\n                    _operational = true;\n                }\n                catch(Exception ex)\n                {\n                    _operational = false;\n                    _perfCounter = null;\n", "answers": ["                    if (LogManager.ThrowExceptions) throw ex;"], "incorrect_answer": "if (!LogManager.ThrowExceptions) return;"}, {"input": "", "context": "import subprocess\nimport cfg\nimport util\nimport shutil\nimport os\nimport time\nimport tempfile\nimport easywebdav\nimport filecmp\nimport threading\nimport Queue\nimport sys\nimport random\nimport hashlib\nfrom nose.tools import with_setup\nfrom nose.tools import assert_raises\n#\n# NOTE: following tests have been implemented using easywebdav instead of davfs2\n#\npjoin = os.path.join\nassert subprocess # pyflakes\nassert cfg # pyflakes\n@with_setup(util.setup_func, util.teardown_func)\ndef test_case_01_get():\n    full_name = pjoin(cfg.webdav_backend_directory, \"foo\")\n    subprocess.call([\"dd\",\"if=/dev/urandom\",'of=%s' % full_name,\"bs=100kB\",\"count=10\"],\n                    stderr=util.FNULL)\n    # could be as well a list\n    # Im using a queue here to make sure it's thread safe\n    test_fails = Queue.Queue()\n    def download_foo(c):\n        try:\n            with tempfile.NamedTemporaryFile() as f:\n                c.download(\"foo\",f) \n                f.flush()\n                assert filecmp.cmp(full_name, f.name)\n        except Exception:\n            test_fails.put( sys.exc_info() )\n    connections = [util.connect_easywebdav() for _ in range(100)]\n    ts = [threading.Thread(target=download_foo,args=(c,) )\n            for c in connections ]\n    for t in ts:\n        t.start()\n    for t in ts:\n        t.join()\n    try:\n        while True:\n            exc = test_fails.get(block=False)\n            raise exc[0], exc[1], exc[2]\n    except Queue.Empty:\n        pass\n@with_setup(util.setup_func, util.teardown_func)\ndef test_case_02_mkcol():\n    # could be as well a list\n    # Im using a queue here to make sure it's thread safe\n    test_fails = Queue.Queue()\n    def mkcol_foo(c):\n        try:\n            try:\n                c.mkdir(\"foo\")\n            except easywebdav.OperationFailed:\n                pass\n        except Exception:\n            test_fails.put( sys.exc_info() )\n    connections = [util.connect_easywebdav() for _ in range(100)]\n    ts = [threading.Thread(target=mkcol_foo,args=(c,) )\n            for c in connections ]\n    for t in ts:\n        t.start()\n    for t in ts:\n        t.join()\n    try:\n        while True:\n            exc = test_fails.get(block=False)\n            raise exc[0], exc[1], exc[2]\n    except Queue.Empty:\n        pass\n    assert os.path.isdir( pjoin( cfg.webdav_backend_directory, \"foo\") )\n@with_setup(util.setup_func, util.teardown_func)\ndef test_case_03_mkcol_different():\n    # could be as well a list\n    # Im using a queue here to make sure it's thread safe\n    test_fails = Queue.Queue()\n    def mkcol(c,name):\n        try:\n            c.mkdir(name)\n        except Exception:\n            test_fails.put( sys.exc_info() )\n    connections = [util.connect_easywebdav() for _ in range(100)]\n    ts = [threading.Thread(target=mkcol, args=(c,\"foo%d\" % i) )\n            for i,c in enumerate(connections) ]\n    for t in ts:\n        t.start()\n    for t in ts:\n        t.join()\n    try:\n        while True:\n            exc = test_fails.get(block=False)\n            raise exc[0], exc[1], exc[2]\n    except Queue.Empty:\n        pass\n    for i in range(100):\n        assert os.path.isdir( pjoin( cfg.webdav_backend_directory, \"foo%d\" %i) )\n@with_setup(util.setup_func, util.teardown_func)\ndef test_case_04_put():\n    # could be as well a list\n    # Im using a queue here to make sure it's thread safe\n    test_fails = Queue.Queue()\n    checksums = Queue.Queue()\n    def put(c):\n        try:\n            with tempfile.TemporaryFile() as f:\n                rand_1mb = ''.join( [ chr( random.randint(0,100) ) for _ in range(1024*1024) ] )\n                f.write(rand_1mb)\n                f.seek(0)\n                c.upload(f, \"foo\")\n                m = hashlib.md5()\n                m.update( rand_1mb )\n                checksums.put( m.digest() )\n        except Exception:\n            test_fails.put( sys.exc_info() )\n    connections = [util.connect_easywebdav() for _ in range(10)]\n    ts = [threading.Thread(target=put, args=(c,) )\n            for c in connections ]\n    for t in ts:\n        t.start()\n    for t in ts:\n        t.join()\n    try:\n        while True:\n            exc = test_fails.get(block=False)\n            raise exc[0], exc[1], exc[2]\n    except Queue.Empty:\n        pass\n    full_name = pjoin( cfg.webdav_backend_directory, \"foo\" )\n    assert os.path.isfile( full_name )\n    with open(full_name, \"rb\") as f:\n        m = hashlib.md5()\n        m.update( f.read() )\n        expected_checksum = m.digest()\n    while True:\n        try:\n            checksum = checksums.get(block=False)\n            if checksum == expected_checksum:\n                break\n        except Queue.Empty:\n            assert False # file uploaded doesn't match any of the orig files!\n@with_setup(util.setup_func, util.teardown_func)\ndef test_case_05_put_diff():\n    # could be as well a list\n    # Im using a queue here to make sure it's thread safe\n    test_fails = Queue.Queue()\n    checksums = Queue.Queue()\n    def put(c,name):\n        try:\n            with tempfile.TemporaryFile() as f:\n                rand_1mb = ''.join( [ chr( random.randint(0,100) ) for _ in range(1024*1024) ] )\n                f.write(rand_1mb)\n                f.seek(0)\n                c.upload(f, name)\n                m = hashlib.md5()\n                m.update( rand_1mb )\n                checksums.put( (name,m.digest()) )\n        except Exception:\n            test_fails.put( sys.exc_info() )\n    connections = [util.connect_easywebdav() for _ in range(10)]\n    ts = [threading.Thread(target=put, args=(c,\"foo-%d\" % i) )\n            for i,c in enumerate(connections) ]\n    for t in ts:\n        t.start()\n    for t in ts:\n        t.join()\n    try:\n        while True:\n            exc = test_fails.get(block=False)\n            raise exc[0], exc[1], exc[2]\n    except Queue.Empty:\n        pass\n    \n    assert checksums.qsize() == 10\n    try:\n        while True:\n", "answers": ["            name, checksum = checksums.get(block=False)"], "incorrect_answer": "error_code, hash_value = checksums.get(block=False)"}, {"input": "", "context": "# This library is free software; you can redistribute it and/or modify\n# it under the terms of the GNU Lesser General Public License as\n# published by the Free Software Foundation; either version 3 of the\n# License, or (at your option) any later version.\n#\n# This library is distributed in the hope that it will be useful, but\n# WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n# Lesser General Public License for more details.\n#\n# You should have received a copy of the GNU Lesser General Public\n# License along with this library; if not, see\n# <http://www.gnu.org/licenses/>.\n\"\"\"\nsibilant.pseudops.stack\nStack counting utilities for sibiliant pseudops blocks\nauthor: Christopher O'Brien <obriencj@gmail.com>\nlicense: LGPL v.3\n\"\"\"\nfrom . import Pseudop, Opcode\nfrom ..lib import SibilantException\n__all__ = (\n    \"StackCounter\", \"StackUnderrun\", \"StackMismatch\",\n    \"stacker\", \"stacking\",\n    \"stacking_pop_args_push\", \"stacking_push_args_pop\",\n)\nclass StackUnderrun(SibilantException):\n    def __init__(self, stack_size, pop_size):\n        self.start_size = stack_size\n        self.pop_size = pop_size\n        msg = \"stack size underrun, %i decremented by %i\"\n        super().__init__(msg % (stack_size, pop_size))\nclass StackMismatch(SibilantException):\n    def __init__(self, label, label_size, jump_size):\n        self.label = label\n        self.label_size = label_size\n        self.jump_size = jump_size\n        msg = \"mismatch between label %r stack: %i and origin stack: %i\"\n        super().__init__(msg % (label, label_size, jump_size))\nclass MetaStackCounter(type):\n    def __init__(self, name, bases, members):\n        # the _translations_ member is merged together with those of\n        # the bases, to provide a sort of inheritance.\n        stk = {}\n        for base in bases:\n            stk.update(getattr(base, \"_stackers_\", {}))\n        stk.update(members.get(\"_stackers_\", {}))\n        # we also hunt for decorated callable members to inject into\n        # the _stackers_\n        for memb in members.values():\n            if callable(memb):\n                trop = getattr(memb, \"_stacks_\", None)\n                if trop is not None:\n                    stk[trop] = memb\n        members[\"_stackers_\"] = stk\n        self._stackers_ = stk\n        return super().__init__(name, bases, members)\ndef stacker(pseudop):\n    def decorator(member):\n        member._stacks_ = pseudop\n        return member\n    return decorator\ndef stacking(pushc, popc):\n    def pop_then_push(self, pseudop, args, push, pop):\n        if popc:\n            pop(popc)\n        if pushc:\n            push(pushc)\n    return pop_then_push\ndef stacking_pop_args_push(pushc):\n    def pop_args_then_push(self, pseudop, args, push, pop):\n        pop(args[0])\n        if pushc:\n            push(pushc)\n    return pop_args_then_push\ndef stacking_push_args_pop(popc):\n    def pop_then_push_args(self, pseudops, args, push, pop):\n        if popc:\n            pop(popc)\n        push(args[0])\n    return pop_then_push_args\nclass StackCounter(metaclass=MetaStackCounter):\n    _stackers_ = {\n        Pseudop.POSITION: stacking(0, 0),\n        Pseudop.DEL_VAR: stacking(0, 0),\n        Pseudop.DEL_GLOBAL: stacking(0, 0),\n        Pseudop.ROT_TWO: stacking(0, 0),\n        Pseudop.ROT_THREE: stacking(0, 0),\n        Pseudop.CONST: stacking(1, 0),\n        Pseudop.DUP: stacking(1, 0),\n        Pseudop.GET_VAR: stacking(1, 0),\n        Pseudop.GET_GLOBAL: stacking(1, 0),\n        Pseudop.BREAK_LOOP: stacking(1, 0),\n        Pseudop.FOR_ITER: stacking(1, 0),\n        Pseudop.IMPORT_FROM: stacking(1, 0),\n        Pseudop.CONTINUE_LOOP: stacking(1, 0),\n        Pseudop.LOAD_CELL: stacking(1, 0),\n        Pseudop.GET_ATTR: stacking(1, 1),\n        Pseudop.UNARY_POSITIVE: stacking(1, 1),\n        Pseudop.UNARY_NEGATIVE: stacking(1, 1),\n        Pseudop.UNARY_NOT: stacking(1, 1),\n        Pseudop.UNARY_INVERT: stacking(1, 1),\n        Pseudop.ITER: stacking(1, 1),\n        Pseudop.GET_YIELD_FROM_ITER: stacking(1, 1),\n        Pseudop.GET_AWAITABLE: stacking(1, 1),\n        Pseudop.YIELD_VAL: stacking(1, 1),\n        Pseudop.COMPARE_OP: stacking(1, 2),\n        Pseudop.GET_ITEM: stacking(1, 2),\n        Pseudop.BINARY_ADD: stacking(1, 2),\n        Pseudop.BINARY_SUBTRACT: stacking(1, 2),\n        Pseudop.BINARY_MULTIPLY: stacking(1, 2),\n        Pseudop.BINARY_MATRIX_MULTIPLY: stacking(1, 2),\n        Pseudop.BINARY_TRUE_DIVIDE: stacking(1, 2),\n        Pseudop.BINARY_FLOOR_DIVIDE: stacking(1, 2),\n        Pseudop.BINARY_POWER: stacking(1, 2),\n        Pseudop.BINARY_MODULO: stacking(1, 2),\n        Pseudop.BINARY_LSHIFT: stacking(1, 2),\n        Pseudop.BINARY_RSHIFT: stacking(1, 2),\n        Pseudop.BINARY_AND: stacking(1, 2),\n        Pseudop.BINARY_XOR: stacking(1, 2),\n        Pseudop.BINARY_OR: stacking(1, 2),\n        Pseudop.IMPORT_NAME: stacking(1, 2),\n        Pseudop.SET_ATTR: stacking(0, 2),\n        Pseudop.DEL_ITEM: stacking(0, 2),\n        Pseudop.SET_ITEM: stacking(0, 3),\n        Pseudop.POP: stacking(0, 1),\n        Pseudop.DEL_ATTR: stacking(0, 1),\n        Pseudop.SET_GLOBAL: stacking(0, 1),\n        Pseudop.SET_LOCAL: stacking(0, 1),\n        Pseudop.SET_VAR: stacking(0, 1),\n        Pseudop.RET_VAL: stacking(0, 1),\n        Pseudop.YIELD_FROM: stacking(1, 2),\n        Pseudop.SETUP_EXCEPT: stacking(6, 0),\n        Pseudop.POP_EXCEPT: stacking(0, 3),\n        Pseudop.SETUP_WITH: stacking(6, 0),\n        Pseudop.WITH_CLEANUP_START: stacking(7, 0),\n        Pseudop.WITH_CLEANUP_FINISH: stacking(0, 7),\n        Pseudop.SETUP_FINALLY: stacking(6, 0),\n        Pseudop.END_FINALLY: stacking(0, 6),\n        Pseudop.BUILD_LIST: stacking_pop_args_push(1),\n        Pseudop.BUILD_SET: stacking_pop_args_push(1),\n        Pseudop.BUILD_TUPLE: stacking_pop_args_push(1),\n        Pseudop.BUILD_TUPLE_UNPACK: stacking_pop_args_push(1),\n        Pseudop.BUILD_MAP_UNPACK: stacking_pop_args_push(1),\n        Pseudop.BUILD_SLICE: stacking_pop_args_push(1),\n        Pseudop.RAISE: stacking_pop_args_push(1),\n        Pseudop.FAUX_POP: stacking_pop_args_push(0),\n        Pseudop.UNPACK_SEQUENCE: stacking_push_args_pop(1),\n        Pseudop.FAUX_PUSH: stacking_push_args_pop(0),\n    }\n    # @stacker(Pseudop.LAMBDA)\n    # def stacks_lambda(self, pseudop, args, push, pop):\n    #    pop(args[1])\n    #    a = len(args[0].co_freevars)\n    #    if a:\n    #        push(a)\n    #        pop(a)\n    #    push(2)\n    #    pop(2)\n    #    push()\n    @stacker(Pseudop.BUILD_MAP)\n    def stacker_build_map(self, pseudop, args, push, pop):\n        pop(args[0] * 2)\n        push()\n    @stacker(Pseudop.UNPACK_EX)\n    def stacker_unpack_ex(self, pseudop, args, push, pop):\n        pop()\n        push(args[0] + args[1] + 1)\n    @stacker(Pseudop.SETUP_LOOP)\n    def stacker_setup_loop(self, pseudop, args, push, pop):\n        push(Opcode.SETUP_LOOP.stack_effect(1))\n    @stacker(Pseudop.POP_BLOCK)\n    def stacker_pop_block(self, pseudop, args, push, pop):\n        push(Opcode.POP_BLOCK.stack_effect())\n    @stacker(Pseudop.LABEL)\n    def stacker_label(self, pseudop, args, push, pop):\n        stac = self.stack_count\n        stac = self.labels.setdefault(args[0], stac)\n        self.stack_count = stac\n    @stacker(Pseudop.BLOCK)\n    def stacker_block(self, pseudop, args, push, pop):\n        block = args[0]\n        block_i, block_max = block.max_stack(self.compiler)\n        push(block_max)\n        pop(block_max)\n    @stacker(Pseudop.JUMP)\n    def stacker_jump(self, pseudop, args, push, pop):\n        stac = self.stack_count\n", "answers": ["        dest = args[0]"], "incorrect_answer": "dest = args[1]"}, {"input": "", "context": "# Copyright (c) 2011-2015 Rusty Wagner\n#\n# This program is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# (at your option) any later version.\n#\n# This program is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with this program.  If not, see <http://www.gnu.org/licenses/>.\nfrom BinaryData import *\nfrom Structure import *\nfrom HexEditor import *\nfrom View import *\nclass ElfFile(BinaryAccessor):\n\tdef __init__(self, data):\n\t\tself.data = data\n\t\tself.valid = False\n\t\tself.callbacks = []\n\t\tself.symbols_by_name = {}\n\t\tself.symbols_by_addr = {}\n\t\tif not self.is_elf():\n\t\t\treturn\n\t\ttry:\n\t\t\tself.tree = Structure(self.data)\n\t\t\tself.header = self.tree.struct(\"ELF header\", \"header\")\n\t\t\tself.header.struct(\"ELF identification\", \"ident\")\n\t\t\tself.header.ident.uint32(\"magic\")\n\t\t\tself.header.ident.uint8(\"file_class\")\n\t\t\tself.header.ident.uint8(\"encoding\")\n\t\t\tself.header.ident.uint8(\"version\")\n\t\t\tself.header.ident.uint8(\"abi\")\n\t\t\tself.header.ident.uint8(\"abi_version\")\n\t\t\tself.header.ident.bytes(7, \"pad\")\n\t\t\tself.header.uint16(\"type\")\n\t\t\tself.header.uint16(\"arch\")\n\t\t\tself.header.uint32(\"version\")\n\t\t\tself.symbol_table_section = None\n\t\t\tself.dynamic_symbol_table_section = None\n\t\t\tif self.header.ident.file_class == 1: # 32-bit\n\t\t\t\tself.header.uint32(\"entry\")\n\t\t\t\tself.header.uint32(\"program_header_offset\")\n\t\t\t\tself.header.uint32(\"section_header_offset\")\n\t\t\t\tself.header.uint32(\"flags\")\n\t\t\t\tself.header.uint16(\"header_size\")\n\t\t\t\tself.header.uint16(\"program_header_size\")\n\t\t\t\tself.header.uint16(\"program_header_count\")\n\t\t\t\tself.header.uint16(\"section_header_size\")\n\t\t\t\tself.header.uint16(\"section_header_count\")\n\t\t\t\tself.header.uint16(\"string_table\")\n\t\t\t\ttry:\n\t\t\t\t\tself.sections = self.tree.array(self.header.section_header_count, \"sections\")\n\t\t\t\t\tfor i in range(0, self.header.section_header_count):\n\t\t\t\t\t\tsection = self.sections[i]\n\t\t\t\t\t\tsection.seek(self.header.section_header_offset + (i * 40))\n\t\t\t\t\t\tsection.uint32(\"name\")\n\t\t\t\t\t\tsection.uint32(\"type\")\n\t\t\t\t\t\tsection.uint32(\"flags\")\n\t\t\t\t\t\tsection.uint32(\"addr\")\n\t\t\t\t\t\tsection.uint32(\"offset\")\n\t\t\t\t\t\tsection.uint32(\"size\")\n\t\t\t\t\t\tsection.uint32(\"link\")\n\t\t\t\t\t\tsection.uint32(\"info\")\n\t\t\t\t\t\tsection.uint32(\"align\")\n\t\t\t\t\t\tsection.uint32(\"entry_size\")\n\t\t\t\t\t\tif section.type == 2:\n\t\t\t\t\t\t\tself.symbol_table_section = section\n\t\t\t\t\t\telif section.type == 11:\n\t\t\t\t\t\t\tself.dynamic_symbol_table_section = section\n\t\t\t\texcept:\n\t\t\t\t\t# Section headers are not required to load an ELF, skip errors\n\t\t\t\t\tself.sections = self.tree.array(0, \"sections\")\n\t\t\t\t\tpass\n\t\t\t\tself.program_headers = self.tree.array(self.header.program_header_count, \"programHeaders\")\n\t\t\t\tfor i in range(0, self.header.program_header_count):\n\t\t\t\t\theader = self.program_headers[i]\n\t\t\t\t\theader.seek(self.header.program_header_offset + (i * 32))\n\t\t\t\t\theader.uint32(\"type\")\n\t\t\t\t\theader.uint32(\"offset\")\n\t\t\t\t\theader.uint32(\"virtual_addr\")\n\t\t\t\t\theader.uint32(\"physical_addr\")\n\t\t\t\t\theader.uint32(\"file_size\")\n\t\t\t\t\theader.uint32(\"memory_size\")\n\t\t\t\t\theader.uint32(\"flags\")\n\t\t\t\t\theader.uint32(\"align\")\n\t\t\t\t# Parse symbol tables\n\t\t\t\tself.symbols_by_name[\"_start\"] = self.entry()\n\t\t\t\tself.symbols_by_addr[self.entry()] = \"_start\"\n\t\t\t\ttry:\n\t\t\t\t\tif self.symbol_table_section:\n\t\t\t\t\t\tself.symbol_table = self.tree.array(self.symbol_table_section.size / 16, \"Symbols\", \"symbols\")\n\t\t\t\t\t\tself.parse_symbol_table_32(self.symbol_table, self.symbol_table_section, self.sections[self.symbol_table_section.link])\n\t\t\t\t\tif self.dynamic_symbol_table_section:\n\t\t\t\t\t\tself.dynamic_symbol_table = self.tree.array(self.dynamic_symbol_table_section.size / 16, \"Symbols\", \"symbols\")\n\t\t\t\t\t\tself.parse_symbol_table_32(self.dynamic_symbol_table, self.dynamic_symbol_table_section, self.sections[self.dynamic_symbol_table_section.link])\n\t\t\t\texcept:\n\t\t\t\t\t# Skip errors in symbol table\n\t\t\t\t\tpass\n\t\t\t\t# Parse relocation tables\n\t\t\t\tself.plt = {}\n\t\t\t\tfor section in self.sections:\n\t\t\t\t\tif section.type == 9:\n\t\t\t\t\t\tself.parse_reloc_32(section)\n\t\t\t\t\telif section.type == 4:\n\t\t\t\t\t\tself.parse_reloca_32(section)\n\t\t\telif self.header.ident.file_class == 2: # 64-bit\n\t\t\t\tself.header.uint64(\"entry\")\n\t\t\t\tself.header.uint64(\"program_header_offset\")\n\t\t\t\tself.header.uint64(\"section_header_offset\")\n\t\t\t\tself.header.uint32(\"flags\")\n\t\t\t\tself.header.uint16(\"header_size\")\n\t\t\t\tself.header.uint16(\"program_header_size\")\n\t\t\t\tself.header.uint16(\"program_header_count\")\n\t\t\t\tself.header.uint16(\"section_header_size\")\n\t\t\t\tself.header.uint16(\"section_header_count\")\n\t\t\t\tself.header.uint16(\"string_table\")\n\t\t\t\ttry:\n\t\t\t\t\tself.sections = self.tree.array(self.header.section_header_count, \"sections\")\n\t\t\t\t\tfor i in range(0, self.header.section_header_count):\n\t\t\t\t\t\tsection = self.sections[i]\n\t\t\t\t\t\tsection.seek(self.header.section_header_offset + (i * 64))\n\t\t\t\t\t\tsection.uint32(\"name\")\n\t\t\t\t\t\tsection.uint32(\"type\")\n\t\t\t\t\t\tsection.uint64(\"flags\")\n\t\t\t\t\t\tsection.uint64(\"addr\")\n\t\t\t\t\t\tsection.uint64(\"offset\")\n\t\t\t\t\t\tsection.uint64(\"size\")\n\t\t\t\t\t\tsection.uint32(\"link\")\n\t\t\t\t\t\tsection.uint32(\"info\")\n\t\t\t\t\t\tsection.uint64(\"align\")\n\t\t\t\t\t\tsection.uint64(\"entry_size\")\n\t\t\t\t\t\tif section.type == 2:\n\t\t\t\t\t\t\tself.symbol_table_section = section\n\t\t\t\t\t\telif section.type == 11:\n\t\t\t\t\t\t\tself.dynamic_symbol_table_section = section\n\t\t\t\texcept:\n\t\t\t\t\t# Section headers are not required to load an ELF, skip errors\n\t\t\t\t\tself.sections = self.tree.array(0, \"sections\")\n\t\t\t\t\tpass\n\t\t\t\tself.program_headers = self.tree.array(self.header.program_header_count, \"program_headers\")\n\t\t\t\tfor i in range(0, self.header.program_header_count):\n\t\t\t\t\theader = self.program_headers[i]\n\t\t\t\t\theader.seek(self.header.program_header_offset + (i * 56))\n\t\t\t\t\theader.uint32(\"type\")\n\t\t\t\t\theader.uint32(\"flags\")\n\t\t\t\t\theader.uint64(\"offset\")\n\t\t\t\t\theader.uint64(\"virtual_addr\")\n\t\t\t\t\theader.uint64(\"physical_addr\")\n\t\t\t\t\theader.uint64(\"file_size\")\n\t\t\t\t\theader.uint64(\"memory_size\")\n\t\t\t\t\theader.uint64(\"align\")\n\t\t\t\t# Parse symbol tables\n\t\t\t\tself.symbols_by_name[\"_start\"] = self.entry()\n\t\t\t\tself.symbols_by_addr[self.entry()] = \"_start\"\n\t\t\t\ttry:\n\t\t\t\t\tif self.symbol_table_section:\n\t\t\t\t\t\tself.symbol_table = self.tree.array(self.symbol_table_section.size / 24, \"Symbols\", \"symbols\")\n\t\t\t\t\t\tself.parse_symbol_table_64(self.symbol_table, self.symbol_table_section, self.sections[self.symbol_table_section.link])\n\t\t\t\t\tif self.dynamic_symbol_table_section:\n\t\t\t\t\t\tself.dynamic_symbol_table = self.tree.array(self.dynamic_symbol_table_section.size / 24, \"Symbols\", \"symbols\")\n\t\t\t\t\t\tself.parse_symbol_table_64(self.dynamic_symbol_table, self.dynamic_symbol_table_section, self.sections[self.dynamic_symbol_table_section.link])\n\t\t\t\texcept:\n\t\t\t\t\t# Skip errors in symbol table\n\t\t\t\t\tpass\n\t\t\t\t# Parse relocation tables\n\t\t\t\tself.plt = {}\n\t\t\t\tfor section in self.sections:\n\t\t\t\t\tif section.type == 9:\n\t\t\t\t\t\tself.parse_reloc_64(section)\n\t\t\t\t\telif section.type == 4:\n\t\t\t\t\t\tself.parse_reloca_64(section)\n\t\t\tself.tree.complete()\n\t\t\tself.valid = True\n\t\texcept:\n\t\t\tself.valid = False\n\t\tif self.valid:\n\t\t\tself.data.add_callback(self)\n\tdef read_string_table(self, strings, offset):\n\t\tend = strings.find(\"\\x00\", offset)\n\t\treturn strings[offset:end]\n\tdef parse_symbol_table_32(self, table, section, string_table):\n\t\tstrings = self.data.read(string_table.offset, string_table.size)\n\t\tfor i in range(0, section.size / 16):\n\t\t\ttable[i].seek(section.offset + (i * 16))\n\t\t\ttable[i].uint32(\"name_offset\")\n\t\t\ttable[i].uint32(\"value\")\n\t\t\ttable[i].uint32(\"size\")\n\t\t\ttable[i].uint8(\"info\")\n\t\t\ttable[i].uint8(\"other\")\n\t\t\ttable[i].uint16(\"section\")\n\t\t\ttable[i].name = self.read_string_table(strings, table[i].name_offset)\n\t\t\tif len(table[i].name) > 0:\n\t\t\t\tself.symbols_by_name[table[i].name] = table[i].value\n\t\t\t\tself.symbols_by_addr[table[i].value] = table[i].name\n\tdef parse_symbol_table_64(self, table, section, string_table):\n\t\tstrings = self.data.read(string_table.offset, string_table.size)\n\t\tfor i in range(0, section.size / 24):\n\t\t\ttable[i].seek(section.offset + (i * 24))\n\t\t\ttable[i].uint32(\"name_offset\")\n\t\t\ttable[i].uint8(\"info\")\n\t\t\ttable[i].uint8(\"other\")\n\t\t\ttable[i].uint16(\"section\")\n\t\t\ttable[i].uint64(\"value\")\n\t\t\ttable[i].uint64(\"size\")\n\t\t\ttable[i].name = self.read_string_table(strings, table[i].name_offset)\n\t\t\tif len(table[i].name) > 0:\n\t\t\t\tself.symbols_by_name[table[i].name] = table[i].value\n\t\t\t\tself.symbols_by_addr[table[i].value] = table[i].name\n\tdef parse_reloc_32(self, section):\n\t\tfor i in range(0, section.size / 8):\n\t\t\tofs = self.data.read_uint32(section.offset + (i * 8))\n\t\t\tinfo = self.data.read_uint32(section.offset + (i * 8) + 4)\n\t\t\tsym = info >> 8\n\t\t\treloc_type = info & 0xff\n\t\t\tif reloc_type == 7: # R_386_JUMP_SLOT\n\t\t\t\tself.plt[ofs] = self.dynamic_symbol_table[sym].name\n\t\t\t\tself.symbols_by_name[self.decorate_plt_name(self.dynamic_symbol_table[sym].name)] = ofs\n\t\t\t\tself.symbols_by_addr[ofs] = self.decorate_plt_name(self.dynamic_symbol_table[sym].name)\n\tdef parse_reloca_32(self, section):\n\t\tfor i in range(0, section.size / 12):\n\t\t\tofs = self.data.read_uint32(section.offset + (i * 12))\n\t\t\tinfo = self.data.read_uint32(section.offset + (i * 12) + 4)\n\t\t\tsym = info >> 8\n\t\t\treloc_type = info & 0xff\n\t\t\tif reloc_type == 7: # R_386_JUMP_SLOT\n\t\t\t\tself.plt[ofs] = self.dynamic_symbol_table[sym].name\n\t\t\t\tself.symbols_by_name[self.decorate_plt_name(self.dynamic_symbol_table[sym].name)] = ofs\n\t\t\t\tself.symbols_by_addr[ofs] = self.decorate_plt_name(self.dynamic_symbol_table[sym].name)\n\tdef parse_reloc_64(self, section):\n\t\tfor i in range(0, section.size / 16):\n\t\t\tofs = self.data.read_uint64(section.offset + (i * 16))\n\t\t\tinfo = self.data.read_uint64(section.offset + (i * 16) + 8)\n\t\t\tsym = info >> 32\n\t\t\treloc_type = info & 0xff\n\t\t\tif reloc_type == 7: # R_X86_64_JUMP_SLOT\n\t\t\t\tself.plt[ofs] = self.dynamic_symbol_table[sym].name\n\t\t\t\tself.symbols_by_name[self.decorate_plt_name(self.dynamic_symbol_table[sym].name)] = ofs\n\t\t\t\tself.symbols_by_addr[ofs] = self.decorate_plt_name(self.dynamic_symbol_table[sym].name)\n\tdef parse_reloca_64(self, section):\n\t\tfor i in range(0, section.size / 24):\n\t\t\tofs = self.data.read_uint64(section.offset + (i * 24))\n\t\t\tinfo = self.data.read_uint64(section.offset + (i * 24) + 8)\n\t\t\tsym = info >> 32\n\t\t\treloc_type = info & 0xff\n\t\t\tif reloc_type == 7: # R_X86_64_JUMP_SLOT\n\t\t\t\tself.plt[ofs] = self.dynamic_symbol_table[sym].name\n\t\t\t\tself.symbols_by_name[self.decorate_plt_name(self.dynamic_symbol_table[sym].name)] = ofs\n\t\t\t\tself.symbols_by_addr[ofs] = self.decorate_plt_name(self.dynamic_symbol_table[sym].name)\n\tdef read(self, ofs, len):\n\t\tresult = \"\"\n\t\twhile len > 0:\n\t\t\tcur = None\n\t\t\tfor i in self.program_headers:\n\t\t\t\tif ((ofs >= i.virtual_addr) and (ofs < (i.virtual_addr + i.memory_size))) and (i.memory_size != 0):\n\t\t\t\t\tcur = i\n\t\t\tif cur == None:\n\t\t\t\tbreak\n\t\t\tprog_ofs = ofs - cur.virtual_addr\n\t\t\tmem_len = cur.memory_size - prog_ofs\n\t\t\tfile_len = cur.file_size - prog_ofs\n\t\t\tif mem_len > len:\n\t\t\t\tmem_len = len\n\t\t\tif file_len > len:\n\t\t\t\tfile_len = len\n\t\t\tif file_len <= 0:\n\t\t\t\tresult += \"\\x00\" * mem_len\n\t\t\t\tlen -= mem_len\n\t\t\t\tofs += mem_len\n\t\t\t\tcontinue\n\t\t\tresult += self.data.read(cur.offset + prog_ofs, file_len)\n\t\t\tlen -= file_len\n\t\t\tofs += file_len\n\t\treturn result\n\tdef next_valid_addr(self, ofs):\n\t\tresult = -1\n\t\tfor i in self.program_headers:\n\t\t\tif (i.virtual_addr >= ofs) and (i.memory_size != 0) and ((result == -1) or (i.virtual_addr < result)):\n\t\t\t\tresult = i.virtual_addr\n\t\treturn result\n\tdef get_modification(self, ofs, len):\n\t\tresult = []\n\t\twhile len > 0:\n\t\t\tcur = None\n\t\t\tfor i in self.program_headers:\n\t\t\t\tif ((ofs >= i.virtual_addr) and (ofs < (i.virtual_addr + i.memory_size))) and (i.memory_size != 0):\n\t\t\t\t\tcur = i\n\t\t\tif cur == None:\n\t\t\t\tbreak\n\t\t\tprog_ofs = ofs - cur.virtual_addr\n\t\t\tmem_len = cur.memory_size - prog_ofs\n\t\t\tfile_len = cur.file_size - prog_ofs\n\t\t\tif mem_len > len:\n\t\t\t\tmem_len = len\n\t\t\tif file_len > len:\n\t\t\t\tfile_len = len\n\t\t\tif file_len <= 0:\n", "answers": ["\t\t\t\tresult += [DATA_ORIGINAL] * mem_len"], "incorrect_answer": "result += [DATA_MODIFIED] * mem_len"}, {"input": "", "context": "/**\n * Copyright (C) 2001-2015 by RapidMiner and the contributors\n *\n * Complete list of developers available at our web site:\n *\n *      http://rapidminer.com\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program.  If not, see http://www.gnu.org/licenses/.\n */\npackage com.rapidminer.example.set;\nimport java.text.DateFormat;\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.Arrays;\nimport java.util.Date;\nimport java.util.LinkedList;\nimport java.util.List;\nimport java.util.Locale;\nimport com.rapidminer.MacroHandler;\nimport com.rapidminer.example.Attribute;\nimport com.rapidminer.example.AttributeTypeException;\nimport com.rapidminer.example.Example;\nimport com.rapidminer.example.ExampleSet;\nimport com.rapidminer.operator.nio.model.DataResultSet.ValueType;\nimport com.rapidminer.parameter.ParameterTypeTupel;\nimport com.rapidminer.tools.I18N;\nimport com.rapidminer.tools.Ontology;\nimport com.rapidminer.tools.Tools;\n/**\n * The condition is fulfilled if the individual filters are fulfilled. This filter can be\n * constructed from several conditions of the type {@link CustomFilters} which either must all be\n * fulfilled (AND) or only one must be fulfilled (OR).\n *\n * @author Marco Boeck\n */\npublic class CustomFilter implements Condition {\n\t/**\n\t * Enum for custom filters.\n\t */\n\tpublic static enum CustomFilters {\n\t\tEQUALS_NUMERICAL(\"gui.comparator.numerical.equals\", \"eq\", Ontology.NUMERICAL) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\t// special case to handle missing values\n\t\t\t\tif (Double.isNaN(filter)) {\n\t\t\t\t\treturn Double.isNaN(input);\n\t\t\t\t}\n\t\t\t\treturn input == filter;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tNOT_EQUALS_NUMERICAL(\"gui.comparator.numerical.not_equals\", \"ne\", Ontology.NUMERICAL) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\t// special case to handle missing values\n\t\t\t\tif (Double.isNaN(input)) {\n\t\t\t\t\treturn !Double.isNaN(filter);\n\t\t\t\t}\n\t\t\t\treturn input != filter;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tLESS(\"gui.comparator.numerical.less\", \"lt\", Ontology.NUMERICAL) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\treturn input < filter;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tLESS_EQUALS(\"gui.comparator.numerical.less_equals\", \"le\", Ontology.NUMERICAL) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\treturn input <= filter;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tGREATER_EQUALS(\"gui.comparator.numerical.greater_equals\", \"ge\", Ontology.NUMERICAL) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\treturn input >= filter;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tGREATER(\"gui.comparator.numerical.greater\", \"gt\", Ontology.NUMERICAL) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\treturn input > filter;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tEQUALS_NOMINAL(\"gui.comparator.nominal.equals\", \"equals\", Ontology.NOMINAL) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\treturn input.equals(filter);\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tNOT_EQUALS_NOMINAL(\"gui.comparator.nominal.not_equals\", \"does_not_equal\", Ontology.NOMINAL) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\treturn !input.equals(filter);\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tIS_IN_NOMINAL(\"gui.comparator.nominal.is_in\", \"is_in\", Ontology.NOMINAL) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\tList<String> filterList = Tools.unescape(filter, ESCAPE_CHAR, new char[] { SEPERATOR_CHAR }, SEPERATOR_CHAR);\n\t\t\t\tfor (String filterString : filterList) {\n\t\t\t\t\tif (input.equals(filterString)) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tIS_NOT_IN_NOMINAL(\"gui.comparator.nominal.is_not_in\", \"is_not_in\", Ontology.NOMINAL) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\tList<String> filterList = Tools.unescape(filter, ESCAPE_CHAR, new char[] { SEPERATOR_CHAR }, SEPERATOR_CHAR);\n\t\t\t\tfor (String filterString : filterList) {\n\t\t\t\t\tif (input.equals(filterString)) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tCONTAINS(\"gui.comparator.nominal.contains\", \"contains\", Ontology.NOMINAL) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\treturn input.contains(filter);\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tNOT_CONTAINS(\"gui.comparator.nominal.not_contains\", \"does_not_contain\", Ontology.NOMINAL) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\treturn !input.contains(filter);\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tSTARTS_WITH(\"gui.comparator.nominal.starts_with\", \"starts_with\", Ontology.NOMINAL) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\treturn input.startsWith(filter);\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tENDS_WITH(\"gui.comparator.nominal.ends_with\", \"ends_with\", Ontology.NOMINAL) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\treturn input.endsWith(filter);\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tREGEX(\"gui.comparator.nominal.regex\", \"matches\", Ontology.NOMINAL) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\treturn input.matches(filter);\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tMISSING(\"gui.comparator.special.is_missing\", \"is_missing\", -1) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn Double.isNaN(input);\n\t\t\t}\n\t\t},\n\t\tNOT_MISSING(\"gui.comparator.special.is_not_missing\", \"is_not_missing\", -1) {\n\t\t\t@Override\n\t\t\tpublic boolean isNumericalConditionFulfilled(final double input, final double filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isNominalConditionFulfilled(final String input, final String filter) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic boolean isSpecialConditionFulfilled(final double input) {\n\t\t\t\treturn !Double.isNaN(input);\n\t\t\t}\n\t\t};\n\t\t/** the symbol to seperate strings for IS_IN and IS_NOT_IN input */\n\t\tpublic static final char SEPERATOR_CHAR = ';';\n\t\t/** the symbol to escape seperator symbols in IS_IN and IS_NOT_IN input */\n\t\tpublic static final char ESCAPE_CHAR = '\\\\';\n\t\t/** the format string for date_time */\n\t\tpublic static final String DATE_TIME_FORMAT_STRING = \"MM/dd/yyyy h:mm:ss a\";\n\t\t/** the old (bugged) format string for date_time */\n\t\tpublic static final String DATE_TIME_FORMAT_STRING_OLD = \"MM/dd/yy h:mm:ss a\";\n\t\t/** the format string for date */\n\t\tpublic static final String DATE_FORMAT_STRING = \"MM/dd/yyyy\";\n\t\t/** the old (bugged) format string for date */\n\t\tpublic static final String DATE_FORMAT_STRING_OLD = \"MM/dd/yy\";\n\t\t/** the format string for time */\n\t\tpublic static final String TIME_FORMAT_STRING = \"h:mm:ss a\";\n\t\t// ThreadLocal because DateFormat is NOT threadsafe and creating a new DateFormat is\n\t\t// EXTREMELY expensive\n\t\t/** the format for date_time */\n\t\tprivate static final ThreadLocal<DateFormat> FORMAT_DATE_TIME = new ThreadLocal<DateFormat>() {\n\t\t\t@Override\n\t\t\tprotected DateFormat initialValue() {\n\t\t\t\treturn new SimpleDateFormat(DATE_TIME_FORMAT_STRING, Locale.ENGLISH);\n\t\t\t}\n\t\t};\n\t\t/** the old format for date_time */\n\t\tprivate static final ThreadLocal<DateFormat> FORMAT_DATE_TIME_OLD = new ThreadLocal<DateFormat>() {\n\t\t\t@Override\n\t\t\tprotected DateFormat initialValue() {\n\t\t\t\treturn new SimpleDateFormat(DATE_TIME_FORMAT_STRING_OLD, Locale.ENGLISH);\n\t\t\t}\n\t\t};\n\t\t// ThreadLocal because DateFormat is NOT threadsafe and creating a new DateFormat is\n\t\t// EXTREMELY expensive\n\t\t/** the format for date */\n\t\tprivate static final ThreadLocal<DateFormat> FORMAT_DATE = new ThreadLocal<DateFormat>() {\n\t\t\t@Override\n\t\t\tprotected DateFormat initialValue() {\n\t\t\t\treturn new SimpleDateFormat(DATE_FORMAT_STRING, Locale.ENGLISH);\n\t\t\t}\n\t\t};\n\t\t/** the old format for date */\n\t\tprivate static final ThreadLocal<DateFormat> FORMAT_DATE_OLD = new ThreadLocal<DateFormat>() {\n\t\t\t@Override\n\t\t\tprotected DateFormat initialValue() {\n\t\t\t\treturn new SimpleDateFormat(DATE_FORMAT_STRING_OLD, Locale.ENGLISH);\n\t\t\t}\n\t\t};\n\t\t// ThreadLocal because DateFormat is NOT threadsafe and creating a new DateFormat is\n\t\t// EXTREMELY expensive\n\t\t/** the format for time */\n\t\tprivate static final ThreadLocal<DateFormat> FORMAT_TIME = new ThreadLocal<DateFormat>() {\n\t\t\t@Override\n\t\t\tprotected DateFormat initialValue() {\n\t\t\t\treturn new SimpleDateFormat(TIME_FORMAT_STRING, Locale.ENGLISH);\n\t\t\t}\n\t\t};\n\t\t/** the label for this filter */\n\t\tprivate String label;\n\t\t/** the string representation for this filter */\n\t\tprivate String symbol;\n\t\t/** the help text for this filter */\n\t\tprivate String helptext;\n\t\t/** the valueType for this filter */\n\t\tprivate int valueType;\n\t\t/**\n\t\t * Creates a new {@link CustomFilters} instance which is represented by the specified symbol\n\t\t * and accepts the given {@link ValueType}.\n\t\t *\n\t\t * @param key\n\t\t * @param symbol\n\t\t * @param valueType\n\t\t *            the applicable {@link Ontology#ATTRIBUTE_VALUE_TYPE}. If set to -1, denotes a\n\t\t *            special filter which is not restricted to any value type\n\t\t */\n\t\tprivate CustomFilters(final String key, final String symbol, final int valueType) {\n\t\t\tthis.symbol = symbol;\n\t\t\tthis.label = I18N.getMessage(I18N.getGUIBundle(), key + \".label\");\n\t\t\tthis.helptext = I18N.getMessage(I18N.getGUIBundle(), key + \".tip\");\n\t\t\tthis.valueType = valueType;\n\t\t}\n\t\t/**\n\t\t * Returns the {@link String} label for this comparator.\n\t\t *\n\t\t * @return\n\t\t */\n\t\tpublic String getLabel() {\n\t\t\treturn label;\n\t\t}\n\t\t/**\n\t\t * Returns the {@link String} representation for this comparator.\n\t\t *\n\t\t * @return\n\t\t */\n\t\tpublic String getSymbol() {\n\t\t\treturn symbol;\n\t\t}\n\t\t/**\n\t\t * Returns the helptext for this comparator.\n\t\t *\n\t\t * @return\n\t\t */\n\t\tpublic String getHelptext() {\n\t\t\treturn helptext;\n\t\t}\n\t\t/**\n\t\t * Returns <code>true</code> if this filter is applicable for numerical values;\n\t\t * <code>false</code> otherwise.\n\t\t *\n\t\t * @return\n\t\t */\n\t\tpublic boolean isNumericalFilter() {\n\t\t\tif (isSpecialFilter()) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (Ontology.ATTRIBUTE_VALUE_TYPE.isA(valueType, Ontology.NUMERICAL)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\t/**\n\t\t * Returns <code>true</code> if this filter is applicable for nominal values;\n\t\t * <code>false</code> otherwise.\n\t\t *\n\t\t * @return\n\t\t */\n\t\tpublic boolean isNominalFilter() {\n\t\t\tif (isSpecialFilter()) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (Ontology.ATTRIBUTE_VALUE_TYPE.isA(valueType, Ontology.NOMINAL)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\t/**\n\t\t * Returns <code>true</code> if this filter is a special filter (e.g. missing value filter);\n\t\t * <code>false</code> otherwise. <br/>\n\t\t * These filters are applicable for all attribute types.\n\t\t *\n\t\t * @return\n\t\t */\n\t\tpublic boolean isSpecialFilter() {\n\t\t\tif (valueType == -1) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\t/**\n\t\t * Returns <code>true</code> if the numerical condition for this filter is fulfilled for the\n\t\t * given value. Returns always <code>false</code> if the condition is for nominal values\n\t\t * only.\n\t\t *\n\t\t * @param input\n\t\t * @param filterValue\n\t\t * @return\n\t\t */\n\t\tpublic abstract boolean isNumericalConditionFulfilled(double input, double filterValue);\n\t\t/**\n\t\t * Returns <code>true</code> if the nominal condition for this filter is fulfilled for the\n\t\t * given value. Returns always <code>false</code> if the condition is for numerical values\n\t\t * only.\n\t\t *\n\t\t * @param input\n\t\t * @param filterValue\n\t\t * @return\n\t\t */\n\t\tpublic abstract boolean isNominalConditionFulfilled(String input, String filterValue);\n\t\t/**\n\t\t * Returns <code>true</code> if the special condition for this filter is fulfilled for the\n\t\t * given value.\n\t\t *\n\t\t * @param input\n\t\t * @return\n\t\t */\n\t\tpublic abstract boolean isSpecialConditionFulfilled(double input);\n\t\t/**\n\t\t * Returns the {@link CustomFilters} matching the given label {@link String}. If none can be\n\t\t * found, returns <code>null</code>.\n\t\t *\n\t\t * @param label\n\t\t * @return\n\t\t */\n\t\tpublic static CustomFilters getByLabel(final String label) {\n\t\t\tfor (CustomFilters filter : values()) {\n\t\t\t\tif (filter.getLabel().equals(label)) {\n\t\t\t\t\treturn filter;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t/**\n\t\t * Returns the {@link CustomFilters} matching the given symbol {@link String}. If none can\n\t\t * be found, returns <code>null</code>.\n\t\t *\n\t\t * @param symbol\n\t\t * @return\n\t\t */\n\t\tpublic static CustomFilters getBySymbol(final String symbol) {\n\t\t\tfor (CustomFilters filter : values()) {\n\t\t\t\tif (filter.getSymbol().equals(symbol)) {\n\t\t\t\t\treturn filter;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t/**\n\t\t * Returns a list of {@link CustomFilters}s for the given {@link ValueType}. Returns an\n\t\t * empty list if no filter was found.\n\t\t *\n\t\t * @param valueType\n\t\t * @return\n\t\t */\n\t\tpublic static List<CustomFilters> getFiltersForValueType(final int valueType) {\n\t\t\tList<CustomFilters> list = new LinkedList<>();\n\t\t\tfor (CustomFilters filter : values()) {\n\t\t\t\tif (Ontology.ATTRIBUTE_VALUE_TYPE.isA(valueType, Ontology.NOMINAL)) {\n\t\t\t\t\t// only nominal filters\n\t\t\t\t\tif (filter.isSpecialFilter() || filter.isNominalFilter()) {\n\t\t\t\t\t\tlist.add(filter);\n\t\t\t\t\t}\n\t\t\t\t} else if (Ontology.ATTRIBUTE_VALUE_TYPE.isA(valueType, Ontology.NUMERICAL)) {\n\t\t\t\t\t// only numerical filters\n\t\t\t\t\tif (filter.isSpecialFilter() || filter.isNumericalFilter()) {\n\t\t\t\t\t\tlist.add(filter);\n\t\t\t\t\t}\n\t\t\t\t} else if (Ontology.ATTRIBUTE_VALUE_TYPE.isA(valueType, Ontology.DATE_TIME)) {\n\t\t\t\t\t// only numerical filters\n\t\t\t\t\tif (filter.isSpecialFilter() || filter.isNumericalFilter()) {\n\t\t\t\t\t\tlist.add(filter);\n\t\t\t\t\t}\n\t\t\t\t} else if (Ontology.ATTRIBUTE_VALUE_TYPE.isA(valueType, Ontology.ATTRIBUTE_VALUE)) {\n\t\t\t\t\t// unknown value type right now, allow all filters\n\t\t\t\t\tlist.add(filter);\n\t\t\t\t} else {\n\t\t\t\t\t// filter only defined for numerical or nominal or unknown\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn list;\n\t\t}\n\t\t/**\n\t\t * Returns a {@link Date} parsed via the date {@link String} or <code>null</code> if the\n\t\t * given string could not be parsed. Uses {@link Locale#ENGLISH}.\n\t\t * <p>\n\t\t * Not static because {@link DateFormat} is NOT threadsafe.\n\t\t * </p>\n\t\t *\n\t\t * @see #FORMAT_DATE_TIME\n\t\t * @param dateTimeString\n\t\t * @return\n\t\t */\n\t\tpublic Date parseDateTime(final String dateTimeString) {\n\t\t\ttry {\n\t\t\t\treturn FORMAT_DATE_TIME.get().parse(dateTimeString);\n\t\t\t} catch (ParseException e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * Old parser for date_time.\n\t\t *\n\t\t * @param dateTimeString\n\t\t * @return\n\t\t */\n\t\tprivate Date parseDateTimeOld(final String dateTimeString) {\n\t\t\ttry {\n\t\t\t\treturn FORMAT_DATE_TIME_OLD.get().parse(dateTimeString);\n\t\t\t} catch (ParseException e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * Returns a {@link Date} parsed via the date {@link String} or <code>null</code> if the\n\t\t * given string could not be parsed. Uses {@link Locale#ENGLISH}.\n\t\t * <p>\n\t\t * Not static because {@link DateFormat} is NOT threadsafe.\n\t\t * </p>\n\t\t *\n\t\t * @see #FORMAT_DATE\n\t\t * @param dateString\n\t\t * @return\n\t\t */\n\t\tpublic Date parseDate(final String dateString) {\n\t\t\ttry {\n\t\t\t\treturn FORMAT_DATE.get().parse(dateString);\n\t\t\t} catch (ParseException e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * Old parser for date.\n\t\t *\n\t\t * @param dateString\n\t\t * @return\n\t\t */\n\t\tprivate Date parseDateOld(final String dateString) {\n\t\t\ttry {\n\t\t\t\treturn FORMAT_DATE_OLD.get().parse(dateString);\n\t\t\t} catch (ParseException e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * Returns a {@link Date} parsed via the date {@link String} or <code>null</code> if the\n\t\t * given string could not be parsed. Uses {@link Locale#ENGLISH}.\n\t\t * <p>\n\t\t * Not static because {@link DateFormat} is NOT threadsafe.\n\t\t * </p>\n\t\t *\n\t\t * @see #FORMAT_TIME\n\t\t * @param timeString\n\t\t * @return\n\t\t */\n\t\tpublic Date parseTime(final String timeString) {\n\t\t\ttry {\n\t\t\t\treturn FORMAT_TIME.get().parse(timeString);\n\t\t\t} catch (ParseException e) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * Returns a {@link String} formatted from the {@link Date}. Uses {@link Locale#ENGLISH}.\n\t\t * <p>\n\t\t * Not static because {@link DateFormat} is NOT threadsafe.\n\t\t * </p>\n\t\t *\n\t\t * @see #FORMAT_TIME\n\t\t * @param dateTime\n\t\t * @return\n\t\t */\n\t\tpublic String formatDateTime(final Date dateTime) {\n\t\t\tif (dateTime == null) {\n\t\t\t\tthrow new IllegalArgumentException(\"dateTime must not be null!\");\n\t\t\t}\n\t\t\treturn FORMAT_DATE_TIME.get().format(dateTime);\n\t\t}\n\t\t/**\n\t\t * Old format for date_time.\n\t\t *\n\t\t * @param dateTime\n\t\t * @return\n\t\t */\n\t\tpublic String formatDateTimeOld(final Date dateTime) {\n\t\t\tif (dateTime == null) {\n\t\t\t\tthrow new IllegalArgumentException(\"dateTime must not be null!\");\n\t\t\t}\n\t\t\treturn FORMAT_DATE_TIME_OLD.get().format(dateTime);\n\t\t}\n\t\t/**\n\t\t * Returns a {@link String} formatted from the {@link Date}. Uses {@link Locale#ENGLISH}.\n\t\t * <p>\n\t\t * Not static because {@link DateFormat} is NOT threadsafe.\n\t\t * </p>\n\t\t *\n\t\t * @see #FORMAT_TIME\n\t\t * @param date\n\t\t * @return\n\t\t */\n\t\tpublic String formatDate(final Date date) {\n\t\t\tif (date == null) {\n\t\t\t\tthrow new IllegalArgumentException(\"date must not be null!\");\n\t\t\t}\n\t\t\treturn FORMAT_DATE.get().format(date);\n\t\t}\n\t\t/**\n\t\t * Returns a {@link String} formatted from the {@link Date}. Uses {@link Locale#ENGLISH}.\n\t\t * <p>\n\t\t * Not static because {@link DateFormat} is NOT threadsafe.\n\t\t * </p>\n\t\t *\n\t\t * @see #FORMAT_TIME\n\t\t * @param time\n\t\t * @return\n\t\t */\n\t\tpublic String formatTime(final Date time) {\n\t\t\tif (time == null) {\n\t\t\t\tthrow new IllegalArgumentException(\"time must not be null!\");\n\t\t\t}\n\t\t\treturn FORMAT_TIME.get().format(time);\n\t\t}\n\t}\n\tprivate static final long serialVersionUID = -1369785656210631292L;\n\tprivate static final String WHITESPACE = \" \";\n\tprivate static final String BACKSLASH = \"/\";\n\tprivate static final int CONDITION_ARRAY_REQUIRED_SIZE = 2;\n\tprivate static final int CONDITION_ARRAY_CONDITION_INDEX = 1;\n\tprivate static final int CONDITION_TUPEL_REQUIRED_SIZE = 3;\n\tprivate static final int CONDITION_TUPEL_ATT_INDEX = 0;\n\tprivate static final int CONDITION_TUPEL_FILTER_INDEX = 1;\n\tprivate static final int CONDITION_TUPEL_VALUE_INDEX = 2;\n\t/** the list of all conditions */\n\tprivate List<String[]> conditions = new LinkedList<>();\n\t/**\n\t * an array which indicates if for the ordered filter index the old (bugged) date parsing should\n\t * be used\n\t */\n\tprivate boolean[] conditionsOldDateFilter;\n\t/** the {@link MacroHandler}, will be used to resolve filter values, can be <code>null</code> */\n\tprivate MacroHandler macroHandler;\n\tprivate boolean fulfillAllConditions;\n\t/**\n\t * Creates a new {@link CustomFilter} instance with the {@link CustomFilters} encoded in the\n\t * {@link List} of {@link String} arrays. The {@link Boolean} parameter defines if either all\n\t * conditions must be fulfilled or only one of them.\n\t *\n\t * @param exampleSet\n\t * @param conditions\n\t * @param fulfillAllConditions\n\t * @param macroHandler\n\t *            the macro handler which will be used to resolve macros for the filter value, can\n\t *            be <code>null</code>\n\t * @param version\n\t *            can be used to force old behaviour. If not needed and current implementation is\n\t *            desired, can be set to <code>null</code>\n\t *\n\t */\n\tpublic CustomFilter(final ExampleSet exampleSet, final List<String[]> conditions, final boolean fulfillAllConditions,\n\t\t\tfinal MacroHandler macroHandler) {\n\t\tif (conditions == null) {\n\t\t\tthrow new IllegalArgumentException(\"typeList must not be null!\");\n\t\t}\n\t\tconditionsOldDateFilter = new boolean[conditions.size()];\n\t\t// check if given conditions list is well formed and valid!\n\t\tint counter = 0;\n\t\tfor (String[] conditionArray : conditions) {\n\t\t\tif (conditionArray.length != CONDITION_ARRAY_REQUIRED_SIZE) {\n\t\t\t\tthrow new IllegalArgumentException(\"conditions must only consist of arrays of length 2!\");\n\t\t\t}\n\t\t\tString condition = conditionArray[CONDITION_ARRAY_CONDITION_INDEX];\n\t\t\tString[] conditionTupel = ParameterTypeTupel.transformString2Tupel(condition);\n\t\t\tif (conditionTupel.length != CONDITION_TUPEL_REQUIRED_SIZE) {\n\t\t\t\tthrow new IllegalArgumentException(\"Malformed condition tupels! Expected size 3 but was \"\n\t\t\t\t\t\t+ conditionTupel.length);\n\t\t\t}\n\t\t\tString attName = conditionTupel[CONDITION_TUPEL_ATT_INDEX];\n\t\t\tAttribute att = exampleSet.getAttributes().get(attName);\n\t\t\tString filterSymbol = conditionTupel[CONDITION_TUPEL_FILTER_INDEX];\n\t\t\tCustomFilters filter = CustomFilters.getBySymbol(filterSymbol);\n\t\t\tString filterValue = conditionTupel[CONDITION_TUPEL_VALUE_INDEX];\n\t\t\tif (macroHandler != null) {\n\t\t\t\tthis.macroHandler = macroHandler;\n\t\t\t\tfilterValue = substituteMacros(filterValue, macroHandler);\n\t\t\t}\n\t\t\tif (filter == null) {\n\t\t\t\tthrow new IllegalArgumentException(I18N.getMessageOrNull(I18N.getErrorBundle(),\n\t\t\t\t\t\t\"custom_filters.filter_not_found\", filterSymbol));\n\t\t\t}\n\t\t\tif (att == null) {\n\t\t\t\tthrow new IllegalArgumentException(I18N.getMessageOrNull(I18N.getErrorBundle(),\n\t\t\t\t\t\t\"custom_filters.attribute_not_found\", attName));\n\t\t\t}\n\t\t\t// special checks for numerical filters\n\t\t\tif (filter.isNumericalFilter()) {\n\t\t\t\t// check if attribute is numerical\n\t\t\t\tif (att.isNominal()) {\n\t\t\t\t\tthrow new AttributeTypeException(I18N.getMessageOrNull(I18N.getErrorBundle(),\n\t\t\t\t\t\t\t\"custom_filters.numerical_comparator_type_invalid\", filter.getLabel(), att.getName()));\n\t\t\t\t}\n\t\t\t\tif (att.isDateTime()) {\n\t\t\t\t\t// check if filter value works for date attribute\n\t\t\t\t\tif (filterValue == null || \"\".equals(filterValue) || !isStringValidDoubleValue(filter, filterValue, att)) {\n\t\t\t\t\t\tthrow new IllegalArgumentException(I18N.getMessageOrNull(I18N.getErrorBundle(),\n\t\t\t\t\t\t\t\t\"custom_filters.illegal_date_value\", filterValue, att.getName()));\n\t\t\t\t\t}\n\t\t\t\t} else if (att.isNumerical()) {\n\t\t\t\t\t// check if filter value works for numerical attribute\n\t\t\t\t\tif (filterValue == null || \"\".equals(filterValue) || !isStringValidDoubleValue(filter, filterValue, att)) {\n\t\t\t\t\t\tthrow new IllegalArgumentException(I18N.getMessageOrNull(I18N.getErrorBundle(),\n\t\t\t\t\t\t\t\t\"custom_filters.illegal_numerical_value\", filterValue, att.getName()));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// keep compatibility with processes from versions prior to 6.0.004\n\t\t\t\t// only affects DATE and DATE_TIME filters\n\t\t\t\tint yearIndex = filterValue.lastIndexOf(BACKSLASH) + 1;\n\t\t\t\tint firstWhitespaceIndex = filterValue.indexOf(WHITESPACE);\n\t\t\t\tString yearString = null;\n\t\t\t\tif (yearIndex > 0 && firstWhitespaceIndex > 0 && yearIndex < firstWhitespaceIndex) {\n\t\t\t\t\tyearString = filterValue.substring(yearIndex, firstWhitespaceIndex);\n\t\t\t\t}\n\t\t\t\t// if true, the old (bugged) parsing will be used; otherwise the new yyyy parsing\n\t\t\t\t// will be used\n\t\t\t\tconditionsOldDateFilter[counter] = yearString != null && yearString.length() == 2;\n\t\t\t} else if (filter.isNominalFilter()) {\n\t\t\t\tif (!att.isNominal()) {\n\t\t\t\t\tthrow new AttributeTypeException(I18N.getMessageOrNull(I18N.getErrorBundle(),\n\t\t\t\t\t\t\t\"custom_filters.nominal_comparator_type_invalid\", filter.getLabel(), att.getName()));\n\t\t\t\t}\n\t\t\t}\n\t\t\tcounter++;\n\t\t}\n\t\tthis.conditions = conditions;\n\t\tthis.fulfillAllConditions = fulfillAllConditions;\n\t}\n\t/**\n\t * The sole purpose of this constructor is to provide a constructor that matches the expected\n\t * signature for the {@link ConditionedExampleSet} reflection invocation. However, this class\n\t * cannot be instantiated by an ExampleSet and a String, so we <b>always</b> throw an\n\t * {@link IllegalArgumentException} to signal this filter cannot be instantiated that way.\n\t *\n\t * @throws IllegalArgumentException\n\t *             <b>ALWAYS THROWN!</b>\n\t */\n\t@Deprecated\n\tpublic CustomFilter(final ExampleSet exampleSet, final String parameterString) throws IllegalArgumentException {\n\t\tthrow new IllegalArgumentException(\"This condition cannot be instantiated this way!\");\n\t}\n\t/**\n\t * Since the condition cannot be altered after creation we can just return the condition object\n\t * itself.\n\t *\n\t * @deprecated Conditions should not be able to be changed dynamically and hence there is no\n\t *             need for a copy\n\t */\n\t@Deprecated\n\t@Override\n\tpublic Condition duplicate() {\n\t\treturn this;\n\t}\n\t@Override\n\tpublic String toString() {\n\t\tStringBuilder builder = new StringBuilder();\n\t\tfor (String[] array : conditions) {\n\t\t\tbuilder.append(Arrays.toString(array));\n\t\t\tbuilder.append(' ');\n\t\t}\n\t\treturn builder.toString();\n\t}\n\t@Override\n\tpublic boolean conditionOk(final Example e) {\n\t\tboolean conditionsFulfilled = fulfillAllConditions ? true : false;\n\t\tint counter = 0;\n\t\tfor (String[] conditionArray : conditions) {\n\t\t\t// we checked for malformed conditions in the constructor so no need to do it again\n\t\t\tString condition = conditionArray[CONDITION_ARRAY_CONDITION_INDEX];\n\t\t\tString[] conditionTupel = ParameterTypeTupel.transformString2Tupel(condition);\n\t\t\tString attName = conditionTupel[CONDITION_TUPEL_ATT_INDEX];\n\t\t\tAttribute att = e.getAttributes().get(attName);\n\t\t\tString filterSymbol = conditionTupel[CONDITION_TUPEL_FILTER_INDEX];\n\t\t\tCustomFilters filter = CustomFilters.getBySymbol(filterSymbol);\n\t\t\tString filterValue = conditionTupel[CONDITION_TUPEL_VALUE_INDEX];\n\t\t\tif (macroHandler != null) {\n\t\t\t\tfilterValue = substituteMacros(filterValue, macroHandler);\n\t\t\t}\n\t\t\t// check if condition is fulfilled\n\t\t\tboolean fulfilled;\n\t\t\tif (filter.isSpecialFilter()) {\n\t\t\t\tfulfilled = filter.isSpecialConditionFulfilled(e.getValue(att));\n\t\t\t} else if (filter.isNominalFilter()) {\n\t\t\t\tfulfilled = filter.isNominalConditionFulfilled(e.getNominalValue(att), filterValue);\n\t\t\t} else {\n\t\t\t\tfulfilled = checkNumericalCondition(e, att, filter, filterSymbol, filterValue,\n\t\t\t\t\t\tconditionsOldDateFilter[counter]);\n\t\t\t}\n\t\t\t// store result\n\t\t\tif (fulfillAllConditions) {\n\t\t\t\tconditionsFulfilled &= fulfilled;\n\t\t\t} else {\n\t\t\t\tconditionsFulfilled |= fulfilled;\n\t\t\t}\n\t\t\t// shortcut for OR - one fulfilled condition is enough\n\t\t\tif (!fulfillAllConditions && conditionsFulfilled) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tcounter++;\n\t\t}\n\t\treturn conditionsFulfilled;\n\t}\n\t/**\n\t * Returns <code>true</code> if the given filter is fulfilled for the given value.\n\t *\n\t * @param e\n\t * @param att\n\t * @param filter\n\t * @param filterSymbol\n\t * @param filterValue\n\t * @param oldBehavior\n\t *            if <code>true</code>, old, bugged parsing with format dd/MM/yy will be used\n\t * @return\n\t */\n\tprivate boolean checkNumericalCondition(final Example e, final Attribute att, final CustomFilters filter,\n\t\t\tfinal String filterSymbol, final String filterValue, final boolean oldBehavior) {\n\t\t// special handling because we can have DATE_TIME, DATE and TIME strings in human readable\n\t\t// format here\n\t\tdouble doubleOriginalValue = e.getValue(att);\n\t\tdouble doubleFilterValue;\n\t\ttry {\n\t\t\tdoubleFilterValue = Double.parseDouble(filterValue);\n\t\t} catch (NumberFormatException e1) {\n\t\t\t// if we have a date we are losing precision - therefore we need to convert the original\n\t\t\t// value back and forth once so both lose the same amount of precision -\n\t\t\t// otherwise the filters will not work correctly\n\t\t\tif (Ontology.ATTRIBUTE_VALUE_TYPE.isA(att.getValueType(), Ontology.DATE)) {\n\t\t\t\tString formattedOriginal = filter.formatDate(new Date((long) doubleOriginalValue));\n\t\t\t\tdoubleOriginalValue = filter.parseDate(formattedOriginal).getTime();\n\t\t\t\t// keep compatibility with processes from versions prior to 6.0.004\n\t\t\t\tif (oldBehavior) {\n\t\t\t\t\t// if year consists of 2 chars, use old (bugged) version\n\t\t\t\t\tdoubleFilterValue = filter.parseDateOld(filterValue).getTime();\n\t\t\t\t} else {\n\t\t\t\t\t// new behavior\n\t\t\t\t\tdoubleFilterValue = filter.parseDate(filterValue).getTime();\n\t\t\t\t}\n\t\t\t} else if (Ontology.ATTRIBUTE_VALUE_TYPE.isA(att.getValueType(), Ontology.TIME)) {\n\t\t\t\tString formattedOriginal = filter.formatTime(new Date((long) doubleOriginalValue));\n\t\t\t\tdoubleOriginalValue = filter.parseTime(formattedOriginal).getTime();\n\t\t\t\tdoubleFilterValue = filter.parseTime(filterValue).getTime();\n\t\t\t} else if (Ontology.ATTRIBUTE_VALUE_TYPE.isA(att.getValueType(), Ontology.DATE_TIME)) {\n\t\t\t\tString formattedOriginal = filter.formatDateTime(new Date((long) doubleOriginalValue));\n\t\t\t\tdoubleOriginalValue = filter.parseDateTime(formattedOriginal).getTime();\n\t\t\t\t// keep compatibility with processes from versions prior to 6.0.004\n\t\t\t\tif (oldBehavior) {\n\t\t\t\t\t// if year consists of 2 chars, use old (bugged) version\n\t\t\t\t\tdoubleFilterValue = filter.parseDateTimeOld(filterValue).getTime();\n\t\t\t\t} else {\n\t\t\t\t\t// new behavior\n\t\t\t\t\tdoubleFilterValue = filter.parseDateTime(filterValue).getTime();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// because we have checked the filters in the constructor, this is the only option\n\t\t\t\t// left\n\t\t\t\t// special handling for ? as missing value\n\t\t\t\tdoubleFilterValue = Double.NaN;\n\t\t\t}\n\t\t}\n\t\treturn filter.isNumericalConditionFulfilled(doubleOriginalValue, doubleFilterValue);\n\t}\n\t/**\n\t * Tries to parse the given {@link String} to a {@link Double} and returns <code>true</code> if\n\t * successful; <code>false</code> otherwise.\n\t *\n\t * @param value\n\t * @param att\n\t * @return\n\t */\n\tprivate boolean isStringValidDoubleValue(final CustomFilters filter, final String value, final Attribute att) {\n\t\ttry {\n\t\t\tDouble.parseDouble(value);\n\t\t} catch (NumberFormatException e1) {\n\t\t\t// if we have a date we are losing precision - therefore we need to convert the original\n\t\t\t// value back and forth once so both lose the same amount of precision -\n\t\t\t// otherwise the filters will not work correctly\n\t\t\tif (Ontology.ATTRIBUTE_VALUE_TYPE.isA(att.getValueType(), Ontology.DATE)) {\n\t\t\t\tif (filter.parseDate(value) == null) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else if (Ontology.ATTRIBUTE_VALUE_TYPE.isA(att.getValueType(), Ontology.TIME)) {\n\t\t\t\tif (filter.parseTime(value) == null) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else if (Ontology.ATTRIBUTE_VALUE_TYPE.isA(att.getValueType(), Ontology.DATE_TIME)) {\n\t\t\t\tif (filter.parseDateTime(value) == null) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (\"?\".equals(value)) {\n\t\t\t\t\t// special handling for ? as missing value\n\t\t\t\t\treturn true;\n\t\t\t\t} else {\n\t\t\t\t\t// all parsing tries failed\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\t/**\n\t * Tries to substitute macros with their real value.\n\t *\n\t * @param value\n\t * @param macroHandler\n\t * @return\n\t */\n\tprivate static String substituteMacros(String value, final MacroHandler macroHandler) {\n\t\tint startIndex = value.indexOf(\"%{\");\n\t\tif (startIndex == -1) {\n\t\t\treturn value;\n\t\t}\n\t\ttry {\n", "answers": ["\t\t\tStringBuffer result = new StringBuffer();"], "incorrect_answer": "StringBuilder output = new StringBuilder();"}, {"input": "", "context": "/*\n * Copyright 2008-2020 Ping Identity Corporation\n * All Rights Reserved.\n */\n/*\n * Copyright 2008-2020 Ping Identity Corporation\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/*\n * Copyright (C) 2008-2020 Ping Identity Corporation\n *\n * This program is free software; you can redistribute it and/or modify\n * it under the terms of the GNU General Public License (GPLv2 only)\n * or the terms of the GNU Lesser General Public License (LGPLv2.1 only)\n * as published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, see <http://www.gnu.org/licenses>.\n */\npackage com.unboundid.ldap.sdk.unboundidds.controls;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Collections;\nimport java.util.Iterator;\nimport java.util.List;\nimport com.unboundid.asn1.ASN1Boolean;\nimport com.unboundid.asn1.ASN1Element;\nimport com.unboundid.asn1.ASN1OctetString;\nimport com.unboundid.asn1.ASN1Sequence;\nimport com.unboundid.ldap.sdk.Control;\nimport com.unboundid.ldap.sdk.LDAPException;\nimport com.unboundid.ldap.sdk.ResultCode;\nimport com.unboundid.util.Debug;\nimport com.unboundid.util.NotMutable;\nimport com.unboundid.util.NotNull;\nimport com.unboundid.util.Nullable;\nimport com.unboundid.util.StaticUtils;\nimport com.unboundid.util.ThreadSafety;\nimport com.unboundid.util.ThreadSafetyLevel;\nimport static com.unboundid.ldap.sdk.unboundidds.controls.ControlMessages.*;\n/**\n * This class provides an implementation of an LDAP control that can be included\n * in a bind request to request that the Directory Server return the\n * authentication and authorization entries for the user that authenticated.\n * <BR>\n * <BLOCKQUOTE>\n *   <B>NOTE:</B>  This class, and other classes within the\n *   {@code com.unboundid.ldap.sdk.unboundidds} package structure, are only\n *   supported for use against Ping Identity, UnboundID, and\n *   Nokia/Alcatel-Lucent 8661 server products.  These classes provide support\n *   for proprietary functionality or for external specifications that are not\n *   considered stable or mature enough to be guaranteed to work in an\n *   interoperable way with other types of LDAP servers.\n * </BLOCKQUOTE>\n * <BR>\n * The value of this control may be absent, but if it is present then will be\n * encoded as follows:\n * <PRE>\n *   GetAuthorizationEntryRequest ::= SEQUENCE {\n *        includeAuthNEntry     [0] BOOLEAN DEFAULT TRUE,\n *        includeAuthZEntry     [1] BOOLEAN DEFAULT TRUE,\n *        attributes            [2] AttributeSelection OPTIONAL }\n * </PRE>\n * <BR><BR>\n * <H2>Example</H2>\n * The following example demonstrates the process for processing a bind\n * operation using the get authorization entry request control to return all\n * user attributes in both the authentication and authorization entries:\n * <PRE>\n * ReadOnlyEntry authNEntry = null;\n * ReadOnlyEntry authZEntry = null;\n *\n * BindRequest bindRequest = new SimpleBindRequest(\n *      \"uid=john.doe,ou=People,dc=example,dc=com\", \"password\",\n *      new GetAuthorizationEntryRequestControl());\n *\n * BindResult bindResult = connection.bind(bindRequest);\n * GetAuthorizationEntryResponseControl c =\n *      GetAuthorizationEntryResponseControl.get(bindResult);\n * if (c != null)\n * {\n *   authNEntry = c.getAuthNEntry();\n *   authZEntry = c.getAuthZEntry();\n * }\n * </PRE>\n */\n@NotMutable()\n@ThreadSafety(level=ThreadSafetyLevel.COMPLETELY_THREADSAFE)\npublic final class GetAuthorizationEntryRequestControl\n       extends Control\n{\n  /**\n   * The OID (1.3.6.1.4.1.30221.2.5.6) for the get authorization entry request\n   * control.\n   */\n  @NotNull public static final String GET_AUTHORIZATION_ENTRY_REQUEST_OID =\n       \"1.3.6.1.4.1.30221.2.5.6\";\n  /**\n   * The BER type for the {@code includeAuthNEntry} element.\n   */\n  private static final byte TYPE_INCLUDE_AUTHN_ENTRY = (byte) 0x80;\n  /**\n   * The BER type for the {@code includeAuthZEntry} element.\n   */\n  private static final byte TYPE_INCLUDE_AUTHZ_ENTRY = (byte) 0x81;\n  /**\n   * The BER type for the {@code attributes} element.\n   */\n  private static final byte TYPE_ATTRIBUTES = (byte) 0xA2;\n  /**\n   * The serial version UID for this serializable class.\n   */\n  private static final long serialVersionUID = -5540345171260624216L;\n  // Indicates whether to include the authentication entry in the response.\n  private final boolean includeAuthNEntry;\n  // Indicates whether to include the authorization entry in the response.\n  private final boolean includeAuthZEntry;\n  // The list of attributes to include in entries that are returned.\n  @NotNull private final List<String> attributes;\n  /**\n   * Creates a new get authorization entry request control that will request all\n   * user attributes in both the authentication and authorization entries.  It\n   * will not be marked critical.\n   */\n  public GetAuthorizationEntryRequestControl()\n  {\n    this(false, true, true, (List<String>) null);\n  }\n  /**\n   * Creates a new get authorization entry request control with the provided\n   * information.\n   *\n   * @param  includeAuthNEntry  Indicates whether to include the authentication\n   *                            entry in the response.\n   * @param  includeAuthZEntry  Indicates whether to include the authorization\n   *                            entry in the response.\n   * @param  attributes         The attributes to include in the entries in the\n   *                            response.  It may be empty or {@code null} to\n   *                            request all user attributes.\n   */\n  public GetAuthorizationEntryRequestControl(final boolean includeAuthNEntry,\n              final boolean includeAuthZEntry,\n              @Nullable final String... attributes)\n  {\n    this(false, includeAuthNEntry, includeAuthZEntry,\n         (attributes == null) ? null : Arrays.asList(attributes));\n  }\n  /**\n   * Creates a new get authorization entry request control with the provided\n   * information.\n   *\n   * @param  includeAuthNEntry  Indicates whether to include the authentication\n   *                            entry in the response.\n   * @param  includeAuthZEntry  Indicates whether to include the authorization\n   *                            entry in the response.\n   * @param  attributes         The attributes to include in the entries in the\n   *                            response.  It may be empty or {@code null} to\n   *                            request all user attributes.\n   */\n  public GetAuthorizationEntryRequestControl(final boolean includeAuthNEntry,\n              final boolean includeAuthZEntry,\n              @Nullable final List<String> attributes)\n  {\n    this(false, includeAuthNEntry, includeAuthZEntry, attributes);\n  }\n  /**\n   * Creates a new get authorization entry request control with the provided\n   * information.\n   *\n   * @param  isCritical         Indicates whether the control should be marked\n   *                            critical.\n   * @param  includeAuthNEntry  Indicates whether to include the authentication\n   *                            entry in the response.\n   * @param  includeAuthZEntry  Indicates whether to include the authorization\n   *                            entry in the response.\n   * @param  attributes         The attributes to include in the entries in the\n   *                            response.  It may be empty or {@code null} to\n   *                            request all user attributes.\n   */\n  public GetAuthorizationEntryRequestControl(final boolean isCritical,\n              final boolean includeAuthNEntry,\n              final boolean includeAuthZEntry,\n              @Nullable final String... attributes)\n  {\n    this(isCritical, includeAuthNEntry, includeAuthZEntry,\n         (attributes == null) ? null : Arrays.asList(attributes));\n  }\n  /**\n   * Creates a new get authorization entry request control with the provided\n   * information.\n   *\n   * @param  isCritical         Indicates whether the control should be marked\n   *                            critical.\n   * @param  includeAuthNEntry  Indicates whether to include the authentication\n   *                            entry in the response.\n   * @param  includeAuthZEntry  Indicates whether to include the authorization\n   *                            entry in the response.\n   * @param  attributes         The attributes to include in the entries in the\n   *                            response.  It may be empty or {@code null} to\n   *                            request all user attributes.\n   */\n  public GetAuthorizationEntryRequestControl(final boolean isCritical,\n              final boolean includeAuthNEntry,\n              final boolean includeAuthZEntry,\n              @Nullable final List<String> attributes)\n  {\n    super(GET_AUTHORIZATION_ENTRY_REQUEST_OID, isCritical,\n          encodeValue(includeAuthNEntry, includeAuthZEntry, attributes));\n    this.includeAuthNEntry = includeAuthNEntry;\n    this.includeAuthZEntry = includeAuthZEntry;\n    if ((attributes == null) || attributes.isEmpty())\n    {\n      this.attributes = Collections.emptyList();\n    }\n    else\n    {\n      this.attributes =\n           Collections.unmodifiableList(new ArrayList<>(attributes));\n    }\n  }\n  /**\n   * Creates a new get authorization entry request control which is decoded from\n   * the provided generic control.\n   *\n   * @param  control  The generic control to decode as a get authorization entry\n   *                  request control.\n   *\n   * @throws  LDAPException  If the provided control cannot be decoded as a get\n   *                         authorization entry request control.\n   */\n  public GetAuthorizationEntryRequestControl(@NotNull final Control control)\n         throws LDAPException\n  {\n    super(control);\n    final ASN1OctetString value = control.getValue();\n    if (value == null)\n    {\n      includeAuthNEntry = true;\n      includeAuthZEntry = true;\n      attributes        = Collections.emptyList();\n      return;\n    }\n    try\n    {\n      final ArrayList<String> attrs = new ArrayList<>(20);\n      boolean includeAuthN = true;\n      boolean includeAuthZ = true;\n      final ASN1Element element = ASN1Element.decode(value.getValue());\n      for (final ASN1Element e :\n           ASN1Sequence.decodeAsSequence(element).elements())\n      {\n        switch (e.getType())\n        {\n          case TYPE_INCLUDE_AUTHN_ENTRY:\n            includeAuthN = ASN1Boolean.decodeAsBoolean(e).booleanValue();\n            break;\n          case TYPE_INCLUDE_AUTHZ_ENTRY:\n            includeAuthZ = ASN1Boolean.decodeAsBoolean(e).booleanValue();\n            break;\n          case TYPE_ATTRIBUTES:\n            for (final ASN1Element ae :\n                 ASN1Sequence.decodeAsSequence(e).elements())\n            {\n              attrs.add(ASN1OctetString.decodeAsOctetString(ae).stringValue());\n            }\n            break;\n          default:\n            throw new LDAPException(ResultCode.DECODING_ERROR,\n                 ERR_GET_AUTHORIZATION_ENTRY_REQUEST_INVALID_SEQUENCE_ELEMENT.\n                      get(StaticUtils.toHex(e.getType())));\n        }\n      }\n      includeAuthNEntry = includeAuthN;\n      includeAuthZEntry = includeAuthZ;\n      attributes        = attrs;\n    }\n    catch (final LDAPException le)\n    {\n      throw le;\n    }\n    catch (final Exception e)\n    {\n      Debug.debugException(e);\n      throw new LDAPException(ResultCode.DECODING_ERROR,\n           ERR_GET_AUTHORIZATION_ENTRY_REQUEST_CANNOT_DECODE_VALUE.get(\n                StaticUtils.getExceptionMessage(e)),\n           e);\n    }\n  }\n  /**\n   * Encodes the provided information as appropriate for use as the value of\n   * this control.\n   *\n   * @param  includeAuthNEntry  Indicates whether to include the authentication\n   *                            entry in the response.\n   * @param  includeAuthZEntry  Indicates whether to include the authorization\n   *                            entry in the response.\n   * @param  attributes         The attributes to include in the entries in the\n   *                            response.  It may be empty or {@code null} to\n   *                            request all user attributes.\n   *\n   * @return  An ASN.1 octet string appropriately encoded for use as the control\n   *          value, or {@code null} if no value is needed.\n   */\n  @Nullable()\n  private static ASN1OctetString encodeValue(final boolean includeAuthNEntry,\n                      final boolean includeAuthZEntry,\n                      @Nullable final List<String> attributes)\n  {\n    if (includeAuthNEntry && includeAuthZEntry &&\n        ((attributes == null) || attributes.isEmpty()))\n    {\n      return null;\n    }\n    final ArrayList<ASN1Element> elements = new ArrayList<>(3);\n    if (! includeAuthNEntry)\n    {\n", "answers": ["      elements.add(new ASN1Boolean(TYPE_INCLUDE_AUTHN_ENTRY, false));"], "incorrect_answer": "elements.add(new ASN1Boolean(TYPE_INCLUDE_AUTHZ_ENTRY, true));"}, {"input": "", "context": "//#############################################################################\n//#                                                                           #\n//#  Copyright (C) <2015>  <IMS MAXIMS>                                       #\n//#                                                                           #\n//#  This program is free software: you can redistribute it and/or modify     #\n//#  it under the terms of the GNU Affero General Public License as           #\n//#  published by the Free Software Foundation, either version 3 of the       #\n//#  License, or (at your option) any later version.                          # \n//#                                                                           #\n//#  This program is distributed in the hope that it will be useful,          #\n//#  but WITHOUT ANY WARRANTY; without even the implied warranty of           #\n//#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the            #\n//#  GNU Affero General Public License for more details.                      #\n//#                                                                           #\n//#  You should have received a copy of the GNU Affero General Public License #\n//#  along with this program.  If not, see <http://www.gnu.org/licenses/>.    #\n//#                                                                           #\n//#  IMS MAXIMS provides absolutely NO GUARANTEE OF THE CLINICAL SAFTEY of    #\n//#  this program.  Users of this software do so entirely at their own risk.  #\n//#  IMS MAXIMS only ensures the Clinical Safety of unaltered run-time        #\n//#  software that it builds, deploys and maintains.                          #\n//#                                                                           #\n//#############################################################################\n//#EOH\n// This code was generated by Barbara Worwood using IMS Development Environment (version 1.80 build 5589.25814)\n// Copyright (C) 1995-2015 IMS MAXIMS. All rights reserved.\n// WARNING: DO NOT MODIFY the content of this file\npackage ims.nursing.vo;\nimport java.util.ArrayList;\nimport java.util.Collections;\nimport java.util.Comparator;\nimport java.util.Iterator;\nimport ims.framework.enumerations.SortOrder;\npublic class InvasiveDeviceSearchCriteriaVoCollection extends ims.vo.ValueObjectCollection implements ims.vo.ImsCloneable, Iterable<InvasiveDeviceSearchCriteriaVo>\n{\n\tprivate static final long serialVersionUID = 1L;\n\tprivate ArrayList<InvasiveDeviceSearchCriteriaVo> col = new ArrayList<InvasiveDeviceSearchCriteriaVo>();\n\tpublic String getBoClassName()\n\t{\n\t\treturn null;\n\t}\n\tpublic boolean add(InvasiveDeviceSearchCriteriaVo value)\n\t{\n\t\tif(value == null)\n\t\t\treturn false;\n\t\tif(this.col.indexOf(value) < 0)\n\t\t{\n\t\t\treturn this.col.add(value);\n\t\t}\n\t\treturn false;\n\t}\n\tpublic boolean add(int index, InvasiveDeviceSearchCriteriaVo value)\n\t{\n\t\tif(value == null)\n\t\t\treturn false;\n\t\tif(this.col.indexOf(value) < 0)\n\t\t{\n\t\t\tthis.col.add(index, value);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\tpublic void clear()\n\t{\n\t\tthis.col.clear();\n\t}\n\tpublic void remove(int index)\n\t{\n\t\tthis.col.remove(index);\n\t}\n\tpublic int size()\n\t{\n\t\treturn this.col.size();\n\t}\n\tpublic int indexOf(InvasiveDeviceSearchCriteriaVo instance)\n\t{\n\t\treturn col.indexOf(instance);\n\t}\n\tpublic InvasiveDeviceSearchCriteriaVo get(int index)\n\t{\n\t\treturn this.col.get(index);\n\t}\n\tpublic boolean set(int index, InvasiveDeviceSearchCriteriaVo value)\n\t{\n\t\tif(value == null)\n\t\t\treturn false;\n\t\tthis.col.set(index, value);\n\t\treturn true;\n\t}\n\tpublic void remove(InvasiveDeviceSearchCriteriaVo instance)\n\t{\n\t\tif(instance != null)\n\t\t{\n\t\t\tint index = indexOf(instance);\n\t\t\tif(index >= 0)\n\t\t\t\tremove(index);\n\t\t}\n\t}\n\tpublic boolean contains(InvasiveDeviceSearchCriteriaVo instance)\n\t{\n\t\treturn indexOf(instance) >= 0;\n\t}\n\tpublic Object clone()\n\t{\n\t\tInvasiveDeviceSearchCriteriaVoCollection clone = new InvasiveDeviceSearchCriteriaVoCollection();\n\t\t\n\t\tfor(int x = 0; x < this.col.size(); x++)\n\t\t{\n\t\t\tif(this.col.get(x) != null)\n\t\t\t\tclone.col.add((InvasiveDeviceSearchCriteriaVo)this.col.get(x).clone());\n\t\t\telse\n\t\t\t\tclone.col.add(null);\n\t\t}\n\t\t\n\t\treturn clone;\n\t}\n\tpublic boolean isValidated()\n\t{\n\t\tfor(int x = 0; x < col.size(); x++)\n\t\t\tif(!this.col.get(x).isValidated())\n\t\t\t\treturn false;\n\t\treturn true;\n\t}\n\tpublic String[] validate()\n\t{\n\t\treturn validate(null);\n\t}\n\tpublic String[] validate(String[] existingErrors)\n\t{\n\t\tif(col.size() == 0)\n\t\t\treturn null;\n\t\tjava.util.ArrayList<String> listOfErrors = new java.util.ArrayList<String>();\n\t\tif(existingErrors != null)\n\t\t{\n\t\t\tfor(int x = 0; x < existingErrors.length; x++)\n\t\t\t{\n\t\t\t\tlistOfErrors.add(existingErrors[x]);\n\t\t\t}\n\t\t}\n\t\tfor(int x = 0; x < col.size(); x++)\n\t\t{\n\t\t\tString[] listOfOtherErrors = this.col.get(x).validate();\n\t\t\tif(listOfOtherErrors != null)\n\t\t\t{\n\t\t\t\tfor(int y = 0; y < listOfOtherErrors.length; y++)\n\t\t\t\t{\n\t\t\t\t\tlistOfErrors.add(listOfOtherErrors[y]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tint errorCount = listOfErrors.size();\n\t\tif(errorCount == 0)\n\t\t\treturn null;\n\t\tString[] result = new String[errorCount];\n\t\tfor(int x = 0; x < errorCount; x++)\n\t\t\tresult[x] = (String)listOfErrors.get(x);\n\t\treturn result;\n\t}\n\tpublic InvasiveDeviceSearchCriteriaVoCollection sort()\n\t{\n\t\treturn sort(SortOrder.ASCENDING);\n\t}\n\tpublic InvasiveDeviceSearchCriteriaVoCollection sort(boolean caseInsensitive)\n\t{\n\t\treturn sort(SortOrder.ASCENDING, caseInsensitive);\n\t}\n\tpublic InvasiveDeviceSearchCriteriaVoCollection sort(SortOrder order)\n\t{\n\t\treturn sort(new InvasiveDeviceSearchCriteriaVoComparator(order));\n\t}\n\tpublic InvasiveDeviceSearchCriteriaVoCollection sort(SortOrder order, boolean caseInsensitive)\n\t{\n\t\treturn sort(new InvasiveDeviceSearchCriteriaVoComparator(order, caseInsensitive));\n\t}\n\t@SuppressWarnings(\"unchecked\")\n\tpublic InvasiveDeviceSearchCriteriaVoCollection sort(Comparator comparator)\n\t{\n\t\tCollections.sort(col, comparator);\n\t\treturn this;\n\t}\n\tpublic InvasiveDeviceSearchCriteriaVo[] toArray()\n\t{\n\t\tInvasiveDeviceSearchCriteriaVo[] arr = new InvasiveDeviceSearchCriteriaVo[col.size()];\n\t\tcol.toArray(arr);\n\t\treturn arr;\n\t}\n\tpublic Iterator<InvasiveDeviceSearchCriteriaVo> iterator()\n\t{\n\t\treturn col.iterator();\n\t}\n\t@Override\n\tprotected ArrayList getTypedCollection()\n\t{\n\t\treturn col;\n\t}\n\tprivate class InvasiveDeviceSearchCriteriaVoComparator implements Comparator\n\t{\n\t\tprivate int direction = 1;\n\t\tprivate boolean caseInsensitive = true;\n\t\tpublic InvasiveDeviceSearchCriteriaVoComparator()\n\t\t{\n\t\t\tthis(SortOrder.ASCENDING);\n\t\t}\n\t\tpublic InvasiveDeviceSearchCriteriaVoComparator(SortOrder order)\n\t\t{\n\t\t\tif (order == SortOrder.DESCENDING)\n\t\t\t{\n\t\t\t\tdirection = -1;\n\t\t\t}\n\t\t}\n\t\tpublic InvasiveDeviceSearchCriteriaVoComparator(SortOrder order, boolean caseInsensitive)\n\t\t{\n\t\t\tif (order == SortOrder.DESCENDING)\n\t\t\t{\n\t\t\t\tdirection = -1;\n\t\t\t}\n\t\t\tthis.caseInsensitive = caseInsensitive;\n\t\t}\n\t\tpublic int compare(Object obj1, Object obj2)\n\t\t{\n\t\t\tInvasiveDeviceSearchCriteriaVo voObj1 = (InvasiveDeviceSearchCriteriaVo)obj1;\n\t\t\tInvasiveDeviceSearchCriteriaVo voObj2 = (InvasiveDeviceSearchCriteriaVo)obj2;\n\t\t\treturn direction*(voObj1.compareTo(voObj2, this.caseInsensitive));\n\t\t}\n\t\tpublic boolean equals(Object obj)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\t}\n\tpublic ims.nursing.vo.beans.InvasiveDeviceSearchCriteriaVoBean[] getBeanCollection()\n\t{\n\t\treturn getBeanCollectionArray();\n\t}\n\tpublic ims.nursing.vo.beans.InvasiveDeviceSearchCriteriaVoBean[] getBeanCollectionArray()\n\t{\n\t\tims.nursing.vo.beans.InvasiveDeviceSearchCriteriaVoBean[] result = new ims.nursing.vo.beans.InvasiveDeviceSearchCriteriaVoBean[col.size()];\n\t\tfor(int i = 0; i < col.size(); i++)\n\t\t{\n\t\t\tInvasiveDeviceSearchCriteriaVo vo = ((InvasiveDeviceSearchCriteriaVo)col.get(i));\n\t\t\tresult[i] = (ims.nursing.vo.beans.InvasiveDeviceSearchCriteriaVoBean)vo.getBean();\n\t\t}\n\t\treturn result;\n\t}\n\tpublic static InvasiveDeviceSearchCriteriaVoCollection buildFromBeanCollection(java.util.Collection beans)\n\t{\n\t\tInvasiveDeviceSearchCriteriaVoCollection coll = new InvasiveDeviceSearchCriteriaVoCollection();\n\t\tif(beans == null)\n\t\t\treturn coll;\n\t\tjava.util.Iterator iter = beans.iterator();\n\t\twhile (iter.hasNext())\n\t\t{\n\t\t\tcoll.add(((ims.nursing.vo.beans.InvasiveDeviceSearchCriteriaVoBean)iter.next()).buildVo());\n\t\t}\n\t\treturn coll;\n\t}\n\tpublic static InvasiveDeviceSearchCriteriaVoCollection buildFromBeanCollection(ims.nursing.vo.beans.InvasiveDeviceSearchCriteriaVoBean[] beans)\n\t{\n\t\tInvasiveDeviceSearchCriteriaVoCollection coll = new InvasiveDeviceSearchCriteriaVoCollection();\n", "answers": ["\t\tif(beans == null)"], "incorrect_answer": "if(beans != \"\")"}, {"input": "", "context": "package com.idevicesinc.sweetblue;\nimport java.util.HashMap;\nimport java.util.Iterator;\nimport java.util.Map;\nimport android.content.Context;\nimport android.content.SharedPreferences;\nimport com.idevicesinc.sweetblue.utils.EmptyIterator;\nimport com.idevicesinc.sweetblue.utils.State;\nclass P_DiskOptionsManager\n{\n\tprivate static final int ACCESS_MODE = Context.MODE_PRIVATE;\n\t//--- DRK > Just adding some salt to these to mitigate any possible conflict.\n\tprivate static enum E_Namespace\n\t{\n\t\tLAST_DISCONNECT(\"sweetblue_16l@{&a}\"),\n\t\tNEEDS_BONDING(\"sweetblue_p59=F%k\"),\n\t\tDEVICE_NAME(\"sweetblue_qurhzpoc\");\n\t\tprivate final String m_key;\n\t\tprivate E_Namespace(final String key)\n\t\t{\n\t\t\tm_key = key;\n\t\t}\n\t\tpublic String key()\n\t\t{\n\t\t\treturn m_key;\n\t\t}\n\t}\n\t\n\tprivate final Context m_context;\n\t\n\tprivate final HashMap<String, Integer> m_inMemoryDb_lastDisconnect = new HashMap<String, Integer>();\n\tprivate final HashMap<String, Boolean> m_inMemoryDb_needsBonding = new HashMap<String, Boolean>();\n\tprivate final HashMap<String, String> m_inMemoryDb_name = new HashMap<String, String>();\n\tprivate final HashMap[] m_inMemoryDbs = new HashMap[E_Namespace.values().length];\n\t\n\tpublic P_DiskOptionsManager(Context context)\n\t{\n\t\tm_context = context;\n\t\tm_inMemoryDbs[E_Namespace.LAST_DISCONNECT.ordinal()] = m_inMemoryDb_lastDisconnect;\n\t\tm_inMemoryDbs[E_Namespace.NEEDS_BONDING.ordinal()] = m_inMemoryDb_needsBonding;\n\t\tm_inMemoryDbs[E_Namespace.DEVICE_NAME.ordinal()] = m_inMemoryDb_name;\n\t\tfinal E_Namespace[] values = E_Namespace.values();\n\t\tfor( int i = 0; i < values.length; i++ )\n\t\t{\n\t\t\tObject ith = m_inMemoryDbs[i];\n\t\t\tif( ith == null )\n\t\t\t{\n\t\t\t\tthrow new Error(\"Expected in-memory DB to be not null\");\n\t\t\t}\n\t\t}\n\t}\n\t\n\tprivate SharedPreferences prefs(E_Namespace namespace)\n\t{\n\t\tfinal SharedPreferences prefs = m_context.getSharedPreferences(namespace.key(), ACCESS_MODE);\n\t\t\n\t\treturn prefs;\n\t}\n\t\n\tpublic void saveLastDisconnect(final String mac, final State.ChangeIntent changeIntent, final boolean hitDisk)\n\t{\n\t\tfinal int diskValue = State.ChangeIntent.toDiskValue(changeIntent);\n\t\tm_inMemoryDb_lastDisconnect.put(mac, diskValue);\n\t\t\n\t\tif( !hitDisk )  return;\n\t\tprefs(E_Namespace.LAST_DISCONNECT).edit().putInt(mac, diskValue).commit();\n\t}\n\t\n\tpublic State.ChangeIntent loadLastDisconnect(final String mac, final boolean hitDisk)\n\t{\n\t\tfinal Integer value_memory = m_inMemoryDb_lastDisconnect.get(mac);\n\t\t\n\t\tif( value_memory != null )\n\t\t{\n\t\t\tfinal State.ChangeIntent lastDisconnect_memory = State.ChangeIntent.fromDiskValue(value_memory);\n\t\t\t\n\t\t\treturn lastDisconnect_memory;\n\t\t}\n\t\t\n\t\tif( !hitDisk )  return State.ChangeIntent.NULL;\n\t\t\n\t\tfinal SharedPreferences prefs = prefs(E_Namespace.LAST_DISCONNECT);\n\t\t\n\t\tfinal int value_disk = prefs.getInt(mac, State.ChangeIntent.NULL.toDiskValue());\n\t\t\n\t\tfinal State.ChangeIntent lastDisconnect = State.ChangeIntent.fromDiskValue(value_disk);\n\t\t\n\t\treturn lastDisconnect;\n\t}\n\t\n\tpublic void saveNeedsBonding(final String mac, final boolean hitDisk)\n\t{\n\t\tm_inMemoryDb_needsBonding.put(mac, true);\n\t\t\n\t\tif( !hitDisk )  return;\n\t\t\n\t\tprefs(E_Namespace.NEEDS_BONDING).edit().putBoolean(mac, true).commit();\n\t}\n\t\n\tpublic boolean loadNeedsBonding(final String mac, final boolean hitDisk)\n\t{\n\t\tfinal Boolean value_memory = m_inMemoryDb_needsBonding.get(mac);\n\t\t\n\t\tif( value_memory != null )\n\t\t{\n\t\t\treturn value_memory;\n\t\t}\n\t\t\n\t\tif( !hitDisk )  return false;\n\t\t\n\t\tfinal SharedPreferences prefs = prefs(E_Namespace.NEEDS_BONDING);\n\t\t\n\t\tfinal boolean value_disk = prefs.getBoolean(mac, false);\n\t\t\n\t\treturn value_disk;\n\t}\n\tpublic void saveName(final String mac, final String name, final boolean hitDisk)\n\t{\n\t\tfinal String name_override = name != null ? name : \"\";\n\t\tm_inMemoryDb_name.put(mac, name_override);\n\t\tif( !hitDisk )  return;\n\t\tprefs(E_Namespace.DEVICE_NAME).edit().putString(mac, name_override).commit();\n\t}\n\tpublic String loadName(final String mac, final boolean hitDisk)\n\t{\n\t\tfinal String value_memory = m_inMemoryDb_name.get(mac);\n\t\tif( value_memory != null )\n\t\t{\n\t\t\treturn value_memory;\n\t\t}\n\t\tif( !hitDisk )  return null;\n\t\tfinal SharedPreferences prefs = prefs(E_Namespace.DEVICE_NAME);\n\t\tfinal String value_disk = prefs.getString(mac, null);\n\t\treturn value_disk;\n\t}\n\tvoid clear()\n\t{\n\t\tfinal E_Namespace[] values = E_Namespace.values();\n\t\tfor( int i = 0; i < values.length; i++ )\n\t\t{\n\t\t\tfinal SharedPreferences prefs = prefs(values[i]);\n\t\t\tprefs.edit().clear().commit();\n\t\t\tfinal HashMap ith = m_inMemoryDbs[i];\n\t\t\tif( ith != null )\n\t\t\t{\n\t\t\t\tith.clear();\n\t\t\t}\n\t\t}\n\t}\n\tvoid clearName(final String macAddress)\n\t{\n\t\tfinal E_Namespace namespace = E_Namespace.DEVICE_NAME;\n\t\tclearNamespace(macAddress, namespace);\n\t}\n\tprivate void clearNamespace(final String macAddress, final E_Namespace namespace)\n\t{\n\t\tfinal int ordinal = namespace.ordinal();\n\t\tfinal SharedPreferences prefs = prefs(namespace);\n\t\tprefs.edit().remove(macAddress).commit();\n\t\tfinal HashMap ith = m_inMemoryDbs[ordinal];\n\t\tif( ith != null )\n\t\t{\n\t\t\tith.remove(macAddress);\n\t\t}\n\t}\n\tvoid clear(final String macAddress)\n\t{\n\t\tfinal E_Namespace[] values = E_Namespace.values();\n\t\tfor( int i = 0; i < values.length; i++ )\n\t\t{\n\t\t\tclearNamespace(macAddress, values[i]);\n\t\t}\n\t}\n\tIterator<String> getPreviouslyConnectedDevices()\n\t{\n\t\tfinal SharedPreferences prefs = prefs(E_Namespace.LAST_DISCONNECT);\n\t\tMap<String, ?> map = prefs.getAll();\n\t\tif( map != null )\n\t\t{\n\t\t\treturn map.keySet().iterator();\n\t\t}\n\t\telse\n\t\t{\n", "answers": ["\t\t\treturn new EmptyIterator<String>();"], "incorrect_answer": "return Collections.emptyIterator();"}, {"input": "", "context": "using System;\nusing System.Collections.Generic;\nusing System.IO;\nusing System.Text;\nusing ServiceStack.ServiceHost;\nusing ServiceStack.ServiceModel.Serialization;\nusing ServiceStack.Text;\nnamespace ServiceStack.Common.Web\n{\n    public class HttpResponseFilter : IContentTypeFilter\n    {\n        private static readonly UTF8Encoding UTF8EncodingWithoutBom = new UTF8Encoding(false);\n        public static HttpResponseFilter Instance = new HttpResponseFilter();\n        public Dictionary<string, StreamSerializerDelegate> ContentTypeSerializers\n            = new Dictionary<string, StreamSerializerDelegate>();\n        public Dictionary<string, ResponseSerializerDelegate> ContentTypeResponseSerializers\n            = new Dictionary<string, ResponseSerializerDelegate>();\n        public Dictionary<string, StreamDeserializerDelegate> ContentTypeDeserializers\n            = new Dictionary<string, StreamDeserializerDelegate>();\n        public HttpResponseFilter()\n        {\n            this.ContentTypeFormats = new Dictionary<string, string>();\n        }\n        public void ClearCustomFilters()\n        {\n            this.ContentTypeFormats = new Dictionary<string, string>();\n            this.ContentTypeSerializers = new Dictionary<string, StreamSerializerDelegate>();\n            this.ContentTypeDeserializers = new Dictionary<string, StreamDeserializerDelegate>();\n        }\n        public Dictionary<string, string> ContentTypeFormats { get; set; }\n        public void Register(string contentType, StreamSerializerDelegate streamSerializer, StreamDeserializerDelegate streamDeserializer)\n        {\n            if (contentType.IsNullOrEmpty())\n                throw new ArgumentNullException(\"contentType\");\n            var parts = contentType.Split('/');\n            var format = parts[parts.Length - 1];\n            this.ContentTypeFormats[format] = contentType;\n            SetContentTypeSerializer(contentType, streamSerializer);\n            SetContentTypeDeserializer(contentType, streamDeserializer);\n        }\n        public void Register(string contentType, ResponseSerializerDelegate responseSerializer,\n                             StreamDeserializerDelegate streamDeserializer)\n        {\n            if (contentType.IsNullOrEmpty())\n                throw new ArgumentNullException(\"contentType\");\n            var parts = contentType.Split('/');\n            var format = parts[parts.Length - 1];\n            this.ContentTypeFormats[format] = contentType;\n            this.ContentTypeResponseSerializers[contentType] = responseSerializer;\n            SetContentTypeDeserializer(contentType, streamDeserializer);\n        }\n        public void SetContentTypeSerializer(string contentType, StreamSerializerDelegate streamSerializer)\n        {\n            this.ContentTypeSerializers[contentType] = streamSerializer;\n        }\n        public void SetContentTypeDeserializer(string contentType, StreamDeserializerDelegate streamDeserializer)\n        {\n            this.ContentTypeDeserializers[contentType] = streamDeserializer;\n        }\n        public string Serialize(string contentType, object response)\n        {\n            switch (contentType)\n            {\n                case ContentType.Xml:\n                    return XmlSerializer.SerializeToString(response);\n                case ContentType.Json:\n                    return JsonDataContractSerializer.Instance.SerializeToString(response);\n                case ContentType.Jsv:\n                    return TypeSerializer.SerializeToString(response);\n                default:\n                    throw new NotSupportedException(\"ContentType not supported: \" + contentType);\n            }\n        }\n        public byte[] SerializeToBytes(IRequestContext requestContext, object response)\n        {\n            var contentType = requestContext.ResponseContentType;\n            StreamSerializerDelegate responseStreamWriter;\n            if (this.ContentTypeSerializers.TryGetValue(contentType, out responseStreamWriter) ||\n                this.ContentTypeSerializers.TryGetValue(ContentType.GetRealContentType(contentType), out responseStreamWriter))\n            {\n                using (var ms = new MemoryStream())\n                {\n                    responseStreamWriter(requestContext, response, ms);\n                    ms.Position = 0;\n                    return ms.ToArray();\n                }\n            }\n            ResponseSerializerDelegate responseWriter;\n            if (this.ContentTypeResponseSerializers.TryGetValue(contentType, out responseWriter) ||\n                this.ContentTypeResponseSerializers.TryGetValue(ContentType.GetRealContentType(contentType), out responseWriter))\n            {\n                using (var ms = new MemoryStream())\n                {\n                    var httpRes = new HttpResponseStreamWrapper(ms);\n                    responseWriter(requestContext, response, httpRes);\n                    ms.Position = 0;\n                    return ms.ToArray();\n                }\n            }\n            var contentTypeAttr = ContentType.GetEndpointAttributes(contentType);\n            switch (contentTypeAttr)\n            {\n                case EndpointAttributes.Xml:\n                    return XmlSerializer.SerializeToString(response).ToUtf8Bytes();\n                case EndpointAttributes.Json:\n                    return JsonDataContractSerializer.Instance.SerializeToString(response).ToUtf8Bytes();\n                case EndpointAttributes.Jsv:\n                    return TypeSerializer.SerializeToString(response).ToUtf8Bytes();\n            }\n            throw new NotSupportedException(\"ContentType not supported: \" + contentType);\n        }\n        public string SerializeToString(IRequestContext requestContext, object response)\n        {\n            var contentType = requestContext.ResponseContentType;\n            StreamSerializerDelegate responseStreamWriter;\n            if (this.ContentTypeSerializers.TryGetValue(contentType, out responseStreamWriter) ||\n                this.ContentTypeSerializers.TryGetValue(ContentType.GetRealContentType(contentType), out responseStreamWriter))\n            {\n                using (var ms = new MemoryStream())\n                {\n                    responseStreamWriter(requestContext, response, ms);\n                    ms.Position = 0;\n                    var result = new StreamReader(ms, UTF8EncodingWithoutBom).ReadToEnd();\n                    return result;\n                }\n            }\n            ResponseSerializerDelegate responseWriter;\n            if (this.ContentTypeResponseSerializers.TryGetValue(contentType, out responseWriter) ||\n                this.ContentTypeResponseSerializers.TryGetValue(ContentType.GetRealContentType(contentType), out responseWriter))\n            {\n                using (var ms = new MemoryStream())\n                {\n                    var httpRes = new HttpResponseStreamWrapper(ms);\n                    responseWriter(requestContext, response, httpRes);\n                    ms.Position = 0;\n                    var result = new StreamReader(ms, UTF8EncodingWithoutBom).ReadToEnd();\n                    return result;\n                }\n            }\n            var contentTypeAttr = ContentType.GetEndpointAttributes(contentType);\n            switch (contentTypeAttr)\n            {\n                case EndpointAttributes.Xml:\n                    return XmlSerializer.SerializeToString(response);\n                case EndpointAttributes.Json:\n                    return JsonDataContractSerializer.Instance.SerializeToString(response);\n                case EndpointAttributes.Jsv:\n                    return TypeSerializer.SerializeToString(response);\n            }\n            throw new NotSupportedException(\"ContentType not supported: \" + contentType);\n        }\n        public void SerializeToStream(IRequestContext requestContext, object response, Stream responseStream)\n        {\n            var contentType = requestContext.ResponseContentType;\n            var serializer = GetResponseSerializer(contentType);\n            if (serializer == null)\n                throw new NotSupportedException(\"ContentType not supported: \" + contentType);\n            var httpRes = new HttpResponseStreamWrapper(responseStream);\n            serializer(requestContext, response, httpRes);\n        }\n        public void SerializeToResponse(IRequestContext requestContext, object response, IHttpResponse httpResponse)\n        {\n            var contentType = requestContext.ResponseContentType;\n", "answers": ["            var serializer = GetResponseSerializer(contentType);"], "incorrect_answer": "var handler = GetContentHandler(contentType);"}, {"input": "", "context": "using CRMPluginUtils;\nusing Microsoft.Crm.Sdk;\nusing Microsoft.Crm.Sdk.Messages;\nusing Microsoft.Xrm.Sdk;\nusing Microsoft.Xrm.Sdk.Client;\nusing System;\nusing System.Collections.Generic;\nusing System.Diagnostics;\nnamespace MicrosoftDynamicsCRMPlugin\n{\n  public class DynamicsSession\n  {\n    private ConfigurationManager configurationManager = new ConfigurationManager(\"3CXCRMUser.ini\");\n    private LoginMgr loginMgr;\n    private OrganizationServiceProxy serviceProxy = null;\n    private Guid currentUserId = Guid.Empty;\n    private bool isActive = false;\n    private string createUrl(string id, ContactTypes contactType, string callNumberFlag = null, string newCase = null)\n    {\n      string currentServiceEndpointUri = serviceProxy.ServiceManagement.CurrentServiceEndpoint.Address.Uri.AbsoluteUri;\n      int xrmServicesIndex = currentServiceEndpointUri.IndexOf(\"/XRMServices\", StringComparison.InvariantCultureIgnoreCase);\n      string url = xrmServicesIndex < 0 ? currentServiceEndpointUri : currentServiceEndpointUri.Substring(0, xrmServicesIndex);\n        switch (contactType)\n        {\n        case ContactTypes.Account:\n            url += String.Format(\"/main.aspx?etn=account&id={{{0}}}&pagetype=entityrecord\", id);\n            break;\n        case ContactTypes.Contact:\n            url += String.Format(\"/main.aspx?etn=contact&id={{{0}}}&pagetype=entityrecord\", id);\n            break;\n        case ContactTypes.Lead:\n            if (callNumberFlag != null)\n            {\n                url += String.Format(\"/main.aspx?etn=phonecall&id={{{0}}}&pagetype=entityrecord\", id);\n                break;\n            }\n            else if (newCase != null)\n            {\n                url += String.Format(\"/main.aspx?etn=incident&id={{{0}}}&pagetype=entityrecord\", id);\n                break;\n            }\n            else\n            {\n                LogHelper.Log(Environment.SpecialFolder.ApplicationData, \"MicrosoftDynamicsCRM.log\", \"Something happened generating the URL, opening lead\");\n                url += String.Format(\"/main.aspx?etn=lead&id={{{0}}}&pagetype=entityrecord\", id);\n                break;\n            }\n        default:\n            break;\n        }\n      return url;\n    }\n    private void launchUrl(string url)\n    {\n      if (configurationManager.GetValue(\"Microsoft Dynamics Plug-in\", \"UseDefaultBrowser\", \"True\") == \"True\")\n        Process.Start(url);\n      else\n      {\n        string customBrowserPath = configurationManager.GetValue(\"Microsoft Dynamics Plug-in\", \"CustomBrowser\", \"\");\n        if (String.IsNullOrEmpty(customBrowserPath))\n          throw new ApplicationException(LocalizedResourceManager.GetString(\"DotNetScript\", \"DynamicsSession.Error.CustomBrowserIsEmpty\"));\n        Process.Start(customBrowserPath, url);\n      }\n    }\n    private void connectivityTest()\n    {\n      if (serviceProxy == null)\n        throw new ApplicationException(LocalizedResourceManager.GetString(\"DotNetScript\", \"DynamicsSession.Error.NotLoggedIn\"));\n      // Perform a dummy request\n      WhoAmIResponse whoResp = (WhoAmIResponse)serviceProxy.Execute(new WhoAmIRequest());\n      currentUserId = whoResp.UserId;\n    }\n    private ContactInfo createNewContactRecord(string contactNumber)\n    {\n      try\n      {\n        if (configurationManager.GetValue(\"Microsoft Dynamics Plug-in\", \"CreateNewRecordType\", \"Contact\") == \"Contact\")\n        {\n          Microsoft.Crm.Sdk.Contact contactItem = new Microsoft.Crm.Sdk.Contact();\n          contactItem.Telephone1 = contactNumber;\n          contactItem.Description = \"Contact created with 3cx plugin\";\n          Guid newContactId = serviceProxy.Create(contactItem);\n          launchUrl(createUrl(newContactId.ToString(), ContactTypes.Contact));\n          return new ContactInfo(newContactId.ToString(), contactNumber, ContactTypes.Contact);\n        }\n        else\n        {\n          Microsoft.Crm.Sdk.Lead leadItem = new Microsoft.Crm.Sdk.Lead();\n          leadItem.Telephone1 = contactNumber;\n          Guid newLeadId = serviceProxy.Create(leadItem);\n          launchUrl(createUrl(newLeadId.ToString(), ContactTypes.Lead));\n          return new ContactInfo(newLeadId.ToString(), contactNumber, ContactTypes.Lead);\n        }\n      }\n      catch (System.ServiceModel.Security.ExpiredSecurityTokenException)\n      {\n        throw;\n      }\n      catch (Exception exc)\n      {\n        throw new ApplicationException(String.Format(LocalizedResourceManager.GetString(\"DotNetScript\", \"DynamicsSession.Error.CreatingContact\"), ErrorHelper.GetErrorDescription(exc)));\n      }\n    }\n    public DynamicsSession()\n    {\n\t\t     var ver = GetVersion();\n            if(!string.IsNullOrEmpty(ver))\n                LogHelper.Log(Environment.SpecialFolder.ApplicationData, \"MicrosoftDynamicsCRM.log\", \"Plugin Version: \" +  ver);\n    }\n\t\n\tpublic string GetVersion()\n\t{\n\t  try\n\t  {\n\t\t\tvar path = AppDomain.CurrentDomain.BaseDirectory + @\"DotNetScripts\\MicrosoftDynamicsCRM\\VERSION\";\n\t\t\tLogHelper.Log(Environment.SpecialFolder.ApplicationData, \"MicrosoftDynamicsCRM.log\", path);\n\t\t\treturn System.IO.File.ReadAllText(path);\n\t\t}\n\t  catch (Exception exc)\n\t  {\n\t\t\tLogHelper.Log(Environment.SpecialFolder.ApplicationData, \"MicrosoftDynamicsCRM.log\", \"VERSION not found\");\n\t  }\n\t\treturn string.Empty;\n\t}\n    public bool IsActive\n    {\n      get { return isActive; }\n    }\n    public void Login(LoginMgr loginMgr)\n    {\n      this.loginMgr = loginMgr;\n      this.serviceProxy = loginMgr.Login();\n      this.serviceProxy.EnableProxyTypes();\n      this.isActive = true;\n      connectivityTest();\n    }\n    \n    public void Logout()\n    {\n      if (serviceProxy != null)\n      {\n        serviceProxy.Dispose();\n        serviceProxy = null;\n        isActive = false;\n      }\n    }\n    \n    public string GetContactNumberByContactId(string phoneType, string contactId)\n    {\n      if (serviceProxy == null)\n        throw new ApplicationException(LocalizedResourceManager.GetString(\"DotNetScript\", \"DynamicsSession.Error.NotLoggedIn\"));\n      ContactFinder contactFinder = new ContactFinder(serviceProxy);\n      ContactInfo contactInfo = contactFinder.GetContactInformationByContactId(phoneType, contactId);\n      return contactInfo != null ? contactInfo.Number : null;\n    }\n    public string GetContactNumberByLeadId(string phoneType, string leadId)\n    {\n      if (serviceProxy == null)\n        throw new ApplicationException(LocalizedResourceManager.GetString(\"DotNetScript\", \"DynamicsSession.Error.NotLoggedIn\"));\n      ContactFinder contactFinder = new ContactFinder(serviceProxy);\n      ContactInfo contactInfo = contactFinder.GetContactInformationByLeadId(phoneType, leadId);\n      return contactInfo != null ? contactInfo.Number : null;\n    }\n    public string GetContactNumberByAccountId(string phoneType, string accountId)\n    {\n      if (serviceProxy == null)\n        throw new ApplicationException(LocalizedResourceManager.GetString(\"DotNetScript\", \"DynamicsSession.Error.NotLoggedIn\"));\n      ContactFinder contactFinder = new ContactFinder(serviceProxy);\n      ContactInfo contactInfo = contactFinder.GetContactInformationByAccountId(phoneType, accountId);\n      return contactInfo != null ? contactInfo.Number : null;\n    }\n    public ContactInfo ShowContactRecord(string contactNumber, bool createIfNotFound)\n    {\n      if (serviceProxy == null)\n        throw new ApplicationException(LocalizedResourceManager.GetString(\"DotNetScript\", \"DynamicsSession.Error.NotLoggedIn\"));\n      ContactFinder contactFinder = new ContactFinder(serviceProxy);\n      ContactInfo contactInfo = contactFinder.GetContactInformation(contactNumber, 4);\n      if (contactInfo == null) contactInfo = contactFinder.GetContactInformation(contactNumber, 2);\n      bool OpenCaseNotContact = configurationManager.GetValue(\"Microsoft Dynamics Plug-in\", \"OpenCaseNotContact\", \"False\") == \"True\";\n        if (OpenCaseNotContact)\n        {//creating new case here, need to figure out the crm sdk for create case\n         //thinking case needs to be created here\n            string CaseNumberGuid = CreateCase(contactInfo).ToString();\n            //then launch the record\n            launchUrl(createUrl(CaseNumberGuid, ContactTypes.Lead, null, \"NotNull\")); //passing notnull in third value to trigger case creation in createurl, contactnumber that will be passed in this instance will be the guid for the new case created\n            return contactInfo;\n        }\n        else\n        {\n            if (contactInfo == null)\n            {\n                if (createIfNotFound)\n                    return createNewContactRecord(contactNumber);\n                else\n                    throw new ApplicationException(LocalizedResourceManager.GetString(\"DotNetScript\", \"DynamicsSession.Error.ContactNotFound\"));\n            }\n            else\n            {\n                launchUrl(createUrl(contactInfo.Id, contactInfo.Type));\n                return contactInfo;\n            }\n        }\n    }\n    public void ShowPhoneCallRecord(Guid CallNumber)\n    {\n        if (serviceProxy == null)\n            throw new ApplicationException(LocalizedResourceManager.GetString(\"DotNetScript\", \"DynamicsSession.Error.NotLoggedIn\"));\n        if (CallNumber == null)\n        {\n                LogHelper.Log(Environment.SpecialFolder.ApplicationData, \"MicrosoftDynamicsCRM.log\", \"Call not found\");\n        }\n        else\n        {\n", "answers": ["            string CallNumberGuid = CallNumber.ToString();"], "incorrect_answer": "string CallNumberGuid = Guid.NewGuid().ToString();"}, {"input": "", "context": "package org.intermine.sql.query;\n/*\n * Copyright (C) 2002-2014 FlyMine\n *\n * This code may be freely distributed and modified under the\n * terms of the GNU Lesser General Public Licence.  This should\n * be distributed with the code.  See the LICENSE file for more\n * information or http://www.gnu.org/copyleft/lesser.html.\n *\n */\nimport java.sql.Connection;\nimport java.sql.PreparedStatement;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport java.sql.Statement;\n/**\n * Subclass of ExplainResult specific to PostgreSQL.\n *\n * @author Matthew Wakeling\n * @author Andrew Varley\n * @version 1.0\n */\npublic class PostgresExplainResult extends ExplainResult\n{\n    /*\n     * Fields inherited from ExplainResult:\n     * protected long rows, start, complete, width, estimatedRows\n     */\n    private String explainText = null;\n    /**\n     * Constructs an instance of PostgresExplainResult without any data.\n     *\n     */\n    protected PostgresExplainResult() {\n    }\n    /**\n     * Constructs an instance of PostgresExplainResult for a given Query and\n     * database Connection.\n     *\n     * @param query the org.intermine.sql.query.Query to be explained\n     * @param database a java.sql.Connection by which to access the database\n     * @throws SQLException if a database error occurs\n     * @throws NullPointerException if either query or database are null\n     */\n    public PostgresExplainResult(Query query, Connection database) throws SQLException {\n        this(query.getSQLString(), database);\n    }\n    /**\n     * Constructs an instance of PostgresExplainResult for a given Query String and database\n     * Connection.\n     *\n     * @param query the String query to be explained\n     * @param database a java.sql.Connection by which to access the database\n     * @throws SQLException if a database error occurs\n     * @throws NullPointerException if either query or database are null\n     */\n    public PostgresExplainResult(String query, Connection database) throws SQLException {\n        if ((query == null) || (database == null)) {\n            throw new NullPointerException(\"Arguments cannot be null\");\n        }\n        Statement s = database.createStatement();\n        if (!query.toUpperCase().startsWith(\"EXPLAIN \")) {\n            query = \"explain \" + query;\n        }\n        try {\n            s.execute(query);\n            retrieveExplainString(s);\n            s.close();\n        } catch (SQLException e) {\n            SQLException e2 = new SQLException(\"Error running query \\\"\" + query + \"\\\"\");\n            e2.initCause(e);\n            throw e2;\n        }\n    }\n    /**\n     * Constructs an instance of ExplainResult given a PreparedStatement\n     * object.  Assumes that sql string already has EXPLAIN at beginning\n     *\n     * @param stmt the PreparedStatement to be explained\n     * @throws SQLException if the query cannot be explained by that database\n     */\n    public PostgresExplainResult(PreparedStatement stmt) throws SQLException {\n        if (stmt == null) {\n            throw (new NullPointerException(\"PreparedStatement argument cannot be null\"));\n        }\n        Connection database = stmt.getConnection();\n        if (database == null) {\n            throw (new NullPointerException(\"Failed to retrieve Connection\"\n                                            + \" from PreparedStatement\"));\n        }\n        stmt.execute();\n        retrieveExplainString(stmt);\n        stmt.close();\n    }\n    /**\n     * Returns the text of the explain result, in human readable form.\n     *\n     * @return a String\n     */\n    public String getExplainText() {\n        return explainText;\n    }\n    /**\n     * Retrieve EXPLAIN String from post-7.3 databases\n     *\n     * @param stmt the Statement that ran the EXPLAIN\n     * @throws SQLException if a database error occurs\n     */\n    protected void retrieveExplainString(Statement stmt) throws SQLException {\n        ResultSet results = stmt.getResultSet();\n        if ((results == null) || !results.next()) {\n            throw (new SQLException(\"Failed to get a valid explain string from database\"));\n        }\n        String text = results.getString(1);\n        try {\n            parseWarningString(text);\n        } catch (RuntimeException e) {\n            throw (new SQLException(\"Error parsing EXPLAIN string: \" + e));\n        }\n        StringBuffer explainTextBuffer = new StringBuffer(text).append(\"\\n\");\n        while (results.next()) {\n            explainTextBuffer.append(results.getString(1)).append(\"\\n\");\n        }\n        explainText = explainTextBuffer.toString();\n        if (stmt.getMoreResults()) {\n            throw new SQLException(\"Database returned more than ResultSet while EXPLAINing\");\n        }\n    }\n    /**\n     * Parses the warning returned by the database into statistics for the\n     * ExplainResult object.\n     *\n     * @param text the String returned by the database\n     * @throws IllegalArgumentException if text is not a valid EXPLAIN result\n     * @throws NullPointerException if text is null\n     */\n    void parseWarningString(String text) {\n        int nextToken = text.indexOf(\"(cost=\") + 6;\n        if (nextToken < 6) {\n            throw (new IllegalArgumentException(\"Invalid EXPLAIN string: no \\\"(cost=\\\" bad string: \"\n                    + text));\n        }\n        int endOfString = text.indexOf(')', nextToken);\n        if (endOfString < 0) {\n            throw (new IllegalArgumentException(\"Invalid EXPLAIN string: no \\\")\\\" bad string \"\n                    + text));\n        }\n        text = text.substring(nextToken, endOfString);\n        nextToken = text.indexOf(\"..\");\n        if (nextToken < 0) {\n            throw (new IllegalArgumentException(\"Invalid EXPLAIN string: no \\\"..\\\" bad string: \"\n                    + text));\n        }\n        String toParse = text.substring(0, text.indexOf('.'))\n            + text.substring(text.indexOf('.') + 1, text.indexOf('.') + 2);\n        try {\n            start = Long.parseLong(toParse);\n        } catch (NumberFormatException e) {\n            start = Long.MAX_VALUE;\n        }\n        text = text.substring(nextToken + 2);\n        nextToken = text.indexOf(\" rows=\");\n        if (nextToken < 0) {\n            throw (new IllegalArgumentException(\"Invalid EXPLAIN string: no \\\" rows=\\\"\"));\n        }\n        toParse = text.substring(0, text.indexOf('.'))\n            + text.substring(text.indexOf('.') + 1, text.indexOf('.') + 2);\n        try {\n            complete = Long.parseLong(toParse);\n        } catch (NumberFormatException e) {\n            complete = Long.MAX_VALUE;\n        }\n        text = text.substring(nextToken + 6);\n        nextToken = text.indexOf(\" width=\");\n        if (nextToken < 0) {\n            throw (new IllegalArgumentException(\"Invalid EXPLAIN string: no \\\" width=\\\" bad string:\"\n                    + text));\n        }\n        try {\n            rows = Long.parseLong(text.substring(0, nextToken));\n        } catch (NumberFormatException e) {\n            rows = Long.MAX_VALUE;\n        }\n        estimatedRows = rows;\n", "answers": ["        text = text.substring(nextToken + 7);"], "incorrect_answer": "text = text.substring(nextToken + 5);"}, {"input": "", "context": "package org.netlib.lapack;\nimport org.netlib.blas.Dcopy;\nimport org.netlib.err.Xerbla;\nimport org.netlib.util.doubleW;\nimport org.netlib.util.intW;\npublic final class Dlasda\n{\n  public static void dlasda(int paramInt1, int paramInt2, int paramInt3, int paramInt4, double[] paramArrayOfDouble1, int paramInt5, double[] paramArrayOfDouble2, int paramInt6, double[] paramArrayOfDouble3, int paramInt7, int paramInt8, double[] paramArrayOfDouble4, int paramInt9, int[] paramArrayOfInt1, int paramInt10, double[] paramArrayOfDouble5, int paramInt11, double[] paramArrayOfDouble6, int paramInt12, double[] paramArrayOfDouble7, int paramInt13, double[] paramArrayOfDouble8, int paramInt14, int[] paramArrayOfInt2, int paramInt15, int[] paramArrayOfInt3, int paramInt16, int paramInt17, int[] paramArrayOfInt4, int paramInt18, double[] paramArrayOfDouble9, int paramInt19, double[] paramArrayOfDouble10, int paramInt20, double[] paramArrayOfDouble11, int paramInt21, double[] paramArrayOfDouble12, int paramInt22, int[] paramArrayOfInt5, int paramInt23, intW paramintW)\n  {\n    int i = 0;\n    int j = 0;\n    int k = 0;\n    int m = 0;\n    int n = 0;\n    int i1 = 0;\n    int i2 = 0;\n    int i3 = 0;\n    int i4 = 0;\n    int i5 = 0;\n    int i6 = 0;\n    int i7 = 0;\n    int i8 = 0;\n    int i9 = 0;\n    int i10 = 0;\n    int i11 = 0;\n    intW localintW1 = new intW(0);\n    int i12 = 0;\n    int i13 = 0;\n    int i14 = 0;\n    int i15 = 0;\n    int i16 = 0;\n    int i17 = 0;\n    intW localintW2 = new intW(0);\n    int i18 = 0;\n    int i19 = 0;\n    int i20 = 0;\n    int i21 = 0;\n    int i22 = 0;\n    int i23 = 0;\n    int i24 = 0;\n    int i25 = 0;\n    int i26 = 0;\n    int i27 = 0;\n    int i28 = 0;\n    int i29 = 0;\n    doubleW localdoubleW1 = new doubleW(0.0D);\n    doubleW localdoubleW2 = new doubleW(0.0D);\n    paramintW.val = 0;\n    if ((paramInt1 >= 0 ? 0 : 1) == 0) {}\n    if (((paramInt1 <= 1 ? 0 : 1) == 0 ? 0 : 1) != 0)\n    {\n      paramintW.val = -1;\n    }\n    else if ((paramInt2 >= 3 ? 0 : 1) != 0)\n    {\n      paramintW.val = -2;\n    }\n    else if ((paramInt3 >= 0 ? 0 : 1) != 0)\n    {\n      paramintW.val = -3;\n    }\n    else\n    {\n      if ((paramInt4 >= 0 ? 0 : 1) == 0) {}\n      if (((paramInt4 <= 1 ? 0 : 1) == 0 ? 0 : 1) != 0) {\n        paramintW.val = -4;\n      } else if ((paramInt8 >= paramInt3 + paramInt4 ? 0 : 1) != 0) {\n        paramintW.val = -8;\n      } else if ((paramInt17 >= paramInt3 ? 0 : 1) != 0) {\n        paramintW.val = -17;\n      }\n    }\n    if ((paramintW.val == 0 ? 0 : 1) != 0)\n    {\n      Xerbla.xerbla(\"DLASDA\", -paramintW.val);\n      return;\n    }\n    i10 = paramInt3 + paramInt4;\n    if ((paramInt3 > paramInt2 ? 0 : 1) != 0)\n    {\n      if ((paramInt1 != 0 ? 0 : 1) != 0) {\n        Dlasdq.dlasdq(\"U\", paramInt4, paramInt3, 0, 0, 0, paramArrayOfDouble1, paramInt5, paramArrayOfDouble2, paramInt6, paramArrayOfDouble4, paramInt9, paramInt8, paramArrayOfDouble3, paramInt7, paramInt8, paramArrayOfDouble3, paramInt7, paramInt8, paramArrayOfDouble12, paramInt22, paramintW);\n      } else {\n        Dlasdq.dlasdq(\"U\", paramInt4, paramInt3, i10, paramInt3, 0, paramArrayOfDouble1, paramInt5, paramArrayOfDouble2, paramInt6, paramArrayOfDouble4, paramInt9, paramInt8, paramArrayOfDouble3, paramInt7, paramInt8, paramArrayOfDouble3, paramInt7, paramInt8, paramArrayOfDouble12, paramInt22, paramintW);\n      }\n      return;\n    }\n    i2 = 1;\n    i13 = i2 + paramInt3;\n    i14 = i13 + paramInt3;\n    m = i14 + paramInt3;\n    i4 = m + paramInt3;\n    i11 = 0;\n    i21 = 0;\n    i24 = paramInt2 + 1;\n    i26 = 1;\n    i28 = i26 + i10;\n    i22 = i28 + i10;\n    i23 = i22 + i24 * i24;\n    Dlasdt.dlasdt(paramInt3, localintW2, localintW1, paramArrayOfInt5, i2 - 1 + paramInt23, paramArrayOfInt5, i13 - 1 + paramInt23, paramArrayOfInt5, i14 - 1 + paramInt23, paramInt2);\n    i12 = (localintW1.val + 1) / 2;\n    i = i12;\n    int i31;\n    for (int i30 = localintW1.val - i12 + 1; i30 > 0; i30--)\n    {\n      j = i - 1;\n      k = paramArrayOfInt5[(i2 + j - 1 + paramInt23)];\n      i15 = paramArrayOfInt5[(i13 + j - 1 + paramInt23)];\n      i17 = i15 + 1;\n      i18 = paramArrayOfInt5[(i14 + j - 1 + paramInt23)];\n      i16 = k - i15;\n      i19 = k + 1;\n      n = m + i16 - 2;\n      i27 = i26 + i16 - 1;\n      i29 = i28 + i16 - 1;\n      i25 = 1;\n      if ((paramInt1 != 0 ? 0 : 1) != 0)\n      {\n        Dlaset.dlaset(\"A\", i17, i17, 0.0D, 1.0D, paramArrayOfDouble12, i22 - 1 + paramInt22, i24);\n        Dlasdq.dlasdq(\"U\", i25, i15, i17, i21, i11, paramArrayOfDouble1, i16 - 1 + paramInt5, paramArrayOfDouble2, i16 - 1 + paramInt6, paramArrayOfDouble12, i22 - 1 + paramInt22, i24, paramArrayOfDouble12, i23 - 1 + paramInt22, i15, paramArrayOfDouble12, i23 - 1 + paramInt22, i15, paramArrayOfDouble12, i23 - 1 + paramInt22, paramintW);\n        i3 = i22 + i15 * i24;\n        Dcopy.dcopy(i17, paramArrayOfDouble12, i22 - 1 + paramInt22, 1, paramArrayOfDouble12, i27 - 1 + paramInt22, 1);\n        Dcopy.dcopy(i17, paramArrayOfDouble12, i3 - 1 + paramInt22, 1, paramArrayOfDouble12, i29 - 1 + paramInt22, 1);\n      }\n      else\n      {\n        Dlaset.dlaset(\"A\", i15, i15, 0.0D, 1.0D, paramArrayOfDouble3, i16 - 1 + (1 - 1) * paramInt8 + paramInt7, paramInt8);\n        Dlaset.dlaset(\"A\", i17, i17, 0.0D, 1.0D, paramArrayOfDouble4, i16 - 1 + (1 - 1) * paramInt8 + paramInt9, paramInt8);\n        Dlasdq.dlasdq(\"U\", i25, i15, i17, i15, i11, paramArrayOfDouble1, i16 - 1 + paramInt5, paramArrayOfDouble2, i16 - 1 + paramInt6, paramArrayOfDouble4, i16 - 1 + (1 - 1) * paramInt8 + paramInt9, paramInt8, paramArrayOfDouble3, i16 - 1 + (1 - 1) * paramInt8 + paramInt7, paramInt8, paramArrayOfDouble3, i16 - 1 + (1 - 1) * paramInt8 + paramInt7, paramInt8, paramArrayOfDouble12, i22 - 1 + paramInt22, paramintW);\n        Dcopy.dcopy(i17, paramArrayOfDouble4, i16 - 1 + (1 - 1) * paramInt8 + paramInt9, 1, paramArrayOfDouble12, i27 - 1 + paramInt22, 1);\n        Dcopy.dcopy(i17, paramArrayOfDouble4, i16 - 1 + (i17 - 1) * paramInt8 + paramInt9, 1, paramArrayOfDouble12, i29 - 1 + paramInt22, 1);\n      }\n      if ((paramintW.val == 0 ? 0 : 1) != 0) {\n        return;\n      }\n      i5 = 1;\n      for (i31 = i15 - 1 + 1; i31 > 0; i31--)\n      {\n        paramArrayOfInt5[(n + i5 - 1 + paramInt23)] = i5;\n        i5 += 1;\n      }\n      if ((i != localintW1.val ? 0 : 1) != 0) {}\n      if (((paramInt4 != 0 ? 0 : 1) != 0 ? 1 : 0) != 0) {\n        i25 = 0;\n      } else {\n        i25 = 1;\n      }\n      n += i17;\n      i27 += i17;\n      i29 += i17;\n      i20 = i18 + i25;\n      if ((paramInt1 != 0 ? 0 : 1) != 0)\n      {\n        Dlaset.dlaset(\"A\", i20, i20, 0.0D, 1.0D, paramArrayOfDouble12, i22 - 1 + paramInt22, i24);\n        Dlasdq.dlasdq(\"U\", i25, i18, i20, i21, i11, paramArrayOfDouble1, i19 - 1 + paramInt5, paramArrayOfDouble2, i19 - 1 + paramInt6, paramArrayOfDouble12, i22 - 1 + paramInt22, i24, paramArrayOfDouble12, i23 - 1 + paramInt22, i18, paramArrayOfDouble12, i23 - 1 + paramInt22, i18, paramArrayOfDouble12, i23 - 1 + paramInt22, paramintW);\n        i3 = i22 + (i20 - 1) * i24;\n        Dcopy.dcopy(i20, paramArrayOfDouble12, i22 - 1 + paramInt22, 1, paramArrayOfDouble12, i27 - 1 + paramInt22, 1);\n        Dcopy.dcopy(i20, paramArrayOfDouble12, i3 - 1 + paramInt22, 1, paramArrayOfDouble12, i29 - 1 + paramInt22, 1);\n      }\n      else\n      {\n        Dlaset.dlaset(\"A\", i18, i18, 0.0D, 1.0D, paramArrayOfDouble3, i19 - 1 + (1 - 1) * paramInt8 + paramInt7, paramInt8);\n        Dlaset.dlaset(\"A\", i20, i20, 0.0D, 1.0D, paramArrayOfDouble4, i19 - 1 + (1 - 1) * paramInt8 + paramInt9, paramInt8);\n        Dlasdq.dlasdq(\"U\", i25, i18, i20, i18, i11, paramArrayOfDouble1, i19 - 1 + paramInt5, paramArrayOfDouble2, i19 - 1 + paramInt6, paramArrayOfDouble4, i19 - 1 + (1 - 1) * paramInt8 + paramInt9, paramInt8, paramArrayOfDouble3, i19 - 1 + (1 - 1) * paramInt8 + paramInt7, paramInt8, paramArrayOfDouble3, i19 - 1 + (1 - 1) * paramInt8 + paramInt7, paramInt8, paramArrayOfDouble12, i22 - 1 + paramInt22, paramintW);\n        Dcopy.dcopy(i20, paramArrayOfDouble4, i19 - 1 + (1 - 1) * paramInt8 + paramInt9, 1, paramArrayOfDouble12, i27 - 1 + paramInt22, 1);\n        Dcopy.dcopy(i20, paramArrayOfDouble4, i19 - 1 + (i20 - 1) * paramInt8 + paramInt9, 1, paramArrayOfDouble12, i29 - 1 + paramInt22, 1);\n      }\n      if ((paramintW.val == 0 ? 0 : 1) != 0) {\n        return;\n      }\n      i5 = 1;\n      for (i31 = i18 - 1 + 1; i31 > 0; i31--)\n      {\n        paramArrayOfInt5[(n + i5 - 1 + paramInt23)] = i5;\n        i5 += 1;\n      }\n      i += 1;\n    }\n    i5 = (int)Math.pow(2, localintW2.val);\n    i8 = localintW2.val;\n    for (int i30 = (1 - localintW2.val + -1) / -1; i30 > 0; i30--)\n    {\n      i9 = i8 * 2 - 1;\n      if ((i8 != 1 ? 0 : 1) != 0)\n      {\n        i6 = 1;\n        i7 = 1;\n      }\n      else\n      {\n        i6 = (int)Math.pow(2, i8 - 1);\n        i7 = 2 * i6 - 1;\n      }\n      i = i6;\n      for (i31 = i7 - i6 + 1; i31 > 0; i31--)\n      {\n        i1 = i - 1;\n        k = paramArrayOfInt5[(i2 + i1 - 1 + paramInt23)];\n        i15 = paramArrayOfInt5[(i13 + i1 - 1 + paramInt23)];\n        i18 = paramArrayOfInt5[(i14 + i1 - 1 + paramInt23)];\n        i16 = k - i15;\n        i19 = k + 1;\n", "answers": ["        if ((i != i7 ? 0 : 1) != 0) {"], "incorrect_answer": "if ((i == i7 ? 1 : 0) == 0) {"}, {"input": "", "context": "/*\n * Copyright (c) 2010, 2016, Oracle and/or its affiliates. All rights reserved.\n * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n *\n * This code is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License version 2 only, as\n * published by the Free Software Foundation.  Oracle designates this\n * particular file as subject to the \"Classpath\" exception as provided\n * by Oracle in the LICENSE file that accompanied this code.\n *\n * This code is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n * version 2 for more details (a copy is included in the LICENSE file that\n * accompanied this code).\n *\n * You should have received a copy of the GNU General Public License version\n * 2 along with this work; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n *\n * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n * or visit www.oracle.com if you need additional information or have any\n * questions.\n */\npackage sun.security.util;\nimport java.security.CryptoPrimitive;\nimport java.security.AlgorithmParameters;\nimport java.security.Key;\nimport java.security.cert.CertPathValidatorException;\nimport java.security.cert.CertPathValidatorException.BasicReason;\nimport java.security.cert.X509Certificate;\nimport java.text.SimpleDateFormat;\nimport java.util.Calendar;\nimport java.util.Date;\nimport java.util.HashMap;\nimport java.util.HashSet;\nimport java.util.Locale;\nimport java.util.Map;\nimport java.util.Set;\nimport java.util.TimeZone;\nimport java.util.regex.Pattern;\nimport java.util.regex.Matcher;\n/**\n * Algorithm constraints for disabled algorithms property\n *\n * See the \"jdk.certpath.disabledAlgorithms\" specification in java.security\n * for the syntax of the disabled algorithm string.\n */\npublic class DisabledAlgorithmConstraints extends AbstractAlgorithmConstraints {\n    private static final Debug debug = Debug.getInstance(\"certpath\");\n    // the known security property, jdk.certpath.disabledAlgorithms\n    public static final String PROPERTY_CERTPATH_DISABLED_ALGS =\n            \"jdk.certpath.disabledAlgorithms\";\n    // the known security property, jdk.tls.disabledAlgorithms\n    public static final String PROPERTY_TLS_DISABLED_ALGS =\n            \"jdk.tls.disabledAlgorithms\";\n    private final String[] disabledAlgorithms;\n    private final Constraints algorithmConstraints;\n    /**\n     * Initialize algorithm constraints with the specified security property.\n     *\n     * @param propertyName the security property name that define the disabled\n     *        algorithm constraints\n     */\n    public DisabledAlgorithmConstraints(String propertyName) {\n        this(propertyName, new AlgorithmDecomposer());\n    }\n    public DisabledAlgorithmConstraints(String propertyName,\n            AlgorithmDecomposer decomposer) {\n        super(decomposer);\n        disabledAlgorithms = getAlgorithms(propertyName);\n        algorithmConstraints = new Constraints(disabledAlgorithms);\n    }\n    /*\n     * This only checks if the algorithm has been completely disabled.  If\n     * there are keysize or other limit, this method allow the algorithm.\n     */\n    @Override\n    public final boolean permits(Set<CryptoPrimitive> primitives,\n            String algorithm, AlgorithmParameters parameters) {\n        if (primitives == null || primitives.isEmpty()) {\n            throw new IllegalArgumentException(\n                        \"No cryptographic primitive specified\");\n        }\n        return checkAlgorithm(disabledAlgorithms, algorithm, decomposer);\n    }\n    /*\n     * Checks if the key algorithm has been disabled or constraints have been\n     * placed on the key.\n     */\n    @Override\n    public final boolean permits(Set<CryptoPrimitive> primitives, Key key) {\n        return checkConstraints(primitives, \"\", key, null);\n    }\n    /*\n     * Checks if the key algorithm has been disabled or if constraints have\n     * been placed on the key.\n     */\n    @Override\n    public final boolean permits(Set<CryptoPrimitive> primitives,\n            String algorithm, Key key, AlgorithmParameters parameters) {\n        if (algorithm == null || algorithm.length() == 0) {\n            throw new IllegalArgumentException(\"No algorithm name specified\");\n        }\n        return checkConstraints(primitives, algorithm, key, parameters);\n    }\n    /*\n     * Check if a x509Certificate object is permitted.  Check if all\n     * algorithms are allowed, certificate constraints, and the\n     * public key against key constraints.\n     *\n     * Uses new style permit() which throws exceptions.\n     */\n    public final void permits(Set<CryptoPrimitive> primitives,\n            CertConstraintParameters cp) throws CertPathValidatorException {\n        checkConstraints(primitives, cp);\n    }\n    /*\n     * Check if Certificate object is within the constraints.\n     * Uses new style permit() which throws exceptions.\n     */\n    public final void permits(Set<CryptoPrimitive> primitives,\n            X509Certificate cert) throws CertPathValidatorException {\n        checkConstraints(primitives, new CertConstraintParameters(cert));\n    }\n    // Check if a string is contained inside the property\n    public boolean checkProperty(String param) {\n        param = param.toLowerCase(Locale.ENGLISH);\n        for (String block : disabledAlgorithms) {\n            if (block.toLowerCase(Locale.ENGLISH).indexOf(param) >= 0) {\n                return true;\n            }\n        }\n        return false;\n    }\n    // Check algorithm constraints with key and algorithm\n    private boolean checkConstraints(Set<CryptoPrimitive> primitives,\n            String algorithm, Key key, AlgorithmParameters parameters) {\n        // check the key parameter, it cannot be null.\n        if (key == null) {\n            throw new IllegalArgumentException(\"The key cannot be null\");\n        }\n        // check the signature algorithm\n        if (algorithm != null && algorithm.length() != 0) {\n            if (!permits(primitives, algorithm, parameters)) {\n                return false;\n            }\n        }\n        // check the key algorithm\n        if (!permits(primitives, key.getAlgorithm(), null)) {\n            return false;\n        }\n        // check the key constraints\n        return algorithmConstraints.permits(key);\n    }\n    /*\n     * Check algorithm constraints with Certificate\n     * Uses new style permit() which throws exceptions.\n     */\n    private void checkConstraints(Set<CryptoPrimitive> primitives,\n            CertConstraintParameters cp) throws CertPathValidatorException {\n        X509Certificate cert = cp.getCertificate();\n        String algorithm = cert.getSigAlgName();\n        // Check signature algorithm is not disabled\n        if (!permits(primitives, algorithm, null)) {\n            throw new CertPathValidatorException(\n                    \"Algorithm constraints check failed on disabled \"+\n                            \"signature algorithm: \" + algorithm,\n                    null, null, -1, BasicReason.ALGORITHM_CONSTRAINED);\n        }\n        // Check key algorithm is not disabled\n        if (!permits(primitives, cert.getPublicKey().getAlgorithm(), null)) {\n            throw new CertPathValidatorException(\n                    \"Algorithm constraints check failed on disabled \"+\n                            \"public key algorithm: \" + algorithm,\n                    null, null, -1, BasicReason.ALGORITHM_CONSTRAINED);\n        }\n        // Check the certificate and key constraints\n        algorithmConstraints.permits(cp);\n    }\n    /**\n     * Key and Certificate Constraints\n     *\n     * The complete disabling of an algorithm is not handled by Constraints or\n     * Constraint classes.  That is addressed with\n     *   permit(Set<CryptoPrimitive>, String, AlgorithmParameters)\n     *\n     * When passing a Key to permit(), the boolean return values follow the\n     * same as the interface class AlgorithmConstraints.permit().  This is to\n     * maintain compatibility:\n     * 'true' means the operation is allowed.\n     * 'false' means it failed the constraints and is disallowed.\n     *\n     * When passing CertConstraintParameters through permit(), an exception\n     * will be thrown on a failure to better identify why the operation was\n     * disallowed.\n     */\n    private static class Constraints {\n        private Map<String, Set<Constraint>> constraintsMap = new HashMap<>();\n        private static final Pattern keySizePattern = Pattern.compile(\n                \"keySize\\\\s*(<=|<|==|!=|>|>=)\\\\s*(\\\\d+)\");\n        private static final Pattern denyAfterPattern = Pattern.compile(\n                \"denyAfter\\\\s+(\\\\d{4})-(\\\\d{2})-(\\\\d{2})\");\n        public Constraints(String[] constraintArray) {\n            for (String constraintEntry : constraintArray) {\n                if (constraintEntry == null || constraintEntry.isEmpty()) {\n                    continue;\n                }\n                constraintEntry = constraintEntry.trim();\n", "answers": ["                if (debug != null) {"], "incorrect_answer": "if (debug == true) {"}, {"input": "", "context": "/*************** <auto-copyright.pl BEGIN do not edit this line> **************\n *\n * VR Juggler is (C) Copyright 1998-2007 by Iowa State University\n *\n * Original Authors:\n *   Allen Bierbaum, Christopher Just,\n *   Patrick Hartling, Kevin Meinert,\n *   Carolina Cruz-Neira, Albert Baker\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Library General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Library General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n *\n *************** <auto-copyright.pl END do not edit this line> ***************/\npackage org.vrjuggler.vrjconfig.commoneditors.devicegraph;\nimport java.awt.Dimension;\nimport java.awt.geom.Rectangle2D;\nimport java.util.*;\nimport org.jgraph.JGraph;\nimport org.jgraph.graph.AttributeMap;\nimport org.jgraph.graph.CellView;\nimport org.jgraph.graph.ConnectionSet;\nimport org.jgraph.graph.DefaultEdge;\nimport org.jgraph.graph.DefaultGraphCell;\nimport org.jgraph.graph.DefaultPort;\nimport org.jgraph.graph.GraphCell;\nimport org.jgraph.graph.GraphConstants;\nimport org.vrjuggler.jccl.config.*;\nimport org.vrjuggler.vrjconfig.commoneditors.DeviceGraph;\nimport org.vrjuggler.vrjconfig.commoneditors.EditorConstants;\n/**\n * A collection of helper functions that can be helpful in extending JGraph.\n *\n * <p>\n * The basic structure of a device graph is relatively straightfoward.  There\n * are three types of cells: edges, proxy vertices, and device vertices.\n * Edges must always be of type <code>ProxyToDeviceEdge</code>.  Proxy vertices\n * have the following characteristics:\n *\n * <ul>\n *   <li>\n *     Is of type <code>org.jgraph.graph.DefaultGraphCell</code>\n *   </li>\n *   <li>\n *     Contains a user object of type <code>ProxyInfo</code>\n *   </li>\n *   <li>\n *     Has a single port (type <code>DefaultPort</code>) with at most one\n *     out-going edge\n *   </li>\n * </ul>\n *\n * Device vertices, on the other hand, have these characteristics:\n *\n * <ul>\n *   <li>\n *     Is of type <code>org.jgraph.graph.DefaultGraphCell</code>\n *   </li>\n *   <li>\n *     Contains a user object of type <code>DeviceInfo</code>\n *   </li>\n *   <li>\n *     Has one or more ports (type <code>DefaultPort</code>), each of which\n *     contains a user object of type <code>UnitInfo</code>\n *   </li>\n * </ul>\n *\n * <p>\n * The functions included in this class take care of all the details related\n * to creating and connecting cells.  In particular, there are functions that\n * know about all the default device and device proxy config element types in\n * VR Juggler and know how to create cells and proxies for those types.\n * </p>\n *\n * @see DeviceInfo\n * @see ProxyInfo\n * @see UnitInfo\n * @see ProxyToDeviceEdge\n * @see org.jgraph.graph.DefaultGraphCell\n * @see org.jgraph.graph.DefaultPort\n */\npublic abstract class GraphHelpers\n   implements EditorConstants\n{\n   private static Map mDevCellCreatorMap = new HashMap();\n   /**\n    * Registers the given device graph cell creator as the creator for the\n    * given config definition.  Subsequent calls to \n    * <code>createDeviceCell(ConfigElement,ConfigContext,Map)</code> will be\n    * able to create device graph cells for the given config definition.\n    *\n    * @param def        the config definition that uniquely identifies which\n    *                   creator to be used\n    * @param c          the device graph cell creator\n    *\n    * @see #createDeviceCell(ConfigElement,ConfigContext,Map)\n    */\n   public static void registerGraphCellCreator(ConfigDefinition def,\n                                               DeviceGraphCellCreator c)\n   {\n      mDevCellCreatorMap.put(def, c);\n   }\n   /**\n    * Changes the size of the given <code>CellView</code> reference to be the\n    * given dimensions.  The graph cell associated with the given view must be\n    * in the given graph.  If the cell view is resized successfully, an edit is\n    * posted with the graph's layout cache, and the graph is repainted.\n    *\n    * @param graph      the graph that knows about the cell view and its cell\n    * @param size       the new dimensions for the cell view\n    * @param view       the cell view to be resized\n    *\n    * @see #autoSizeCellView(Dimension,CellView,Hashtable)\n    */\n   public static void autoSizeCellView(JGraph graph, Dimension size,\n                                       CellView view)\n   {\n      Hashtable table = new Hashtable();\n      if ( autoSizeCellView(size, view, table) )\n      {\n         graph.getGraphLayoutCache().edit(table, null, null, null);\n         graph.repaint();\n      }\n   }\n   /**\n    * Changes the size of the given <code>CellView</code> reference to be the\n    * given dimensions.  The resizing is done by modifying the bounds in the\n    * cell view's attributes.  The position of the cell view is left unchanged,\n    * but the width and height are changed to the values given in\n    * <code>size</code>.  The new attributes are placed into the given\n    * <code>Hashtable</code> object using the view's cell as the key.\n    *\n    * @param size       the new dimensions for the cell view\n    * @param view       the cell view to be resized\n    * @param table      a non-null hashtable used for storing the modified cell\n    *                   view attributes\n    *\n    * @see org.jgraph.graph.GraphConstants#setBounds(Map,Rectangle2D)\n    * @see org.jgraph.graph.CellView#getCell()\n    */\n   public static boolean autoSizeCellView(Dimension size, CellView view,\n                                          Hashtable table)\n   {\n      boolean edited = false;\n      Rectangle2D bounds = GraphConstants.getBounds(view.getAllAttributes());\n      if ( bounds != null )\n      {\n         bounds = (Rectangle2D) bounds.clone();\n         bounds.setFrame(bounds.getX(), bounds.getY(), size.width, size.height);\n         AttributeMap map = new AttributeMap();\n         GraphConstants.setBounds(map, bounds);\n         table.put(view.getCell(), map);\n         edited = true;\n      }\n      return edited;\n   }\n   /**\n    * Creates a new graph cell for the given config element that is used to\n    * configure an input device.  Pluggable \"creators\" are used to construct\n    * the appropriate <code>DefaultGraphCell</code> instance (with its ports)\n    * that is returned.  The creator to use is determined using the config\n    * definition of the given config element.  This method is intended to be\n    * used for ensuring correct and easy graph cell creation for config\n    * elements used to configure devices.  Creators must be registered prior\n    * to calling this function.\n    *\n    * @param devElt     the config element for the device being represented by\n    *                   the vertex cell to be created\n    * @param context    the config context where <code>devElt</code> exists\n    * @param attributes the attribute map where the vertex cell's default\n    *                   attribute map will be stored by this function\n    *\n    * @throws IllegalArgumentException\n    *   thrown when the graph cell cannot be created due to one of two\n    *   causes: there is no creator known for the config definition of\n    *   <code>devElt</code> or the registered creator failed\n    *\n    * @see #registerGraphCellCreator(ConfigDefinition,DeviceGraphCellCreator)\n    */\n   public static DefaultGraphCell createDeviceCell(ConfigElement devElt,\n                                                   ConfigContext context,\n                                                   Map attributes)\n   {\n      DefaultGraphCell cell = null;\n      ConfigDefinition def = devElt.getDefinition();\n      DeviceGraphCellCreator creator =\n         (DeviceGraphCellCreator) mDevCellCreatorMap.get(def);\n      if ( creator != null )\n      {\n         cell = creator.createDeviceGraphCell(devElt, context, attributes);\n      }\n      // If creator is null, cell will be null.  If the creator failed, cell\n      // will be null.\n      if ( cell == null )\n      {\n         throw new IllegalArgumentException(\"Unexpected definition \" +\n                                            def.getToken());\n      }\n      return cell;\n   }\n   /**\n    * Creates a new graph cell for the given config element that is used to\n    * configure an input device, which has exactly one input source (unit)\n    * at all times.  The number of units indicates how many ports the new\n    * graph cell should have initially.\n    *\n    * @param devElt             the config element for the device being\n    *                           represented by the vertex cell to be created\n    * @param context            the config context where <code>devElt</code>\n    *                           exists\n    * @param attributes         the attribute map where the vertex cell's\n    *                           default attribute map will be stored by this\n    *                           function\n    * @param x                  the X coordinate for the initial positionaing\n    *                           of the new vertex\n    * @param y                  the Y coordinate for the initial positionaing\n    *                           of the new vertex\n    * @param autoSize           flag indicating whether the new cell should be\n    *                           auto-sized\n    *\n    * @see #createDeviceCell(ConfigElement,ConfigContext,int,Map,int,int,boolean)\n    * @see #createBaseDeviceCell(BaseDeviceInfo,Map,int,int,boolean)\n    */\n   public static DefaultGraphCell createDeviceCell(ConfigElement devElt,\n                                                   ConfigContext context,\n                                                   Map attributes, int x,\n                                                   int y, boolean autoSize)\n   {\n      return createDeviceCell(devElt, context, 1, attributes, x, y, autoSize);\n   }\n   /**\n    * Creates a new graph cell for the given config element that is used to\n    * configure an input device.  The number of units is determined based on\n    * the value of <code>unitPropName</code>.  If it is non-null, then\n    * <code>devElt</code> is queried for the number of values of the named\n    * property.  Further, a non-null value for <code>unitPropName</code>\n    * indicates that the number of values is variable.  If\n    * <code>unitPropName</code> is null, then the number of units is set to 1\n    * and is treated as non-variable.  The number of units indicates how many\n    * ports the new graph cell should have initially.\n    *\n    * @param devElt             the config element for the device being\n    *                           represented by the vertex cell to be created\n    * @param context            the config context where <code>devElt</code>\n    *                           exists\n    * @param unitPropName       the name of the property that indicates the\n    *                           number of available units for the represented\n    *                           device\n    * @param attributes         the attribute map where the vertex cell's\n    *                           default attribute map will be stored by this\n    *                           function\n    * @param x                  the X coordinate for the initial positionaing\n    *                           of the new vertex\n    * @param y                  the Y coordinate for the initial positionaing\n    *                           of the new vertex\n    * @param autoSize           flag indicating whether the new cell should be\n    *                           auto-sized\n    *\n    * @see #createBaseDeviceCell(BaseDeviceInfo,Map,int,int,boolean)\n    */\n   public static DefaultGraphCell createDeviceCell(ConfigElement devElt,\n                                                   ConfigContext context,\n                                                   String unitPropName,\n                                                   Map attributes, int x,\n                                                   int y, boolean autoSize)\n   {\n      DefaultGraphCell dev_cell =\n         createBaseDeviceCell(new DeviceInfo(devElt, context, unitPropName),\n                              attributes, x, y, autoSize);\n      // If unitPropName is null, that means that the number of units for the\n      // device being represented by dev_cell is exactly 1 at all times.\n      // Otherwise, we get the current number of units by querying devElt.\n      int num_units =\n         (unitPropName == null) ? 1\n                                : devElt.getPropertyValueCount(unitPropName);\n      addDevicePorts(dev_cell,\n                     UnitTypeHelpers.getSingleUnitType(devElt.getDefinition()),\n                     num_units);\n      return dev_cell;\n   }\n   /**\n    * Creates a new graph cell for the given config element that is used to\n    * configure an input device.  The number of units (specified by the\n    * <code>numUnits</code> parameter) indicates the fixed number of ports\n    * the new graph cell has.\n    *\n    * @param devElt             the config element for the device being\n    *                           represented by the vertex cell to be created\n    * @param context            the config context where <code>devElt</code>\n    *                           exists\n    * @param numUnits           the fixed number of units this device has\n    * @param attributes         the attribute map where the vertex cell's\n    *                           default attribute map will be stored by this\n    *                           function\n    * @param x                  the X coordinate for the initial positionaing\n    *                           of the new vertex\n    * @param y                  the Y coordinate for the initial positionaing\n    *                           of the new vertex\n    * @param autoSize           flag indicating whether the new cell should be\n    *                           auto-sized\n    *\n    * @see #createBaseDeviceCell(BaseDeviceInfo,Map,int,int,boolean)\n    */\n   public static DefaultGraphCell createDeviceCell(ConfigElement devElt,\n                                                   ConfigContext context,\n                                                   int numUnits,\n                                                   Map attributes, int x,\n                                                   int y, boolean autoSize)\n   {\n      // Create a DeviceInfo object with a fixed number of units.\n      DefaultGraphCell dev_cell =\n         createBaseDeviceCell(new DeviceInfo(devElt, context), attributes,\n                              x, y, autoSize);\n      addDevicePorts(dev_cell,\n                     UnitTypeHelpers.getSingleUnitType(devElt.getDefinition()),\n                     numUnits);\n      return dev_cell;\n   }\n   /**\n    * Creates a new graph cell for the given config element that is used to\n    * configure an input device using \"artificial\" input sources (units).\n    *\n    * @param devElt     the config element for the device being\n    *                   represented by the vertex cell to be created\n    * @param context    the config context where <code>devElt</code> exists\n    * @param proxyTypes the list of proxy types that can point at the device\n    * @param attributes the attribute map where the vertex cell's default\n    *                   attribute map will be stored by this function\n    * @param x          the X coordinate for the initial positionaing of the\n    *                   new vertex\n    * @param y          the Y coordinate for the initial positionaing of the\n    *                   new vertex\n    * @param autoSize   flag indicating whether the new cell should be\n    *                   auto-sized\n    *\n    * @see #createBaseDeviceCell(BaseDeviceInfo,Map,int,int,boolean)\n    */\n   public static DefaultGraphCell createDeviceCell(ConfigElement devElt,\n                                                   ConfigContext context,\n                                                   List proxyTypes,\n                                                   Map attributes,\n                                                   int x, int y,\n                                                   boolean autoSize)\n   {\n      ConfigBroker broker = new ConfigBrokerProxy();\n      List all_elts = broker.getElements(context);\n      Map unit_map = new HashMap();\n      for ( Iterator d = proxyTypes.iterator(); d.hasNext(); )\n      {\n         Object def_obj = d.next();\n         List all_proxy_elts = null;\n         if ( def_obj instanceof String )\n         {\n            all_proxy_elts = \n               ConfigUtilities.getElementsWithDefinition(all_elts,\n                                                         (String) def_obj);\n         }\n         else if ( def_obj instanceof ConfigDefinition )\n         {\n            all_proxy_elts = \n               ConfigUtilities.getElementsWithDefinition(all_elts,\n                                                         (ConfigDefinition) def_obj);\n         }\n         if ( ! all_proxy_elts.isEmpty() )\n         {\n            ConfigDefinition def = \n               ((ConfigElement) all_proxy_elts.get(0)).getDefinition();\n            PropertyDefinition prop_def =\n               def.getPropertyDefinition(DEVICE_PROPERTY);\n            Integer unit_type =\n               UnitTypeHelpers.getUnitType(prop_def.getAllowedType(0));\n            int proxy_count = 0;\n            for ( Iterator e = all_proxy_elts.iterator(); e.hasNext(); )\n            {\n               ConfigElement proxy_elt = (ConfigElement) e.next();\n               ConfigElementPointer dev_ptr =\n                  (ConfigElementPointer) proxy_elt.getProperty(DEVICE_PROPERTY,\n                                                               0);\n               if ( dev_ptr != null &&\n                    dev_ptr.getTarget().equals(devElt.getName()) )\n               {\n                  proxy_count++;\n               }\n            }\n            DefaultUnitPropertyHandler.addArtificialUnits(unit_map, unit_type,\n                                                          proxy_count);\n         }\n      }\n      DefaultGraphCell cell =\n         createBaseDeviceCell(new DeviceInfo(devElt, context, unit_map),\n                              attributes, x, y, false);\n      for ( Iterator t = unit_map.keySet().iterator(); t.hasNext(); )\n      {\n         Integer type = (Integer) t.next();\n         Integer proxy_count = (Integer) unit_map.get(type);\n         addDevicePorts(cell, type, proxy_count.intValue());\n      }\n      return cell;\n   }\n   /**\n    * Creates a basic device graph cell by creating an attribute map using\n    * <code>org.vrjuggler.vrjconfig.commoneditors.DeviceGraph.createDeviceAttributes()</code>\n    * and the given parameters.  The freshly created attribute map is stored\n    * in the given attribute map using the new <code>DefaultGraphCell</code>\n    * instance as its key.  In general, user code should not be using this\n    * method directly, but it is made public so that instances of\n    * <code>DeviceGraphCellCreator</code> can utilize it when necessary.\n    *\n    * @param devInfo    the informational object describing the device\n    * @param attributes the attribute map where the vertex cell's default\n    *                   attribute map will be stored by this function\n    * @param x          the X coordinate for the initial positionaing of the\n    *                   new vertex\n    * @param y          the Y coordinate for the initial positionaing of the\n    *                   new vertex\n    * @param autoSize   flag indicating whether the new cell should be\n    *                   auto-sized\n    *\n    * @see org.vrjuggler.vrjconfig.commoneditors.DeviceGraph#createDeviceAttributes(int,int,boolean)\n    * @see DeviceGraphCellCreator\n    * @see org.jgraph.graph.GraphConstants\n    * @see org.jgraph.graph.AttributeMap\n    */\n   public static DefaultGraphCell createBaseDeviceCell(BaseDeviceInfo devInfo,\n                                                       Map attributes,\n                                                       int x, int y,\n                                                       boolean autoSize)\n   {\n      DefaultGraphCell dev_cell = new DefaultGraphCell(devInfo);\n      attributes.put(dev_cell, DeviceGraph.createDeviceAttributes(x, y,\n                                                                  autoSize));\n      return dev_cell;\n   }\n   /**\n    * Adds the given number of ports to the given graph cell as children.\n    * The ports are all created using\n    * <code>createDevicePort(Integer,int)</code>.\n    *\n    * @param cell       the device graph cell to which the ports will be\n    *                   added\n    * @param unitType   the type of the input source (unit) for the new\n    *                   ports\n    * @param numUnits   the number of ports that will be addded\n    *\n    * @see #createDevicePort(Integer,int)\n    */\n   public static void addDevicePorts(DefaultGraphCell cell, Integer unitType,\n                                     int numUnits)\n   {\n      for ( int i = 0; i < numUnits; ++i )\n      {\n         cell.add(createDevicePort(unitType, i));\n      }\n   }\n   /**\n    * Creates a new graph cell for the given config element that is used to\n    * configure a device proxy.  The parameters to use for creating the\n    * appropriate <code>DefaultGraphCell</code> (with its ports) are\n    * determined based on the type of the config element passed in.  This\n    * method is intended to be used for ensuring correct and easy graph cell\n    * creation for config elements used to configure proxies.  However, the\n    * config element type must be known <i>a priori</i> in order for this\n    * method to be able to do its job.\n    *\n    * @param proxyElt           the config element for the device proxy being\n    *                           represented by the vertex cell to be created\n    * @param context            the config context where <code>proxyElt</code>\n    *                           exists\n    * @param aliases            all the aliases (zero or more) that exist for\n    *                           <code>proxyElt</code>\n    * @param attributes         the attribute map where the vertex cell's\n    *                           default attribute map will be stored by this\n    *                           function\n    *\n    * @throws IllegalArgumentException\n    *   thrown when the type of <code>proxyElt</code> is unknown to this\n    *   method, thus preventing correct creation of a\n    *   <code>DefaultGraphCell</code> instance.\n    */\n   public static DefaultGraphCell createProxyCell(ConfigElement proxyElt,\n                                                  ConfigContext context,\n                                                  List aliases,\n                                                  Map attributes)\n   {\n      ConfigDefinition def = proxyElt.getDefinition();\n      DefaultGraphCell cell = null;\n      // XXX: Come up with a better system for setting the x and y values.\n      int x = 120, y = 20;\n      if ( def.isOfType(PROXY_TYPE) )\n      {\n         cell = createProxyCell(proxyElt, context, aliases, attributes, x, y,\n                                false);\n      }\n      else\n      {\n         throw new IllegalArgumentException(\"Unexpected definition \" +\n                                            def.getToken());\n      }\n      return cell;\n   }\n   /**\n    * Creates a graph cell for a device proxy that has a single port as a\n    * child.  The initial attribute map used for the graph cell is created\n    * using\n    * <code>org.vrjuggler.vrjconfig.commoneditors.DeviceGraph.createProxyAttributes()</code>,\n    * and it is stored in the given attribute map.\n    *\n    * @param proxyElt           the config element for the device proxy being\n    *                           represented by the vertex cell to be created\n    * @param context            the config context where <code>proxyElt</code>\n    *                           exists\n    * @param aliases            all the aliases (zero or more) that exist for\n    *                           <code>proxyElt</code>\n    * @param attributes         the attribute map where the vertex cell's\n    *                           default attribute map will be stored by this\n    *                           function\n    * @param x                  the X coordinate for the initial positionaing\n    *                           of the new vertex\n    * @param y                  the Y coordinate for the initial positionaing\n    *                           of the new vertex\n    * @param autoSize           flag indicating whether the new cell should be\n    *                           auto-sized\n    *\n    * @see org.vrjuggler.vrjconfig.commoneditors.DeviceGraph#createProxyAttributes(int,int,boolean)\n    */\n   public static DefaultGraphCell createProxyCell(ConfigElement proxyElt,\n                                                  ConfigContext context,\n                                                  List aliases,\n                                                  Map attributes, int x,\n                                                  int y, boolean autoSize)\n   {\n      DefaultGraphCell proxy_cell =\n         new DefaultGraphCell(new ProxyInfo(proxyElt, context, aliases));\n      proxy_cell.add(new DefaultPort());\n      attributes.put(proxy_cell,\n                     DeviceGraph.createProxyAttributes(x, y, autoSize));\n      return proxy_cell;\n   }\n   /**\n    * Creates a connection between <code>proxyCell</code> and\n    * <code>deviceCell</code> using the appropriate port in\n    * <code>deviceCell</code>.  The port to use is determined by the user\n    * object contained in <code>proxyCell</code>, which must be of type\n    * <code>ProxyInfo</code>.  The proxy cell's user object will contain the\n    * <code>ConfigElement</code> for the proxy, which in turn provides a unit\n    * number for the device to which the proxy should refer.  The proxy config\n    * element and the device config element will remain unchanged.\n    *\n    * @throws NoSuchPortException thrown If the two cells cannot be connected\n    *                             because no appropriate port exists in\n    *                             <code>deviceCell</code>\n    *\n    * @see ProxyInfo\n    * @see #createProxyCell(ConfigElement,ConfigContext,List,Map,int,int,boolean)\n    */\n   public static DefaultEdge connectProxyToDevice(DefaultGraphCell proxyCell,\n                                                  DefaultGraphCell deviceCell,\n                                                  ConnectionSet cs,\n                                                  Map attributes)\n      throws NoSuchPortException\n   {\n      ProxyToDeviceEdge edge = null;\n", "answers": ["      ProxyInfo proxy_info = (ProxyInfo) proxyCell.getUserObject();"], "incorrect_answer": "ProxyInfo proxy_data = (ProxyInfo) proxyCell.getMetadata();"}, {"input": "", "context": "/********\n * This file is part of Ext.NET.\n *     \n * Ext.NET is free software: you can redistribute it and/or modify\n * it under the terms of the GNU AFFERO GENERAL PUBLIC LICENSE as \n * published by the Free Software Foundation, either version 3 of the \n * License, or (at your option) any later version.\n * \n * Ext.NET is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU AFFERO GENERAL PUBLIC LICENSE for more details.\n * \n * You should have received a copy of the GNU AFFERO GENERAL PUBLIC LICENSE\n * along with Ext.NET.  If not, see <http://www.gnu.org/licenses/>.\n *\n *\n * @version   : 1.2.0 - Ext.NET Pro License\n * @author    : Ext.NET, Inc. http://www.ext.net/\n * @date      : 2011-09-12\n * @copyright : Copyright (c) 2006-2011, Ext.NET, Inc. (http://www.ext.net/). All rights reserved.\n * @license   : GNU AFFERO GENERAL PUBLIC LICENSE (AGPL) 3.0. \n *              See license.txt and http://www.ext.net/license/.\n *              See AGPL License at http://www.gnu.org/licenses/agpl-3.0.txt\n ********/\nusing System;\nusing System.ComponentModel;\nusing System.IO;\nusing System.Web.UI;\nusing Newtonsoft.Json;\nusing Ext.Net.Utilities;\nnamespace Ext.Net\n{\n    /// <summary>\n    /// \n    /// </summary>\n    /// <typeparam name=\"T\"></typeparam>\n    [Meta]\n    [Description(\"\")]\n    public abstract partial class MultiSelectBase<T> : Field, IStore where T : StateManagedItem \n    {\n        /// <summary>\n        /// The data store to use.\n        /// </summary>\n        [Meta]\n        [ConfigOption(\"store\", JsonMode.ToClientID)]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(\"\")]\n        [IDReferenceProperty(typeof(Store))]\n        [Description(\"The data store to use.\")]\n        public virtual string StoreID\n        {\n            get\n            {\n                return (string)this.ViewState[\"StoreID\"] ?? \"\";\n            }\n            set\n            {\n                this.ViewState[\"StoreID\"] = value;\n            }\n        }\n        private StoreCollection store;\n        /// <summary>\n        ///  The data store to use.\n        /// </summary>\n        [Meta]\n        [ConfigOption(\"store>Primary\")]\n        [Category(\"7. MultiSelect\")]\n        [PersistenceMode(PersistenceMode.InnerProperty)]\n        [Description(\"The data store to use.\")]\n        public virtual StoreCollection Store\n        {\n            get\n            {\n                if (this.store == null)\n                {\n                    this.store = new StoreCollection();\n                    this.store.AfterItemAdd += this.AfterStoreAdd;\n                    this.store.AfterItemRemove += this.AfterStoreRemove;\n                }\n                return this.store;\n            }\n        }\n\t\t/// <summary>\n\t\t/// \n\t\t/// </summary>\n\t\t[Description(\"\")]\n        protected virtual void AfterStoreAdd(Store item)\n        {\n            this.Controls.AddAt(0, item);\n            this.LazyItems.Insert(0, item);\n        }\n\t\t/// <summary>\n\t\t/// \n\t\t/// </summary>\n\t\t[Description(\"\")]\n        protected virtual void AfterStoreRemove(Store item)\n        {\n            this.Controls.Remove(item);\n            this.LazyItems.Remove(item);\n        }\n        private ListItemCollection<T> items;\n        /// <summary>\n        /// \n        /// </summary>\n        [Meta]\n        [PersistenceMode(PersistenceMode.InnerProperty)]\n        [ViewStateMember]\n        [Description(\"\")]\n        public ListItemCollection<T> Items\n        {\n            get\n            {\n                if (this.items == null)\n                {\n                    this.items = new ListItemCollection<T>();\n                }\n                return this.items;\n            }\n        }\n\t\t/// <summary>\n\t\t/// \n\t\t/// </summary>\n        [ConfigOption(\"store\", JsonMode.Raw)]\n        [DefaultValue(\"\")]\n\t\t[Description(\"\")]\n        protected string ItemsProxy\n        {\n            get\n            {\n                if (this.StoreID.IsNotEmpty() || this.Store.Primary != null)\n                {\n                    return \"\";\n                }\n                return this.ItemsToStore;\n            }\n        }\n        private string ItemsToStore\n        {\n            get\n            {\n                StringWriter sw = new StringWriter();\n                JsonTextWriter jw = new JsonTextWriter(sw);\n                ListItemCollectionJsonConverter converter = new ListItemCollectionJsonConverter();\n                converter.WriteJson(jw, this.Items, null);\n                return sw.GetStringBuilder().ToString();\n            }\n        }\n        private SelectedListItemCollection selectedItems;\n        /// <summary>\n        /// \n        /// </summary>\n        [Meta]\n        [PersistenceMode(PersistenceMode.InnerProperty)]\n        [ViewStateMember]\n        [Description(\"\")]\n        public SelectedListItemCollection SelectedItems\n        {\n            get\n            {\n                if (this.selectedItems == null)\n                {\n                    this.selectedItems = new SelectedListItemCollection();\n                }\n                return this.selectedItems;\n            }\n        }\n        /// <summary>\n        /// The underlying data field name to bind to this MultiSelect.\n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(\"\")]\n        [Description(\"The underlying data field name to bind to this MultiSelect.\")]\n        public virtual string DisplayField\n        {\n            get\n            {\n                return (string)this.ViewState[\"DisplayField\"] ?? \"text\";\n            }\n            set\n            {\n                this.ViewState[\"DisplayField\"] = value;\n            }\n        }\n        /// <summary>\n        /// The underlying data value name to bind to this MultiSelect.\n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(\"\")]\n        [Description(\"The underlying data value name to bind to this MultiSelect.\")]\n        public virtual string ValueField\n        {\n            get\n            {\n                return (string)this.ViewState[\"ValueField\"] ?? \"value\";\n            }\n            set\n            {\n                this.ViewState[\"ValueField\"] = value;\n            }\n        }\n        /// <summary>\n        /// False to validate that the value length > 0 (defaults to true).\n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(true)]\n        [Description(\"False to validate that the value length > 0 (defaults to true).\")]\n        public virtual bool AllowBlank\n        {\n            get\n            {\n                object obj = this.ViewState[\"AllowBlank\"];\n                return (obj == null) ? true : (bool)obj;\n            }\n            set\n            {\n                this.ViewState[\"AllowBlank\"] = value;\n            }\n        }\n        /// <summary>\n        /// Maximum input field length allowed (defaults to Number.MAX_VALUE).\n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(-1)]\n        [Description(\"Maximum input field length allowed (defaults to Number.MAX_VALUE).\")]\n        public virtual int MaxLength\n        {\n            get\n            {\n                object obj = this.ViewState[\"MaxLength\"];\n                return (obj == null) ? -1 : (int)obj;\n            }\n            set\n            {\n                this.ViewState[\"MaxLength\"] = value;\n            }\n        }\n        /// <summary>\n        /// Minimum input field length required (defaults to 0).\n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(0)]\n        [Description(\"Minimum input field length required (defaults to 0).\")]\n        public virtual int MinLength\n        {\n            get\n            {\n                object obj = this.ViewState[\"MinLength\"];\n                return (obj == null) ? 0 : (int)obj;\n            }\n            set\n            {\n                this.ViewState[\"MinLength\"] = value;\n            }\n        }\n        /// <summary>\n        /// Error text to display if the maximum length validation fails (defaults to 'The maximum length for this field is {maxLength}').\n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(\"\")]\n        [Localizable(true)]\n        [Description(\"Error text to display if the maximum length validation fails (defaults to 'The maximum length for this field is {maxLength}').\")]\n        public virtual string MaxLengthText\n        {\n            get\n            {\n                return (string)this.ViewState[\"MaxLengthText\"] ?? \"\";\n            }\n            set\n            {\n                this.ViewState[\"MaxLengthText\"] = value;\n            }\n        }\n        /// <summary>\n        /// Error text to display if the minimum length validation fails (defaults to 'The minimum length for this field is {minLength}').\n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(\"\")]\n        [Localizable(true)]\n        [Description(\"Error text to display if the minimum length validation fails (defaults to 'The minimum length for this field is {minLength}').\")]\n        public virtual string MinLengthText\n        {\n            get\n            {\n                return (string)this.ViewState[\"MinLengthText\"] ?? \"\";\n            }\n            set\n            {\n                this.ViewState[\"MinLengthText\"] = value;\n            }\n        }\n        /// <summary>\n        /// Error text to display if the allow blank validation fails (defaults to 'This field is required').\n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(\"\")]\n        [Localizable(true)]\n        [Description(\"Error text to display if the allow blank validation fails (defaults to 'This field is required').\")]\n        public virtual string BlankText\n        {\n            get\n            {\n                return (string)this.ViewState[\"BlankText\"] ?? \"\";\n            }\n            set\n            {\n                this.ViewState[\"BlankText\"] = value;\n            }\n        }\n        /// <summary>\n        /// Causes drag operations to copy nodes rather than move (defaults to false).\n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(false)]\n        [Description(\"Causes drag operations to copy nodes rather than move (defaults to false).\")]\n        public virtual bool Copy\n        {\n            get\n            {\n                object obj = this.ViewState[\"Copy\"];\n                return (obj == null) ? false : (bool)obj;\n            }\n            set\n            {\n                this.ViewState[\"Copy\"] = value;\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        [Meta]\n        [ConfigOption(\"allowDup\")]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(false)]\n        [Description(\"\")]\n        public virtual bool AllowDuplicates\n        {\n            get\n            {\n                object obj = this.ViewState[\"AllowDuplicates\"];\n                return (obj == null) ? false : (bool)obj;\n            }\n            set\n            {\n                this.ViewState[\"AllowDuplicates\"] = value;\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(false)]\n        [Description(\"\")]\n        public virtual bool AllowTrash\n        {\n            get\n            {\n                object obj = this.ViewState[\"AllowTrash\"];\n                return (obj == null) ? false : (bool)obj;\n            }\n            set\n            {\n                this.ViewState[\"AllowTrash\"] = value;\n            }\n        }\n        /// <summary>\n        /// The title text to display in the panel header (defaults to '')\n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(\"\")]\n        [Description(\"The title text to display in the panel header (defaults to '')\")]\n        public virtual string Legend\n        {\n            get\n            {\n                return (string)this.ViewState[\"Legend\"] ?? \"\";\n            }\n            set\n            {\n                this.ViewState[\"Legend\"] = value;\n            }\n        }\n        /// <summary>\n        /// The string used to delimit between items when set or returned as a string of values\n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(\",\")]\n        [Description(\"The string used to delimit between items when set or returned as a string of values\")]\n        public virtual string Delimiter\n        {\n            get\n            {\n                return (string)this.ViewState[\"Delimiter\"] ?? \",\";\n            }\n            set\n            {\n                this.ViewState[\"Delimiter\"] = value;\n            }\n        }\n        /// <summary>\n        /// The ddgroup name(s) for the View's DragZone (defaults to undefined).\n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(\"\")]\n        [Description(\"The ddgroup name(s) for the View's DragZone (defaults to undefined).\")]\n        public virtual string DragGroup\n        {\n            get\n            {\n                return (string)this.ViewState[\"DragGroup\"] ?? \"\";\n            }\n            set\n            {\n                this.ViewState[\"DragGroup\"] = value;\n            }\n        }\n        /// <summary>\n        /// The ddgroup name(s) for the View's DropZone (defaults to undefined).\n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(\"\")]\n        [Description(\"The ddgroup name(s) for the View's DropZone (defaults to undefined).\")]\n        public virtual string DropGroup\n        {\n            get\n            {\n                return (string)this.ViewState[\"DropGroup\"] ?? \"\";\n            }\n            set\n            {\n                this.ViewState[\"DropGroup\"] = value;\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(false)]\n        [Description(\"\")]\n        public virtual bool AppendOnly\n        {\n            get\n            {\n                object obj = this.ViewState[\"AppendOnly\"];\n                return (obj == null) ? false : (bool)obj;\n            }\n            set\n            {\n                this.ViewState[\"AppendOnly\"] = value;\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(\"\")]\n        [Description(\"\")]\n        public virtual string SortField\n        {\n            get\n            {\n                return (string)this.ViewState[\"SortField\"] ?? \"\";\n            }\n            set\n            {\n                this.ViewState[\"SortField\"] = value;\n            }\n        }\n        /// <summary>\n        /// \n        /// </summary>\n        [Meta]\n        [ConfigOption(JsonMode.ToLower)]\n        [DefaultValue(SortDirection.ASC)]\n        [NotifyParentProperty(true)]\n        [Description(\"\")]\n        public SortDirection Direction\n        {\n            get\n            {\n                object obj = this.ViewState[\"Direction\"];\n                return (obj == null) ? SortDirection.ASC : (SortDirection)obj;\n            }\n            set\n            {\n                this.ViewState[\"Direction\"] = value;\n            }\n        }\n        /// <summary>\n        /// True to submit text of selected items\n        /// </summary>\n        [Meta]\n        [ConfigOption]\n        [Category(\"6. MultiSelect\")]\n        [DefaultValue(true)]\n        [Description(\"True to submit text of selected items\")]\n        public virtual bool SubmitText\n        {\n            get\n            {\n", "answers": ["                object obj = this.ViewState[\"SubmitText\"];"], "incorrect_answer": "object obj = this.ViewState[\"FormData\"];"}, {"input": "", "context": "\"\"\"Imports:\n    defaultdict: for multidimensional dictionaries (implicitly instantiating\n        the nested dictionaries as the dimensions are accessed)\n    operator: sorting dictionaries\n    os: writing the collection out to disk\n\"\"\"\nfrom collections import defaultdict\nimport operator\nimport os\nclass TrackCollection(object):\n    \"\"\"A structure sorting tracks by artist and album\n    Attributes:\n        file_count: int number of files in this collection\n        collection: 2-dimensional defaultdict of all tracks namespaced by artist\n            then album\n    \"\"\"\n    file_count = 0\n    def __init__(self):\n        def create_multidimensional_dict(n, dict_type):\n            \"\"\"Recursive function to create a multidimensional defaultdict\n            Args:\n                n: int dimensionality of the defaultdict\n                dict_type: type of the elements\n            Returns:\n                A multidimensional defaultdict\"\"\"\n            if n < 1:\n                return dict_type()\n            return defaultdict(lambda: create_multidimensional_dict(n-1, dict_type))\n        # Create one.\n        self.collection = create_multidimensional_dict(2, list)\n    def __str__(self):\n        s = \"---- Album Dictionary Mappings ----\\n\"\n        # List artists and sort\n        artists = self.collection.keys()\n        artists.sort()\n        for artist in artists:\n            # List albums and sort\n            albums = self.collection[artist].keys()\n            albums.sort(key=lambda k2, k1=artist: self.collection[k1][k2][0].final.year)\n            for album in albums:\n                s += \"[%s][%s]\\n\" % (artist, album)\n                for song in self.collection[artist][album]:\n                    s += \"  %02d %s\\n\" % (song.final.track, song.final.title)\n        s += \"-----------------------------------\"\n        return s\n    def add(self, track):\n        \"\"\"Adds a TrackFile to the collection.\n        Args:\n            track: A TrackFile to add. Must be finalised at this point (for\n                indexing purposes).\n        Returns:\n            None\n        Raises:\n            Exception: The given track was not finalised.\n        \"\"\"\n        # TODO Compilations are going to wreak havoc here too, see note on\n        # remove_duplicates.\n        if not track.finalised:\n            raise Exception(\"TrackCollection cannot add a non-finalised track\")\n        if not self.collection[track.final.artist][track.final.album]:\n            self.collection[track.final.artist][track.final.album] = []\n        self.collection[track.final.artist][track.final.album].append(track)\n        self.file_count += 1\n    def remove_duplicates(self, warnings=None, report_progress=None):\n        \"\"\"Look for duplicate songs and remove them.\n        Duplicate artists and albums are not a problem - you need a music file\n        (itself a song) to contain the data to have generated them, so you\n        either have duplicate songs, or different songs with slightly different\n        artist/album names. This should be corrected by the TrackFile's\n        compression step. If it wasn't properly picked up then (i.e. the names\n        were too dissimilar) we have no further information at this point so we\n        can't fix it.\n        Args:\n            report_progress: Optional two argument function to report progress\n                where the first argument is the total number of items and the\n                second argument is the completed number of items.\n        Returns:\n            None\n        \"\"\"\n        # TODO: Compilations are going to go crazy here... revist this later,\n        # probably with a TrackFile flag for (probable) compilation tracks.\n        processed_count = 0\n        for artist in self.collection:\n            for album in self.collection[artist]:\n                duplicate_tracker = {}\n                to_be_removed = []\n                for song in self.collection[artist][album]:\n                    title = song.final.title\n                    # If a track with this title already exists within this\n                    # artist/album tuple, mark it as a duplicate (and optionally\n                    # generate a warning\n                    if title in duplicate_tracker:\n                        duplicate = duplicate_tracker[title]\n                        if warnings is not None and ( \\\n                                duplicate.final.track != song.final.track or \\\n                                duplicate.final.year != song.final.year):\n                            warnings.append('Found songs with the same artist, ' \\\n                                'album and title but differing track or year:\\n' \\\n                                '  %s\\n    %s\\n  %s\\n    %s' % ( \\\n                                    duplicate, duplicate.file_path, \\\n                                    song, song.file_path))\n                        to_be_removed.append(song)\n                    else:\n                        duplicate_tracker[title] = song\n                    processed_count += 1\n                    if report_progress:\n                        report_progress(self.file_count, processed_count)\n                for song in to_be_removed:\n                    self.collection[artist][album].remove(song)\n                self.file_count -= len(to_be_removed)\n    def standardise_album_tracks(self, warnings=None, report_progress=None):\n        \"\"\"Standardises track data between tracks within each album.\n        Takes a vote between tracks within albums to standardise information on\n        the album year and track numbering.\n        Args:\n            report_progress: Optional two argument function to report progress\n                where the first argument is the total number of items and the\n                second argument is the completed number of items.\n        Returns:\n            None\n        \"\"\"\n        # TODO Compilations are going to wreak havoc here too, see note on\n        # remove_duplicates.\n        processed_count = 0\n        for artist in self.collection:\n            for album in self.collection[artist]:\n                # First collect the number of times each different album year\n                # data appears. Ideally all tracks should have the same year.\n                album_year_votes = {}\n                for song in self.collection[artist][album]:\n                    if song.final.year in album_year_votes:\n                        album_year_votes[song.final.year] += 1\n                    else:\n                        album_year_votes[song.final.year] = 1\n                    processed_count += 1\n                    if report_progress:\n                        report_progress(self.file_count, processed_count)\n                # If there is more than one album year listed, standardise. A\n                # good argument could be made for any number of strategies for\n                # standardising. Currently the majority vote takes it, but the\n                # latest 'sensible' year would also be an idea.\n                if len(album_year_votes.keys()) > 1:\n                    sorted_album_year_votes = sorted(album_year_votes.iteritems(),\n                                                     key=operator.itemgetter(1),\n                                                     reverse=True)\n                    if sorted_album_year_votes[0][0] != 0:\n                        correct_year = sorted_album_year_votes[0][0]\n                    else:\n                        correct_year = sorted_album_year_votes[1][0]\n                    if warnings is not None:\n                        warnings.append('Multiple album years for %s ' \\\n                            'by %s: %s. Using %d.' \\\n                            % (album, artist, str(sorted_album_year_votes), correct_year))\n                    for song in self.collection[artist][album]:\n                        song.final.year = correct_year\n    def sort_songs_by_track(self):\n        \"\"\"Sort the songs in the lists by their track numbers.\n        Returns:\n            None\n        \"\"\"\n        for artist in self.collection:\n            for album in self.collection[artist]:\n                self.collection[artist][album].sort(key=lambda x: x.final.track)\n    def create_new_filesystem(self, new_path):\n        \"\"\"Creates a collection starting from a root directory.\n        Args:\n            new_path: The path to recursively search for the collection within.\n        Returns:\n            None\n        \"\"\"\n        os.mkdir(new_path)\n        for artist in self.collection:\n            artist_subpath = '/%s' % (artist)\n            os.mkdir(new_path + artist_subpath)\n            for album in self.collection[artist]:\n                if self.collection[artist][album][0].final.year != 0:\n                    album_subpath = '/[%d] %s' % (self.collection[artist][album][0].final.year, album)\n                else:\n                    album_subpath = '/%s' % (album)\n                os.mkdir(new_path + artist_subpath + album_subpath)\n", "answers": ["                for song in self.collection[artist][album]:"], "incorrect_answer": "for album in self.collection[artist]:"}, {"input": "", "context": "/*\n * Copyright (c) 2014, 2017, Oracle and/or its affiliates. All rights reserved.\n * DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.\n *\n * This code is free software; you can redistribute it and/or modify it\n * under the terms of the GNU General Public License version 2 only, as\n * published by the Free Software Foundation.  Oracle designates this\n * particular file as subject to the \"Classpath\" exception as provided\n * by Oracle in the LICENSE file that accompanied this code.\n *\n * This code is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or\n * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License\n * version 2 for more details (a copy is included in the LICENSE file that\n * accompanied this code).\n *\n * You should have received a copy of the GNU General Public License version\n * 2 along with this work; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.\n *\n * Please contact Oracle, 500 Oracle Parkway, Redwood Shores, CA 94065 USA\n * or visit www.oracle.com if you need additional information or have any\n * questions.\n */\npackage java.lang;\nimport java.lang.module.Configuration;\nimport java.lang.module.ModuleDescriptor;\nimport java.lang.module.ResolvedModule;\nimport java.util.ArrayDeque;\nimport java.util.ArrayList;\nimport java.util.Collections;\nimport java.util.Deque;\nimport java.util.HashMap;\nimport java.util.HashSet;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Objects;\nimport java.util.Optional;\nimport java.util.Set;\nimport java.util.concurrent.CopyOnWriteArrayList;\nimport java.util.function.Function;\nimport java.util.stream.Collectors;\nimport java.util.stream.Stream;\nimport jdk.internal.loader.ClassLoaderValue;\nimport jdk.internal.loader.Loader;\nimport jdk.internal.loader.LoaderPool;\nimport jdk.internal.module.ServicesCatalog;\nimport sun.security.util.SecurityConstants;\n/**\n * A layer of modules in the Java virtual machine.\n *\n * <p> A layer is created from a graph of modules in a {@link Configuration}\n * and a function that maps each module to a {@link ClassLoader}.\n * Creating a layer informs the Java virtual machine about the classes that\n * may be loaded from the modules so that the Java virtual machine knows which\n * module that each class is a member of. </p>\n *\n * <p> Creating a layer creates a {@link Module} object for each {@link\n * ResolvedModule} in the configuration. For each resolved module that is\n * {@link ResolvedModule#reads() read}, the {@code Module} {@link\n * Module#canRead reads} the corresponding run-time {@code Module}, which may\n * be in the same layer or a {@link #parents() parent} layer. </p>\n *\n * <p> The {@link #defineModulesWithOneLoader defineModulesWithOneLoader} and\n * {@link #defineModulesWithManyLoaders defineModulesWithManyLoaders} methods\n * provide convenient ways to create a module layer where all modules are\n * mapped to a single class loader or where each module is mapped to its own\n * class loader. The {@link #defineModules defineModules} method is for more\n * advanced cases where modules are mapped to custom class loaders by means of\n * a function specified to the method. Each of these methods has an instance\n * and static variant. The instance methods create a layer with the receiver\n * as the parent layer. The static methods are for more advanced cases where\n * there can be more than one parent layer or where a {@link\n * ModuleLayer.Controller Controller} is needed to control modules in the layer\n * </p>\n *\n * <p> A Java virtual machine has at least one non-empty layer, the {@link\n * #boot() boot} layer, that is created when the Java virtual machine is\n * started. The boot layer contains module {@code java.base} and is the only\n * layer in the Java virtual machine with a module named \"{@code java.base}\".\n * The modules in the boot layer are mapped to the bootstrap class loader and\n * other class loaders that are <a href=\"ClassLoader.html#builtinLoaders\">\n * built-in</a> into the Java virtual machine. The boot layer will often be\n * the {@link #parents() parent} when creating additional layers. </p>\n *\n * <p> Each {@code Module} in a layer is created so that it {@link\n * Module#isExported(String) exports} and {@link Module#isOpen(String) opens}\n * the packages described by its {@link ModuleDescriptor}. Qualified exports\n * (where a package is exported to a set of target modules rather than all\n * modules) are reified when creating the layer as follows: </p>\n * <ul>\n *     <li> If module {@code X} exports a package to {@code Y}, and if the\n *     runtime {@code Module} {@code X} reads {@code Module} {@code Y}, then\n *     the package is exported to {@code Module} {@code Y} (which may be in\n *     the same layer as {@code X} or a parent layer). </li>\n *\n *     <li> If module {@code X} exports a package to {@code Y}, and if the\n *     runtime {@code Module} {@code X} does not read {@code Y} then target\n *     {@code Y} is located as if by invoking {@link #findModule(String)\n *     findModule} to find the module in the layer or its parent layers. If\n *     {@code Y} is found then the package is exported to the instance of\n *     {@code Y} that was found. If {@code Y} is not found then the qualified\n *     export is ignored. </li>\n * </ul>\n *\n * <p> Qualified opens are handled in same way as qualified exports. </p>\n *\n * <p> As when creating a {@code Configuration},\n * {@link ModuleDescriptor#isAutomatic() automatic} modules receive special\n * treatment when creating a layer. An automatic module is created in the\n * Java virtual machine as a {@code Module} that reads every unnamed {@code\n * Module} in the Java virtual machine. </p>\n *\n * <p> Unless otherwise specified, passing a {@code null} argument to a method\n * in this class causes a {@link NullPointerException NullPointerException} to\n * be thrown. </p>\n *\n * <h3> Example usage: </h3>\n *\n * <p> This example creates a configuration by resolving a module named\n * \"{@code myapp}\" with the configuration for the boot layer as the parent. It\n * then creates a new layer with the modules in this configuration. All modules\n * are defined to the same class loader. </p>\n *\n * <pre>{@code\n *     ModuleFinder finder = ModuleFinder.of(dir1, dir2, dir3);\n *\n *     ModuleLayer parent = ModuleLayer.boot();\n *\n *     Configuration cf = parent.configuration().resolve(finder, ModuleFinder.of(), Set.of(\"myapp\"));\n *\n *     ClassLoader scl = ClassLoader.getSystemClassLoader();\n *\n *     ModuleLayer layer = parent.defineModulesWithOneLoader(cf, scl);\n *\n *     Class<?> c = layer.findLoader(\"myapp\").loadClass(\"app.Main\");\n * }</pre>\n *\n * @since 9\n * @spec JPMS\n * @see Module#getLayer()\n */\npublic final class ModuleLayer {\n    // the empty layer\n    private static final ModuleLayer EMPTY_LAYER\n        = new ModuleLayer(Configuration.empty(), List.of(), null);\n    // the configuration from which this layer was created\n    private final Configuration cf;\n    // parent layers, empty in the case of the empty layer\n    private final List<ModuleLayer> parents;\n    // maps module name to jlr.Module\n    private final Map<String, Module> nameToModule;\n    /**\n     * Creates a new module layer from the modules in the given configuration.\n     */\n    private ModuleLayer(Configuration cf,\n                        List<ModuleLayer> parents,\n                        Function<String, ClassLoader> clf)\n    {\n        this.cf = cf;\n        this.parents = parents; // no need to do defensive copy\n        Map<String, Module> map;\n        if (parents.isEmpty()) {\n            map = Map.of();\n        } else {\n            map = Module.defineModules(cf, clf, this);\n        }\n        this.nameToModule = map; // no need to do defensive copy\n    }\n    /**\n     * Controls a module layer. The static methods defined by {@link ModuleLayer}\n     * to create module layers return a {@code Controller} that can be used to\n     * control modules in the layer.\n     *\n     * <p> Unless otherwise specified, passing a {@code null} argument to a\n     * method in this class causes a {@link NullPointerException\n     * NullPointerException} to be thrown. </p>\n     *\n     * @apiNote Care should be taken with {@code Controller} objects, they\n     * should never be shared with untrusted code.\n     *\n     * @since 9\n     * @spec JPMS\n     */\n    public static final class Controller {\n        private final ModuleLayer layer;\n        Controller(ModuleLayer layer) {\n            this.layer = layer;\n        }\n        /**\n         * Returns the layer that this object controls.\n         *\n         * @return the module layer\n         */\n        public ModuleLayer layer() {\n            return layer;\n        }\n        private void ensureInLayer(Module source) {\n            if (source.getLayer() != layer)\n                throw new IllegalArgumentException(source + \" not in layer\");\n        }\n        /**\n         * Updates module {@code source} in the layer to read module\n         * {@code target}. This method is a no-op if {@code source} already\n         * reads {@code target}.\n         *\n         * @implNote <em>Read edges</em> added by this method are <em>weak</em>\n         * and do not prevent {@code target} from being GC'ed when {@code source}\n         * is strongly reachable.\n         *\n         * @param  source\n         *         The source module\n         * @param  target\n         *         The target module to read\n         *\n         * @return This controller\n         *\n         * @throws IllegalArgumentException\n         *         If {@code source} is not in the module layer\n         *\n         * @see Module#addReads\n         */\n        public Controller addReads(Module source, Module target) {\n            ensureInLayer(source);\n            source.implAddReads(target);\n            return this;\n        }\n        /**\n         * Updates module {@code source} in the layer to export a package to\n         * module {@code target}. This method is a no-op if {@code source}\n         * already exports the package to at least {@code target}.\n         *\n         * @param  source\n         *         The source module\n         * @param  pn\n         *         The package name\n         * @param  target\n         *         The target module\n         *\n         * @return This controller\n         *\n         * @throws IllegalArgumentException\n         *         If {@code source} is not in the module layer or the package\n         *         is not in the source module\n         *\n         * @see Module#addExports\n         */\n        public Controller addExports(Module source, String pn, Module target) {\n            ensureInLayer(source);\n            source.implAddExports(pn, target);\n            return this;\n        }\n        /**\n         * Updates module {@code source} in the layer to open a package to\n         * module {@code target}. This method is a no-op if {@code source}\n         * already opens the package to at least {@code target}.\n         *\n         * @param  source\n         *         The source module\n         * @param  pn\n         *         The package name\n         * @param  target\n         *         The target module\n         *\n         * @return This controller\n         *\n         * @throws IllegalArgumentException\n         *         If {@code source} is not in the module layer or the package\n         *         is not in the source module\n         *\n         * @see Module#addOpens\n         */\n        public Controller addOpens(Module source, String pn, Module target) {\n            ensureInLayer(source);\n            source.implAddOpens(pn, target);\n            return this;\n        }\n    }\n    /**\n     * Creates a new module layer, with this layer as its parent, by defining the\n     * modules in the given {@code Configuration} to the Java virtual machine.\n     * This method creates one class loader and defines all modules to that\n     * class loader. The {@link ClassLoader#getParent() parent} of each class\n     * loader is the given parent class loader. This method works exactly as\n     * specified by the static {@link\n     * #defineModulesWithOneLoader(Configuration,List,ClassLoader)\n     * defineModulesWithOneLoader} method when invoked with this layer as the\n     * parent. In other words, if this layer is {@code thisLayer} then this\n     * method is equivalent to invoking:\n     * <pre> {@code\n     *     ModuleLayer.defineModulesWithOneLoader(cf, List.of(thisLayer), parentLoader).layer();\n     * }</pre>\n     *\n     * @param  cf\n     *         The configuration for the layer\n     * @param  parentLoader\n     *         The parent class loader for the class loader created by this\n     *         method; may be {@code null} for the bootstrap class loader\n     *\n     * @return The newly created layer\n     *\n     * @throws IllegalArgumentException\n     *         If the given configuration has more than one parent or the parent\n     *         of the configuration is not the configuration for this layer\n     * @throws LayerInstantiationException\n     *         If the layer cannot be created for any of the reasons specified\n     *         by the static {@code defineModulesWithOneLoader} method\n     * @throws SecurityException\n     *         If {@code RuntimePermission(\"createClassLoader\")} or\n     *         {@code RuntimePermission(\"getClassLoader\")} is denied by\n     *         the security manager\n     *\n     * @see #findLoader\n     */\n    public ModuleLayer defineModulesWithOneLoader(Configuration cf,\n                                                  ClassLoader parentLoader) {\n        return defineModulesWithOneLoader(cf, List.of(this), parentLoader).layer();\n    }\n    /**\n     * Creates a new module layer, with this layer as its parent, by defining the\n     * modules in the given {@code Configuration} to the Java virtual machine.\n     * Each module is defined to its own {@link ClassLoader} created by this\n     * method. The {@link ClassLoader#getParent() parent} of each class loader\n     * is the given parent class loader. This method works exactly as specified\n     * by the static {@link\n     * #defineModulesWithManyLoaders(Configuration,List,ClassLoader)\n     * defineModulesWithManyLoaders} method when invoked with this layer as the\n     * parent. In other words, if this layer is {@code thisLayer} then this\n     * method is equivalent to invoking:\n     * <pre> {@code\n     *     ModuleLayer.defineModulesWithManyLoaders(cf, List.of(thisLayer), parentLoader).layer();\n     * }</pre>\n     *\n     * @param  cf\n     *         The configuration for the layer\n     * @param  parentLoader\n     *         The parent class loader for each of the class loaders created by\n     *         this method; may be {@code null} for the bootstrap class loader\n     *\n     * @return The newly created layer\n     *\n     * @throws IllegalArgumentException\n     *         If the given configuration has more than one parent or the parent\n     *         of the configuration is not the configuration for this layer\n     * @throws LayerInstantiationException\n     *         If the layer cannot be created for any of the reasons specified\n     *         by the static {@code defineModulesWithManyLoaders} method\n     * @throws SecurityException\n     *         If {@code RuntimePermission(\"createClassLoader\")} or\n     *         {@code RuntimePermission(\"getClassLoader\")} is denied by\n     *         the security manager\n     *\n     * @see #findLoader\n     */\n    public ModuleLayer defineModulesWithManyLoaders(Configuration cf,\n                                                    ClassLoader parentLoader) {\n        return defineModulesWithManyLoaders(cf, List.of(this), parentLoader).layer();\n    }\n    /**\n     * Creates a new module layer, with this layer as its parent, by defining the\n     * modules in the given {@code Configuration} to the Java virtual machine.\n     * Each module is mapped, by name, to its class loader by means of the\n     * given function. This method works exactly as specified by the static\n     * {@link #defineModules(Configuration,List,Function) defineModules}\n     * method when invoked with this layer as the parent. In other words, if\n     * this layer is {@code thisLayer} then this method is equivalent to\n     * invoking:\n     * <pre> {@code\n     *     ModuleLayer.defineModules(cf, List.of(thisLayer), clf).layer();\n     * }</pre>\n     *\n     * @param  cf\n     *         The configuration for the layer\n     * @param  clf\n     *         The function to map a module name to a class loader\n     *\n     * @return The newly created layer\n     *\n     * @throws IllegalArgumentException\n     *         If the given configuration has more than one parent or the parent\n     *         of the configuration is not the configuration for this layer\n     * @throws LayerInstantiationException\n     *         If the layer cannot be created for any of the reasons specified\n     *         by the static {@code defineModules} method\n     * @throws SecurityException\n     *         If {@code RuntimePermission(\"getClassLoader\")} is denied by\n     *         the security manager\n     */\n    public ModuleLayer defineModules(Configuration cf,\n                                     Function<String, ClassLoader> clf) {\n        return defineModules(cf, List.of(this), clf).layer();\n    }\n    /**\n     * Creates a new module layer by defining the modules in the given {@code\n     * Configuration} to the Java virtual machine. This method creates one\n     * class loader and defines all modules to that class loader.\n     *\n     * <p> The class loader created by this method implements <em>direct\n     * delegation</em> when loading classes from modules. If the {@link\n     * ClassLoader#loadClass(String, boolean) loadClass} method is invoked to\n     * load a class then it uses the package name of the class to map it to a\n     * module. This may be a module in this layer and hence defined to the same\n     * class loader. It may be a package in a module in a parent layer that is\n     * exported to one or more of the modules in this layer. The class\n     * loader delegates to the class loader of the module, throwing {@code\n     * ClassNotFoundException} if not found by that class loader.\n     * When {@code loadClass} is invoked to load classes that do not map to a\n     * module then it delegates to the parent class loader. </p>\n     *\n     * <p> The class loader created by this method locates resources\n     * ({@link ClassLoader#getResource(String) getResource}, {@link\n     * ClassLoader#getResources(String) getResources}, and other resource\n     * methods) in all modules in the layer before searching the parent class\n     * loader. </p>\n     *\n     * <p> Attempting to create a layer with all modules defined to the same\n     * class loader can fail for the following reasons:\n     *\n     * <ul>\n     *\n     *     <li><p> <em>Overlapping packages</em>: Two or more modules in the\n     *     configuration have the same package. </p></li>\n     *\n     *     <li><p> <em>Split delegation</em>: The resulting class loader would\n     *     need to delegate to more than one class loader in order to load\n     *     classes in a specific package. </p></li>\n     *\n     * </ul>\n     *\n     * <p> In addition, a layer cannot be created if the configuration contains\n     * a module named \"{@code java.base}\", or a module contains a package named\n     * \"{@code java}\" or a package with a name starting with \"{@code java.}\". </p>\n     *\n     * <p> If there is a security manager then the class loader created by\n     * this method will load classes and resources with privileges that are\n     * restricted by the calling context of this method. </p>\n     *\n     * @param  cf\n     *         The configuration for the layer\n     * @param  parentLayers\n     *         The list of parent layers in search order\n     * @param  parentLoader\n     *         The parent class loader for the class loader created by this\n     *         method; may be {@code null} for the bootstrap class loader\n     *\n     * @return A controller that controls the newly created layer\n     *\n     * @throws IllegalArgumentException\n     *         If the parent(s) of the given configuration do not match the\n     *         configuration of the parent layers, including order\n     * @throws LayerInstantiationException\n     *         If all modules cannot be defined to the same class loader for any\n     *         of the reasons listed above\n     * @throws SecurityException\n     *         If {@code RuntimePermission(\"createClassLoader\")} or\n     *         {@code RuntimePermission(\"getClassLoader\")} is denied by\n     *         the security manager\n     *\n     * @see #findLoader\n     */\n    public static Controller defineModulesWithOneLoader(Configuration cf,\n                                                        List<ModuleLayer> parentLayers,\n                                                        ClassLoader parentLoader)\n    {\n        List<ModuleLayer> parents = new ArrayList<>(parentLayers);\n        checkConfiguration(cf, parents);\n        checkCreateClassLoaderPermission();\n        checkGetClassLoaderPermission();\n        try {\n            Loader loader = new Loader(cf.modules(), parentLoader);\n            loader.initRemotePackageMap(cf, parents);\n            ModuleLayer layer = new ModuleLayer(cf, parents, mn -> loader);\n            return new Controller(layer);\n        } catch (IllegalArgumentException | IllegalStateException e) {\n            throw new LayerInstantiationException(e.getMessage());\n        }\n    }\n    /**\n     * Creates a new module layer by defining the modules in the given {@code\n     * Configuration} to the Java virtual machine. Each module is defined to\n     * its own {@link ClassLoader} created by this method. The {@link\n     * ClassLoader#getParent() parent} of each class loader is the given parent\n     * class loader.\n     *\n     * <p> The class loaders created by this method implement <em>direct\n     * delegation</em> when loading classes from modules. If the {@link\n     * ClassLoader#loadClass(String, boolean) loadClass} method is invoked to\n     * load a class then it uses the package name of the class to map it to a\n     * module. The package may be in the module defined to the class loader.\n     * The package may be exported by another module in this layer to the\n     * module defined to the class loader. It may be in a package exported by a\n     * module in a parent layer. The class loader delegates to the class loader\n     * of the module, throwing {@code ClassNotFoundException} if not found by\n     * that class loader. When {@code loadClass} is invoked to load a class\n     * that does not map to a module then it delegates to the parent class\n     * loader. </p>\n     *\n     * <p> The class loaders created by this method locate resources\n     * ({@link ClassLoader#getResource(String) getResource}, {@link\n     * ClassLoader#getResources(String) getResources}, and other resource\n     * methods) in the module defined to the class loader before searching\n     * the parent class loader. </p>\n     *\n     * <p> If there is a security manager then the class loaders created by\n     * this method will load classes and resources with privileges that are\n     * restricted by the calling context of this method. </p>\n     *\n     * @param  cf\n     *         The configuration for the layer\n     * @param  parentLayers\n     *         The list of parent layers in search order\n     * @param  parentLoader\n     *         The parent class loader for each of the class loaders created by\n     *         this method; may be {@code null} for the bootstrap class loader\n     *\n     * @return A controller that controls the newly created layer\n     *\n     * @throws IllegalArgumentException\n     *         If the parent(s) of the given configuration do not match the\n     *         configuration of the parent layers, including order\n     * @throws LayerInstantiationException\n     *         If the layer cannot be created because the configuration contains\n     *         a module named \"{@code java.base}\" or a module contains a package\n     *         named \"{@code java}\" or a package with a name starting with\n     *         \"{@code java.}\"\n     *\n     * @throws SecurityException\n     *         If {@code RuntimePermission(\"createClassLoader\")} or\n     *         {@code RuntimePermission(\"getClassLoader\")} is denied by\n     *         the security manager\n     *\n     * @see #findLoader\n     */\n    public static Controller defineModulesWithManyLoaders(Configuration cf,\n                                                          List<ModuleLayer> parentLayers,\n                                                          ClassLoader parentLoader)\n    {\n        List<ModuleLayer> parents = new ArrayList<>(parentLayers);\n        checkConfiguration(cf, parents);\n        checkCreateClassLoaderPermission();\n        checkGetClassLoaderPermission();\n        LoaderPool pool = new LoaderPool(cf, parents, parentLoader);\n        try {\n            ModuleLayer layer = new ModuleLayer(cf, parents, pool::loaderFor);\n            return new Controller(layer);\n        } catch (IllegalArgumentException | IllegalStateException e) {\n            throw new LayerInstantiationException(e.getMessage());\n        }\n    }\n    /**\n     * Creates a new module layer by defining the modules in the given {@code\n     * Configuration} to the Java virtual machine. The given function maps each\n     * module in the configuration, by name, to a class loader. Creating the\n     * layer informs the Java virtual machine about the classes that may be\n     * loaded so that the Java virtual machine knows which module that each\n     * class is a member of.\n     *\n     * <p> The class loader delegation implemented by the class loaders must\n     * respect module readability. The class loaders should be\n     * {@link ClassLoader#registerAsParallelCapable parallel-capable} so as to\n     * avoid deadlocks during class loading. In addition, the entity creating\n     * a new layer with this method should arrange that the class loaders be\n     * ready to load from these modules before there are any attempts to load\n     * classes or resources. </p>\n     *\n     * <p> Creating a layer can fail for the following reasons: </p>\n     *\n     * <ul>\n     *\n     *     <li><p> Two or more modules with the same package are mapped to the\n     *     same class loader. </p></li>\n     *\n     *     <li><p> A module is mapped to a class loader that already has a\n     *     module of the same name defined to it. </p></li>\n     *\n     *     <li><p> A module is mapped to a class loader that has already\n     *     defined types in any of the packages in the module. </p></li>\n     *\n     * </ul>\n     *\n     * <p> In addition, a layer cannot be created if the configuration contains\n     * a module named \"{@code java.base}\", a configuration contains a module\n     * with a package named \"{@code java}\" or a package name starting with\n     * \"{@code java.}\", or the function to map a module name to a class loader\n     * returns {@code null} or the {@linkplain ClassLoader#getPlatformClassLoader()\n     * platform class loader}. </p>\n     *\n     * <p> If the function to map a module name to class loader throws an error\n     * or runtime exception then it is propagated to the caller of this method.\n     * </p>\n     *\n     * @apiNote It is implementation specific as to whether creating a layer\n     * with this method is an atomic operation or not. Consequentially it is\n     * possible for this method to fail with some modules, but not all, defined\n     * to the Java virtual machine.\n     *\n     * @param  cf\n     *         The configuration for the layer\n     * @param  parentLayers\n     *         The list of parent layers in search order\n     * @param  clf\n     *         The function to map a module name to a class loader\n     *\n     * @return A controller that controls the newly created layer\n     *\n     * @throws IllegalArgumentException\n     *         If the parent(s) of the given configuration do not match the\n     *         configuration of the parent layers, including order\n     * @throws LayerInstantiationException\n     *         If creating the layer fails for any of the reasons listed above\n     * @throws SecurityException\n     *         If {@code RuntimePermission(\"getClassLoader\")} is denied by\n     *         the security manager\n     */\n    public static Controller defineModules(Configuration cf,\n                                           List<ModuleLayer> parentLayers,\n                                           Function<String, ClassLoader> clf)\n    {\n        List<ModuleLayer> parents = new ArrayList<>(parentLayers);\n        checkConfiguration(cf, parents);\n        Objects.requireNonNull(clf);\n        checkGetClassLoaderPermission();\n        // The boot layer is checked during module system initialization\n        if (boot() != null) {\n            checkForDuplicatePkgs(cf, clf);\n        }\n        try {\n            ModuleLayer layer = new ModuleLayer(cf, parents, clf);\n            return new Controller(layer);\n        } catch (IllegalArgumentException | IllegalStateException e) {\n            throw new LayerInstantiationException(e.getMessage());\n        }\n    }\n    /**\n     * Checks that the parent configurations match the configuration of\n     * the parent layers.\n     */\n    private static void checkConfiguration(Configuration cf,\n                                           List<ModuleLayer> parentLayers)\n    {\n        Objects.requireNonNull(cf);\n        List<Configuration> parentConfigurations = cf.parents();\n        if (parentLayers.size() != parentConfigurations.size())\n            throw new IllegalArgumentException(\"wrong number of parents\");\n        int index = 0;\n        for (ModuleLayer parent : parentLayers) {\n            if (parent.configuration() != parentConfigurations.get(index)) {\n                throw new IllegalArgumentException(\n                        \"Parent of configuration != configuration of this Layer\");\n            }\n            index++;\n        }\n    }\n    private static void checkCreateClassLoaderPermission() {\n        SecurityManager sm = System.getSecurityManager();\n        if (sm != null)\n            sm.checkPermission(SecurityConstants.CREATE_CLASSLOADER_PERMISSION);\n    }\n    private static void checkGetClassLoaderPermission() {\n", "answers": ["        SecurityManager sm = System.getSecurityManager();"], "incorrect_answer": "SecurityManager currentSecurity = getCurrentSecurity();"}]